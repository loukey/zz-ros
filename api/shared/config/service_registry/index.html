
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://loukey.github.io/zz-ros/api/shared/config/service_registry/">
      
      
        <link rel="prev" href="../di_container/">
      
      
      
        
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Service Registry - 镇中科技机械臂控制系统文档</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#service-registry" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../../.." title="镇中科技机械臂控制系统文档" class="md-header__button md-logo" aria-label="镇中科技机械臂控制系统文档" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            镇中科技机械臂控制系统文档
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Service Registry
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="切换到深色模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="切换到深色模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="切换到浅色模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换到浅色模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/loukey/zz-ros/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    loukey/zz-ros
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../.." class="md-tabs__link">
          
  
  
  Index

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../introduction/dh_setting/" class="md-tabs__link">
          
  
  
  Introduction

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../cv/" class="md-tabs__link">
          
  
  
  Computer Vision

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../application/services/camera/" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="镇中科技机械臂控制系统文档" class="md-nav__button md-logo" aria-label="镇中科技机械臂控制系统文档" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    镇中科技机械臂控制系统文档
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/loukey/zz-ros/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    loukey/zz-ros
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Index
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Index
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    项目结构概览
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../index/quick_start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    快速开始
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_3" >
        
          
          <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    配置
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    配置
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../index/config/message_config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    消息配置
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../index/config/kinematic_config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    运动学配置
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../index/config/dynamic_config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    动力学配置
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../index/config/hand_eye_config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    手眼标定配置
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../index/config/save_config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    轨迹保存设置
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Introduction
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../introduction/dh_setting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    机械臂DH设置
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../introduction/hand_eye_calibration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    手眼标定
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../introduction/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    基础知识
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Computer Vision
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Computer Vision
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    模块概述
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cv/quick_start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    快速开始
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cv/detectors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    检测器架构
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cv/data_tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    数据工具
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Application
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Application
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_1" id="__nav_4_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Services
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Services
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../application/services/camera/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Camera Service
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../application/services/serial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Serial Service
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../application/services/motion_planning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Motion Planning Service
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../application/services/tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tools Service
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../application/services/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Base Service
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../application/services/command_hub/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Command Hub Service
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../application/services/message_response/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Message Response Service
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_2" >
        
          
          <label class="md-nav__link" for="__nav_4_1_2" id="__nav_4_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Commands
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Commands
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../application/commands/message_display/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Message Display
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1_3" >
        
          
          <label class="md-nav__link" for="__nav_4_1_3" id="__nav_4_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Listeners
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Listeners
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../application/listeners/motion_listener/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Motion Listener
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Domain
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Domain
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../domain/entities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Entities
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2_2" id="__nav_4_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Services
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Services
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../domain/algorithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Algorithm
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../domain/communication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Communication
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../domain/motion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Motion
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../domain/planning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Planning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../domain/state/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    State
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../domain/vision/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Vision
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../domain/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../domain/value_objects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Value Objects
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Infrastructure
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Infrastructure
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3_1" >
        
          
          <label class="md-nav__link" for="__nav_4_3_1" id="__nav_4_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Communication
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Communication
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../infrastructure/communication/adapter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Serial Adapter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../infrastructure/communication/reader/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Serial Reader
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../infrastructure/communication/writer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Serial Writer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../infrastructure/communication/scanner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Port Scanner
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3_2" >
        
          
          <label class="md-nav__link" for="__nav_4_3_2" id="__nav_4_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Persistence
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Persistence
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../infrastructure/persistence/trajectory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Trajectory Repository
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../infrastructure/persistence/record/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Record Repository
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../infrastructure/persistence/motion_plan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Motion Plan Repository
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../infrastructure/persistence/calibration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Calibration Repository
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Presentation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Presentation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_4_1" id="__nav_4_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Core
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Core
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../presentation/core/main/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Main ViewModel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../presentation/core/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Base ViewModel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../presentation/core/display/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Display ViewModel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_4_2" id="__nav_4_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Device Control
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Device Control
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../presentation/device/serial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Serial ViewModel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../presentation/device/control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Control ViewModel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../presentation/device/status/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Status ViewModel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../presentation/device/effector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Effector ViewModel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_4_3" id="__nav_4_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Features
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Features
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../presentation/features/camera/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Camera ViewModel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../presentation/features/dynamics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dynamics ViewModel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../presentation/features/motion_planning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Motion Planning ViewModel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../presentation/features/tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tools ViewModel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../presentation/features/trajectory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Trajectory ViewModel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" checked>
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Shared
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Shared
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5_1" checked>
        
          
          <label class="md-nav__link" for="__nav_4_5_1" id="__nav_4_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_5_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_5_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Configuration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../di_container/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DI Container
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Service Registry
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Service Registry
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;service_registry
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" service_registry">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialApplicationService" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SerialApplicationService
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" SerialApplicationService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialApplicationService.refresh_ports" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;refresh_ports
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialApplicationService.get_port_info" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_port_info
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialApplicationService.get_available_ports" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_available_ports
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialApplicationService.get_current_port" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_current_port
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialApplicationService.connect_serial" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;connect_serial
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialApplicationService.disconnect_serial" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;disconnect_serial
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialApplicationService.is_connected" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_connected
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialApplicationService.cleanup" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;cleanup
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CommandHubService" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CommandHubService
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" CommandHubService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CommandHubService.single_send_command" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;single_send_command
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CommandHubService.command_distribution" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;command_distribution
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CommandHubService.get_current_position" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_current_position
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CommandHubService.run_teach_record" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;run_teach_record
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CommandHubService.run_motion_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;run_motion_sequence
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MessageResponseService" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MessageResponseService
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MessageResponseService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MessageResponseService.handle_message" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;handle_message
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MessageResponseService.handle_motion_message" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;handle_motion_message
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningApplicationService" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MotionPlanningApplicationService
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MotionPlanningApplicationService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningApplicationService.create_plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;create_plan
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningApplicationService.delete_plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;delete_plan
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningApplicationService.switch_plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;switch_plan
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningApplicationService.rename_plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rename_plan
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningApplicationService.add_point" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;add_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningApplicationService.delete_point" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;delete_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningApplicationService.move_point_up" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;move_point_up
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningApplicationService.move_point_down" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;move_point_down
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningApplicationService.update_point" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningApplicationService.get_single_point" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_single_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningApplicationService.execute_single_point" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;execute_single_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningApplicationService.execute_motion_plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;execute_motion_plan
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningApplicationService.request_current_position" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;request_current_position
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningApplicationService.save_node_trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save_node_trajectory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningApplicationService.save_plan_trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save_plan_trajectory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningApplicationService.preview_node_trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;preview_node_trajectory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningApplicationService.preview_plan_trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;preview_plan_trajectory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningApplicationService.load_local_trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load_local_trajectory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningApplicationService.get_local_trajectory_files" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_local_trajectory_files
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraApplicationService" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CameraApplicationService
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" CameraApplicationService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraApplicationService.connect_camera" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;connect_camera
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraApplicationService.disconnect_camera" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;disconnect_camera
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraApplicationService.start_detection" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;start_detection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraApplicationService.stop_detection" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stop_detection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraApplicationService.move_to_detected_part" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;move_to_detected_part
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraApplicationService.is_camera_connected" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_camera_connected
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraApplicationService.is_color_available" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_color_available
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraApplicationService.is_depth_available" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_depth_available
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraApplicationService.get_latest_color_image" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_latest_color_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraApplicationService.get_latest_depth_image" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_latest_depth_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraApplicationService.visualize_depth_image" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;visualize_depth_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraApplicationService.is_detection_running" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_detection_running
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraApplicationService.get_latest_detection_result" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_latest_detection_result
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraApplicationService.get_image_with_detection" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_image_with_detection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.ToolsApplicationService" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ToolsApplicationService
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ToolsApplicationService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.ToolsApplicationService.calculate_forward_kinematics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;calculate_forward_kinematics
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.ToolsApplicationService.get_current_joint_angles" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_current_joint_angles
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.ToolsApplicationService.calculate_inverse_kinematics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;calculate_inverse_kinematics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MessageDisplay" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MessageDisplay
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MessageDisplay">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MessageDisplay.display_message" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;display_message
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MessageDisplay.clear_messages" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;clear_messages
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionListener" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MotionListener
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MotionListener">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionListener.handle_motion_msg" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;handle_motion_msg
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.BaseViewModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BaseViewModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BaseViewModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.BaseViewModel.cleanup" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;cleanup
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MainViewModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MainViewModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MainViewModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MainViewModel.cleanup" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;cleanup
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialViewModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SerialViewModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" SerialViewModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialViewModel.refresh_ports" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;refresh_ports
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialViewModel.connect_serial" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;connect_serial
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialViewModel.disconnect_serial" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;disconnect_serial
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialViewModel.get_available_ports" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_available_ports
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialViewModel.get_current_port" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_current_port
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialViewModel.get_connection_status" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_connection_status
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialViewModel.get_port_info" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_port_info
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialViewModel.cleanup" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;cleanup
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.DisplayViewModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DisplayViewModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" DisplayViewModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.DisplayViewModel.clear_messages" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;clear_messages
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.DisplayViewModel.cleanup" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;cleanup
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.ControlViewModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ControlViewModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ControlViewModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.ControlViewModel.send_command" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;send_command
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.StatusViewModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;StatusViewModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" StatusViewModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.StatusViewModel.get_position_string" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_position_string
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.StatusViewModel.get_status_summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_status_summary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.EffectorViewModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;EffectorViewModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" EffectorViewModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.EffectorViewModel.send_effector_command" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;send_effector_command
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TrajectoryViewModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TrajectoryViewModel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.DynamicsViewModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DynamicsViewModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" DynamicsViewModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.DynamicsViewModel.toggle_teaching_mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;toggle_teaching_mode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.DynamicsViewModel.send_torque" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;send_torque
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.DynamicsViewModel.toggle_recording" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;toggle_recording
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.DynamicsViewModel.delete_record" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;delete_record
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.DynamicsViewModel.run_record" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;run_record
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.DynamicsViewModel.reverse_record" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reverse_record
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.DynamicsViewModel.get_record_names" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_record_names
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.DynamicsViewModel.is_recording" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_recording
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraViewModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CameraViewModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" CameraViewModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraViewModel.connect_camera" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;connect_camera
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraViewModel.disconnect_camera" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;disconnect_camera
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraViewModel.start_color_display" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;start_color_display
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraViewModel.start_depth_display" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;start_depth_display
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraViewModel.stop_display" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stop_display
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraViewModel.start_detection" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;start_detection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraViewModel.stop_detection" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stop_detection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraViewModel.move_to_detected_part" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;move_to_detected_part
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraViewModel.cleanup" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;cleanup
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MotionPlanningViewModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MotionPlanningViewModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.create_plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;create_plan
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.delete_plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;delete_plan
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.switch_plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;switch_plan
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.rename_plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rename_plan
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.get_plan_names" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_plan_names
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.get_current_plan_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_current_plan_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.get_plan_count" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_plan_count
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.add_point" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;add_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.delete_point" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;delete_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.move_point_up" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;move_point_up
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.move_point_down" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;move_point_down
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.update_point" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.get_all_points" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_all_points
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.get_single_point" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_single_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.get_teach_record_names" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_teach_record_names
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.get_teach_record" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_teach_record
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.execute_single_point" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;execute_single_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.execute_motion_plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;execute_motion_plan
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.request_current_position" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;request_current_position
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.save_node_trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save_node_trajectory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.save_plan_trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save_plan_trajectory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.preview_node_trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;preview_node_trajectory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.preview_plan_trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;preview_plan_trajectory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.load_local_trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load_local_trajectory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningViewModel.get_local_trajectory_files" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_local_trajectory_files
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.ToolsViewModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ToolsViewModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ToolsViewModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.ToolsViewModel.calculate_kinematics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;calculate_kinematics
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.ToolsViewModel.get_current_position" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_current_position
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.ToolsViewModel.calculate_inverse_kinematics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;calculate_inverse_kinematics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.DHParam" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DHParam
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" DHParam">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.DHParam.get_kinematic_dh" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_kinematic_dh
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.DHParam.get_dynamic_dh" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_dynamic_dh
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RobotStateSnapshot" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;RobotStateSnapshot
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" RobotStateSnapshot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RobotStateSnapshot.from_decoded_message" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_decoded_message
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.HandEyeCalibrationConfig" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;HandEyeCalibrationConfig
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" HandEyeCalibrationConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.HandEyeCalibrationConfig.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__post_init__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraIntrinsics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CameraIntrinsics
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TargetOffset" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TargetOffset
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" TargetOffset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TargetOffset.to_array" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_array
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.EndEffectorAdjustment" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;EndEffectorAdjustment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionOperationMode" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MotionOperationMode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.KinematicUtils" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;KinematicUtils
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" KinematicUtils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.KinematicUtils.dh2rm" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;dh2rm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.KinematicUtils.rm2quat" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rm2quat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.KinematicUtils.quat2rm" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;quat2rm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.KinematicUtils.quat2euler" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;quat2euler
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.KinematicUtils.euler2quat" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;euler2quat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.KinematicUtils.euler2rm" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;euler2rm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.KinematicUtils.rm2euler" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rm2euler
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.KinematicUtils.normalize_angle" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;normalize_angle
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MessageEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MessageEncoder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MessageEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MessageEncoder.create_message" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;create_message
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MessageEncoder.interpret_message" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;interpret_message
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MessageDecoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MessageDecoder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MessageDecoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MessageDecoder.decode_message" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;decode_message
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MessageDecoder.decode_message_detailed" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;decode_message_detailed
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RobotUtils" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;RobotUtils
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" RobotUtils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RobotUtils.position2radian" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;position2radian
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RobotUtils.radian2position" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;radian2position
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RobotUtils.speed2position" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;speed2position
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RobotUtils.torque_transfer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;torque_transfer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RobotUtils.effector2hex" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;effector2hex
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RobotUtils.calculate_crc16" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;calculate_crc16
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.ImageDrawingUtils" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ImageDrawingUtils
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ImageDrawingUtils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.ImageDrawingUtils.draw_detection_result" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;draw_detection_result
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.ImageDrawingUtils.draw_direction_arrow" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;draw_direction_arrow
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.KinematicDomainService" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;KinematicDomainService
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" KinematicDomainService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.KinematicDomainService.get_kinematic_dh" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_kinematic_dh
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.KinematicDomainService.get_gripper2base" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_gripper2base
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.KinematicDomainService.get_gripper2base_rm" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_gripper2base_rm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.KinematicDomainService.inverse_kinematic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;inverse_kinematic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.KinematicDomainService.verify_solution" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;verify_solution
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.DynamicDomainService" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DynamicDomainService
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" DynamicDomainService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.DynamicDomainService.compute_gravity_compensation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute_gravity_compensation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MessageDomainService" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MessageDomainService
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MessageDomainService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MessageDomainService.encode_message" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;encode_message
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MessageDomainService.decode_message" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;decode_message
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SCurve" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SCurve
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" SCurve">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SCurve.solve_cubic_numeric" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;solve_cubic_numeric
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SCurve.solve_quadratic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;solve_quadratic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SCurve.base_method" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;base_method
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SCurve.planning" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;planning
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SmoothDomainService" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SmoothDomainService
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" SmoothDomainService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SmoothDomainService.smooth_trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;smooth_trajectory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SmoothDomainService.spline_then_savgol" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;spline_then_savgol
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SmoothDomainService.toppra_smooth" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;toppra_smooth
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SmoothDomainService.remove_redundant_points" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;remove_redundant_points
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SmoothDomainService.resample_equal_arclen" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;resample_equal_arclen
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SmoothDomainService.affine_align_to_fixed_ends" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;affine_align_to_fixed_ends
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SmoothDomainService.teach_smooth" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;teach_smooth
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.LinearMotionDomainService" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LinearMotionDomainService
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LinearMotionDomainService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.LinearMotionDomainService.clamp" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;clamp
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.LinearMotionDomainService.linear_motion" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;linear_motion
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.LinearMotionDomainService.linear_motion_z_axis" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;linear_motion_z_axis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.LinearMotionDomainService.sampling" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sampling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.LinearMotionDomainService.smooth" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;smooth
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.LinearMotionDomainService.inverse_kinematic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;inverse_kinematic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.LinearMotionDomainService.wrap_to_pi" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;wrap_to_pi
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.LinearMotionDomainService.ensure_2d_array" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;ensure_2d_array
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.LinearMotionDomainService.toppra_time_parameterize" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;toppra_time_parameterize
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CurveMotionDomainService" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CurveMotionDomainService
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" CurveMotionDomainService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CurveMotionDomainService.clamp" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;clamp
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CurveMotionDomainService.curve_motion" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;curve_motion
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CurveMotionDomainService.make_pos_fun_spline" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;make_pos_fun_spline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CurveMotionDomainService.sample_parametric_equal_arclen" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sample_parametric_equal_arclen
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CurveMotionDomainService.wrap_to_pi" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;wrap_to_pi
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CurveMotionDomainService.ensure_2d_array" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;ensure_2d_array
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ensure_2d_array">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CurveMotionDomainService.ensure_2d_array--raises" class="md-nav__link">
    <span class="md-ellipsis">
      
        Raises
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CurveMotionDomainService.toppra_time_parameterize" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;toppra_time_parameterize
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialDomainService" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SerialDomainService
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" SerialDomainService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialDomainService.scan_available_ports" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;scan_available_ports
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialDomainService.get_port_info" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_port_info
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialDomainService.get_current_port" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_current_port
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialDomainService.is_connected" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_connected
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialDomainService.connect_port" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;connect_port
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialDomainService.disconnect_port" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;disconnect_port
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialDomainService.send_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;send_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialDomainService.cleanup" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;cleanup
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionRunner" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MotionRunner
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MotionRunner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionRunner.add_motion_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;add_motion_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionRunner.add_gripper_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;add_gripper_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionRunner.start_motion" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;start_motion
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionRunner.stop_motion" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stop_motion
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionRunner.clear_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;clear_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionRunner.motion_timeout" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;motion_timeout
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionConstructor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MotionConstructor
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MotionConstructor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionConstructor.prepare_operation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;prepare_operation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionConstructor.has_pending_operation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;has_pending_operation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionConstructor.get_operation_mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_operation_mode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionConstructor.get_pending_tasks" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_pending_tasks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionConstructor.get_operation_context" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_operation_context
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionConstructor.clear_operation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;clear_operation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionConstructor.execute_motion" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;execute_motion
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TrajectoryPlanningService" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TrajectoryPlanningService
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" TrajectoryPlanningService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TrajectoryPlanningService.plan_task_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;plan_task_sequence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TrajectoryPlanningService.plan_task_sequence_with_derivatives" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;plan_task_sequence_with_derivatives
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RobotStateDomainService" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;RobotStateDomainService
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" RobotStateDomainService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RobotStateDomainService.update_state" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update_state
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RobotStateDomainService.get_current_state" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_current_state
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RobotStateDomainService.get_current_angles" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_current_angles
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RobotStateDomainService.get_current_positions" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_current_positions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RobotStateDomainService.get_position_history" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_position_history
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RobotStateDomainService.get_friction_compensation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_friction_compensation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RobotStateDomainService.set_teaching_mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;set_teaching_mode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RobotStateDomainService.set_friction_config" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;set_friction_config
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RobotStateDomainService.clear_history" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;clear_history
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TeachRecordDomainService" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TeachRecordDomainService
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" TeachRecordDomainService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TeachRecordDomainService.start_recording" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;start_recording
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TeachRecordDomainService.stop_recording" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stop_recording
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TeachRecordDomainService.is_recording" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_recording
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TeachRecordDomainService.add_angle_to_current_record" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;add_angle_to_current_record
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TeachRecordDomainService.get_record_timer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_record_timer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TeachRecordDomainService.get_all_records" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_all_records
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TeachRecordDomainService.get_record_names" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_record_names
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TeachRecordDomainService.get_record" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_record
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TeachRecordDomainService.delete_record" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;delete_record
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TeachRecordDomainService.reverse_record" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reverse_record
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TeachRecordDomainService.load_records" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load_records
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TeachRecordDomainService.clear_all_records" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;clear_all_records
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningDomainService" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MotionPlanningDomainService
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MotionPlanningDomainService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningDomainService.initialize" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;initialize
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningDomainService.get_all_plans" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_all_plans
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningDomainService.create_plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;create_plan
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningDomainService.get_plan_names" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_plan_names
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningDomainService.get_current_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_current_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningDomainService.set_current_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;set_current_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningDomainService.delete_plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;delete_plan
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningDomainService.can_delete_plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;can_delete_plan
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningDomainService.rename_plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rename_plan
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningDomainService.get_current_plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_current_plan
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningDomainService.get_plan_count" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_plan_count
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningDomainService.add_point" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;add_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningDomainService.remove_point" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;remove_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningDomainService.move_point_up" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;move_point_up
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningDomainService.move_point_down" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;move_point_down
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningDomainService.update_point" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanningDomainService.get_all_points" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_all_points
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraDomainService" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CameraDomainService
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" CameraDomainService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraDomainService.connect" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;connect
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraDomainService.disconnect" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;disconnect
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraDomainService.get_latest_color_image" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_latest_color_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraDomainService.get_latest_depth_image" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_latest_depth_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraDomainService.is_color_available" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_color_available
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraDomainService.is_depth_available" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_depth_available
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.CameraDomainService.visualize_depth_image" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;visualize_depth_image
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RecognitionDomainService" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;RecognitionDomainService
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" RecognitionDomainService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RecognitionDomainService.start_detection" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;start_detection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RecognitionDomainService.stop_detection" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stop_detection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RecognitionDomainService.get_latest_result" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_latest_result
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RecognitionDomainService.is_detection_running" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_detection_running
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RecognitionDomainService.clear_result" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;clear_result
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.HandEyeTransformDomainService" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;HandEyeTransformDomainService
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" HandEyeTransformDomainService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.HandEyeTransformDomainService.calculate_target_joint_angles" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;calculate_target_joint_angles
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.HandEyeTransformDomainService.get_z_rotation_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_z_rotation_matrix
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.HandEyeTransformDomainService.get_y_rotation_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_y_rotation_matrix
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.HandEyeTransformDomainService.get_x_rotation_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_x_rotation_matrix
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlan" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MotionPlan
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MotionPlan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlan.add_point" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;add_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlan.remove_point" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;remove_point
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlan.move_point_up" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;move_point_up
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlan.move_point_down" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;move_point_down
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlan.update_point" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update_point
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.PortScanner" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PortScanner
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PortScanner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.PortScanner.scan_ports" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;scan_ports
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.PortScanner.get_port_info" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_port_info
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.PortScanner.get_all_port_info" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_all_port_info
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialAdapter" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SerialAdapter
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" SerialAdapter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialAdapter.connect" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;connect
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialAdapter.disconnect" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;disconnect
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialAdapter.is_connected" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_connected
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialAdapter.get_serial_port" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_serial_port
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialAdapter.get_current_config" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_current_config
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialAdapter.get_port_name" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_port_name
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialReader" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SerialReader
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" SerialReader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialReader.stop" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialReader.read_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;read_data
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialWriter" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SerialWriter
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" SerialWriter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialWriter.stop" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialWriter.add_to_queue" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;add_to_queue
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.SerialWriter.send_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;send_data
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RecordRepository" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;RecordRepository
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" RecordRepository">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RecordRepository.load_records" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load_records
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RecordRepository.save_records" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save_records
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.RecordRepository.delete_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;delete_file
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanRepository" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MotionPlanRepository
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" MotionPlanRepository">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanRepository.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.MotionPlanRepository.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.HandEyeCalibrationRepository" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;HandEyeCalibrationRepository
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" HandEyeCalibrationRepository">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.HandEyeCalibrationRepository.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.HandEyeCalibrationRepository.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TrajectoryRepository" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TrajectoryRepository
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" TrajectoryRepository">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TrajectoryRepository.save_trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save_trajectory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TrajectoryRepository.load_trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load_trajectory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TrajectoryRepository.list_trajectory_files" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;list_trajectory_files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.TrajectoryRepository.trajectory_exists" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;trajectory_exists
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.register_infrastructure_services" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;register_infrastructure_services
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.register_domain_services" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;register_domain_services
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.register_application_services" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;register_application_services
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.register_presentation_services" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;register_presentation_services
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.configure_services" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;configure_services
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.get_main_view_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_main_view_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.get_serial_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_serial_service
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.get_serial_view_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_serial_view_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.get_display_view_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_display_view_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controller.shared.config.service_registry.get_listener_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_listener_service
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="service-registry">Service Registry</h1>


<div class="doc doc-object doc-module">



<h2 id="controller.shared.config.service_registry" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">controller.shared.config.service_registry</span>


</h2>

    <div class="doc doc-contents first">

        <p>服务注册配置 - Shared Config
注册所有应用服务到DI容器 - 简化版</p>










<div class="doc doc-children">



















<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.SerialApplicationService" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">SerialApplicationService</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">SerialApplicationService</span><span class="p">(</span><span class="n">message_display</span><span class="p">:</span> <span class="n">MessageDisplay</span><span class="p">,</span> <span class="n">serial_domain_service</span><span class="p">:</span> <span class="n">SerialDomainService</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseService (controller.application.services.base_service.BaseService)" href="../../../application/services/base/#controller.application.services.base_service.BaseService">BaseService</a></code></p>



        <p>串口应用服务。</p>
<p>只负责串口连接管理和状态协调，不处理数据收发。
数据收发由各个Domain服务直接使用SerialDomainService。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.SerialApplicationService.connection_status_changed">connection_status_changed</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>串口连接状态变化信号。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.SerialApplicationService.port_list_updated">port_list_updated</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>端口列表更新信号。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化串口应用服务。</p>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/application/services/serial_application_service.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message_display</span><span class="p">:</span> <span class="n">MessageDisplay</span><span class="p">,</span> <span class="n">serial_domain_service</span><span class="p">:</span> <span class="n">SerialDomainService</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化串口应用服务。&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message_display</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">serial_domain_service</span> <span class="o">=</span> <span class="n">serial_domain_service</span>

    <span class="c1"># 连接Domain层信号到Application层</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_connect_domain_signals</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialApplicationService.refresh_ports" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">refresh_ports</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">refresh_ports</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>刷新可用端口列表。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[str]: 可用端口名称列表。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/serial_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">refresh_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;刷新可用端口列表。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: 可用端口名称列表。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">ports</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_domain_service</span><span class="o">.</span><span class="n">scan_available_ports</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">port_list_updated</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">ports</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;发现 </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ports</span><span class="p">)</span><span class="si">}</span><span class="s2"> 个可用端口&quot;</span><span class="p">,</span> <span class="s2">&quot;系统&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ports</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;刷新端口失败: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;错误&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialApplicationService.get_port_info" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_port_info</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_port_info</span><span class="p">(</span><span class="n">port_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取指定端口信息。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>port_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>端口名称。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[Dict[str, str]]: 端口信息字典，失败时返回None。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/serial_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_port_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">port_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取指定端口信息。</span>

<span class="sd">    Args:</span>
<span class="sd">        port_name (str): 端口名称。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[Dict[str, str]]: 端口信息字典，失败时返回None。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_domain_service</span><span class="o">.</span><span class="n">get_port_info</span><span class="p">(</span><span class="n">port_name</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;获取端口信息失败: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;错误&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialApplicationService.get_available_ports" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_available_ports</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_available_ports</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取当前可用端口列表（不刷新）。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[str]: 可用端口名称列表。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/serial_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_available_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取当前可用端口列表（不刷新）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: 可用端口名称列表。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_domain_service</span><span class="o">.</span><span class="n">scan_available_ports</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;获取端口列表失败: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;错误&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialApplicationService.get_current_port" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_current_port</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_current_port</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取当前连接的端口名称。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[str]: 端口名称，未连接时返回None。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/serial_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_current_port</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取当前连接的端口名称。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[str]: 端口名称，未连接时返回None。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_domain_service</span><span class="o">.</span><span class="n">get_current_port</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialApplicationService.connect_serial" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">connect_serial</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">connect_serial</span><span class="p">(</span><span class="n">port</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>连接串口。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>port</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>串口名称。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>串口配置参数。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>连接是否成功。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/serial_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">connect_serial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;连接串口。</span>

<span class="sd">    Args:</span>
<span class="sd">        port (str): 串口名称。</span>
<span class="sd">        config (Dict[str, Any]): 串口配置参数。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 连接是否成功。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;连接串口: </span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2">, 配置: </span><span class="si">{</span><span class="n">config</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;系统&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_domain_service</span><span class="o">.</span><span class="n">connect_port</span><span class="p">(</span><span class="n">port</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;成功连接到端口 </span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;系统&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">success</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;连接失败: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;错误&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialApplicationService.disconnect_serial" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">disconnect_serial</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">disconnect_serial</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>断开串口连接。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>断开是否成功。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/serial_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">disconnect_serial</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;断开串口连接。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 断开是否成功。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_domain_service</span><span class="o">.</span><span class="n">disconnect_port</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s2">&quot;已断开串口连接&quot;</span><span class="p">,</span> <span class="s2">&quot;系统&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">success</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;断开连接失败: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;错误&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialApplicationService.is_connected" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">is_connected</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_connected</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>检查串口是否已连接。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否已连接。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/serial_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;检查串口是否已连接。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 是否已连接。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_domain_service</span><span class="o">.</span><span class="n">is_connected</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialApplicationService.cleanup" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">cleanup</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">cleanup</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>清理资源。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/serial_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;清理资源。&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_disconnect_domain_signals</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serial_domain_service</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># 忽略清理时的异常 </span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.CommandHubService" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">CommandHubService</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">CommandHubService</span><span class="p">(</span><span class="n">message_domain_service</span><span class="p">:</span> <span class="n">MessageDomainService</span><span class="p">,</span> <span class="n">motion_runner</span><span class="p">:</span> <span class="n">MotionRunner</span><span class="p">,</span> <span class="n">serial_domain_service</span><span class="p">:</span> <span class="n">SerialDomainService</span><span class="p">,</span> <span class="n">message_display</span><span class="p">:</span> <span class="n">MessageDisplay</span><span class="p">,</span> <span class="n">motion_constructor</span><span class="p">:</span> <span class="n">MotionConstructor</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseService (controller.application.services.base_service.BaseService)" href="../../../application/services/base/#controller.application.services.base_service.BaseService">BaseService</a></code></p>



        <p>命令中心服务 - Application层。</p>
<p>职责：
1. 分发用户命令到不同的处理逻辑
2. 协调运动任务的准备和执行
3. 管理消息显示</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CommandHubService.message_domain_service">message_domain_service</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>消息领域服务。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CommandHubService.motion_runner">motion_runner</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运动执行器。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CommandHubService.serial_domain_service">serial_domain_service</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>串口领域服务。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CommandHubService.motion_constructor">motion_constructor</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运动构造器。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化命令中心服务。</p>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/application/services/command_hub_service.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
<span class="n">message_domain_service</span><span class="p">:</span> <span class="n">MessageDomainService</span><span class="p">,</span> 
<span class="n">motion_runner</span><span class="p">:</span> <span class="n">MotionRunner</span><span class="p">,</span>
<span class="n">serial_domain_service</span><span class="p">:</span> <span class="n">SerialDomainService</span><span class="p">,</span> 
<span class="n">message_display</span><span class="p">:</span> <span class="n">MessageDisplay</span><span class="p">,</span>
<span class="n">motion_constructor</span><span class="p">:</span> <span class="n">MotionConstructor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化命令中心服务。&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message_display</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">message_domain_service</span> <span class="o">=</span> <span class="n">message_domain_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">motion_runner</span> <span class="o">=</span> <span class="n">motion_runner</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">serial_domain_service</span> <span class="o">=</span> <span class="n">serial_domain_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">motion_constructor</span> <span class="o">=</span> <span class="n">motion_constructor</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CommandHubService.single_send_command" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">single_send_command</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">single_send_command</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>发送单个命令。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>命令参数，将被编码为消息帧。</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否发送成功。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/command_hub_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">single_send_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;发送单个命令。</span>

<span class="sd">    Args:</span>
<span class="sd">        **kwargs: 命令参数，将被编码为消息帧。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 是否发送成功。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">message_domain_service</span><span class="o">.</span><span class="n">encode_message</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="s2">&quot;发送&quot;</span><span class="p">)</span>
        <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_domain_service</span><span class="o">.</span><span class="n">send_data</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s2">&quot;发送失败：串口未连接&quot;</span><span class="p">,</span> <span class="s2">&quot;错误&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">success</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;发送命令失败: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;错误&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CommandHubService.command_distribution" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">command_distribution</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">command_distribution</span><span class="p">(</span><span class="n">config_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>分发用户命令到对应的处理逻辑。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>配置字典，包含 control, mode 等参数。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/command_hub_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">command_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;分发用户命令到对应的处理逻辑。</span>

<span class="sd">    Args:</span>
<span class="sd">        config_dict (dict): 配置字典，包含 control, mode 等参数。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">control</span> <span class="o">=</span> <span class="n">config_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;control&#39;</span><span class="p">)</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="n">config_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mode&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">control</span> <span class="ow">in</span> <span class="p">[</span><span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">single_send_command</span><span class="p">(</span><span class="o">**</span><span class="n">config_dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_current_position</span><span class="p">()</span>

    <span class="k">elif</span> <span class="n">control</span> <span class="o">==</span> <span class="mh">0x05</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="mh">0x0A</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s2">&quot;关闭示教模式&quot;</span><span class="p">,</span> <span class="s2">&quot;动力学&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">single_send_command</span><span class="p">(</span><span class="o">**</span><span class="n">config_dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">motion_runner</span><span class="o">.</span><span class="n">stop_motion</span><span class="p">()</span>

    <span class="k">elif</span> <span class="n">control</span> <span class="o">==</span> <span class="mh">0x07</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="mh">0x0A</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s2">&quot;开启示教模式&quot;</span><span class="p">,</span> <span class="s2">&quot;动力学&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">single_send_command</span><span class="p">(</span><span class="o">**</span><span class="n">config_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">!=</span> <span class="mh">0x0A</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_current_position</span><span class="p">()</span>

    <span class="k">elif</span> <span class="n">control</span> <span class="o">==</span> <span class="mh">0x06</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="mh">0x0A</span><span class="p">:</span>
            <span class="n">torque_values</span> <span class="o">=</span> <span class="n">config_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;torque&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;发送力矩: </span><span class="si">{</span><span class="n">torque_values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;动力学&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">single_send_command</span><span class="p">(</span><span class="o">**</span><span class="n">config_dict</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># 角度控制：默认使用 S 曲线和 0.01 频率</span>
            <span class="n">target_angles</span> <span class="o">=</span> <span class="n">config_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;target_angles&#39;</span><span class="p">)</span>
            <span class="n">task</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;motion&quot;</span><span class="p">,</span>
                <span class="s2">&quot;target_angles&quot;</span><span class="p">:</span> <span class="n">target_angles</span><span class="p">,</span>
                <span class="s2">&quot;curve_type&quot;</span><span class="p">:</span> <span class="s2">&quot;s_curve&quot;</span><span class="p">,</span>
                <span class="s2">&quot;frequency&quot;</span><span class="p">:</span> <span class="mf">0.01</span>
            <span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">motion_constructor</span><span class="o">.</span><span class="n">prepare_operation</span><span class="p">(</span>
                <span class="n">MotionOperationMode</span><span class="o">.</span><span class="n">EXECUTE</span><span class="p">,</span>
                <span class="p">[</span><span class="n">task</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;准备运动到目标位置: </span><span class="si">{</span><span class="n">target_angles</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;控制&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_current_position</span><span class="p">()</span>

    <span class="k">elif</span> <span class="n">control</span> <span class="o">==</span> <span class="mh">0x08</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">single_send_command</span><span class="p">(</span><span class="o">**</span><span class="n">config_dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">motion_runner</span><span class="o">.</span><span class="n">stop_motion</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CommandHubService.get_current_position" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_current_position</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_current_position</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>请求获取当前位置。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/command_hub_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_current_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;请求获取当前位置。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">message_display</span><span class="o">.</span><span class="n">clear_messages</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s2">&quot;正在获取当前位置...&quot;</span><span class="p">,</span> <span class="s2">&quot;控制&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">single_send_command</span><span class="p">(</span><span class="n">control</span><span class="o">=</span><span class="mh">0x07</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CommandHubService.run_teach_record" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">run_teach_record</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">run_teach_record</span><span class="p">(</span><span class="n">angles_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>运行示教记录（播放示教轨迹）。</p>
<p>流程：
1. 准备示教运动任务
2. 获取当前位置
3. 异步回调时自动构建平滑轨迹并执行</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>angles_list</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="list">list</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>示教记录的角度列表 [[θ1,...,θ6], ...]。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/command_hub_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_teach_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angles_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;运行示教记录（播放示教轨迹）。</span>

<span class="sd">    流程：</span>
<span class="sd">    1. 准备示教运动任务</span>
<span class="sd">    2. 获取当前位置</span>
<span class="sd">    3. 异步回调时自动构建平滑轨迹并执行</span>

<span class="sd">    Args:</span>
<span class="sd">        angles_list (list[list[float]]): 示教记录的角度列表 [[θ1,...,θ6], ...]。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">task</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;teach&quot;</span><span class="p">,</span>
        <span class="s2">&quot;teach_data&quot;</span><span class="p">:</span> <span class="n">angles_list</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">motion_constructor</span><span class="o">.</span><span class="n">prepare_operation</span><span class="p">(</span>
        <span class="n">MotionOperationMode</span><span class="o">.</span><span class="n">EXECUTE</span><span class="p">,</span>
        <span class="p">[</span><span class="n">task</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;准备播放示教轨迹，共 </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">angles_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> 个点&quot;</span><span class="p">,</span> <span class="s2">&quot;示教&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">get_current_position</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CommandHubService.run_motion_sequence" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">run_motion_sequence</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">run_motion_sequence</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>开始执行运动序列（用于运动规划方案）。</p>
<p>流程：
1. 查询当前位置
2. 收到位置反馈后，MotionConstructor 自动规划所有任务</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/command_hub_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_motion_sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;开始执行运动序列（用于运动规划方案）。</span>

<span class="sd">    流程：</span>
<span class="sd">    1. 查询当前位置</span>
<span class="sd">    2. 收到位置反馈后，MotionConstructor 自动规划所有任务</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s2">&quot;开始执行运动规划方案...&quot;</span><span class="p">,</span> <span class="s2">&quot;运动规划&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">get_current_position</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.MessageResponseService" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MessageResponseService</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">MessageResponseService</span><span class="p">(</span><span class="n">message_display</span><span class="p">:</span> <span class="n">MessageDisplay</span><span class="p">,</span> <span class="n">serial_domain_service</span><span class="p">:</span> <span class="n">SerialDomainService</span><span class="p">,</span> <span class="n">message_domain_service</span><span class="p">:</span> <span class="n">MessageDomainService</span><span class="p">,</span> <span class="n">robot_state_service</span><span class="p">:</span> <span class="n">RobotStateDomainService</span><span class="p">,</span> <span class="n">motion_runner</span><span class="p">:</span> <span class="n">MotionRunner</span><span class="p">,</span> <span class="n">motion_constructor</span><span class="p">:</span> <span class="n">MotionConstructor</span><span class="p">,</span> <span class="n">trajectory_planner</span><span class="p">:</span> <span class="n">TrajectoryPlanningService</span><span class="p">,</span> <span class="n">trajectory_repository</span><span class="p">:</span> <span class="n">TrajectoryRepository</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseService (controller.application.services.base_service.BaseService)" href="../../../application/services/base/#controller.application.services.base_service.BaseService">BaseService</a></code></p>



        <p>消息响应服务 - Application层。</p>
<p>处理串口接收的数据，解码并更新状态服务。</p>
<p>职责：
1. 接收串口数据
2. 拼接缓冲，检测完整帧
3. 解码消息
4. 更新状态服务（统一入口）
5. 根据操作模式分发处理（执行/保存/预览）</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MessageResponseService.get_current_position_signal">get_current_position_signal</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>获取当前位置信号（用于UI显示）。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MessageResponseService.trajectory_preview_signal">trajectory_preview_signal</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>轨迹预览数据信号。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化消息响应服务。</p>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/application/services/message_response_service.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">message_display</span><span class="p">:</span> <span class="n">MessageDisplay</span><span class="p">,</span>
    <span class="n">serial_domain_service</span><span class="p">:</span> <span class="n">SerialDomainService</span><span class="p">,</span>
    <span class="n">message_domain_service</span><span class="p">:</span> <span class="n">MessageDomainService</span><span class="p">,</span>
    <span class="n">robot_state_service</span><span class="p">:</span> <span class="n">RobotStateDomainService</span><span class="p">,</span>
    <span class="n">motion_runner</span><span class="p">:</span> <span class="n">MotionRunner</span><span class="p">,</span>
    <span class="n">motion_constructor</span><span class="p">:</span> <span class="n">MotionConstructor</span><span class="p">,</span>
    <span class="n">trajectory_planner</span><span class="p">:</span> <span class="n">TrajectoryPlanningService</span><span class="p">,</span>
    <span class="n">trajectory_repository</span><span class="p">:</span> <span class="n">TrajectoryRepository</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化消息响应服务。&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message_display</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">serial_domain_service</span> <span class="o">=</span> <span class="n">serial_domain_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">message_domain_service</span> <span class="o">=</span> <span class="n">message_domain_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">robot_state_service</span> <span class="o">=</span> <span class="n">robot_state_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">motion_runner</span> <span class="o">=</span> <span class="n">motion_runner</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">motion_constructor</span> <span class="o">=</span> <span class="n">motion_constructor</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">trajectory_planner</span> <span class="o">=</span> <span class="n">trajectory_planner</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">trajectory_repository</span> <span class="o">=</span> <span class="n">trajectory_repository</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_connect_signals</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">message_buffer</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="c1"># 操作处理器映射（策略模式）</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_operation_handlers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">MotionOperationMode</span><span class="o">.</span><span class="n">EXECUTE</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_execute</span><span class="p">,</span>
        <span class="n">MotionOperationMode</span><span class="o">.</span><span class="n">SAVE</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_save</span><span class="p">,</span>
        <span class="n">MotionOperationMode</span><span class="o">.</span><span class="n">PREVIEW</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_preview</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MessageResponseService.handle_message" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">handle_message</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">handle_message</span><span class="p">(</span><span class="n">message_in</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>处理接收到的消息。</p>
<p>流程：
1. 拼接缓冲
2. 检测完整帧（AA55...0D0A）
3. 解码消息
4. 更新状态服务
5. 处理运动消息</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>message_in</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>输入的原始串口数据。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/message_response_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">handle_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message_in</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;处理接收到的消息。</span>

<span class="sd">    流程：</span>
<span class="sd">    1. 拼接缓冲</span>
<span class="sd">    2. 检测完整帧（AA55...0D0A）</span>
<span class="sd">    3. 解码消息</span>
<span class="sd">    4. 更新状态服务</span>
<span class="sd">    5. 处理运动消息</span>

<span class="sd">    Args:</span>
<span class="sd">        message_in (str): 输入的原始串口数据。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">message_buffer</span> <span class="o">+=</span> <span class="n">message_in</span>
    <span class="k">if</span> <span class="s2">&quot;0D0A&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">message_buffer</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">message_buffer</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;AA55&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">message_buffer</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">120</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">message_buffer</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;0D0A&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>            
        <span class="bp">self</span><span class="o">.</span><span class="n">message_buffer</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">command_line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="n">command_line</span> <span class="o">+</span> <span class="s2">&quot;0D0A&quot;</span><span class="p">,</span> <span class="s2">&quot;接收&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">command_line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;AA55&quot;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># 解码消息</span>
                <span class="n">decoded_message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">message_domain_service</span><span class="o">.</span><span class="n">decode_message</span><span class="p">(</span>
                    <span class="n">command_line</span> <span class="o">+</span> <span class="s2">&quot;0D0A&quot;</span>
                <span class="p">)</span>
                <span class="c1"># 更新统一的状态服务（单一入口）</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">robot_state_service</span><span class="o">.</span><span class="n">update_state</span><span class="p">(</span><span class="n">decoded_message</span><span class="p">)</span>

                <span class="c1"># 处理运动消息</span>
                <span class="k">if</span> <span class="n">decoded_message</span><span class="o">.</span><span class="n">control</span> <span class="o">==</span> <span class="mh">0x07</span> <span class="ow">and</span> <span class="n">decoded_message</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="mh">0x08</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">handle_motion_message</span><span class="p">(</span><span class="n">decoded_message</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;解码消息失败: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;错误&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ascii_text</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">command_line</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span>
                <span class="n">printable_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="n">c</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">isprintable</span><span class="p">()</span> <span class="ow">or</span> <span class="n">c</span> <span class="ow">in</span> <span class="s1">&#39;</span><span class="se">\n\r\t</span><span class="s1">&#39;</span> 
                    <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">x</span><span class="si">{</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="si">:</span><span class="s1">02x</span><span class="si">}</span><span class="s1">&#39;</span> 
                    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ascii_text</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">printable_text</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ASCII: </span><span class="si">{</span><span class="n">printable_text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;接收&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MessageResponseService.handle_motion_message" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">handle_motion_message</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">handle_motion_message</span><span class="p">(</span><span class="n">current_position</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>处理运动消息（获取当前位置的回复）。</p>
<p>根据状态决定行为：
1. 有待处理的操作 → 调用对应的处理器
2. 无操作 → 仅发射信号供UI显示</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>current_position</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>当前关节位置（编码器值）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/message_response_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">handle_motion_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_position</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;处理运动消息（获取当前位置的回复）。</span>

<span class="sd">    根据状态决定行为：</span>
<span class="sd">    1. 有待处理的操作 → 调用对应的处理器</span>
<span class="sd">    2. 无操作 → 仅发射信号供UI显示</span>

<span class="sd">    Args:</span>
<span class="sd">        current_position (list[float]): 当前关节位置（编码器值）。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">motion_constructor</span><span class="o">.</span><span class="n">has_pending_operation</span><span class="p">():</span>
        <span class="c1"># 获取操作模式</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">motion_constructor</span><span class="o">.</span><span class="n">get_operation_mode</span><span class="p">()</span>

        <span class="c1"># 从字典中获取对应的处理函数</span>
        <span class="n">handler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_operation_handlers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">handler</span><span class="p">:</span>
            <span class="c1"># 调用处理函数</span>
            <span class="n">handler</span><span class="p">(</span><span class="n">current_position</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;未知操作模式: </span><span class="si">{</span><span class="n">mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;错误&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">motion_constructor</span><span class="o">.</span><span class="n">clear_operation</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># 无操作：仅发射信号供UI显示</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_current_position_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">current_position</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.MotionPlanningApplicationService" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MotionPlanningApplicationService</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">MotionPlanningApplicationService</span><span class="p">(</span><span class="n">domain_service</span><span class="p">:</span> <span class="n">MotionPlanningDomainService</span><span class="p">,</span> <span class="n">repository</span><span class="p">:</span> <span class="n">MotionPlanRepository</span><span class="p">,</span> <span class="n">motion_constructor</span><span class="p">:</span> <span class="n">MotionConstructor</span><span class="p">,</span> <span class="n">command_hub</span><span class="p">:</span> <span class="n">CommandHubService</span><span class="p">,</span> <span class="n">message_response</span><span class="p">:</span> <span class="n">MessageResponseService</span><span class="p">,</span> <span class="n">trajectory_repository</span><span class="p">:</span> <span class="n">TrajectoryRepository</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="PyQt5.QtCore.QObject">QObject</span></code></p>



        <p>运动规划应用服务。</p>
<p>职责：
1. 协调Domain和Infrastructure
2. 自动保存
3. 发送UI更新信号
4. 执行运动规划（单点和整体方案）
5. 处理"获取位置"功能</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionPlanningApplicationService.plan_list_changed">plan_list_changed</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>方案列表变化信号。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionPlanningApplicationService.current_plan_changed">current_plan_changed</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>当前方案切换信号。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionPlanningApplicationService.point_list_changed">point_list_changed</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点列表变化信号。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionPlanningApplicationService.current_position_received">current_position_received</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>当前位置数据信号（弧度值）。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionPlanningApplicationService.trajectory_preview_signal">trajectory_preview_signal</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>轨迹预览数据信号（轨迹数据，上下文）。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化运动规划应用服务。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>domain_service</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MotionPlanningDomainService (controller.domain.MotionPlanningDomainService)" href="#controller.shared.config.service_registry.MotionPlanningDomainService">MotionPlanningDomainService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运动规划领域服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>repository</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MotionPlanRepository (controller.infrastructure.MotionPlanRepository)" href="#controller.shared.config.service_registry.MotionPlanRepository">MotionPlanRepository</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运动方案仓储。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>motion_constructor</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MotionConstructor (controller.domain.MotionConstructor)" href="#controller.shared.config.service_registry.MotionConstructor">MotionConstructor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运动构造器。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>command_hub</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommandHubService (controller.application.services.command_hub_service.CommandHubService)" href="../../../application/services/command_hub/#controller.application.services.command_hub_service.CommandHubService">CommandHubService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>命令中心服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>message_response</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MessageResponseService (controller.application.services.message_response_service.MessageResponseService)" href="../../../application/services/message_response/#controller.application.services.message_response_service.MessageResponseService">MessageResponseService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>消息响应服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>trajectory_repository</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TrajectoryRepository (controller.infrastructure.TrajectoryRepository)" href="#controller.shared.config.service_registry.TrajectoryRepository">TrajectoryRepository</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>轨迹仓储。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/application/services/motion_planning_application_service.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">domain_service</span><span class="p">:</span> <span class="n">MotionPlanningDomainService</span><span class="p">,</span>
    <span class="n">repository</span><span class="p">:</span> <span class="n">MotionPlanRepository</span><span class="p">,</span>
    <span class="n">motion_constructor</span><span class="p">:</span> <span class="n">MotionConstructor</span><span class="p">,</span>
    <span class="n">command_hub</span><span class="p">:</span> <span class="n">CommandHubService</span><span class="p">,</span>
    <span class="n">message_response</span><span class="p">:</span> <span class="n">MessageResponseService</span><span class="p">,</span>
    <span class="n">trajectory_repository</span><span class="p">:</span> <span class="n">TrajectoryRepository</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化运动规划应用服务。</span>

<span class="sd">    Args:</span>
<span class="sd">        domain_service: 运动规划领域服务。</span>
<span class="sd">        repository: 运动方案仓储。</span>
<span class="sd">        motion_constructor: 运动构造器。</span>
<span class="sd">        command_hub: 命令中心服务。</span>
<span class="sd">        message_response: 消息响应服务。</span>
<span class="sd">        trajectory_repository: 轨迹仓储。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">domain_service</span> <span class="o">=</span> <span class="n">domain_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">repository</span> <span class="o">=</span> <span class="n">repository</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">motion_constructor</span> <span class="o">=</span> <span class="n">motion_constructor</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">command_hub</span> <span class="o">=</span> <span class="n">command_hub</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">message_response</span> <span class="o">=</span> <span class="n">message_response</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">trajectory_repository</span> <span class="o">=</span> <span class="n">trajectory_repository</span>

    <span class="c1"># 连接MessageResponse的位置数据信号</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">message_response</span><span class="o">.</span><span class="n">get_current_position_signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_position_received</span><span class="o">.</span><span class="n">emit</span>
    <span class="p">)</span>

    <span class="c1"># 连接MessageResponse的轨迹预览信号</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">message_response</span><span class="o">.</span><span class="n">trajectory_preview_signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trajectory_preview_signal</span><span class="o">.</span><span class="n">emit</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_load_data</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningApplicationService.create_plan" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_plan</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_plan</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>创建方案。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>方案名称。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/motion_planning_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;创建方案。</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): 方案名称。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_service</span><span class="o">.</span><span class="n">create_plan</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_save_data</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">plan_list_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_plan_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">new_index</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">point_list_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningApplicationService.delete_plan" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">delete_plan</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">delete_plan</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>删除方案。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>方案索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True=删除成功, False=删除失败（违反业务规则）。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/motion_planning_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;删除方案。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 方案索引。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True=删除成功, False=删除失败（违反业务规则）。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_service</span><span class="o">.</span><span class="n">delete_plan</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plan_list_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_plan_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">domain_service</span><span class="o">.</span><span class="n">get_current_index</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">point_list_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningApplicationService.switch_plan" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">switch_plan</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">switch_plan</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>切换方案。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>目标方案索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/motion_planning_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">switch_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;切换方案。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 目标方案索引。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_service</span><span class="o">.</span><span class="n">set_current_index</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_plan_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">point_list_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningApplicationService.rename_plan" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">rename_plan</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">rename_plan</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>重命名方案。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>方案索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>new_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>新名称。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/motion_planning_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rename_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;重命名方案。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 方案索引。</span>
<span class="sd">        new_name (str): 新名称。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_service</span><span class="o">.</span><span class="n">rename_plan</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">new_name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plan_list_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningApplicationService.add_point" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_point</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_point</span><span class="p">(</span><span class="n">point_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>添加节点</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/motion_planning_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;添加节点&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">domain_service</span><span class="o">.</span><span class="n">add_point</span><span class="p">(</span><span class="n">point_data</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_save_data</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">point_list_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningApplicationService.delete_point" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">delete_point</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">delete_point</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>删除节点</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/motion_planning_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;删除节点&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">domain_service</span><span class="o">.</span><span class="n">remove_point</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_save_data</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">point_list_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningApplicationService.move_point_up" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">move_point_up</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">move_point_up</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>上移节点</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/motion_planning_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_point_up</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;上移节点&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_service</span><span class="o">.</span><span class="n">move_point_up</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">point_list_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningApplicationService.move_point_down" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">move_point_down</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">move_point_down</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>下移节点</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/motion_planning_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_point_down</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;下移节点&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_service</span><span class="o">.</span><span class="n">move_point_down</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">point_list_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningApplicationService.update_point" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">update_point</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">update_point</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">point_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>更新节点</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/motion_planning_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">point_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;更新节点&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">domain_service</span><span class="o">.</span><span class="n">update_point</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">point_data</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_save_data</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">point_list_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningApplicationService.get_single_point" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_single_point</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_single_point</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取单个节点数据。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点数据字典，如果索引无效则返回None。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/motion_planning_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_single_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取单个节点数据。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 节点索引。</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: 节点数据字典，如果索引无效则返回None。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_service</span><span class="o">.</span><span class="n">get_all_points</span><span class="p">()</span>
    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">points</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningApplicationService.execute_single_point" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">execute_single_point</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">execute_single_point</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>执行单个节点。</p>
<p>流程：
1. 获取节点数据
2. 解析为任务列表
3. 准备执行操作
4. 查询当前位置</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/motion_planning_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">execute_single_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;执行单个节点。</span>

<span class="sd">    流程：</span>
<span class="sd">    1. 获取节点数据</span>
<span class="sd">    2. 解析为任务列表</span>
<span class="sd">    3. 准备执行操作</span>
<span class="sd">    4. 查询当前位置</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 节点索引。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tasks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_tasks</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">tasks</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="c1"># 准备执行操作</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">motion_constructor</span><span class="o">.</span><span class="n">prepare_operation</span><span class="p">(</span>
        <span class="n">MotionOperationMode</span><span class="o">.</span><span class="n">EXECUTE</span><span class="p">,</span>
        <span class="n">tasks</span>
    <span class="p">)</span>

    <span class="c1"># 查询当前位置，触发执行</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">command_hub</span><span class="o">.</span><span class="n">get_current_position</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningApplicationService.execute_motion_plan" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">execute_motion_plan</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">execute_motion_plan</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>执行整个运动规划方案。</p>
<p>流程：
1. 获取所有节点的任务
2. 准备执行操作
3. 查询当前位置，触发执行</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/motion_planning_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">execute_motion_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;执行整个运动规划方案。</span>

<span class="sd">    流程：</span>
<span class="sd">    1. 获取所有节点的任务</span>
<span class="sd">    2. 准备执行操作</span>
<span class="sd">    3. 查询当前位置，触发执行</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tasks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_plan_tasks</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">tasks</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="c1"># 准备执行操作</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">motion_constructor</span><span class="o">.</span><span class="n">prepare_operation</span><span class="p">(</span>
        <span class="n">MotionOperationMode</span><span class="o">.</span><span class="n">EXECUTE</span><span class="p">,</span>
        <span class="n">tasks</span>
    <span class="p">)</span>

    <span class="c1"># 查询当前位置，触发执行</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">command_hub</span><span class="o">.</span><span class="n">run_motion_sequence</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningApplicationService.request_current_position" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">request_current_position</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">request_current_position</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>请求获取当前位置（仅用于UI显示）。</p>
<p>流程：
1. 发送 0x07 命令查询位置
2. 串口返回数据后，MessageResponseService 检查 has_pending_operation()
3. 因为没有调用 prepare_operation，所以返回 False
4. MessageResponseService emit get_current_position_signal
5. 本Service转发信号给ViewModel</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/motion_planning_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">request_current_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;请求获取当前位置（仅用于UI显示）。</span>

<span class="sd">    流程：</span>
<span class="sd">    1. 发送 0x07 命令查询位置</span>
<span class="sd">    2. 串口返回数据后，MessageResponseService 检查 has_pending_operation()</span>
<span class="sd">    3. 因为没有调用 prepare_operation，所以返回 False</span>
<span class="sd">    4. MessageResponseService emit get_current_position_signal</span>
<span class="sd">    5. 本Service转发信号给ViewModel</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">command_hub</span><span class="o">.</span><span class="n">single_send_command</span><span class="p">(</span><span class="n">control</span><span class="o">=</span><span class="mh">0x07</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningApplicationService.save_node_trajectory" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">save_node_trajectory</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">save_node_trajectory</span><span class="p">(</span><span class="n">node_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>保存单个节点的轨迹。</p>
<p>流程：
1. 获取节点任务
2. 准备保存操作
3. 查询当前位置
4. MessageResponseService 自动完成保存</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>node_index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True: 准备成功, False: 准备失败。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/motion_planning_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_node_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;保存单个节点的轨迹。</span>

<span class="sd">    流程：</span>
<span class="sd">    1. 获取节点任务</span>
<span class="sd">    2. 准备保存操作</span>
<span class="sd">    3. 查询当前位置</span>
<span class="sd">    4. MessageResponseService 自动完成保存</span>

<span class="sd">    Args:</span>
<span class="sd">        node_index (int): 节点索引。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True: 准备成功, False: 准备失败。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tasks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_tasks</span><span class="p">(</span><span class="n">node_index</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tasks</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">current_plan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_service</span><span class="o">.</span><span class="n">get_current_plan</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">current_plan</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">context</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">current_plan</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">node_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;node&quot;</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">motion_constructor</span><span class="o">.</span><span class="n">prepare_operation</span><span class="p">(</span>
            <span class="n">MotionOperationMode</span><span class="o">.</span><span class="n">SAVE</span><span class="p">,</span>
            <span class="n">tasks</span><span class="p">,</span>
            <span class="n">context</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">command_hub</span><span class="o">.</span><span class="n">get_current_position</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningApplicationService.save_plan_trajectory" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">save_plan_trajectory</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">save_plan_trajectory</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>保存整个方案的轨迹</p>
<p>流程：
1. 获取方案所有任务
2. 准备保存操作
3. 查询当前位置
4. MessageResponseService 自动完成保存</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>True</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>准备成功</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>False</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>准备失败</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/motion_planning_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_plan_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    保存整个方案的轨迹</span>

<span class="sd">    流程：</span>
<span class="sd">    1. 获取方案所有任务</span>
<span class="sd">    2. 准备保存操作</span>
<span class="sd">    3. 查询当前位置</span>
<span class="sd">    4. MessageResponseService 自动完成保存</span>

<span class="sd">    Returns:</span>
<span class="sd">        True: 准备成功</span>
<span class="sd">        False: 准备失败</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tasks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_plan_tasks</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tasks</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">current_plan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_service</span><span class="o">.</span><span class="n">get_current_plan</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">current_plan</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">context</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="n">current_plan</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;plan&quot;</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">motion_constructor</span><span class="o">.</span><span class="n">prepare_operation</span><span class="p">(</span>
            <span class="n">MotionOperationMode</span><span class="o">.</span><span class="n">SAVE</span><span class="p">,</span>
            <span class="n">tasks</span><span class="p">,</span>
            <span class="n">context</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">command_hub</span><span class="o">.</span><span class="n">get_current_position</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningApplicationService.preview_node_trajectory" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">preview_node_trajectory</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">preview_node_trajectory</span><span class="p">(</span><span class="n">node_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>预览单个节点的轨迹曲线</p>
<p>流程：
1. 获取节点任务
2. 准备预览操作
3. 查询当前位置
4. MessageResponseService 自动发射预览信号</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>node_index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点索引</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>True</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>准备成功</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>False</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>准备失败</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/motion_planning_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">preview_node_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    预览单个节点的轨迹曲线</span>

<span class="sd">    流程：</span>
<span class="sd">    1. 获取节点任务</span>
<span class="sd">    2. 准备预览操作</span>
<span class="sd">    3. 查询当前位置</span>
<span class="sd">    4. MessageResponseService 自动发射预览信号</span>

<span class="sd">    Args:</span>
<span class="sd">        node_index: 节点索引</span>

<span class="sd">    Returns:</span>
<span class="sd">        True: 准备成功</span>
<span class="sd">        False: 准备失败</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tasks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_tasks</span><span class="p">(</span><span class="n">node_index</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tasks</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">context</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;node&quot;</span><span class="p">,</span>
            <span class="s2">&quot;node_index&quot;</span><span class="p">:</span> <span class="n">node_index</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">motion_constructor</span><span class="o">.</span><span class="n">prepare_operation</span><span class="p">(</span>
            <span class="n">MotionOperationMode</span><span class="o">.</span><span class="n">PREVIEW</span><span class="p">,</span>
            <span class="n">tasks</span><span class="p">,</span>
            <span class="n">context</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">command_hub</span><span class="o">.</span><span class="n">get_current_position</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningApplicationService.preview_plan_trajectory" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">preview_plan_trajectory</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">preview_plan_trajectory</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>预览整个方案的轨迹曲线</p>
<p>流程：
1. 获取方案所有任务
2. 准备预览操作
3. 查询当前位置
4. MessageResponseService 自动发射预览信号</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>True</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>准备成功</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>False</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>准备失败</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/motion_planning_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">preview_plan_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    预览整个方案的轨迹曲线</span>

<span class="sd">    流程：</span>
<span class="sd">    1. 获取方案所有任务</span>
<span class="sd">    2. 准备预览操作</span>
<span class="sd">    3. 查询当前位置</span>
<span class="sd">    4. MessageResponseService 自动发射预览信号</span>

<span class="sd">    Returns:</span>
<span class="sd">        True: 准备成功</span>
<span class="sd">        False: 准备失败</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tasks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_plan_tasks</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tasks</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">context</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;plan&quot;</span><span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">motion_constructor</span><span class="o">.</span><span class="n">prepare_operation</span><span class="p">(</span>
            <span class="n">MotionOperationMode</span><span class="o">.</span><span class="n">PREVIEW</span><span class="p">,</span>
            <span class="n">tasks</span><span class="p">,</span>
            <span class="n">context</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">command_hub</span><span class="o">.</span><span class="n">get_current_position</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningApplicationService.load_local_trajectory" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">load_local_trajectory</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">load_local_trajectory</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>从 plans 目录加载轨迹文件，作为示教节点添加</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>轨迹文件的完整路径或文件名</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>True</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>加载成功</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>False</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>加载失败</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/motion_planning_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_local_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    从 plans 目录加载轨迹文件，作为示教节点添加</span>

<span class="sd">    Args:</span>
<span class="sd">        file_path: 轨迹文件的完整路径或文件名</span>

<span class="sd">    Returns:</span>
<span class="sd">        True: 加载成功</span>
<span class="sd">        False: 加载失败</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 1. 提取文件名（不带路径和扩展名）</span>
        <span class="n">file_stem</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span>

        <span class="c1"># 2. 从 TrajectoryRepository 加载</span>
        <span class="n">trajectory_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trajectory_repository</span><span class="o">.</span><span class="n">load_trajectory</span><span class="p">(</span><span class="n">file_stem</span><span class="p">)</span>

        <span class="c1"># 3. 验证数据</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_trajectory_data</span><span class="p">(</span><span class="n">trajectory_data</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># 4. 创建示教节点数据（复用示教模式的格式）</span>
        <span class="n">point_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;示教-</span><span class="si">{</span><span class="n">file_stem</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;joint1&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
            <span class="s2">&quot;joint2&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
            <span class="s2">&quot;joint3&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
            <span class="s2">&quot;joint4&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
            <span class="s2">&quot;joint5&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
            <span class="s2">&quot;joint6&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
            <span class="s2">&quot;frequency&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
            <span class="s2">&quot;curve_type&quot;</span><span class="p">:</span> <span class="s2">&quot;S曲线&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gripper_command&quot;</span><span class="p">:</span> <span class="s2">&quot;00: 不进行任何操作&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gripper_param&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
            <span class="s2">&quot;note&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;本地轨迹，共</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">trajectory_data</span><span class="p">)</span><span class="si">}</span><span class="s2">个点&quot;</span><span class="p">,</span>
            <span class="s2">&quot;teach_record_name&quot;</span><span class="p">:</span> <span class="n">file_stem</span><span class="p">,</span>
            <span class="s2">&quot;teach_data&quot;</span><span class="p">:</span> <span class="n">trajectory_data</span><span class="p">,</span>
            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;local_trajectory&quot;</span>  <span class="c1"># 标记来源</span>
        <span class="p">}</span>

        <span class="c1"># 5. 添加节点</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">domain_service</span><span class="o">.</span><span class="n">add_point</span><span class="p">(</span><span class="n">point_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_data</span><span class="p">()</span>  <span class="c1"># 持久化保存</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">point_list_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningApplicationService.get_local_trajectory_files" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_local_trajectory_files</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_local_trajectory_files</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取所有可用的本地轨迹文件</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>文件名列表（不带扩展名）</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/motion_planning_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_local_trajectory_files</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    获取所有可用的本地轨迹文件</span>

<span class="sd">    Returns:</span>
<span class="sd">        文件名列表（不带扩展名）</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">trajectory_repository</span><span class="o">.</span><span class="n">list_trajectory_files</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.CameraApplicationService" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">CameraApplicationService</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">CameraApplicationService</span><span class="p">(</span><span class="n">camera_service</span><span class="p">:</span> <span class="n">CameraDomainService</span><span class="p">,</span> <span class="n">recognition_service</span><span class="p">:</span> <span class="n">RecognitionDomainService</span><span class="p">,</span> <span class="n">hand_eye_service</span><span class="p">:</span> <span class="n">HandEyeTransformDomainService</span><span class="p">,</span> <span class="n">kinematic_service</span><span class="p">:</span> <span class="n">KinematicDomainService</span><span class="p">,</span> <span class="n">robot_state_service</span><span class="p">:</span> <span class="n">RobotStateDomainService</span><span class="p">,</span> <span class="n">motion_constructor</span><span class="p">:</span> <span class="n">MotionConstructor</span><span class="p">,</span> <span class="n">command_hub</span><span class="p">:</span> <span class="n">CommandHubService</span><span class="p">,</span> <span class="n">message_display</span><span class="p">:</span> <span class="n">MessageDisplay</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="PyQt5.QtCore.QObject">QObject</span></code></p>



        <p>摄像头应用服务。</p>
<p>协调摄像头Domain服务、检测服务和消息显示，提供统一的查询接口，避免ViewModel直接访问Domain层。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CameraApplicationService.connection_status_changed">connection_status_changed</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>摄像头连接状态变化信号。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CameraApplicationService.detection_status_changed">detection_status_changed</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>检测状态变化信号。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化摄像头应用服务。</p>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/application/services/camera_application_service.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">camera_service</span><span class="p">:</span> <span class="n">CameraDomainService</span><span class="p">,</span>
    <span class="n">recognition_service</span><span class="p">:</span> <span class="n">RecognitionDomainService</span><span class="p">,</span>
    <span class="n">hand_eye_service</span><span class="p">:</span> <span class="n">HandEyeTransformDomainService</span><span class="p">,</span>
    <span class="n">kinematic_service</span><span class="p">:</span> <span class="n">KinematicDomainService</span><span class="p">,</span>
    <span class="n">robot_state_service</span><span class="p">:</span> <span class="n">RobotStateDomainService</span><span class="p">,</span>
    <span class="n">motion_constructor</span><span class="p">:</span> <span class="n">MotionConstructor</span><span class="p">,</span>
    <span class="n">command_hub</span><span class="p">:</span> <span class="n">CommandHubService</span><span class="p">,</span>
    <span class="n">message_display</span><span class="p">:</span> <span class="n">MessageDisplay</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化摄像头应用服务。&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">camera_service</span> <span class="o">=</span> <span class="n">camera_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">recognition_service</span> <span class="o">=</span> <span class="n">recognition_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">hand_eye_service</span> <span class="o">=</span> <span class="n">hand_eye_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_service</span> <span class="o">=</span> <span class="n">kinematic_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">robot_state_service</span> <span class="o">=</span> <span class="n">robot_state_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">motion_constructor</span> <span class="o">=</span> <span class="n">motion_constructor</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">command_hub</span> <span class="o">=</span> <span class="n">command_hub</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">message_display</span> <span class="o">=</span> <span class="n">message_display</span>

    <span class="c1"># 连接Domain Service信号</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_connect_signals</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraApplicationService.connect_camera" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">connect_camera</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">connect_camera</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>连接摄像头。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/camera_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">connect_camera</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;连接摄像头。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">message_display</span><span class="o">.</span><span class="n">clear_messages</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s2">&quot;正在连接摄像头...&quot;</span><span class="p">,</span> <span class="s2">&quot;摄像头&quot;</span><span class="p">)</span>

    <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_service</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s2">&quot;摄像头连接成功&quot;</span><span class="p">,</span> <span class="s2">&quot;摄像头&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connection_status_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s2">&quot;摄像头连接失败&quot;</span><span class="p">,</span> <span class="s2">&quot;错误&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connection_status_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraApplicationService.disconnect_camera" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">disconnect_camera</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">disconnect_camera</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>断开摄像头。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/camera_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">disconnect_camera</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;断开摄像头。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">message_display</span><span class="o">.</span><span class="n">clear_messages</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s2">&quot;正在断开摄像头...&quot;</span><span class="p">,</span> <span class="s2">&quot;摄像头&quot;</span><span class="p">)</span>

    <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_service</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s2">&quot;摄像头已断开&quot;</span><span class="p">,</span> <span class="s2">&quot;摄像头&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connection_status_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s2">&quot;断开摄像头失败&quot;</span><span class="p">,</span> <span class="s2">&quot;错误&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraApplicationService.start_detection" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">start_detection</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">start_detection</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>开始检测。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/camera_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">start_detection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;开始检测。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">message_display</span><span class="o">.</span><span class="n">clear_messages</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s2">&quot;正在启动检测...&quot;</span><span class="p">,</span> <span class="s2">&quot;检测&quot;</span><span class="p">)</span>

    <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recognition_service</span><span class="o">.</span><span class="n">start_detection</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s2">&quot;开始零件识别&quot;</span><span class="p">,</span> <span class="s2">&quot;检测&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detection_status_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s2">&quot;启动检测失败&quot;</span><span class="p">,</span> <span class="s2">&quot;错误&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detection_status_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraApplicationService.stop_detection" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">stop_detection</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">stop_detection</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>停止检测。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/camera_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stop_detection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;停止检测。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">message_display</span><span class="o">.</span><span class="n">clear_messages</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s2">&quot;正在停止检测...&quot;</span><span class="p">,</span> <span class="s2">&quot;检测&quot;</span><span class="p">)</span>

    <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recognition_service</span><span class="o">.</span><span class="n">stop_detection</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s2">&quot;停止零件识别&quot;</span><span class="p">,</span> <span class="s2">&quot;检测&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detection_status_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s2">&quot;停止检测失败&quot;</span><span class="p">,</span> <span class="s2">&quot;错误&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraApplicationService.move_to_detected_part" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">move_to_detected_part</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">move_to_detected_part</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>运动到检测到的零件位置。</p>
<p>完整流程：
1. 检查检测状态
2. 获取检测结果
3. 获取当前关节角度
4. 手眼标定计算目标关节角度
5. 构建运动任务
6. 触发运动执行
7. 停止检测（可选）</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/camera_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_to_detected_part</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;运动到检测到的零件位置。</span>

<span class="sd">    完整流程：</span>
<span class="sd">    1. 检查检测状态</span>
<span class="sd">    2. 获取检测结果</span>
<span class="sd">    3. 获取当前关节角度</span>
<span class="sd">    4. 手眼标定计算目标关节角度</span>
<span class="sd">    5. 构建运动任务</span>
<span class="sd">    6. 触发运动执行</span>
<span class="sd">    7. 停止检测（可选）</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 1. 检查检测是否运行</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">recognition_service</span><span class="o">.</span><span class="n">is_detection_running</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s2">&quot;检测未运行，无法执行运动&quot;</span><span class="p">,</span> <span class="s2">&quot;错误&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># 2. 获取最新检测结果</span>
    <span class="n">detection_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recognition_service</span><span class="o">.</span><span class="n">get_latest_result</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">detection_result</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s2">&quot;未检测到零件，无法执行运动&quot;</span><span class="p">,</span> <span class="s2">&quot;警告&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># 3. 获取当前关节角度</span>
    <span class="n">current_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">robot_state_service</span><span class="o">.</span><span class="n">get_current_state</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">current_state</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s2">&quot;无法获取当前机器人状态&quot;</span><span class="p">,</span> <span class="s2">&quot;错误&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">current_joint_angles</span> <span class="o">=</span> <span class="n">current_state</span><span class="o">.</span><span class="n">joint_angles</span>  <span class="c1"># ✅ 修复：正确的属性名（弧度）</span>

    <span class="c1"># 4. 手眼标定计算目标关节角度</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">target_angles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hand_eye_service</span><span class="o">.</span><span class="n">calculate_target_joint_angles</span><span class="p">(</span>
            <span class="n">central_center</span><span class="o">=</span><span class="n">detection_result</span><span class="p">[</span><span class="s1">&#39;central_center&#39;</span><span class="p">],</span>
            <span class="n">depth</span><span class="o">=</span><span class="n">detection_result</span><span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">],</span>
            <span class="n">real_center</span><span class="o">=</span><span class="n">detection_result</span><span class="p">[</span><span class="s1">&#39;real_center&#39;</span><span class="p">],</span>
            <span class="n">real_depth</span><span class="o">=</span><span class="n">detection_result</span><span class="p">[</span><span class="s1">&#39;real_depth&#39;</span><span class="p">],</span>
            <span class="n">angle</span><span class="o">=</span><span class="n">detection_result</span><span class="p">[</span><span class="s1">&#39;angle&#39;</span><span class="p">],</span>
            <span class="n">current_joint_angles</span><span class="o">=</span><span class="n">current_joint_angles</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">target_angles</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s2">&quot;逆运动学无解，无法到达目标位置&quot;</span><span class="p">,</span> <span class="s2">&quot;错误&quot;</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;计算目标位姿失败: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;错误&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># 5. 构建运动任务</span>
    <span class="n">motion_task</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;motion&#39;</span><span class="p">,</span>
        <span class="s1">&#39;target_angles&#39;</span><span class="p">:</span> <span class="n">target_angles</span><span class="p">,</span>
        <span class="s1">&#39;curve_type&#39;</span><span class="p">:</span> <span class="s1">&#39;s_curve&#39;</span><span class="p">,</span>  <span class="c1"># &#39;s_curve&#39; 或 &#39;linear&#39;（笛卡尔直线）</span>
        <span class="s1">&#39;frequency&#39;</span><span class="p">:</span> <span class="mf">0.01</span>
    <span class="p">}</span>

    <span class="c1"># 6. 准备运动并触发执行</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 使用统一的 prepare_operation 接口</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">motion_constructor</span><span class="o">.</span><span class="n">prepare_operation</span><span class="p">(</span>
            <span class="n">MotionOperationMode</span><span class="o">.</span><span class="n">EXECUTE</span><span class="p">,</span>
            <span class="p">[</span><span class="n">motion_task</span><span class="p">]</span>  <span class="c1"># 需要传入任务列表</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command_hub</span><span class="o">.</span><span class="n">get_current_position</span><span class="p">()</span>  <span class="c1"># 触发运动执行</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;开始运动到零件位置 &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;(中心: </span><span class="si">{</span><span class="n">detection_result</span><span class="p">[</span><span class="s1">&#39;central_center&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;深度: </span><span class="si">{</span><span class="n">detection_result</span><span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">mm, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;角度: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">detection_result</span><span class="p">[</span><span class="s1">&#39;angle&#39;</span><span class="p">])</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">°)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;运动&quot;</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;启动运动失败: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;错误&quot;</span><span class="p">)</span>
        <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraApplicationService.is_camera_connected" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">is_camera_connected</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_camera_connected</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>检查摄像头是否连接。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True=已连接, False=未连接。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/camera_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_camera_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;检查摄像头是否连接。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True=已连接, False=未连接。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_service</span><span class="o">.</span><span class="n">is_connected</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraApplicationService.is_color_available" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">is_color_available</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_color_available</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>检查彩色图像是否可用。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True=有数据, False=无数据。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/camera_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_color_available</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;检查彩色图像是否可用。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True=有数据, False=无数据。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_service</span><span class="o">.</span><span class="n">is_color_available</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraApplicationService.is_depth_available" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">is_depth_available</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_depth_available</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>检查深度图像是否可用。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True=有数据, False=无数据。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/camera_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_depth_available</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;检查深度图像是否可用。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True=有数据, False=无数据。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_service</span><span class="o">.</span><span class="n">is_depth_available</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraApplicationService.get_latest_color_image" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_latest_color_image</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_latest_color_image</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取最新彩色图像。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[np.ndarray]: 彩色图像（BGR格式），如果无数据则返回None。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/camera_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_latest_color_image</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取最新彩色图像。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[np.ndarray]: 彩色图像（BGR格式），如果无数据则返回None。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_service</span><span class="o">.</span><span class="n">get_latest_color_image</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraApplicationService.get_latest_depth_image" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_latest_depth_image</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_latest_depth_image</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取最新深度图像。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[np.ndarray]: 深度图像（16位或32位浮点），如果无数据则返回None。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/camera_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_latest_depth_image</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取最新深度图像。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[np.ndarray]: 深度图像（16位或32位浮点），如果无数据则返回None。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_service</span><span class="o">.</span><span class="n">get_latest_depth_image</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraApplicationService.visualize_depth_image" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">visualize_depth_image</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">visualize_depth_image</span><span class="p">(</span><span class="n">depth_image</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>深度图可视化为伪彩色图。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>depth_image</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>原始深度图（16位或32位浮点）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: 伪彩色深度图（BGR, uint8）。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/camera_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">visualize_depth_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">depth_image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;深度图可视化为伪彩色图。</span>

<span class="sd">    Args:</span>
<span class="sd">        depth_image (np.ndarray): 原始深度图（16位或32位浮点）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: 伪彩色深度图（BGR, uint8）。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_service</span><span class="o">.</span><span class="n">visualize_depth_image</span><span class="p">(</span><span class="n">depth_image</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraApplicationService.is_detection_running" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">is_detection_running</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_detection_running</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>检查检测是否正在运行。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True=运行中, False=未运行。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/camera_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_detection_running</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;检查检测是否正在运行。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True=运行中, False=未运行。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recognition_service</span><span class="o">.</span><span class="n">is_detection_running</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraApplicationService.get_latest_detection_result" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_latest_detection_result</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_latest_detection_result</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取最新检测结果。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[Dict]: 检测结果字典，如果无数据则返回None。
包含字段：head_center, central_center, real_center, angle, depth, real_depth。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/camera_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_latest_detection_result</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取最新检测结果。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[Dict]: 检测结果字典，如果无数据则返回None。</span>
<span class="sd">            包含字段：head_center, central_center, real_center, angle, depth, real_depth。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recognition_service</span><span class="o">.</span><span class="n">get_latest_result</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraApplicationService.get_image_with_detection" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_image_with_detection</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_image_with_detection</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取叠加了检测结果的图像。</p>
<p>封装了检测状态检查和图像绘制逻辑，提供高层业务接口。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>image</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>原始图像（BGR格式）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: 如果检测正在运行且有结果，返回叠加了检测标注的图像；
       否则返回原图像。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/camera_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_image_with_detection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取叠加了检测结果的图像。</span>

<span class="sd">    封装了检测状态检查和图像绘制逻辑，提供高层业务接口。</span>

<span class="sd">    Args:</span>
<span class="sd">        image (np.ndarray): 原始图像（BGR格式）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: 如果检测正在运行且有结果，返回叠加了检测标注的图像；</span>
<span class="sd">                   否则返回原图像。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 检查检测是否运行</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recognition_service</span><span class="o">.</span><span class="n">is_detection_running</span><span class="p">():</span>
        <span class="c1"># 获取最新检测结果</span>
        <span class="n">detection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recognition_service</span><span class="o">.</span><span class="n">get_latest_result</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">detection</span><span class="p">:</span>
            <span class="c1"># 绘制检测结果到图像上</span>
            <span class="k">return</span> <span class="n">ImageDrawingUtils</span><span class="o">.</span><span class="n">draw_detection_result</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">detection</span><span class="p">)</span>

    <span class="c1"># 无检测或无结果，返回原图</span>
    <span class="k">return</span> <span class="n">image</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.ToolsApplicationService" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ToolsApplicationService</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">ToolsApplicationService</span><span class="p">(</span><span class="n">kinematic_service</span><span class="p">:</span> <span class="n">KinematicDomainService</span><span class="p">,</span> <span class="n">robot_state_service</span><span class="p">:</span> <span class="n">RobotStateDomainService</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="PyQt5.QtCore.QObject">QObject</span></code></p>



        <p>工具应用服务。</p>
<p>职责：
1. 接收 6 个关节角度
2. 调用 KinematicDomainService 计算正运动学
3. 格式化结果并发射信号
4. 获取当前机械臂关节角度
5. 计算逆运动学</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.ToolsApplicationService.calculation_result_signal">calculation_result_signal</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>发送正运动学计算结果。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.ToolsApplicationService.current_angles_signal">current_angles_signal</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>发送当前关节角度。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.ToolsApplicationService.inverse_result_signal">inverse_result_signal</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>发送逆运动学计算结果。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化工具应用服务。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>kinematic_service</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="KinematicDomainService (controller.domain.KinematicDomainService)" href="#controller.shared.config.service_registry.KinematicDomainService">KinematicDomainService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运动学服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>robot_state_service</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="RobotStateDomainService (controller.domain.RobotStateDomainService)" href="#controller.shared.config.service_registry.RobotStateDomainService">RobotStateDomainService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>机械臂状态服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/application/services/tools_application_service.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kinematic_service</span><span class="p">:</span> <span class="n">KinematicDomainService</span><span class="p">,</span> <span class="n">robot_state_service</span><span class="p">:</span> <span class="n">RobotStateDomainService</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化工具应用服务。</span>

<span class="sd">    Args:</span>
<span class="sd">        kinematic_service (KinematicDomainService): 运动学服务。</span>
<span class="sd">        robot_state_service (RobotStateDomainService): 机械臂状态服务。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_service</span> <span class="o">=</span> <span class="n">kinematic_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">robot_state_service</span> <span class="o">=</span> <span class="n">robot_state_service</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.ToolsApplicationService.calculate_forward_kinematics" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">calculate_forward_kinematics</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">calculate_forward_kinematics</span><span class="p">(</span><span class="n">joint_angles</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>计算正运动学。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>joint_angles</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>6个关节角度（弧度）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="emits" open>
  <summary>Emits</summary>
  <p>calculation_result_signal 包含：
{
    "quaternion": [x, y, z, w],
    "position": [x, y, z],
    "rotation_matrix": [[...], [...], [...]]  # 3x3
}
或错误信息：
{
    "error": "错误信息"
}</p>
</details>

            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/tools_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_forward_kinematics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">joint_angles</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;计算正运动学。</span>

<span class="sd">    Args:</span>
<span class="sd">        joint_angles (List[float]): 6个关节角度（弧度）。</span>

<span class="sd">    Emits:</span>
<span class="sd">        calculation_result_signal 包含：</span>
<span class="sd">        {</span>
<span class="sd">            &quot;quaternion&quot;: [x, y, z, w],</span>
<span class="sd">            &quot;position&quot;: [x, y, z],</span>
<span class="sd">            &quot;rotation_matrix&quot;: [[...], [...], [...]]  # 3x3</span>
<span class="sd">        }</span>
<span class="sd">        或错误信息：</span>
<span class="sd">        {</span>
<span class="sd">            &quot;error&quot;: &quot;错误信息&quot;</span>
<span class="sd">        }</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 获取四元数和位置</span>
        <span class="n">quat</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_service</span><span class="o">.</span><span class="n">get_gripper2base</span><span class="p">(</span><span class="n">joint_angles</span><span class="p">)</span>

        <span class="c1"># 获取完整变换矩阵</span>
        <span class="n">transform_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_service</span><span class="o">.</span><span class="n">get_gripper2base_rm</span><span class="p">(</span><span class="n">joint_angles</span><span class="p">)</span>
        <span class="n">rotation_matrix</span> <span class="o">=</span> <span class="n">transform_matrix</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># 提取旋转矩阵部分</span>

        <span class="c1"># 构建结果字典</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;quaternion&quot;</span><span class="p">:</span> <span class="n">quat</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>  <span class="c1"># [x, y, z, w]</span>
            <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="n">pos</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>     <span class="c1"># [x, y, z]</span>
            <span class="s2">&quot;rotation_matrix&quot;</span><span class="p">:</span> <span class="n">rotation_matrix</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>  <span class="c1"># 3x3 list</span>
        <span class="p">}</span>

        <span class="c1"># 发射信号</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculation_result_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># 错误处理</span>
        <span class="n">error_result</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;计算失败: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculation_result_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">error_result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.ToolsApplicationService.get_current_joint_angles" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_current_joint_angles</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_current_joint_angles</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取当前机械臂关节角度。</p>


<details class="emits" open>
  <summary>Emits</summary>
  <p>current_angles_signal: List[float] - 6个关节角度（弧度）。</p>
</details>

            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/tools_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_current_joint_angles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取当前机械臂关节角度。</span>

<span class="sd">    Emits:</span>
<span class="sd">        current_angles_signal: List[float] - 6个关节角度（弧度）。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 从机械臂状态服务获取当前角度</span>
        <span class="n">current_angles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">robot_state_service</span><span class="o">.</span><span class="n">get_current_angles</span><span class="p">()</span>
        <span class="c1"># 发射信号</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_angles_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">current_angles</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># 如果获取失败，发送空列表</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_angles_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.ToolsApplicationService.calculate_inverse_kinematics" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">calculate_inverse_kinematics</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">calculate_inverse_kinematics</span><span class="p">(</span><span class="n">rotation_matrix</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="n">position</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">initial_theta</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>计算逆运动学。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rotation_matrix</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>3x3 旋转矩阵。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>position</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>[x, y, z] 位置（米）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>initial_theta</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>初始关节角度（用于选择最接近的解）. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="emits" open>
  <summary>Emits</summary>
  <p>inverse_result_signal 包含：
{
    "joint_angles": [θ1, θ2, θ3, θ4, θ5, θ6],  # 弧度
    "joint_angles_deg": [θ1, θ2, θ3, θ4, θ5, θ6]  # 度
}
或错误信息：
{
    "error": "错误信息"
}</p>
</details>

            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/services/tools_application_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_inverse_kinematics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rotation_matrix</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="n">position</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">initial_theta</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;计算逆运动学。</span>

<span class="sd">    Args:</span>
<span class="sd">        rotation_matrix (List[List[float]]): 3x3 旋转矩阵。</span>
<span class="sd">        position (List[float]): [x, y, z] 位置（米）。</span>
<span class="sd">        initial_theta (List[float], optional): 初始关节角度（用于选择最接近的解）. Defaults to None.</span>

<span class="sd">    Emits:</span>
<span class="sd">        inverse_result_signal 包含：</span>
<span class="sd">        {</span>
<span class="sd">            &quot;joint_angles&quot;: [θ1, θ2, θ3, θ4, θ5, θ6],  # 弧度</span>
<span class="sd">            &quot;joint_angles_deg&quot;: [θ1, θ2, θ3, θ4, θ5, θ6]  # 度</span>
<span class="sd">        }</span>
<span class="sd">        或错误信息：</span>
<span class="sd">        {</span>
<span class="sd">            &quot;error&quot;: &quot;错误信息&quot;</span>
<span class="sd">        }</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 转换为 numpy 数组</span>
        <span class="n">rm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rotation_matrix</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>

        <span class="c1"># 如果没有提供初始角度，使用当前角度</span>
        <span class="k">if</span> <span class="n">initial_theta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">initial_theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">robot_state_service</span><span class="o">.</span><span class="n">get_current_angles</span><span class="p">()</span>

        <span class="c1"># 调用逆运动学求解</span>
        <span class="n">solution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_service</span><span class="o">.</span><span class="n">inverse_kinematic</span><span class="p">(</span><span class="n">rm</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">initial_theta</span><span class="p">)</span>

        <span class="c1"># 构建结果字典</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;joint_angles&quot;</span><span class="p">:</span> <span class="n">solution</span><span class="p">,</span>  <span class="c1"># 弧度</span>
            <span class="s2">&quot;joint_angles_deg&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">]</span>  <span class="c1"># 度</span>
        <span class="p">}</span>

        <span class="c1"># 发射信号</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inverse_result_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># 错误处理</span>
        <span class="n">error_result</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;逆解计算失败: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inverse_result_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">error_result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.MessageDisplay" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MessageDisplay</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">MessageDisplay</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="PyQt5.QtCore.QObject">QObject</span></code></p>



        <p>消息显示服务。</p>
<p>负责在界面上显示日志和状态消息，通过信号分发给 UI 组件。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MessageDisplay.message_display_signal">message_display_signal</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>消息显示信号，携带 (消息内容, 消息类型)。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MessageDisplay.clear_requested">clear_requested</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>清除消息请求信号。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化消息显示服务。</p>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/application/commands/message_display.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化消息显示服务。&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MessageDisplay.display_message" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">display_message</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">display_message</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>显示一条消息。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>消息内容。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>message_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>消息类型（如 "info", "error", "warning"）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/commands/message_display.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">display_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;显示一条消息。</span>

<span class="sd">    Args:</span>
<span class="sd">        message (str): 消息内容。</span>
<span class="sd">        message_type (str): 消息类型（如 &quot;info&quot;, &quot;error&quot;, &quot;warning&quot;）。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">message_display_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">message_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MessageDisplay.clear_messages" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clear_messages</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">clear_messages</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>清除所有消息。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/commands/message_display.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">clear_messages</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;清除所有消息。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">clear_requested</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.MotionListener" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MotionListener</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">MotionListener</span><span class="p">(</span><span class="n">motion_runner</span><span class="p">:</span> <span class="n">MotionRunner</span><span class="p">,</span> <span class="n">message_display</span><span class="p">:</span> <span class="n">MessageDisplay</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>运动消息监听器。</p>
<p>负责监听运动执行器发送的消息，解码位置数据并显示。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionListener.motion_runner">motion_runner</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MotionRunner (controller.domain.MotionRunner)" href="#controller.shared.config.service_registry.MotionRunner">MotionRunner</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运动执行器。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionListener.message_display">message_display</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MessageDisplay (controller.application.commands.MessageDisplay)" href="#controller.shared.config.service_registry.MessageDisplay">MessageDisplay</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>消息显示服务。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionListener.robot_utils">robot_utils</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="RobotUtils (controller.domain.RobotUtils)" href="#controller.shared.config.service_registry.RobotUtils">RobotUtils</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>机器人工具类，用于坐标转换。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化运动监听器。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>motion_runner</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MotionRunner (controller.domain.MotionRunner)" href="#controller.shared.config.service_registry.MotionRunner">MotionRunner</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运动执行器。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>message_display</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MessageDisplay (controller.application.commands.MessageDisplay)" href="#controller.shared.config.service_registry.MessageDisplay">MessageDisplay</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>消息显示服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/application/listener/motion_listener.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">motion_runner</span><span class="p">:</span> <span class="n">MotionRunner</span><span class="p">,</span> <span class="n">message_display</span><span class="p">:</span> <span class="n">MessageDisplay</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化运动监听器。</span>

<span class="sd">    Args:</span>
<span class="sd">        motion_runner (MotionRunner): 运动执行器。</span>
<span class="sd">        message_display (MessageDisplay): 消息显示服务。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">motion_runner</span> <span class="o">=</span> <span class="n">motion_runner</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">message_display</span> <span class="o">=</span> <span class="n">message_display</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">robot_utils</span> <span class="o">=</span> <span class="n">RobotUtils</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_connect_signals</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionListener.handle_motion_msg" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">handle_motion_msg</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">handle_motion_msg</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">message_type</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>处理运动消息，手动解析位置数据。</p>
<p>消息格式：AA55 + control(1) + mode(1) + joint_angles(24) + ... + CRC(2) + 0D0A
编码过程：弧度 -&gt; radian2position -&gt; 位置值(32位) -&gt; 大端序16进制</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>原始16进制消息字符串。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>message_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>消息类型。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/application/listener/motion_listener.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">handle_motion_msg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">message_type</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;处理运动消息，手动解析位置数据。</span>

<span class="sd">    消息格式：AA55 + control(1) + mode(1) + joint_angles(24) + ... + CRC(2) + 0D0A</span>
<span class="sd">    编码过程：弧度 -&gt; radian2position -&gt; 位置值(32位) -&gt; 大端序16进制</span>

<span class="sd">    Args:</span>
<span class="sd">        message (str): 原始16进制消息字符串。</span>
<span class="sd">        message_type (str): 消息类型。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 手动解析位置数据</span>
        <span class="n">joint_angles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_joint_angles</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">joint_angles</span><span class="p">:</span>
            <span class="c1"># 格式化显示弧度值</span>
            <span class="n">angles_str</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">angle</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">joint_angles</span><span class="p">])</span>
            <span class="n">display_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">message_type</span><span class="si">}</span><span class="s2">] 位置(弧度): [</span><span class="si">{</span><span class="n">angles_str</span><span class="si">}</span><span class="s2">]&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">message_display</span><span class="o">.</span><span class="n">display_message</span><span class="p">(</span><span class="n">display_text</span><span class="p">,</span> <span class="n">message_type</span><span class="p">)</span>

            <span class="c1"># 同时显示原始16进制数据</span>
            <span class="n">raw_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">message_type</span><span class="si">}</span><span class="s2">] 原始数据: </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">message_display</span><span class="o">.</span><span class="n">display_message</span><span class="p">(</span><span class="n">raw_text</span><span class="p">,</span> <span class="n">message_type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># 无法解析，只显示原始消息</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">message_display</span><span class="o">.</span><span class="n">display_message</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">message</span><span class="p">),</span> <span class="n">message_type</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># 解析失败，显示原始消息</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message_display</span><span class="o">.</span><span class="n">display_message</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">message</span><span class="p">),</span> <span class="n">message_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.BaseViewModel" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">BaseViewModel</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">BaseViewModel</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="PyQt5.QtCore.QObject">QObject</span></code></p>



        <p>基础视图模型类。</p>
<p>所有视图模型的基类，提供通用的信号和清理接口。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.BaseViewModel.connection_status_changed">connection_status_changed</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>连接状态变更信号，携带 bool 状态。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化基础视图模型。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>parent</code>
            </td>
            <td>
                  <code><span title="PyQt5.QtCore.QObject">QObject</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>父对象. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/presentation/view_models/base_view_model.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化基础视图模型。</span>

<span class="sd">    Args:</span>
<span class="sd">        parent (QObject, optional): 父对象. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.BaseViewModel.cleanup" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">cleanup</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">cleanup</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>清理资源。</p>
<p>子类应重写此方法以释放资源（如关闭连接、停止定时器等）。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/base_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;清理资源。</span>

<span class="sd">    子类应重写此方法以释放资源（如关闭连接、停止定时器等）。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span> 
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.MainViewModel" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MainViewModel</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">MainViewModel</span><span class="p">(</span><span class="n">serial_vm</span><span class="p">:</span> <span class="n">SerialViewModel</span><span class="p">,</span> <span class="n">display_vm</span><span class="p">:</span> <span class="n">DisplayViewModel</span><span class="p">,</span> <span class="n">control_vm</span><span class="p">:</span> <span class="n">ControlViewModel</span><span class="p">,</span> <span class="n">status_vm</span><span class="p">:</span> <span class="n">StatusViewModel</span><span class="p">,</span> <span class="n">effector_vm</span><span class="p">:</span> <span class="n">EffectorViewModel</span><span class="p">,</span> <span class="n">trajectory_vm</span><span class="p">:</span> <span class="n">TrajectoryViewModel</span><span class="p">,</span> <span class="n">dynamics_vm</span><span class="p">:</span> <span class="n">DynamicsViewModel</span><span class="p">,</span> <span class="n">camera_vm</span><span class="p">:</span> <span class="n">CameraViewModel</span><span class="p">,</span> <span class="n">motion_planning_vm</span><span class="p">:</span> <span class="n">MotionPlanningViewModel</span><span class="p">,</span> <span class="n">tools_vm</span><span class="p">:</span> <span class="n">ToolsViewModel</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseViewModel (controller.presentation.view_models.base_view_model.BaseViewModel)" href="../../../presentation/core/base/#controller.presentation.view_models.base_view_model.BaseViewModel">BaseViewModel</a></code></p>



        <p>主视图模型。</p>
<p>整合所有子视图模型，并管理它们之间的信号交互。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MainViewModel.connection_status_changed">connection_status_changed</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>串口连接状态信号。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MainViewModel.status_message_changed">status_message_changed</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>状态消息变更信号。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MainViewModel.progress_changed">progress_changed</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>进度变更信号。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MainViewModel.serial_vm">serial_vm</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SerialViewModel (controller.presentation.view_models.serial_view_model.SerialViewModel)" href="../../../presentation/device/serial/#controller.presentation.view_models.serial_view_model.SerialViewModel">SerialViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>串口视图模型。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MainViewModel.display_vm">display_vm</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DisplayViewModel (controller.presentation.view_models.display_view_model.DisplayViewModel)" href="../../../presentation/core/display/#controller.presentation.view_models.display_view_model.DisplayViewModel">DisplayViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>显示视图模型。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MainViewModel.control_vm">control_vm</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ControlViewModel (controller.presentation.view_models.control_view_model.ControlViewModel)" href="../../../presentation/device/control/#controller.presentation.view_models.control_view_model.ControlViewModel">ControlViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>控制视图模型。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MainViewModel.status_vm">status_vm</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="StatusViewModel (controller.presentation.view_models.status_view_model.StatusViewModel)" href="../../../presentation/device/status/#controller.presentation.view_models.status_view_model.StatusViewModel">StatusViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>状态视图模型。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MainViewModel.effector_vm">effector_vm</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="EffectorViewModel (controller.presentation.view_models.effector_view_model.EffectorViewModel)" href="../../../presentation/device/effector/#controller.presentation.view_models.effector_view_model.EffectorViewModel">EffectorViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>末端执行器视图模型。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MainViewModel.trajectory_vm">trajectory_vm</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TrajectoryViewModel (controller.presentation.view_models.trajectory_view_model.TrajectoryViewModel)" href="../../../presentation/features/trajectory/#controller.presentation.view_models.trajectory_view_model.TrajectoryViewModel">TrajectoryViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>轨迹视图模型。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MainViewModel.dynamics_vm">dynamics_vm</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DynamicsViewModel (controller.presentation.view_models.dynamics_view_model.DynamicsViewModel)" href="../../../presentation/features/dynamics/#controller.presentation.view_models.dynamics_view_model.DynamicsViewModel">DynamicsViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>动力学视图模型。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MainViewModel.camera_vm">camera_vm</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CameraViewModel (controller.presentation.view_models.camera_view_model.CameraViewModel)" href="../../../presentation/features/camera/#controller.presentation.view_models.camera_view_model.CameraViewModel">CameraViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>相机视图模型。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MainViewModel.motion_planning_vm">motion_planning_vm</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MotionPlanningViewModel (controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel)" href="../../../presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel">MotionPlanningViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运动规划视图模型。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MainViewModel.tools_vm">tools_vm</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ToolsViewModel (controller.presentation.view_models.tools_view_model.ToolsViewModel)" href="../../../presentation/features/tools/#controller.presentation.view_models.tools_view_model.ToolsViewModel">ToolsViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>工具视图模型。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化主视图模型。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>serial_vm</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SerialViewModel (controller.presentation.view_models.serial_view_model.SerialViewModel)" href="../../../presentation/device/serial/#controller.presentation.view_models.serial_view_model.SerialViewModel">SerialViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>注入的串口 VM。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>display_vm</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DisplayViewModel (controller.presentation.view_models.display_view_model.DisplayViewModel)" href="../../../presentation/core/display/#controller.presentation.view_models.display_view_model.DisplayViewModel">DisplayViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>注入的显示 VM。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>control_vm</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ControlViewModel (controller.presentation.view_models.control_view_model.ControlViewModel)" href="../../../presentation/device/control/#controller.presentation.view_models.control_view_model.ControlViewModel">ControlViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>注入的控制 VM。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>status_vm</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="StatusViewModel (controller.presentation.view_models.status_view_model.StatusViewModel)" href="../../../presentation/device/status/#controller.presentation.view_models.status_view_model.StatusViewModel">StatusViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>注入的状态 VM。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>effector_vm</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="EffectorViewModel (controller.presentation.view_models.effector_view_model.EffectorViewModel)" href="../../../presentation/device/effector/#controller.presentation.view_models.effector_view_model.EffectorViewModel">EffectorViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>注入的末端 VM。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>trajectory_vm</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TrajectoryViewModel (controller.presentation.view_models.trajectory_view_model.TrajectoryViewModel)" href="../../../presentation/features/trajectory/#controller.presentation.view_models.trajectory_view_model.TrajectoryViewModel">TrajectoryViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>注入的轨迹 VM。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dynamics_vm</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DynamicsViewModel (controller.presentation.view_models.dynamics_view_model.DynamicsViewModel)" href="../../../presentation/features/dynamics/#controller.presentation.view_models.dynamics_view_model.DynamicsViewModel">DynamicsViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>注入的动力学 VM。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>camera_vm</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CameraViewModel (controller.presentation.view_models.camera_view_model.CameraViewModel)" href="../../../presentation/features/camera/#controller.presentation.view_models.camera_view_model.CameraViewModel">CameraViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>注入的相机 VM。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>motion_planning_vm</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MotionPlanningViewModel (controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel)" href="../../../presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel">MotionPlanningViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>注入的规划 VM。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tools_vm</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ToolsViewModel (controller.presentation.view_models.tools_view_model.ToolsViewModel)" href="../../../presentation/features/tools/#controller.presentation.view_models.tools_view_model.ToolsViewModel">ToolsViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>注入的工具 VM。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parent</code>
            </td>
            <td>
                  <code><span title="QObject">QObject</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>父对象. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/presentation/view_models/main_view_model.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">serial_vm</span><span class="p">:</span> <span class="n">SerialViewModel</span><span class="p">,</span> 
    <span class="n">display_vm</span><span class="p">:</span> <span class="n">DisplayViewModel</span><span class="p">,</span> 
    <span class="n">control_vm</span><span class="p">:</span> <span class="n">ControlViewModel</span><span class="p">,</span> 
    <span class="n">status_vm</span><span class="p">:</span> <span class="n">StatusViewModel</span><span class="p">,</span>
    <span class="n">effector_vm</span><span class="p">:</span> <span class="n">EffectorViewModel</span><span class="p">,</span>
    <span class="n">trajectory_vm</span><span class="p">:</span> <span class="n">TrajectoryViewModel</span><span class="p">,</span>
    <span class="n">dynamics_vm</span><span class="p">:</span> <span class="n">DynamicsViewModel</span><span class="p">,</span>
    <span class="n">camera_vm</span><span class="p">:</span> <span class="n">CameraViewModel</span><span class="p">,</span>
    <span class="n">motion_planning_vm</span><span class="p">:</span> <span class="n">MotionPlanningViewModel</span><span class="p">,</span>
    <span class="n">tools_vm</span><span class="p">:</span> <span class="n">ToolsViewModel</span><span class="p">,</span>
    <span class="n">parent</span><span class="o">=</span><span class="kc">None</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化主视图模型。</span>

<span class="sd">    Args:</span>
<span class="sd">        serial_vm (SerialViewModel): 注入的串口 VM。</span>
<span class="sd">        display_vm (DisplayViewModel): 注入的显示 VM。</span>
<span class="sd">        control_vm (ControlViewModel): 注入的控制 VM。</span>
<span class="sd">        status_vm (StatusViewModel): 注入的状态 VM。</span>
<span class="sd">        effector_vm (EffectorViewModel): 注入的末端 VM。</span>
<span class="sd">        trajectory_vm (TrajectoryViewModel): 注入的轨迹 VM。</span>
<span class="sd">        dynamics_vm (DynamicsViewModel): 注入的动力学 VM。</span>
<span class="sd">        camera_vm (CameraViewModel): 注入的相机 VM。</span>
<span class="sd">        motion_planning_vm (MotionPlanningViewModel): 注入的规划 VM。</span>
<span class="sd">        tools_vm (ToolsViewModel): 注入的工具 VM。</span>
<span class="sd">        parent (QObject, optional): 父对象. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">serial_vm</span> <span class="o">=</span> <span class="n">serial_vm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">display_vm</span> <span class="o">=</span> <span class="n">display_vm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">control_vm</span> <span class="o">=</span> <span class="n">control_vm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">status_vm</span> <span class="o">=</span> <span class="n">status_vm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">effector_vm</span> <span class="o">=</span> <span class="n">effector_vm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">trajectory_vm</span> <span class="o">=</span> <span class="n">trajectory_vm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dynamics_vm</span> <span class="o">=</span> <span class="n">dynamics_vm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">camera_vm</span> <span class="o">=</span> <span class="n">camera_vm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">motion_planning_vm</span> <span class="o">=</span> <span class="n">motion_planning_vm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tools_vm</span> <span class="o">=</span> <span class="n">tools_vm</span>

    <span class="c1"># 连接连接状态信号</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_connect_status_update_signals</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MainViewModel.cleanup" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">cleanup</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">cleanup</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>清理资源。</p>
<p>调用所有子 ViewModel 的 cleanup 方法，确保资源释放。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/main_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;清理资源。</span>

<span class="sd">    调用所有子 ViewModel 的 cleanup 方法，确保资源释放。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 清理所有子ViewModels</span>
    <span class="k">for</span> <span class="n">vm_attr</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;serial_vm&#39;</span><span class="p">,</span> <span class="s1">&#39;display_vm&#39;</span><span class="p">,</span> <span class="s1">&#39;control_vm&#39;</span><span class="p">,</span> <span class="s1">&#39;status_vm&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;effector_vm&#39;</span><span class="p">,</span> <span class="s1">&#39;trajectory_vm&#39;</span><span class="p">,</span> <span class="s1">&#39;dynamics_vm&#39;</span><span class="p">,</span> <span class="s1">&#39;camera_vm&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;motion_planning_vm&#39;</span><span class="p">,</span> <span class="s1">&#39;tools_vm&#39;</span><span class="p">]:</span>
        <span class="n">vm</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vm_attr</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">vm</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">vm</span><span class="p">,</span> <span class="s1">&#39;cleanup&#39;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">vm</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">pass</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span> 
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.SerialViewModel" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">SerialViewModel</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">SerialViewModel</span><span class="p">(</span><span class="n">serial_service</span><span class="p">:</span> <span class="n">SerialApplicationService</span><span class="p">,</span> <span class="n">command_hub_service</span><span class="p">:</span> <span class="n">CommandHubService</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseViewModel (controller.presentation.view_models.base_view_model.BaseViewModel)" href="../../../presentation/core/base/#controller.presentation.view_models.base_view_model.BaseViewModel">BaseViewModel</a></code></p>



        <p>串口视图模型。</p>
<p>纯信号转发层，不包含业务逻辑，负责 UI 与串口服务的交互。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.SerialViewModel.port_list_updated">port_list_updated</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>端口列表更新信号，携带端口列表。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.SerialViewModel.serial_service">serial_service</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SerialApplicationService (controller.application.SerialApplicationService)" href="#controller.shared.config.service_registry.SerialApplicationService">SerialApplicationService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>串口应用服务。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.SerialViewModel.command_hub_service">command_hub_service</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommandHubService (controller.application.CommandHubService)" href="#controller.shared.config.service_registry.CommandHubService">CommandHubService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>命令中心服务。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化视图模型。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>serial_service</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SerialApplicationService (controller.application.SerialApplicationService)" href="#controller.shared.config.service_registry.SerialApplicationService">SerialApplicationService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>串口应用服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>command_hub_service</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommandHubService (controller.application.CommandHubService)" href="#controller.shared.config.service_registry.CommandHubService">CommandHubService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>命令中心服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parent</code>
            </td>
            <td>
                  <code><span title="QObject">QObject</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>父对象. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/presentation/view_models/serial_view_model.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">serial_service</span><span class="p">:</span> <span class="n">SerialApplicationService</span><span class="p">,</span> <span class="n">command_hub_service</span><span class="p">:</span> <span class="n">CommandHubService</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化视图模型。</span>

<span class="sd">    Args:</span>
<span class="sd">        serial_service (SerialApplicationService): 串口应用服务。</span>
<span class="sd">        command_hub_service (CommandHubService): 命令中心服务。</span>
<span class="sd">        parent (QObject, optional): 父对象. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">serial_service</span> <span class="o">=</span> <span class="n">serial_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">command_hub_service</span> <span class="o">=</span> <span class="n">command_hub_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_connect_service_signals</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialViewModel.refresh_ports" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">refresh_ports</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">refresh_ports</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>刷新端口列表命令 - 直接转发到Service。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/serial_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">refresh_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;刷新端口列表命令 - 直接转发到Service。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">serial_service</span><span class="o">.</span><span class="n">refresh_ports</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialViewModel.connect_serial" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">connect_serial</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">connect_serial</span><span class="p">(</span><span class="n">port</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>连接串口命令 - 直接转发到Service。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>port</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>端口名称。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>配置参数。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/serial_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">connect_serial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;连接串口命令 - 直接转发到Service。</span>

<span class="sd">    Args:</span>
<span class="sd">        port (str): 端口名称。</span>
<span class="sd">        config (Dict[str, Any]): 配置参数。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">serial_service</span><span class="o">.</span><span class="n">connect_serial</span><span class="p">(</span><span class="n">port</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialViewModel.disconnect_serial" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">disconnect_serial</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">disconnect_serial</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>断开连接命令 - 直接转发到Service。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/serial_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">disconnect_serial</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;断开连接命令 - 直接转发到Service。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">serial_service</span><span class="o">.</span><span class="n">disconnect_serial</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialViewModel.get_available_ports" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_available_ports</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_available_ports</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取可用端口列表 - 委托给Service。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[str]: 端口列表。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/serial_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_available_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取可用端口列表 - 委托给Service。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: 端口列表。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_service</span><span class="o">.</span><span class="n">get_available_ports</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialViewModel.get_current_port" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_current_port</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_current_port</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取当前连接的端口 - 委托给Service。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[str]: 端口名称。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/serial_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_current_port</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取当前连接的端口 - 委托给Service。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[str]: 端口名称。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_service</span><span class="o">.</span><span class="n">get_current_port</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialViewModel.get_connection_status" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_connection_status</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_connection_status</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取连接状态 - 委托给Service。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否已连接。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/serial_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_connection_status</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取连接状态 - 委托给Service。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 是否已连接。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_service</span><span class="o">.</span><span class="n">is_connected</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialViewModel.get_port_info" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_port_info</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_port_info</span><span class="p">(</span><span class="n">port_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取端口信息 - 委托给Service。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>port_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>端口名称。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[Dict[str, str]]: 端口信息。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/serial_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_port_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">port_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取端口信息 - 委托给Service。</span>

<span class="sd">    Args:</span>
<span class="sd">        port_name (str): 端口名称。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[Dict[str, str]]: 端口信息。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_service</span><span class="o">.</span><span class="n">get_port_info</span><span class="p">(</span><span class="n">port_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialViewModel.cleanup" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">cleanup</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">cleanup</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>清理视图模型 - 断开信号连接。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/serial_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;清理视图模型 - 断开信号连接。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_disconnect_service_signals</span><span class="p">()</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span> 
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.DisplayViewModel" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">DisplayViewModel</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">DisplayViewModel</span><span class="p">(</span><span class="n">message_display</span><span class="p">:</span> <span class="n">MessageDisplay</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseViewModel (controller.presentation.view_models.base_view_model.BaseViewModel)" href="../../../presentation/core/base/#controller.presentation.view_models.base_view_model.BaseViewModel">BaseViewModel</a></code></p>



        <p>显示视图模型。</p>
<p>作为消息显示的中心分发器，其他服务调用它的方法来显示消息。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.DisplayViewModel.message_display_signal">message_display_signal</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>消息显示信号，携带 (消息内容, 消息类型)。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.DisplayViewModel.clear_requested">clear_requested</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>清除消息请求信号。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.DisplayViewModel.message_display">message_display</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MessageDisplay (controller.application.MessageDisplay)" href="#controller.shared.config.service_registry.MessageDisplay">MessageDisplay</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>消息显示服务。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化显示视图模型。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>message_display</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MessageDisplay (controller.application.MessageDisplay)" href="#controller.shared.config.service_registry.MessageDisplay">MessageDisplay</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>消息显示服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parent</code>
            </td>
            <td>
                  <code><span title="QObject">QObject</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>父对象. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/presentation/view_models/display_view_model.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message_display</span><span class="p">:</span> <span class="n">MessageDisplay</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化显示视图模型。</span>

<span class="sd">    Args:</span>
<span class="sd">        message_display (MessageDisplay): 消息显示服务。</span>
<span class="sd">        parent (QObject, optional): 父对象. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">message_display</span> <span class="o">=</span> <span class="n">message_display</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">message_display</span><span class="o">.</span><span class="n">message_display_signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">message_display_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">message_display</span><span class="o">.</span><span class="n">clear_requested</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clear_requested</span><span class="o">.</span><span class="n">emit</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.DisplayViewModel.clear_messages" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clear_messages</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">clear_messages</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>清除所有消息。</p>
<p>发送清除消息信号。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/display_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">clear_messages</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;清除所有消息。</span>

<span class="sd">    发送清除消息信号。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 发送清除消息信号</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">clear_requested</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.DisplayViewModel.cleanup" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">cleanup</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">cleanup</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>清理资源。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/display_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;清理资源。&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span> 
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.ControlViewModel" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ControlViewModel</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">ControlViewModel</span><span class="p">(</span><span class="n">command_hub_service</span><span class="p">:</span> <span class="n">CommandHubService</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseViewModel (controller.presentation.view_models.base_view_model.BaseViewModel)" href="../../../presentation/core/base/#controller.presentation.view_models.base_view_model.BaseViewModel">BaseViewModel</a></code></p>



        <p>控制视图模型。</p>
<p>负责处理用户输入的控制命令，并分发到命令中心服务。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.ControlViewModel.command_hub_service">command_hub_service</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommandHubService (controller.application.CommandHubService)" href="#controller.shared.config.service_registry.CommandHubService">CommandHubService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>命令中心服务。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化控制视图模型。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>command_hub_service</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommandHubService (controller.application.CommandHubService)" href="#controller.shared.config.service_registry.CommandHubService">CommandHubService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>命令中心服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parent</code>
            </td>
            <td>
                  <code><span title="QObject">QObject</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>父对象. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/presentation/view_models/control_view_model.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_hub_service</span><span class="p">:</span> <span class="n">CommandHubService</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化控制视图模型。</span>

<span class="sd">    Args:</span>
<span class="sd">        command_hub_service (CommandHubService): 命令中心服务。</span>
<span class="sd">        parent (QObject, optional): 父对象. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">command_hub_service</span> <span class="o">=</span> <span class="n">command_hub_service</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.ControlViewModel.send_command" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">send_command</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">send_command</span><span class="p">(</span><span class="n">config_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>发送控制命令。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>命令配置字典，包含控制参数。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/control_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">send_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;发送控制命令。</span>

<span class="sd">    Args:</span>
<span class="sd">        config_dict (dict): 命令配置字典，包含控制参数。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">command_hub_service</span><span class="o">.</span><span class="n">command_distribution</span><span class="p">(</span><span class="n">config_dict</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.StatusViewModel" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">StatusViewModel</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">StatusViewModel</span><span class="p">(</span><span class="n">robot_state_service</span><span class="p">:</span> <span class="n">RobotStateDomainService</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseViewModel (controller.presentation.view_models.base_view_model.BaseViewModel)" href="../../../presentation/core/base/#controller.presentation.view_models.base_view_model.BaseViewModel">BaseViewModel</a></code></p>



        <p>状态视图模型。</p>
<p>管理机器人状态显示，订阅 RobotStateDomainService 的状态更新，不再自己维护状态。</p>
<p>职责：
1. 订阅 RobotStateDomainService 的状态更新
2. 转换数据格式（转换为 dict 供 UI 组件使用）
3. 发射信号给 UI 组件</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.StatusViewModel.status_updated">status_updated</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>状态更新信号，携带状态数据字典。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.StatusViewModel.robot_state_service">robot_state_service</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="RobotStateDomainService (controller.domain.RobotStateDomainService)" href="#controller.shared.config.service_registry.RobotStateDomainService">RobotStateDomainService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>机械臂状态服务。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化状态视图模型。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>robot_state_service</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="RobotStateDomainService (controller.domain.RobotStateDomainService)" href="#controller.shared.config.service_registry.RobotStateDomainService">RobotStateDomainService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>机械臂状态服务（依赖注入）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parent</code>
            </td>
            <td>
                  <code><span title="QObject">QObject</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>父对象. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/presentation/view_models/status_view_model.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">robot_state_service</span><span class="p">:</span> <span class="n">RobotStateDomainService</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化状态视图模型。</span>

<span class="sd">    Args:</span>
<span class="sd">        robot_state_service (RobotStateDomainService): 机械臂状态服务（依赖注入）。</span>
<span class="sd">        parent (QObject, optional): 父对象. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">robot_state_service</span> <span class="o">=</span> <span class="n">robot_state_service</span>

    <span class="c1"># 订阅状态服务的信号</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">robot_state_service</span><span class="o">.</span><span class="n">state_updated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_state_updated</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.StatusViewModel.get_position_string" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_position_string</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_position_string</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取位置信息的字符串表示。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>位置字符串，如 "[0.50, -1.20, 0.30, 0.00, 0.00, 0.00]"。如果无数据返回 "--"。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/status_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_position_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取位置信息的字符串表示。</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: 位置字符串，如 &quot;[0.50, -1.20, 0.30, 0.00, 0.00, 0.00]&quot;。如果无数据返回 &quot;--&quot;。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">robot_state_service</span><span class="o">.</span><span class="n">get_current_state</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">snapshot</span><span class="p">:</span>
        <span class="n">positions</span> <span class="o">=</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">joint_angles</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pos</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">positions</span><span class="p">[:</span><span class="mi">6</span><span class="p">])</span><span class="si">}</span><span class="s2">]&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;--&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.StatusViewModel.get_status_summary" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_status_summary</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_status_summary</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取状态摘要。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>状态摘要字符串，如 "CMD:0x06 | MODE:0x08 | STA:0x01"。如果无数据返回 "无状态数据"。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/status_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_status_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取状态摘要。</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: 状态摘要字符串，如 &quot;CMD:0x06 | MODE:0x08 | STA:0x01&quot;。如果无数据返回 &quot;无状态数据&quot;。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">robot_state_service</span><span class="o">.</span><span class="n">get_current_state</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">snapshot</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;无状态数据&quot;</span>

    <span class="n">summary</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CMD:0x</span><span class="si">{</span><span class="n">snapshot</span><span class="o">.</span><span class="n">control</span><span class="si">:</span><span class="s2">02X</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MODE:0x</span><span class="si">{</span><span class="n">snapshot</span><span class="o">.</span><span class="n">mode</span><span class="si">:</span><span class="s2">02X</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;STA:0x</span><span class="si">{</span><span class="n">snapshot</span><span class="o">.</span><span class="n">init_status</span><span class="si">:</span><span class="s2">02X</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># 检查错误</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">err</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">err</span> <span class="ow">in</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">errors</span><span class="p">):</span>
        <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ERR:有错误&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot; | &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.EffectorViewModel" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">EffectorViewModel</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">EffectorViewModel</span><span class="p">(</span><span class="n">command_hub_service</span><span class="p">:</span> <span class="n">CommandHubService</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseViewModel (controller.presentation.view_models.base_view_model.BaseViewModel)" href="../../../presentation/core/base/#controller.presentation.view_models.base_view_model.BaseViewModel">BaseViewModel</a></code></p>



        <p>末端执行器视图模型。</p>
<p>负责处理末端执行器（如夹爪、吸盘）的控制命令。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.EffectorViewModel.command_hub_service">command_hub_service</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommandHubService (controller.application.CommandHubService)" href="#controller.shared.config.service_registry.CommandHubService">CommandHubService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>命令中心服务。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化末端执行器视图模型。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>command_hub_service</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommandHubService (controller.application.CommandHubService)" href="#controller.shared.config.service_registry.CommandHubService">CommandHubService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>命令中心服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parent</code>
            </td>
            <td>
                  <code><span title="QObject">QObject</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>父对象. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/presentation/view_models/effector_view_model.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_hub_service</span><span class="p">:</span> <span class="n">CommandHubService</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化末端执行器视图模型。</span>

<span class="sd">    Args:</span>
<span class="sd">        command_hub_service (CommandHubService): 命令中心服务。</span>
<span class="sd">        parent (QObject, optional): 父对象. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">command_hub_service</span> <span class="o">=</span> <span class="n">command_hub_service</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.EffectorViewModel.send_effector_command" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">send_effector_command</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">send_effector_command</span><span class="p">(</span><span class="n">config_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>发送末端执行器命令。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>命令配置字典。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/effector_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">send_effector_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;发送末端执行器命令。</span>

<span class="sd">    Args:</span>
<span class="sd">        config_dict (dict): 命令配置字典。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">command_hub_service</span><span class="o">.</span><span class="n">command_distribution</span><span class="p">(</span><span class="n">config_dict</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.TrajectoryViewModel" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">TrajectoryViewModel</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">TrajectoryViewModel</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseViewModel (controller.presentation.view_models.base_view_model.BaseViewModel)" href="../../../presentation/core/base/#controller.presentation.view_models.base_view_model.BaseViewModel">BaseViewModel</a></code></p>



        <p>轨迹规划视图模型。</p>
<p>负责轨迹规划相关的 UI 交互逻辑。</p>

        <p>初始化轨迹规划视图模型。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>parent</code>
            </td>
            <td>
                  <code><span title="QObject">QObject</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>父对象. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/presentation/view_models/trajectory_view_model.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化轨迹规划视图模型。</span>

<span class="sd">    Args:</span>
<span class="sd">        parent (QObject, optional): 父对象. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">







  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.DynamicsViewModel" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">DynamicsViewModel</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">DynamicsViewModel</span><span class="p">(</span><span class="n">command_hub_service</span><span class="p">:</span> <span class="n">CommandHubService</span><span class="p">,</span> <span class="n">robot_state_service</span><span class="p">:</span> <span class="n">RobotStateDomainService</span><span class="p">,</span> <span class="n">dynamic_service</span><span class="p">:</span> <span class="n">DynamicDomainService</span><span class="p">,</span> <span class="n">teach_record_service</span><span class="p">:</span> <span class="n">TeachRecordDomainService</span><span class="p">,</span> <span class="n">record_repository</span><span class="p">:</span> <span class="n">RecordRepository</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">object</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseViewModel (controller.presentation.view_models.base_view_model.BaseViewModel)" href="../../../presentation/core/base/#controller.presentation.view_models.base_view_model.BaseViewModel">BaseViewModel</a></code></p>



        <p>动力学视图模型。</p>
<p>订阅 RobotStateDomainService，实现力矩补偿和示教记录。</p>
<p>职责：
1. 处理示教模式切换
2. 订阅力矩补偿请求（数据驱动）
3. 计算并发送力矩补偿
4. 管理示教记录的录制、保存、播放</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.DynamicsViewModel.recording_state_changed">recording_state_changed</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>记录状态变化信号。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.DynamicsViewModel.record_list_updated">record_list_updated</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>记录列表更新信号。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.DynamicsViewModel.command_hub">command_hub</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommandHubService (controller.application.CommandHubService)" href="#controller.shared.config.service_registry.CommandHubService">CommandHubService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>命令中心服务。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.DynamicsViewModel.robot_state">robot_state</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="RobotStateDomainService (controller.domain.RobotStateDomainService)" href="#controller.shared.config.service_registry.RobotStateDomainService">RobotStateDomainService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>机械臂状态服务。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.DynamicsViewModel.dynamic_service">dynamic_service</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DynamicDomainService (controller.domain.DynamicDomainService)" href="#controller.shared.config.service_registry.DynamicDomainService">DynamicDomainService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>动力学服务。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.DynamicsViewModel.teach_record_service">teach_record_service</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TeachRecordDomainService (controller.domain.TeachRecordDomainService)" href="#controller.shared.config.service_registry.TeachRecordDomainService">TeachRecordDomainService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>示教记录服务。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.DynamicsViewModel.record_repository">record_repository</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="RecordRepository (controller.infrastructure.RecordRepository)" href="#controller.shared.config.service_registry.RecordRepository">RecordRepository</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>记录仓储。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化动力学视图模型。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>command_hub_service</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommandHubService (controller.application.CommandHubService)" href="#controller.shared.config.service_registry.CommandHubService">CommandHubService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>命令中心服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>robot_state_service</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="RobotStateDomainService (controller.domain.RobotStateDomainService)" href="#controller.shared.config.service_registry.RobotStateDomainService">RobotStateDomainService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>机械臂状态服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dynamic_service</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DynamicDomainService (controller.domain.DynamicDomainService)" href="#controller.shared.config.service_registry.DynamicDomainService">DynamicDomainService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>动力学服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>teach_record_service</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TeachRecordDomainService (controller.domain.TeachRecordDomainService)" href="#controller.shared.config.service_registry.TeachRecordDomainService">TeachRecordDomainService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>示教记录服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>record_repository</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="RecordRepository (controller.infrastructure.RecordRepository)" href="#controller.shared.config.service_registry.RecordRepository">RecordRepository</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>记录仓储。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parent</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="object">object</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>父对象。</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">command_hub_service</span><span class="p">:</span> <span class="n">CommandHubService</span><span class="p">,</span>
    <span class="n">robot_state_service</span><span class="p">:</span> <span class="n">RobotStateDomainService</span><span class="p">,</span>
    <span class="n">dynamic_service</span><span class="p">:</span> <span class="n">DynamicDomainService</span><span class="p">,</span>
    <span class="n">teach_record_service</span><span class="p">:</span> <span class="n">TeachRecordDomainService</span><span class="p">,</span>
    <span class="n">record_repository</span><span class="p">:</span> <span class="n">RecordRepository</span><span class="p">,</span>
    <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">object</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化动力学视图模型。</span>

<span class="sd">    Args:</span>
<span class="sd">        command_hub_service: 命令中心服务。</span>
<span class="sd">        robot_state_service: 机械臂状态服务。</span>
<span class="sd">        dynamic_service: 动力学服务。</span>
<span class="sd">        teach_record_service: 示教记录服务。</span>
<span class="sd">        record_repository: 记录仓储。</span>
<span class="sd">        parent: 父对象。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">command_hub</span> <span class="o">=</span> <span class="n">command_hub_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">robot_state</span> <span class="o">=</span> <span class="n">robot_state_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_service</span> <span class="o">=</span> <span class="n">dynamic_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">teach_record_service</span> <span class="o">=</span> <span class="n">teach_record_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">record_repository</span> <span class="o">=</span> <span class="n">record_repository</span>

    <span class="c1"># 订阅力矩补偿请求信号（数据驱动，不是定时器）</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">robot_state</span><span class="o">.</span><span class="n">torque_compensation_requested</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_torque_compensation_requested</span>
    <span class="p">)</span>

    <span class="c1"># 订阅记录服务的信号</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">teach_record_service</span><span class="o">.</span><span class="n">recording_state_changed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recording_state_changed</span><span class="o">.</span><span class="n">emit</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">teach_record_service</span><span class="o">.</span><span class="n">record_added</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_record_added</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">teach_record_service</span><span class="o">.</span><span class="n">record_deleted</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_record_deleted</span>
    <span class="p">)</span>

    <span class="c1"># 连接记录定时器到状态更新</span>
    <span class="n">record_timer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">teach_record_service</span><span class="o">.</span><span class="n">get_record_timer</span><span class="p">()</span>
    <span class="n">record_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_record_timer_timeout</span><span class="p">)</span>

    <span class="c1"># 加载已存在的记录</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_load_records_from_file</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.DynamicsViewModel.toggle_teaching_mode" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">toggle_teaching_mode</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">toggle_teaching_mode</span><span class="p">(</span><span class="n">command_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>切换示教模式。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>command_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>命令字典，包含 control 和 mode。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">toggle_teaching_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;切换示教模式。</span>

<span class="sd">    Args:</span>
<span class="sd">        command_dict (dict): 命令字典，包含 control 和 mode。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 1. 发送串口命令</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">command_hub</span><span class="o">.</span><span class="n">command_distribution</span><span class="p">(</span><span class="n">command_dict</span><span class="p">)</span>

    <span class="c1"># 2. 更新状态服务的示教模式标志</span>
    <span class="n">is_enable</span> <span class="o">=</span> <span class="p">(</span><span class="n">command_dict</span><span class="p">[</span><span class="s1">&#39;control&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x07</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">robot_state</span><span class="o">.</span><span class="n">set_teaching_mode</span><span class="p">(</span><span class="n">is_enable</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.DynamicsViewModel.send_torque" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">send_torque</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">send_torque</span><span class="p">(</span><span class="n">torque_values</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>发送力矩控制命令。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>torque_values</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>力矩值列表（6个关节）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">send_torque</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">torque_values</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;发送力矩控制命令。</span>

<span class="sd">    Args:</span>
<span class="sd">        torque_values (list): 力矩值列表（6个关节）。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">command_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;control&#39;</span><span class="p">:</span> <span class="mh">0x06</span><span class="p">,</span>  <span class="c1"># 力矩控制</span>
        <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="mh">0x0A</span><span class="p">,</span>     <span class="c1"># 周期力矩模式</span>
        <span class="s1">&#39;torque&#39;</span><span class="p">:</span> <span class="n">torque_values</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">command_hub</span><span class="o">.</span><span class="n">command_distribution</span><span class="p">(</span><span class="n">command_dict</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.DynamicsViewModel.toggle_recording" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">toggle_recording</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">toggle_recording</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>切换记录状态（开始/停止）。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">toggle_recording</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;切换记录状态（开始/停止）。&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">teach_record_service</span><span class="o">.</span><span class="n">is_recording</span><span class="p">():</span>
        <span class="c1"># 停止记录</span>
        <span class="n">record_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">teach_record_service</span><span class="o">.</span><span class="n">stop_recording</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">record_name</span><span class="p">:</span>
            <span class="c1"># 保存到文件</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_records_to_file</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># 开始记录</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">teach_record_service</span><span class="o">.</span><span class="n">start_recording</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.DynamicsViewModel.delete_record" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">delete_record</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">delete_record</span><span class="p">(</span><span class="n">record_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>删除指定记录。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>record_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>记录名称。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否删除成功。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;删除指定记录。</span>

<span class="sd">    Args:</span>
<span class="sd">        record_name (str): 记录名称。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 是否删除成功。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">teach_record_service</span><span class="o">.</span><span class="n">delete_record</span><span class="p">(</span><span class="n">record_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_records_to_file</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">success</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.DynamicsViewModel.run_record" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">run_record</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">run_record</span><span class="p">(</span><span class="n">record_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>运行指定记录（播放示教轨迹）。</p>
<p>流程：
1. 获取示教记录的角度列表
2. 委托给 CommandHubService 处理</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>record_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>记录名称。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;运行指定记录（播放示教轨迹）。</span>

<span class="sd">    流程：</span>
<span class="sd">    1. 获取示教记录的角度列表</span>
<span class="sd">    2. 委托给 CommandHubService 处理</span>

<span class="sd">    Args:</span>
<span class="sd">        record_name (str): 记录名称。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">angles_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">teach_record_service</span><span class="o">.</span><span class="n">get_record</span><span class="p">(</span><span class="n">record_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">angles_list</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command_hub</span><span class="o">.</span><span class="n">run_teach_record</span><span class="p">(</span><span class="n">angles_list</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.DynamicsViewModel.reverse_record" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">reverse_record</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">reverse_record</span><span class="p">(</span><span class="n">record_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>反转指定记录。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>record_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>记录名称。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[str]: 新记录名称，失败返回 None。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reverse_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;反转指定记录。</span>

<span class="sd">    Args:</span>
<span class="sd">        record_name (str): 记录名称。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[str]: 新记录名称，失败返回 None。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">teach_record_service</span><span class="o">.</span><span class="n">reverse_record</span><span class="p">(</span><span class="n">record_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">new_name</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_records_to_file</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">new_name</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.DynamicsViewModel.get_record_names" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_record_names</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_record_names</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取所有记录名称。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[str]: 记录名称列表。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_record_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取所有记录名称。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: 记录名称列表。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">teach_record_service</span><span class="o">.</span><span class="n">get_record_names</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.DynamicsViewModel.is_recording" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">is_recording</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_recording</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>查询是否正在记录。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否正在记录。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_recording</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;查询是否正在记录。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 是否正在记录。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">teach_record_service</span><span class="o">.</span><span class="n">is_recording</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.CameraViewModel" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">CameraViewModel</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">CameraViewModel</span><span class="p">(</span><span class="n">app_service</span><span class="p">:</span> <span class="n">CameraApplicationService</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseViewModel (controller.presentation.view_models.base_view_model.BaseViewModel)" href="../../../presentation/core/base/#controller.presentation.view_models.base_view_model.BaseViewModel">BaseViewModel</a></code></p>



        <p>摄像头视图模型。</p>
<p>职责：
- 连接 UI 和 Application Service
- 管理图像显示状态（定时刷新）
- 管理检测状态
- 通过 Application Service 获取图像和检测结果</p>
<p>架构原则：
- 只依赖 Application 层，不直接访问 Domain 层
- 所有 Domain 层调用通过 Application Service 转发</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CameraViewModel.image_display_requested">image_display_requested</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>图像显示请求信号，携带 (image, image_type)。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CameraViewModel.status_updated">status_updated</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>状态文本更新信号。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CameraViewModel.image_info_updated">image_info_updated</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>图像信息更新信号。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CameraViewModel.connection_status_changed">connection_status_changed</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>摄像头连接状态信号。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CameraViewModel.button_states_changed">button_states_changed</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>按钮状态变更信号，携带 (color_active, depth_active)。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CameraViewModel.clear_display_requested">clear_display_requested</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>清除显示请求信号。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CameraViewModel.detection_status_changed">detection_status_changed</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>检测状态变更信号。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CameraViewModel.detection_result_updated">detection_result_updated</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>检测结果更新信号。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CameraViewModel.app_service">app_service</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CameraApplicationService (controller.application.CameraApplicationService)" href="#controller.shared.config.service_registry.CameraApplicationService">CameraApplicationService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>摄像头应用服务。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CameraViewModel.display_timer">display_timer</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.QTimer">QTimer</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>图像刷新定时器。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化摄像头视图模型。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>app_service</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CameraApplicationService (controller.application.CameraApplicationService)" href="#controller.shared.config.service_registry.CameraApplicationService">CameraApplicationService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>摄像头应用服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parent</code>
            </td>
            <td>
                  <code><span title="QObject">QObject</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>父对象. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/presentation/view_models/camera_view_model.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">app_service</span><span class="p">:</span> <span class="n">CameraApplicationService</span><span class="p">,</span>
    <span class="n">parent</span><span class="o">=</span><span class="kc">None</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化摄像头视图模型。</span>

<span class="sd">    Args:</span>
<span class="sd">        app_service (CameraApplicationService): 摄像头应用服务。</span>
<span class="sd">        parent (QObject, optional): 父对象. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span> <span class="o">=</span> <span class="n">app_service</span>

    <span class="c1"># 显示状态</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_display_mode</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># None, &#39;color&#39;, &#39;depth&#39;</span>

    <span class="c1"># 定时器（30FPS刷新图像）</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">display_timer</span> <span class="o">=</span> <span class="n">QTimer</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">display_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_display</span><span class="p">)</span>

    <span class="c1"># 连接信号</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_connect_signals</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraViewModel.connect_camera" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">connect_camera</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">connect_camera</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>连接摄像头。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/camera_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">connect_camera</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;连接摄像头。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">connect_camera</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraViewModel.disconnect_camera" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">disconnect_camera</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">disconnect_camera</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>断开摄像头。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/camera_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">disconnect_camera</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;断开摄像头。&quot;&quot;&quot;</span>
    <span class="c1"># 先停止显示</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_display_mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_display</span><span class="p">()</span>

    <span class="c1"># 断开摄像头</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">disconnect_camera</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraViewModel.start_color_display" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">start_color_display</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">start_color_display</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>开始显示彩色图。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/camera_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">start_color_display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;开始显示彩色图。&quot;&quot;&quot;</span>
    <span class="c1"># ✅ 通过Application层检查摄像头是否连接</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">is_camera_connected</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_updated</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">&quot;请先连接摄像头&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># 设置显示模式</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_display_mode</span> <span class="o">=</span> <span class="s1">&#39;color&#39;</span>

    <span class="c1"># 启动定时器（33ms = ~30FPS）</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">display_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>

    <span class="c1"># 更新状态</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">status_updated</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">&quot;显示彩色图像&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">button_states_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraViewModel.start_depth_display" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">start_depth_display</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">start_depth_display</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>开始显示深度图。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/camera_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">start_depth_display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;开始显示深度图。&quot;&quot;&quot;</span>
    <span class="c1"># ✅ 通过Application层检查摄像头是否连接</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">is_camera_connected</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_updated</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">&quot;请先连接摄像头&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># 设置显示模式</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_display_mode</span> <span class="o">=</span> <span class="s1">&#39;depth&#39;</span>

    <span class="c1"># 启动定时器</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">display_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>

    <span class="c1"># 更新状态</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">status_updated</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">&quot;显示深度图像&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">button_states_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraViewModel.stop_display" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">stop_display</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">stop_display</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>停止显示。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/camera_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stop_display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;停止显示。&quot;&quot;&quot;</span>
    <span class="c1"># 停止定时器</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">display_timer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

    <span class="c1"># 清除显示模式</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_display_mode</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># 清除显示</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">clear_display_requested</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>

    <span class="c1"># 更新状态</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">status_updated</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">&quot;已停止显示&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">button_states_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">image_info_updated</span><span class="o">.</span><span class="n">emit</span><span class="p">({})</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraViewModel.start_detection" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">start_detection</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">start_detection</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>开始检测。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/camera_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">start_detection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;开始检测。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">start_detection</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraViewModel.stop_detection" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">stop_detection</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">stop_detection</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>停止检测。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/camera_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stop_detection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;停止检测。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">stop_detection</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraViewModel.move_to_detected_part" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">move_to_detected_part</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">move_to_detected_part</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>运动到检测到的零件位置。</p>
<p>职责：仅转发到 Application 层。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/camera_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_to_detected_part</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;运动到检测到的零件位置。</span>

<span class="sd">    职责：仅转发到 Application 层。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">move_to_detected_part</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraViewModel.cleanup" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">cleanup</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">cleanup</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>清理资源。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/camera_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;清理资源。&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 停止检测（✅ 通过Application层）</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">is_detection_running</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">stop_detection</span><span class="p">()</span>

        <span class="c1"># 停止显示</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_display</span><span class="p">()</span>

        <span class="c1"># 断开摄像头（✅ 通过Application层）</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">is_camera_connected</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">disconnect_camera</span><span class="p">()</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.MotionPlanningViewModel" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MotionPlanningViewModel</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">MotionPlanningViewModel</span><span class="p">(</span><span class="n">app_service</span><span class="p">:</span> <span class="n">MotionPlanningApplicationService</span><span class="p">,</span> <span class="n">dynamics_vm</span><span class="p">:</span> <span class="n">DynamicsViewModel</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="PyQt5.QtCore.QObject">QObject</span></code></p>



        <p>运动规划 ViewModel。</p>
<p>职责：
1. 转发 UI 命令到 Application Service
2. 转发 Application Service 信号到 UI 组件
3. 通过 DynamicsViewModel 获取示教记录（避免重复注入）</p>
<p>设计原则：
- ViewModel 只依赖 Application Service，不直接访问 Domain 或 Infrastructure
- 所有业务逻辑在 Application Service 中封装</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionPlanningViewModel.plan_list_changed">plan_list_changed</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>方案列表变更信号。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionPlanningViewModel.current_plan_changed">current_plan_changed</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>当前方案变更信号，携带索引。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionPlanningViewModel.point_list_changed">point_list_changed</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点列表变更信号。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionPlanningViewModel.current_position_received">current_position_received</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>当前位置数据信号，携带角度列表（弧度）。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionPlanningViewModel.trajectory_preview_signal">trajectory_preview_signal</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>轨迹预览信号，携带 (轨迹数据, 上下文)。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionPlanningViewModel.app_service">app_service</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MotionPlanningApplicationService (controller.application.MotionPlanningApplicationService)" href="#controller.shared.config.service_registry.MotionPlanningApplicationService">MotionPlanningApplicationService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运动规划应用服务。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionPlanningViewModel.dynamics_vm">dynamics_vm</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DynamicsViewModel (controller.presentation.view_models.dynamics_view_model.DynamicsViewModel)" href="../../../presentation/features/dynamics/#controller.presentation.view_models.dynamics_view_model.DynamicsViewModel">DynamicsViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>动力学 ViewModel。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化运动规划 ViewModel。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>app_service</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MotionPlanningApplicationService (controller.application.MotionPlanningApplicationService)" href="#controller.shared.config.service_registry.MotionPlanningApplicationService">MotionPlanningApplicationService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运动规划应用服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dynamics_vm</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DynamicsViewModel (controller.presentation.view_models.dynamics_view_model.DynamicsViewModel)" href="../../../presentation/features/dynamics/#controller.presentation.view_models.dynamics_view_model.DynamicsViewModel">DynamicsViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>动力学 ViewModel。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">app_service</span><span class="p">:</span> <span class="n">MotionPlanningApplicationService</span><span class="p">,</span>
    <span class="n">dynamics_vm</span><span class="p">:</span> <span class="n">DynamicsViewModel</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化运动规划 ViewModel。</span>

<span class="sd">    Args:</span>
<span class="sd">        app_service (MotionPlanningApplicationService): 运动规划应用服务。</span>
<span class="sd">        dynamics_vm (DynamicsViewModel): 动力学 ViewModel。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span> <span class="o">=</span> <span class="n">app_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dynamics_vm</span> <span class="o">=</span> <span class="n">dynamics_vm</span>

    <span class="c1"># 连接Application Service的信号</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">plan_list_changed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plan_list_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">current_plan_changed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_plan_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">point_list_changed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point_list_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">current_position_received</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_position_received</span><span class="o">.</span><span class="n">emit</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">trajectory_preview_signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trajectory_preview_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.create_plan" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_plan</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_plan</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>创建方案。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>方案名称。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;创建方案。</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): 方案名称。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">create_plan</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.delete_plan" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">delete_plan</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">delete_plan</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>删除方案。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>方案索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True=删除成功, False=删除失败（违反业务规则）。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;删除方案。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 方案索引。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True=删除成功, False=删除失败（违反业务规则）。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">delete_plan</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.switch_plan" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">switch_plan</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">switch_plan</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>切换方案。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>方案索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">switch_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;切换方案。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 方案索引。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">switch_plan</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.rename_plan" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">rename_plan</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">rename_plan</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>重命名方案。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>方案索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>new_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>新名称。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rename_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;重命名方案。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 方案索引。</span>
<span class="sd">        new_name (str): 新名称。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">rename_plan</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.get_plan_names" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_plan_names</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_plan_names</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取所有方案名称。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[str]: 方案名称列表。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_plan_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取所有方案名称。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: 方案名称列表。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">domain_service</span><span class="o">.</span><span class="n">get_plan_names</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.get_current_plan_index" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_current_plan_index</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_current_plan_index</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取当前方案索引。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>当前索引。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_current_plan_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取当前方案索引。</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: 当前索引。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">domain_service</span><span class="o">.</span><span class="n">get_current_index</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.get_plan_count" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_plan_count</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_plan_count</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取方案数量。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>方案数量。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_plan_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取方案数量。</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: 方案数量。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">domain_service</span><span class="o">.</span><span class="n">get_plan_count</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.add_point" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_point</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_point</span><span class="p">(</span><span class="n">point_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>添加节点。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>point_data</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点数据。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;添加节点。</span>

<span class="sd">    Args:</span>
<span class="sd">        point_data (dict): 节点数据。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">add_point</span><span class="p">(</span><span class="n">point_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.delete_point" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">delete_point</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">delete_point</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>删除节点。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;删除节点。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 节点索引。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">delete_point</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.move_point_up" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">move_point_up</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">move_point_up</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>上移节点。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_point_up</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;上移节点。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 节点索引。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">move_point_up</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.move_point_down" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">move_point_down</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">move_point_down</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>下移节点。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_point_down</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;下移节点。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 节点索引。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">move_point_down</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.update_point" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">update_point</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">update_point</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">point_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>更新节点。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>point_data</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点数据。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">point_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;更新节点。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 节点索引。</span>
<span class="sd">        point_data (dict): 节点数据。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">update_point</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">point_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.get_all_points" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_all_points</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_all_points</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取当前方案的所有节点。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[dict]: 节点列表。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_all_points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取当前方案的所有节点。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[dict]: 节点列表。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">domain_service</span><span class="o">.</span><span class="n">get_all_points</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.get_single_point" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_single_point</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_single_point</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取单个节点数据。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点数据。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_single_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取单个节点数据。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 节点索引。</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: 节点数据。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">get_single_point</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.get_teach_record_names" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_teach_record_names</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_teach_record_names</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取所有示教记录名称（委托给 DynamicsViewModel）。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[str]: 记录名称列表。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_teach_record_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取所有示教记录名称（委托给 DynamicsViewModel）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: 记录名称列表。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamics_vm</span><span class="o">.</span><span class="n">get_record_names</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.get_teach_record" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_teach_record</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_teach_record</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取指定示教记录的数据（委托给 DynamicsViewModel）。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>记录名称。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[List[float]]: 记录数据。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_teach_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取指定示教记录的数据（委托给 DynamicsViewModel）。</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): 记录名称。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[List[float]]: 记录数据。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">angles_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamics_vm</span><span class="o">.</span><span class="n">teach_record_service</span><span class="o">.</span><span class="n">get_record</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">angles_list</span> <span class="k">if</span> <span class="n">angles_list</span> <span class="k">else</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.execute_single_point" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">execute_single_point</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">execute_single_point</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>执行单个节点。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">execute_single_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;执行单个节点。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 节点索引。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">execute_single_point</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.execute_motion_plan" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">execute_motion_plan</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">execute_motion_plan</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>执行整个运动规划方案。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">execute_motion_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;执行整个运动规划方案。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">execute_motion_plan</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.request_current_position" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">request_current_position</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">request_current_position</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>请求获取当前位置（仅用于UI显示）。</p>
<p>委托给 Application Service 处理。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">request_current_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;请求获取当前位置（仅用于UI显示）。</span>

<span class="sd">    委托给 Application Service 处理。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">request_current_position</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.save_node_trajectory" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">save_node_trajectory</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">save_node_trajectory</span><span class="p">(</span><span class="n">node_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>保存单个节点的轨迹。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>node_index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True=准备成功, False=准备失败。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_node_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;保存单个节点的轨迹。</span>

<span class="sd">    Args:</span>
<span class="sd">        node_index (int): 节点索引。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True=准备成功, False=准备失败。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">save_node_trajectory</span><span class="p">(</span><span class="n">node_index</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.save_plan_trajectory" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">save_plan_trajectory</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">save_plan_trajectory</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>保存整个方案的轨迹。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True=准备成功, False=准备失败。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_plan_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;保存整个方案的轨迹。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True=准备成功, False=准备失败。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">save_plan_trajectory</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.preview_node_trajectory" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">preview_node_trajectory</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">preview_node_trajectory</span><span class="p">(</span><span class="n">node_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>预览单个节点的轨迹曲线。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>node_index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True=准备成功, False=准备失败。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">preview_node_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;预览单个节点的轨迹曲线。</span>

<span class="sd">    Args:</span>
<span class="sd">        node_index (int): 节点索引。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True=准备成功, False=准备失败。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">preview_node_trajectory</span><span class="p">(</span><span class="n">node_index</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.preview_plan_trajectory" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">preview_plan_trajectory</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">preview_plan_trajectory</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>预览整个方案的轨迹曲线。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True=准备成功, False=准备失败。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">preview_plan_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;预览整个方案的轨迹曲线。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True=准备成功, False=准备失败。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">preview_plan_trajectory</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.load_local_trajectory" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">load_local_trajectory</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">load_local_trajectory</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>从 plans 目录加载轨迹文件。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>轨迹文件的完整路径或文件名。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True=加载成功, False=加载失败。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_local_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;从 plans 目录加载轨迹文件。</span>

<span class="sd">    Args:</span>
<span class="sd">        file_path (str): 轨迹文件的完整路径或文件名。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True=加载成功, False=加载失败。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">load_local_trajectory</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningViewModel.get_local_trajectory_files" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_local_trajectory_files</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_local_trajectory_files</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取所有可用的本地轨迹文件。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[str]: 文件名列表（不带扩展名）。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_local_trajectory_files</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取所有可用的本地轨迹文件。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: 文件名列表（不带扩展名）。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">get_local_trajectory_files</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.ToolsViewModel" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ToolsViewModel</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">ToolsViewModel</span><span class="p">(</span><span class="n">app_service</span><span class="p">:</span> <span class="n">ToolsApplicationService</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="PyQt5.QtCore.QObject">QObject</span></code></p>



        <p>工具 ViewModel。</p>
<p>职责：
1. 转发 UI 的计算请求到 Application Service
2. 转发 Application Service 的结果信号到 UI
3. 处理获取当前位置和逆运动学计算请求</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.ToolsViewModel.calculation_result">calculation_result</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>正运动学结果信号，携带结果字典。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.ToolsViewModel.current_angles_received">current_angles_received</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>当前关节角度信号，携带角度列表。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.ToolsViewModel.inverse_result">inverse_result</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>逆运动学结果信号，携带结果字典。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.ToolsViewModel.app_service">app_service</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ToolsApplicationService (controller.application.ToolsApplicationService)" href="#controller.shared.config.service_registry.ToolsApplicationService">ToolsApplicationService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>工具应用服务。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化工具 ViewModel。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>app_service</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ToolsApplicationService (controller.application.ToolsApplicationService)" href="#controller.shared.config.service_registry.ToolsApplicationService">ToolsApplicationService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>工具应用服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/presentation/view_models/tools_view_model.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_service</span><span class="p">:</span> <span class="n">ToolsApplicationService</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化工具 ViewModel。</span>

<span class="sd">    Args:</span>
<span class="sd">        app_service (ToolsApplicationService): 工具应用服务。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span> <span class="o">=</span> <span class="n">app_service</span>

    <span class="c1"># 连接Application Service的信号</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">calculation_result_signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculation_result</span><span class="o">.</span><span class="n">emit</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">current_angles_signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_angles_received</span><span class="o">.</span><span class="n">emit</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">inverse_result_signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inverse_result</span><span class="o">.</span><span class="n">emit</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.ToolsViewModel.calculate_kinematics" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">calculate_kinematics</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">calculate_kinematics</span><span class="p">(</span><span class="n">joint_angles</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>请求计算正运动学（转发给 Application Service）。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>joint_angles</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>6个关节角度（弧度）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/tools_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_kinematics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">joint_angles</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;请求计算正运动学（转发给 Application Service）。</span>

<span class="sd">    Args:</span>
<span class="sd">        joint_angles (List[float]): 6个关节角度（弧度）。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">calculate_forward_kinematics</span><span class="p">(</span><span class="n">joint_angles</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.ToolsViewModel.get_current_position" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_current_position</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_current_position</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>请求获取当前机械臂关节角度。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/tools_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_current_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;请求获取当前机械臂关节角度。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">get_current_joint_angles</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.ToolsViewModel.calculate_inverse_kinematics" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">calculate_inverse_kinematics</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">calculate_inverse_kinematics</span><span class="p">(</span><span class="n">rotation_matrix</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="n">position</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">initial_theta</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>请求计算逆运动学。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rotation_matrix</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>3x3 旋转矩阵。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>position</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>[x, y, z] 位置（米）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>initial_theta</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>初始关节角度. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/presentation/view_models/tools_view_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_inverse_kinematics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rotation_matrix</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="n">position</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">initial_theta</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;请求计算逆运动学。</span>

<span class="sd">    Args:</span>
<span class="sd">        rotation_matrix (List[List[float]]): 3x3 旋转矩阵。</span>
<span class="sd">        position (List[float]): [x, y, z] 位置（米）。</span>
<span class="sd">        initial_theta (List[float], optional): 初始关节角度. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_service</span><span class="o">.</span><span class="n">calculate_inverse_kinematics</span><span class="p">(</span><span class="n">rotation_matrix</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">initial_theta</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.DHParam" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">DHParam</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">DHParam</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>机械臂 DH 参数配置。</p>
<p>存储运动学和动力学所需的 DH 参数。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.DHParam.kinematic_dh">kinematic_dh</span></code></td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运动学 DH 参数表。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.DHParam.dynamic_dh">dynamic_dh</span></code></td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>动力学 DH 参数表。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化默认 DH 参数。</p>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/domain/value_objects/dh_param.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化默认 DH 参数。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_dh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.425</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.401</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="mf">0.0856</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.086</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.231</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>  
    <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_dh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.425</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.401</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="mf">0.0856</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.086</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.0725</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
    <span class="p">])</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.DHParam.get_kinematic_dh" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_kinematic_dh</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_kinematic_dh</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取运动学 DH 参数。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: 运动学 DH 参数矩阵。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/value_objects/dh_param.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_kinematic_dh</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取运动学 DH 参数。</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: 运动学 DH 参数矩阵。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_dh</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.DHParam.get_dynamic_dh" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_dynamic_dh</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_dynamic_dh</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取动力学 DH 参数。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: 动力学 DH 参数矩阵。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/value_objects/dh_param.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_dynamic_dh</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取动力学 DH 参数。</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: 动力学 DH 参数矩阵。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_dh</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.RobotStateSnapshot" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">RobotStateSnapshot</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">RobotStateSnapshot</span><span class="p">(</span><span class="n">init_status</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">control</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">joint_positions</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">joint_angles</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">joint_speeds</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">joint_torques</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">joint_status</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">double_encoder_interpolations</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">errors</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">effector_data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>机械臂状态快照 - 不可变数据载体。</p>
<p>特点：
- frozen=True: 不可变，线程安全
- 包含完整的机械臂状态
- 可以保存历史快照序列</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.RobotStateSnapshot.init_status">init_status</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>初始化状态。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.RobotStateSnapshot.control">control</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>当前命令 0x06/0x07...。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.RobotStateSnapshot.mode">mode</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运行模式 0x08/0x0A...。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.RobotStateSnapshot.joint_positions">joint_positions</span></code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>编码器位置（原始值，6个关节）。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.RobotStateSnapshot.joint_angles">joint_angles</span></code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="float">float</span>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>关节角度（弧度，6个关节）。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.RobotStateSnapshot.joint_speeds">joint_speeds</span></code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>关节速度。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.RobotStateSnapshot.joint_torques">joint_torques</span></code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>关节力矩。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.RobotStateSnapshot.joint_status">joint_status</span></code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>关节状态码。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.RobotStateSnapshot.double_encoder_interpolations">double_encoder_interpolations</span></code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>双编码器插值。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.RobotStateSnapshot.errors">errors</span></code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>错误码。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.RobotStateSnapshot.effector_data">effector_data</span></code></td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>夹爪数据。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.RobotStateSnapshot.timestamp">timestamp</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>接收时间戳。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">







<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RobotStateSnapshot.from_decoded_message" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">from_decoded_message</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">from_decoded_message</span><span class="p">(</span><span class="n">decoded_msg</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RobotStateSnapshot</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>从解码消息创建快照。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>decoded_msg</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>解码后的消息对象，应包含 positions(弧度), speeds, torques 等字段。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>RobotStateSnapshot</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="RobotStateSnapshot


  
      dataclass
   (controller.domain.value_objects.robot_state_snapshot.RobotStateSnapshot)" href="../../../domain/value_objects/#controller.domain.value_objects.robot_state_snapshot.RobotStateSnapshot">RobotStateSnapshot</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>创建的状态快照实例。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>decoded_msg.positions 已经通过 position2radian 转换为弧度值，
所以 joint_angles 直接使用该值。
joint_positions 会通过反向计算还原为原始编码器值。</p>
</details>

            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/value_objects/robot_state_snapshot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_decoded_message</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">decoded_msg</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;RobotStateSnapshot&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;从解码消息创建快照。</span>

<span class="sd">    Args:</span>
<span class="sd">        decoded_msg (Any): 解码后的消息对象，应包含 positions(弧度), speeds, torques 等字段。</span>

<span class="sd">    Returns:</span>
<span class="sd">        RobotStateSnapshot: 创建的状态快照实例。</span>

<span class="sd">    Note:</span>
<span class="sd">        decoded_msg.positions 已经通过 position2radian 转换为弧度值，</span>
<span class="sd">        所以 joint_angles 直接使用该值。</span>
<span class="sd">        joint_positions 会通过反向计算还原为原始编码器值。</span>
<span class="sd">    &quot;&quot;&quot;</span>        
    <span class="n">robot_utils</span> <span class="o">=</span> <span class="n">RobotUtils</span><span class="p">()</span>

    <span class="c1"># decoded_msg.positions 已经是弧度值（由MessageDecoder的transform完成）</span>
    <span class="c1"># 所以直接使用，不需要再次转换</span>
    <span class="n">angles</span> <span class="o">=</span> <span class="n">decoded_msg</span><span class="o">.</span><span class="n">positions</span>  <span class="c1"># 已经是弧度值</span>

    <span class="c1"># 反向计算原始编码器位置值（用于保存完整状态）</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">robot_utils</span><span class="o">.</span><span class="n">radian2position</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
        <span class="n">init_status</span><span class="o">=</span><span class="n">decoded_msg</span><span class="o">.</span><span class="n">init_status</span><span class="p">,</span>
        <span class="n">control</span><span class="o">=</span><span class="n">decoded_msg</span><span class="o">.</span><span class="n">control</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="n">decoded_msg</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
        <span class="n">joint_positions</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">positions</span><span class="p">),</span>  <span class="c1"># 反向计算的编码器值</span>
        <span class="n">joint_angles</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">angles</span><span class="p">),</span>        <span class="c1"># 直接使用解码后的弧度值</span>
        <span class="n">joint_speeds</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">decoded_msg</span><span class="o">.</span><span class="n">speeds</span><span class="p">),</span>
        <span class="n">joint_torques</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">decoded_msg</span><span class="o">.</span><span class="n">torques</span><span class="p">),</span>
        <span class="n">joint_status</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">decoded_msg</span><span class="o">.</span><span class="n">status</span><span class="p">),</span>
        <span class="n">double_encoder_interpolations</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">decoded_msg</span><span class="o">.</span><span class="n">double_encoder_interpolations</span><span class="p">),</span>
        <span class="n">errors</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">decoded_msg</span><span class="o">.</span><span class="n">errors</span><span class="p">),</span>
        <span class="n">effector_data</span><span class="o">=</span><span class="n">decoded_msg</span><span class="o">.</span><span class="n">effector_data</span><span class="p">,</span>
        <span class="n">timestamp</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.HandEyeCalibrationConfig" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">HandEyeCalibrationConfig</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">HandEyeCalibrationConfig</span><span class="p">(</span><span class="n">hand_eye_matrix</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">camera_intrinsics</span><span class="p">:</span> <span class="n">CameraIntrinsics</span><span class="p">,</span> <span class="n">target_offset</span><span class="p">:</span> <span class="n">TargetOffset</span><span class="p">,</span> <span class="n">end_effector_adjustment</span><span class="p">:</span> <span class="n">EndEffectorAdjustment</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>手眼标定完整配置。</p>
<p>这是一个值对象（Value Object），不可变且无副作用。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.HandEyeCalibrationConfig.hand_eye_matrix">hand_eye_matrix</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>4x4 齐次变换矩阵。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.HandEyeCalibrationConfig.camera_intrinsics">camera_intrinsics</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CameraIntrinsics


  
      dataclass
   (controller.domain.value_objects.hand_eye_calibration_config.CameraIntrinsics)" href="../../../domain/value_objects/#controller.domain.value_objects.hand_eye_calibration_config.CameraIntrinsics">CameraIntrinsics</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>相机内参。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.HandEyeCalibrationConfig.target_offset">target_offset</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TargetOffset


  
      dataclass
   (controller.domain.value_objects.hand_eye_calibration_config.TargetOffset)" href="../../../domain/value_objects/#controller.domain.value_objects.hand_eye_calibration_config.TargetOffset">TargetOffset</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>目标偏移量。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.HandEyeCalibrationConfig.end_effector_adjustment">end_effector_adjustment</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="EndEffectorAdjustment


  
      dataclass
   (controller.domain.value_objects.hand_eye_calibration_config.EndEffectorAdjustment)" href="../../../domain/value_objects/#controller.domain.value_objects.hand_eye_calibration_config.EndEffectorAdjustment">EndEffectorAdjustment</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>末端姿态调整。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">







<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.HandEyeCalibrationConfig.__post_init__" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">__post_init__</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__post_init__</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>验证数据完整性。</p>


<p><span class="doc-section-title">引发：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>如果手眼标定矩阵形状不是 4x4。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/value_objects/hand_eye_calibration_config.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;验证数据完整性。</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: 如果手眼标定矩阵形状不是 4x4。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hand_eye_matrix</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;手眼标定矩阵必须是 4x4 矩阵&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.CameraIntrinsics" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">CameraIntrinsics</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">CameraIntrinsics</span><span class="p">(</span><span class="n">fx</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">fy</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">cx</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">cy</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>相机内参。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CameraIntrinsics.fx">fx</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>x 方向焦距。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CameraIntrinsics.fy">fy</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>y 方向焦距。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CameraIntrinsics.cx">cx</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>光心 x 坐标。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CameraIntrinsics.cy">cy</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>光心 y 坐标。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">





  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.TargetOffset" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">TargetOffset</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">TargetOffset</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>目标偏移量（米）。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.TargetOffset.x">x</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>x 方向偏移。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.TargetOffset.y">y</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>y 方向偏移。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.TargetOffset.z">z</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>z 方向偏移。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">







<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.TargetOffset.to_array" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">to_array</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">to_array</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>转换为 numpy 数组。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: [x, y, z] 数组。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/value_objects/hand_eye_calibration_config.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_array</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;转换为 numpy 数组。</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: [x, y, z] 数组。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.EndEffectorAdjustment" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">EndEffectorAdjustment</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">EndEffectorAdjustment</span><span class="p">(</span><span class="n">z_rotation</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y_rotation</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">x_rotation</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>末端姿态调整（弧度）。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.EndEffectorAdjustment.z_rotation">z_rotation</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>绕 Z 轴旋转角度。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.EndEffectorAdjustment.y_rotation">y_rotation</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>绕 Y 轴旋转角度。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.EndEffectorAdjustment.x_rotation">x_rotation</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>绕 X 轴旋转角度。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">





  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.MotionOperationMode" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MotionOperationMode</span>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="enum.Enum">Enum</span></code></p>



        <p>运动操作模式枚举。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionOperationMode.NONE">NONE</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>无操作（仅获取位置）。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionOperationMode.EXECUTE">EXECUTE</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>执行运动。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionOperationMode.SAVE">SAVE</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>保存轨迹。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionOperationMode.PREVIEW">PREVIEW</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>预览轨迹（显示曲线）。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">





  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.KinematicUtils" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">KinematicUtils</span>


</h3>


    <div class="doc doc-contents ">



        <p>运动学工具类。</p>
<p>提供基本的运动学变换和角度处理函数。</p>











<div class="doc doc-children">







<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.KinematicUtils.dh2rm" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">dh2rm</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">dh2rm</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">theta</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>根据 DH 参数计算变换矩阵。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>a</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>连杆长度。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alpha</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>连杆扭转角。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>d</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>连杆偏移。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>theta</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>关节角。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: 4x4 齐次变换矩阵。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/utils/kinematic_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">dh2rm</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">theta</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;根据 DH 参数计算变换矩阵。</span>

<span class="sd">    Args:</span>
<span class="sd">        a (float): 连杆长度。</span>
<span class="sd">        alpha (float): 连杆扭转角。</span>
<span class="sd">        d (float): 连杆偏移。</span>
<span class="sd">        theta (float): 关节角。</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: 4x4 齐次变换矩阵。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c_theta</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">s_theta</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">c_alpha</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">s_alpha</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="p">[</span><span class="n">c_theta</span><span class="p">,</span> <span class="o">-</span><span class="n">s_theta</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">],</span>
        <span class="p">[</span><span class="n">s_theta</span> <span class="o">*</span> <span class="n">c_alpha</span><span class="p">,</span> <span class="n">c_theta</span> <span class="o">*</span> <span class="n">c_alpha</span><span class="p">,</span> <span class="o">-</span><span class="n">s_alpha</span><span class="p">,</span> <span class="o">-</span><span class="n">s_alpha</span> <span class="o">*</span> <span class="n">d</span><span class="p">],</span>
        <span class="p">[</span><span class="n">s_theta</span> <span class="o">*</span> <span class="n">s_alpha</span><span class="p">,</span> <span class="n">c_theta</span> <span class="o">*</span> <span class="n">s_alpha</span><span class="p">,</span> <span class="n">c_alpha</span><span class="p">,</span> <span class="n">c_alpha</span> <span class="o">*</span> <span class="n">d</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.KinematicUtils.rm2quat" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">rm2quat</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">rm2quat</span><span class="p">(</span><span class="n">rm</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>旋转矩阵转四元数。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rm</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>3x3 旋转矩阵或 4x4 变换矩阵。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: 四元数 [x, y, z, w]。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/utils/kinematic_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">rm2quat</span><span class="p">(</span><span class="n">rm</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;旋转矩阵转四元数。</span>

<span class="sd">    Args:</span>
<span class="sd">        rm (np.ndarray): 3x3 旋转矩阵或 4x4 变换矩阵。</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: 四元数 [x, y, z, w]。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 如果是 4x4 矩阵，提取 3x3 部分</span>
    <span class="k">if</span> <span class="n">rm</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
        <span class="n">rm</span> <span class="o">=</span> <span class="n">rm</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">R</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">rm</span><span class="p">)</span><span class="o">.</span><span class="n">as_quat</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.KinematicUtils.quat2rm" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">quat2rm</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">quat2rm</span><span class="p">(</span><span class="n">quat</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>四元数转旋转矩阵。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>quat</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>四元数 [x, y, z, w]。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: 3x3 旋转矩阵。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/utils/kinematic_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">quat2rm</span><span class="p">(</span><span class="n">quat</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;四元数转旋转矩阵。</span>

<span class="sd">    Args:</span>
<span class="sd">        quat (np.ndarray): 四元数 [x, y, z, w]。</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: 3x3 旋转矩阵。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">R</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="n">quat</span><span class="p">)</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.KinematicUtils.quat2euler" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">quat2euler</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">quat2euler</span><span class="p">(</span><span class="n">quat</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>四元数转欧拉角 (XYZ 顺序)。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>quat</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>四元数 [x, y, z, w]。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: 欧拉角 [roll, pitch, yaw] (弧度)。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/utils/kinematic_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">quat2euler</span><span class="p">(</span><span class="n">quat</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;四元数转欧拉角 (XYZ 顺序)。</span>

<span class="sd">    Args:</span>
<span class="sd">        quat (np.ndarray): 四元数 [x, y, z, w]。</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: 欧拉角 [roll, pitch, yaw] (弧度)。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">R</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="n">quat</span><span class="p">)</span><span class="o">.</span><span class="n">as_euler</span><span class="p">(</span><span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.KinematicUtils.euler2quat" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">euler2quat</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">euler2quat</span><span class="p">(</span><span class="n">euler</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>欧拉角转四元数 (XYZ 顺序)。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>euler</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>欧拉角 [roll, pitch, yaw] (弧度)。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: 四元数 [x, y, z, w]。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/utils/kinematic_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">euler2quat</span><span class="p">(</span><span class="n">euler</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;欧拉角转四元数 (XYZ 顺序)。</span>

<span class="sd">    Args:</span>
<span class="sd">        euler (np.ndarray): 欧拉角 [roll, pitch, yaw] (弧度)。</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: 四元数 [x, y, z, w]。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">R</span><span class="o">.</span><span class="n">from_euler</span><span class="p">(</span><span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="n">euler</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">as_quat</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.KinematicUtils.euler2rm" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">euler2rm</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">euler2rm</span><span class="p">(</span><span class="n">euler</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>欧拉角转旋转矩阵 (XYZ 顺序)。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>euler</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>欧拉角 [roll, pitch, yaw] (弧度)。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: 3x3 旋转矩阵。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/utils/kinematic_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">euler2rm</span><span class="p">(</span><span class="n">euler</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;欧拉角转旋转矩阵 (XYZ 顺序)。</span>

<span class="sd">    Args:</span>
<span class="sd">        euler (np.ndarray): 欧拉角 [roll, pitch, yaw] (弧度)。</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: 3x3 旋转矩阵。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">R</span><span class="o">.</span><span class="n">from_euler</span><span class="p">(</span><span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="n">euler</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.KinematicUtils.rm2euler" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">rm2euler</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">rm2euler</span><span class="p">(</span><span class="n">rm</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>旋转矩阵转欧拉角 (XYZ 顺序)。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rm</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>3x3 旋转矩阵。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: 欧拉角 [roll, pitch, yaw] (弧度)。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/utils/kinematic_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">rm2euler</span><span class="p">(</span><span class="n">rm</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;旋转矩阵转欧拉角 (XYZ 顺序)。</span>

<span class="sd">    Args:</span>
<span class="sd">        rm (np.ndarray): 3x3 旋转矩阵。</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: 欧拉角 [roll, pitch, yaw] (弧度)。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 如果是 4x4 矩阵，提取 3x3 部分</span>
    <span class="k">if</span> <span class="n">rm</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
        <span class="n">rm</span> <span class="o">=</span> <span class="n">rm</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">R</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">rm</span><span class="p">)</span><span class="o">.</span><span class="n">as_euler</span><span class="p">(</span><span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.KinematicUtils.normalize_angle" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">normalize_angle</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">normalize_angle</span><span class="p">(</span><span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>将角度归一化到 [-pi, pi] 范围。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>angle</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>输入角度（弧度）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>归一化后的角度（弧度）。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/utils/kinematic_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">normalize_angle</span><span class="p">(</span><span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;将角度归一化到 [-pi, pi] 范围。</span>

<span class="sd">    Args:</span>
<span class="sd">        angle (float): 输入角度（弧度）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: 归一化后的角度（弧度）。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">angle</span> <span class="o">+</span> <span class="n">pi</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">pi</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.MessageEncoder" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MessageEncoder</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">MessageEncoder</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="s1">&#39;controller/config/message_encoder_config.yaml&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>消息编码器。</p>
<p>基于 YAML 配置文件动态生成十六进制消息。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MessageEncoder.config">config</span></code></td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>加载的配置字典。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MessageEncoder.robot_utils">robot_utils</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="RobotUtils (controller.domain.utils.robot_utils.RobotUtils)" href="../../../domain/utils/#controller.domain.utils.robot_utils.RobotUtils">RobotUtils</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>工具类实例。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MessageEncoder.formatters">formatters</span></code></td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="controller.domain.utils.message_encoder.BaseFormatter">BaseFormatter</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>已注册的格式化器字典。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MessageEncoder.Message">Message</span></code></td>
            <td>
                  <code><span title="type">type</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>动态创建的消息数据类。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化消息编码器。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>配置文件路径. Defaults to "controller/config/message_encoder_config.yaml".</p>
              </div>
            </td>
            <td>
                  <code>&#39;controller/config/message_encoder_config.yaml&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/domain/utils/message_encoder.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_path</span> <span class="o">=</span> <span class="s2">&quot;controller/config/message_encoder_config.yaml&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化消息编码器。</span>

<span class="sd">    Args:</span>
<span class="sd">        config_path (str, optional): 配置文件路径. Defaults to &quot;controller/config/message_encoder_config.yaml&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 使用 ROS2 包资源管理方式查找配置文件</span>
    <span class="k">if</span> <span class="n">_HAS_AMENT_INDEX</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># ROS2 方式：从 share 目录加载</span>
            <span class="n">package_share_dir</span> <span class="o">=</span> <span class="n">get_package_share_directory</span><span class="p">(</span><span class="s1">&#39;controller&#39;</span><span class="p">)</span>
            <span class="n">config_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">package_share_dir</span><span class="p">,</span> <span class="s1">&#39;config&#39;</span><span class="p">,</span> <span class="s1">&#39;message_encoder_config.yaml&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># 如果包未安装，使用相对路径（开发模式）</span>
            <span class="k">pass</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">robot_utils</span> <span class="o">=</span> <span class="n">RobotUtils</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">formatters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_register_formatters</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_message_class</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MessageEncoder.create_message" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_message</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_message</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>创建 MessageOut 实例。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>消息字段值。</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Any</code></td>            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>消息对象 (MessageOut)。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/utils/message_encoder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;创建 MessageOut 实例。</span>

<span class="sd">    Args:</span>
<span class="sd">        **kwargs: 消息字段值。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Any: 消息对象 (MessageOut)。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Message</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MessageEncoder.interpret_message" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">interpret_message</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">interpret_message</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>根据配置动态将消息对象编码为字符串。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>MessageOut 对象。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>编码后的十六进制字符串。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/utils/message_encoder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">interpret_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;根据配置动态将消息对象编码为字符串。</span>

<span class="sd">    Args:</span>
<span class="sd">        message (Any): MessageOut 对象。</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: 编码后的十六进制字符串。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">protocol_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;protocol&#39;</span><span class="p">]</span>
    <span class="n">fields_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;message_formats&#39;</span><span class="p">][</span><span class="s1">&#39;message_out&#39;</span><span class="p">][</span><span class="s1">&#39;fields&#39;</span><span class="p">]</span>

    <span class="c1"># 1. 添加协议头</span>
    <span class="n">command</span> <span class="o">=</span> <span class="n">protocol_config</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span>

    <span class="c1"># 2. 按配置顺序处理每个字段</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_config</span> <span class="ow">in</span> <span class="n">fields_config</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">field_value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="n">command</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_field</span><span class="p">(</span><span class="n">field_value</span><span class="p">,</span> <span class="n">field_config</span><span class="p">)</span>

    <span class="c1"># 3. 计算CRC（如果启用）</span>
    <span class="k">if</span> <span class="n">protocol_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;crc_enabled&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
        <span class="n">crc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">robot_utils</span><span class="o">.</span><span class="n">calculate_crc16</span><span class="p">(</span><span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">command</span><span class="p">))</span>
        <span class="n">command</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">crc</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="si">:</span><span class="s2">02X</span><span class="si">}{</span><span class="n">crc</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="si">:</span><span class="s2">02X</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># 4. 添加协议尾</span>
    <span class="n">command</span> <span class="o">+=</span> <span class="n">protocol_config</span><span class="p">[</span><span class="s1">&#39;footer&#39;</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">command</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.MessageDecoder" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MessageDecoder</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">MessageDecoder</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="s1">&#39;controller/config/message_decoder_config.yaml&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>消息解码器。</p>
<p>基于 YAML 配置文件动态解析十六进制消息。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MessageDecoder.config">config</span></code></td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>加载的配置字典。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MessageDecoder.robot_utils">robot_utils</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="RobotUtils (controller.domain.utils.robot_utils.RobotUtils)" href="../../../domain/utils/#controller.domain.utils.robot_utils.RobotUtils">RobotUtils</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>工具类实例。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MessageDecoder.parsers">parsers</span></code></td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="controller.domain.utils.message_decoder.BaseParser">BaseParser</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>已注册的解析器字典。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MessageDecoder.MessageIn">MessageIn</span></code></td>
            <td>
                  <code><span title="type">type</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>动态创建的消息数据类。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化消息解码器。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>配置文件路径. Defaults to "controller/config/message_decoder_config.yaml".</p>
              </div>
            </td>
            <td>
                  <code>&#39;controller/config/message_decoder_config.yaml&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/domain/utils/message_decoder.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_path</span> <span class="o">=</span> <span class="s2">&quot;controller/config/message_decoder_config.yaml&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化消息解码器。</span>

<span class="sd">    Args:</span>
<span class="sd">        config_path (str, optional): 配置文件路径. Defaults to &quot;controller/config/message_decoder_config.yaml&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 使用 ROS2 包资源管理方式查找配置文件</span>
    <span class="k">if</span> <span class="n">_HAS_AMENT_INDEX</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># ROS2 方式：从 share 目录加载</span>
            <span class="n">package_share_dir</span> <span class="o">=</span> <span class="n">get_package_share_directory</span><span class="p">(</span><span class="s1">&#39;controller&#39;</span><span class="p">)</span>
            <span class="n">config_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">package_share_dir</span><span class="p">,</span> <span class="s1">&#39;config&#39;</span><span class="p">,</span> <span class="s1">&#39;message_decoder_config.yaml&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># 如果包未安装，使用相对路径（开发模式）</span>
            <span class="k">pass</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">robot_utils</span> <span class="o">=</span> <span class="n">RobotUtils</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parsers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_register_parsers</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">MessageIn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_message_class</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MessageDecoder.decode_message" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">decode_message</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">decode_message</span><span class="p">(</span><span class="n">hex_message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>解码十六进制消息。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>hex_message</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>原始十六进制字符串。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Any</code></td>            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>解码后的消息对象 (MessageIn)。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">引发：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>如果消息格式错误或校验失败。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/utils/message_decoder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">decode_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hex_message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;解码十六进制消息。</span>

<span class="sd">    Args:</span>
<span class="sd">        hex_message (str): 原始十六进制字符串。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Any: 解码后的消息对象 (MessageIn)。</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: 如果消息格式错误或校验失败。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 移除空格和换行符</span>
    <span class="n">hex_message</span> <span class="o">=</span> <span class="n">hex_message</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="c1"># 验证协议头和尾</span>
    <span class="n">protocol_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;protocol&#39;</span><span class="p">]</span>
    <span class="n">header</span> <span class="o">=</span> <span class="n">protocol_config</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span>
    <span class="n">footer</span> <span class="o">=</span> <span class="n">protocol_config</span><span class="p">[</span><span class="s1">&#39;footer&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">hex_message</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">header</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid header. Expected </span><span class="si">{</span><span class="n">header</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="n">hex_message</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">hex_message</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">footer</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid footer. Expected </span><span class="si">{</span><span class="n">footer</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="n">hex_message</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


    <span class="c1"># 验证CRC（如果启用）</span>
    <span class="k">if</span> <span class="n">protocol_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;crc_enabled&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
        <span class="n">crc_bytes</span> <span class="o">=</span> <span class="n">protocol_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;crc_bytes&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>  <span class="c1"># 转换为十六进制字符数</span>
        <span class="n">message_without_crc</span> <span class="o">=</span> <span class="n">hex_message</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">footer</span><span class="p">)</span><span class="o">-</span><span class="n">crc_bytes</span><span class="p">]</span>
        <span class="n">received_crc</span> <span class="o">=</span> <span class="n">hex_message</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">footer</span><span class="p">)</span><span class="o">-</span><span class="n">crc_bytes</span><span class="p">:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">footer</span><span class="p">)]</span>

        <span class="n">calculated_crc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">robot_utils</span><span class="o">.</span><span class="n">calculate_crc16</span><span class="p">(</span><span class="n">message_without_crc</span><span class="p">)</span>
        <span class="n">calculated_crc_hex</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">calculated_crc</span><span class="si">:</span><span class="s2">04X</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">calculated_crc_hex</span> <span class="o">!=</span> <span class="n">received_crc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CRC校验失败: 接收=</span><span class="si">{</span><span class="n">received_crc</span><span class="si">}</span><span class="s2">, 计算=</span><span class="si">{</span><span class="n">calculated_crc_hex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># 解析各个字段</span>
    <span class="n">fields_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;message_formats&#39;</span><span class="p">][</span><span class="s1">&#39;message_in&#39;</span><span class="p">][</span><span class="s1">&#39;fields&#39;</span><span class="p">]</span>
    <span class="n">parsed_data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">current_pos</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_config</span> <span class="ow">in</span> <span class="n">fields_config</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">field_bytes</span> <span class="o">=</span> <span class="n">field_config</span><span class="p">[</span><span class="s1">&#39;bytes&#39;</span><span class="p">]</span>
        <span class="n">hex_chars</span> <span class="o">=</span> <span class="n">field_bytes</span> <span class="o">*</span> <span class="mi">2</span>  <span class="c1"># 每个字节对应2个十六进制字符</span>

        <span class="c1"># 特殊处理CRC字段</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="o">==</span> <span class="s1">&#39;crc&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">protocol_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;crc_enabled&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                <span class="n">field_hex</span> <span class="o">=</span> <span class="n">hex_message</span><span class="p">[</span><span class="n">current_pos</span><span class="p">:</span><span class="n">current_pos</span> <span class="o">+</span> <span class="n">hex_chars</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">field_hex</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">field_hex</span> <span class="o">=</span> <span class="n">hex_message</span><span class="p">[</span><span class="n">current_pos</span><span class="p">:</span><span class="n">current_pos</span> <span class="o">+</span> <span class="n">hex_chars</span><span class="p">]</span>

        <span class="c1"># 解析字段</span>
        <span class="n">parsed_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_field</span><span class="p">(</span><span class="n">field_hex</span><span class="p">,</span> <span class="n">field_config</span><span class="p">)</span>
        <span class="n">parsed_data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">parsed_value</span>

        <span class="n">current_pos</span> <span class="o">+=</span> <span class="n">hex_chars</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">MessageIn</span><span class="p">(</span><span class="o">**</span><span class="n">parsed_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MessageDecoder.decode_message_detailed" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">decode_message_detailed</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">decode_message_detailed</span><span class="p">(</span><span class="n">hex_message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>解码消息并返回详细信息（包括原始十六进制值）。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>hex_message</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>原始十六进制字符串。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict[str, Any]: 包含详细信息的字典。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/utils/message_decoder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">decode_message_detailed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hex_message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;解码消息并返回详细信息（包括原始十六进制值）。</span>

<span class="sd">    Args:</span>
<span class="sd">        hex_message (str): 原始十六进制字符串。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, Any]: 包含详细信息的字典。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">message_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode_message</span><span class="p">(</span><span class="n">hex_message</span><span class="p">)</span>

    <span class="c1"># 创建详细信息字典</span>
    <span class="n">detailed_info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">fields_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;message_formats&#39;</span><span class="p">][</span><span class="s1">&#39;message_in&#39;</span><span class="p">][</span><span class="s1">&#39;fields&#39;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">fields_config</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">message_in</span><span class="p">,</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="n">detailed_info</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span>
            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="n">fields_config</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;description&#39;</span><span class="p">,</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="k">return</span> <span class="n">detailed_info</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.RobotUtils" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">RobotUtils</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">RobotUtils</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>机器人工具类。</p>
<p>提供机器人相关的数值转换、校验和计算等工具方法。</p>

        <p>初始化机器人参数。</p>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/domain/utils/robot_utils.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化机器人参数。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">JOINT_OFFSETS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">79119</span><span class="p">,</span> <span class="mi">369835</span><span class="p">,</span> <span class="mi">83627</span><span class="p">,</span> <span class="mi">392414</span><span class="p">,</span> <span class="mi">507293</span><span class="p">,</span> <span class="mi">456372</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">RADIAN_TO_POS_SCALE_FACTOR</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">19</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span><span class="p">)</span>  <span class="c1"># 弧度转位置值的系数</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">POS_TO_RADIAN_SCALE_FACTOR</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">19</span><span class="p">)</span>  <span class="c1"># 位置值转弧度的系数</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">init_radians</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RobotUtils.position2radian" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">position2radian</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">position2radian</span><span class="p">(</span><span class="n">position</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>编码器位置值转换为弧度。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>position</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>编码器位置值列表。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>关节角度列表（弧度）。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/utils/robot_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">position2radian</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;编码器位置值转换为弧度。</span>

<span class="sd">    Args:</span>
<span class="sd">        position (list): 编码器位置值列表。</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: 关节角度列表（弧度）。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">radians</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_radians</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">position</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="n">radians</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">pos</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">JOINT_OFFSETS</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">POS_TO_RADIAN_SCALE_FACTOR</span>
    <span class="k">return</span> <span class="n">radians</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RobotUtils.radian2position" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">radian2position</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">radian2position</span><span class="p">(</span><span class="n">radian</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>弧度转换为编码器位置值。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>radian</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>关节角度列表（弧度）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>编码器位置值列表（32位整数）。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/utils/robot_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">radian2position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radian</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;弧度转换为编码器位置值。</span>

<span class="sd">    Args:</span>
<span class="sd">        radian (list): 关节角度列表（弧度）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: 编码器位置值列表（32位整数）。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rad</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">radian</span><span class="p">):</span>
        <span class="n">position</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">rad</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_radians</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">RADIAN_TO_POS_SCALE_FACTOR</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">JOINT_OFFSETS</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span>
        <span class="n">positions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">positions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RobotUtils.speed2position" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">speed2position</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">speed2position</span><span class="p">(</span><span class="n">speed</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>速度值转换为位置增量值。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>speed</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>速度列表。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>对应的时间步长内的位置增量值。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/utils/robot_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">speed2position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">speed</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;速度值转换为位置增量值。</span>

<span class="sd">    Args:</span>
<span class="sd">        speed (list): 速度列表。</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: 对应的时间步长内的位置增量值。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">position</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">RADIAN_TO_POS_SCALE_FACTOR</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFF</span> <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">speed</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RobotUtils.torque_transfer" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">torque_transfer</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">torque_transfer</span><span class="p">(</span><span class="n">torque</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>力矩值转换与归一化。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>torque</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>力矩值列表，长度不超过6。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>转换后的力矩值列表（16位整数）。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">引发：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>如果力矩列表长度超过6。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/utils/robot_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">torque_transfer</span><span class="p">(</span><span class="n">torque</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;力矩值转换与归一化。</span>

<span class="sd">    Args:</span>
<span class="sd">        torque (list): 力矩值列表，长度不超过6。</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: 转换后的力矩值列表（16位整数）。</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: 如果力矩列表长度超过6。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">torque</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;力矩值列表长度不能超过6&quot;</span><span class="p">)</span>
    <span class="n">transfer_torque</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">torque</span><span class="p">[:</span><span class="mi">3</span><span class="p">]:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">),</span> <span class="mi">50</span><span class="p">)</span>
        <span class="n">transfer_torque</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="mi">87</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">torque</span><span class="p">[</span><span class="mi">3</span><span class="p">:]:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">transfer_torque</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">transfer_torque</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RobotUtils.effector2hex" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">effector2hex</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">effector2hex</span><span class="p">(</span><span class="n">effector_data</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>末端执行器数据转换为十六进制字节列表。</p>
<p>将浮点数拆分为整数部分和小数部分，分别转换为 2 字节的大端序十六进制。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>effector_data</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>末端执行器数据。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>包含两个十六进制字符串的列表 [整数部分hex, 小数部分hex]。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/utils/robot_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">effector2hex</span><span class="p">(</span><span class="n">effector_data</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;末端执行器数据转换为十六进制字节列表。</span>

<span class="sd">    将浮点数拆分为整数部分和小数部分，分别转换为 2 字节的大端序十六进制。</span>

<span class="sd">    Args:</span>
<span class="sd">        effector_data (float): 末端执行器数据。</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: 包含两个十六进制字符串的列表 [整数部分hex, 小数部分hex]。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">effector_data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">effector_data</span><span class="p">))</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">effector_data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;big&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">hex</span><span class="p">(),</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;big&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">hex</span><span class="p">()]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RobotUtils.calculate_crc16" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">calculate_crc16</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">calculate_crc16</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>计算 CRC16 校验和 (CCITT)。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="Union">Union</span>[<span title="bytes">bytes</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>字节数组或十六进制字符串。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>16位校验和。如果输入格式错误返回 False。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/utils/robot_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">calculate_crc16</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;计算 CRC16 校验和 (CCITT)。</span>

<span class="sd">    Args:</span>
<span class="sd">        data (Union[bytes, str]): 字节数组或十六进制字符串。</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: 16位校验和。如果输入格式错误返回 False。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># 计算CRC16-CCITT</span>
    <span class="n">crc</span> <span class="o">=</span> <span class="mh">0xFFFF</span>
    <span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">crc</span> <span class="o">^=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">crc</span> <span class="o">&amp;</span> <span class="mh">0x8000</span><span class="p">:</span>
                <span class="n">crc</span> <span class="o">=</span> <span class="p">(</span><span class="n">crc</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0x1021</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">crc</span> <span class="o">=</span> <span class="n">crc</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span>
            <span class="n">crc</span> <span class="o">&amp;=</span> <span class="mh">0xFFFF</span>

    <span class="k">return</span> <span class="n">crc</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.ImageDrawingUtils" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ImageDrawingUtils</span>


</h3>


    <div class="doc doc-contents ">



        <p>图像绘制工具类。</p>
<p>提供静态方法用于在 OpenCV 图像上绘制检测结果和辅助图形。</p>











<div class="doc doc-children">







<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.ImageDrawingUtils.draw_detection_result" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">draw_detection_result</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">draw_detection_result</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">detection</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>在图像上绘制检测结果。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>image</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>原始图像（BGR）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>detection</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>检测结果字典，包含：
- head_center (Tuple[float, float]): 头部中心点 (x, y)。
- central_center (Tuple[float, float]): 中央中心点 (x, y)。
- real_center (Tuple[float, float]): 实际中心点 (x, y)。
- angle (float): 角度（弧度）。
- depth (float): central_center 的深度（米）。
- real_depth (float): real_center 的深度（米）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: 绘制后的图像（新图像，不修改原图）。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/utils/image_drawing_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">draw_detection_result</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">detection</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;在图像上绘制检测结果。</span>

<span class="sd">    Args:</span>
<span class="sd">        image (np.ndarray): 原始图像（BGR）。</span>
<span class="sd">        detection (Dict): 检测结果字典，包含：</span>
<span class="sd">            - head_center (Tuple[float, float]): 头部中心点 (x, y)。</span>
<span class="sd">            - central_center (Tuple[float, float]): 中央中心点 (x, y)。</span>
<span class="sd">            - real_center (Tuple[float, float]): 实际中心点 (x, y)。</span>
<span class="sd">            - angle (float): 角度（弧度）。</span>
<span class="sd">            - depth (float): central_center 的深度（米）。</span>
<span class="sd">            - real_depth (float): real_center 的深度（米）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: 绘制后的图像（新图像，不修改原图）。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">detection</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">image</span>

    <span class="c1"># 复制图像，避免修改原图</span>
    <span class="n">result_image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 提取检测数据</span>
        <span class="n">head_center</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;head_center&#39;</span><span class="p">)</span>
        <span class="n">central_center</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;central_center&#39;</span><span class="p">)</span>
        <span class="n">real_center</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;real_center&#39;</span><span class="p">)</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;angle&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">depth</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;depth&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">real_depth</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;real_depth&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>

        <span class="c1"># 转换为整数坐标</span>
        <span class="k">if</span> <span class="n">head_center</span><span class="p">:</span>
            <span class="n">head_center</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">head_center</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">head_center</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="c1"># 绘制head_center（红色圆点）</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">result_image</span><span class="p">,</span> <span class="n">head_center</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># 绘制angle文本</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span>
                <span class="n">result_image</span><span class="p">,</span> 
                <span class="sa">f</span><span class="s2">&quot;angle: </span><span class="si">{</span><span class="n">angle</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> 
                <span class="p">(</span><span class="n">head_center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">head_center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">10</span><span class="p">),</span> 
                <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> 
                <span class="mf">0.5</span><span class="p">,</span> 
                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> 
                <span class="mi">2</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">central_center</span><span class="p">:</span>
            <span class="n">central_center</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">central_center</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">central_center</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="c1"># 绘制central_center（绿色圆点）</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">result_image</span><span class="p">,</span> <span class="n">central_center</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># 绘制depth文本</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span>
                <span class="n">result_image</span><span class="p">,</span> 
                <span class="sa">f</span><span class="s2">&quot;depth: </span><span class="si">{</span><span class="n">depth</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> 
                <span class="p">(</span><span class="n">central_center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">central_center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">10</span><span class="p">),</span> 
                <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> 
                <span class="mf">0.5</span><span class="p">,</span> 
                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> 
                <span class="mi">2</span>
            <span class="p">)</span>
            <span class="c1"># 绘制方向箭头</span>
            <span class="n">ImageDrawingUtils</span><span class="o">.</span><span class="n">draw_direction_arrow</span><span class="p">(</span><span class="n">result_image</span><span class="p">,</span> <span class="n">central_center</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">real_center</span><span class="p">:</span>
            <span class="n">real_center</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">real_center</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">real_center</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="c1"># 绘制real_center（红色圆点）</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">result_image</span><span class="p">,</span> <span class="n">real_center</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># 绘制real_depth文本</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span>
                <span class="n">result_image</span><span class="p">,</span> 
                <span class="sa">f</span><span class="s2">&quot;real_depth: </span><span class="si">{</span><span class="n">real_depth</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> 
                <span class="p">(</span><span class="n">real_center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">real_center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">10</span><span class="p">),</span> 
                <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> 
                <span class="mf">0.5</span><span class="p">,</span> 
                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> 
                <span class="mi">2</span>
            <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># 如果绘制失败，返回原图</span>
        <span class="k">return</span> <span class="n">image</span>

    <span class="k">return</span> <span class="n">result_image</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.ImageDrawingUtils.draw_direction_arrow" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">draw_direction_arrow</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">draw_direction_arrow</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">center</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>绘制方向箭头。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>image</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>图像（原地修改）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>center</code>
            </td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>中心点坐标 (x, y)。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>angle</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>角度（弧度）- 直着向上为 0，顺时针为正。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/utils/image_drawing_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">draw_direction_arrow</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">center</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;绘制方向箭头。</span>

<span class="sd">    Args:</span>
<span class="sd">        image (np.ndarray): 图像（原地修改）。</span>
<span class="sd">        center (Tuple[int, int]): 中心点坐标 (x, y)。</span>
<span class="sd">        angle (float): 角度（弧度）- 直着向上为 0，顺时针为正。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 箭头参数</span>
        <span class="n">arrow_length</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># 箭头长度（像素）</span>
        <span class="n">arrow_color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># 蓝色（BGR格式）</span>
        <span class="n">arrow_thickness</span> <span class="o">=</span> <span class="mi">3</span>

        <span class="c1"># 计算箭头终点</span>
        <span class="c1"># 角度系统：直着向上为0，顺时针为正</span>
        <span class="c1"># 向上方向为 (0, -1)，因为图像坐标系Y轴向下</span>
        <span class="n">end_x</span> <span class="o">=</span> <span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">arrow_length</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
        <span class="n">end_y</span> <span class="o">=</span> <span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">arrow_length</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
        <span class="n">end_point</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">end_x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">end_y</span><span class="p">))</span>

        <span class="c1"># 绘制箭头</span>
        <span class="n">cv2</span><span class="o">.</span><span class="n">arrowedLine</span><span class="p">(</span>
            <span class="n">image</span><span class="p">,</span> 
            <span class="n">center</span><span class="p">,</span> 
            <span class="n">end_point</span><span class="p">,</span> 
            <span class="n">arrow_color</span><span class="p">,</span> 
            <span class="n">arrow_thickness</span><span class="p">,</span> 
            <span class="n">tipLength</span><span class="o">=</span><span class="mf">0.3</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.KinematicDomainService" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">KinematicDomainService</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">KinematicDomainService</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>运动学领域服务。</p>
<p>提供机械臂正逆运动学解算功能，包括DH参数管理、坐标变换矩阵计算等。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.KinematicDomainService.dh_param">dh_param</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DHParam


  
      dataclass
   (controller.domain.value_objects.DHParam)" href="#controller.shared.config.service_registry.DHParam">DHParam</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>机械臂 DH 参数对象。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.KinematicDomainService.kinematic_dh">kinematic_dh</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运动学 DH 参数矩阵。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.KinematicDomainService.kinematic_utils">kinematic_utils</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="KinematicUtils (controller.domain.utils.KinematicUtils)" href="#controller.shared.config.service_registry.KinematicUtils">KinematicUtils</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运动学工具类实例。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.KinematicDomainService.gripper2base">gripper2base</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>当前末端到基座的变换矩阵。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化运动学服务。</p>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/kinematic_domain_service.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化运动学服务。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dh_param</span> <span class="o">=</span> <span class="n">DHParam</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_dh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dh_param</span><span class="o">.</span><span class="n">get_kinematic_dh</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_utils</span> <span class="o">=</span> <span class="n">KinematicUtils</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gripper2base</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_gripper2base</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kinematic_dh</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.KinematicDomainService.get_kinematic_dh" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_kinematic_dh</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_kinematic_dh</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取运动学 DH 参数矩阵。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: DH 参数矩阵。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/kinematic_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_kinematic_dh</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取运动学 DH 参数矩阵。</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: DH 参数矩阵。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_dh</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.KinematicDomainService.get_gripper2base" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_gripper2base</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_gripper2base</span><span class="p">(</span><span class="n">theta_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>计算末端执行器相对于基座的位姿（四元数 + 位置）。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>theta_list</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>] | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>关节角度列表（弧度）。如果不传则使用当前内部状态。</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code><span title="tuple">tuple</span>[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(quat, pos)
- quat (np.ndarray): 姿态四元数 [x, y, z, w]。
- pos (np.ndarray): 位置坐标 [x, y, z]。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/kinematic_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_gripper2base</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;计算末端执行器相对于基座的位姿（四元数 + 位置）。</span>

<span class="sd">    Args:</span>
<span class="sd">        theta_list (list[float] | np.ndarray, optional): 关节角度列表（弧度）。如果不传则使用当前内部状态。</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: (quat, pos)</span>
<span class="sd">            - quat (np.ndarray): 姿态四元数 [x, y, z, w]。</span>
<span class="sd">            - pos (np.ndarray): 位置坐标 [x, y, z]。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">theta_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_dh</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">theta_list</span>
        <span class="n">rm_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">dh</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_dh</span><span class="p">:</span>
            <span class="n">rm_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kinematic_utils</span><span class="o">.</span><span class="n">dh2rm</span><span class="p">(</span><span class="o">*</span><span class="n">dh</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gripper2base</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">,</span> <span class="n">rm_list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">quat</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gripper2base</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">as_quat</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">quat</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gripper2base</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.KinematicDomainService.get_gripper2base_rm" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_gripper2base_rm</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_gripper2base_rm</span><span class="p">(</span><span class="n">theta_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取末端执行器相对于基座的变换矩阵。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>theta_list</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>关节角度列表（弧度）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: 4x4 齐次变换矩阵。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/kinematic_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_gripper2base_rm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取末端执行器相对于基座的变换矩阵。</span>

<span class="sd">    Args:</span>
<span class="sd">        theta_list (list[float]): 关节角度列表（弧度）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: 4x4 齐次变换矩阵。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_dh</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">theta_list</span>
    <span class="n">rm_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">dh</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_dh</span><span class="p">:</span>
        <span class="n">rm_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kinematic_utils</span><span class="o">.</span><span class="n">dh2rm</span><span class="p">(</span><span class="o">*</span><span class="n">dh</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gripper2base</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">@</span> <span class="n">y</span><span class="p">,</span> <span class="n">rm_list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gripper2base</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.KinematicDomainService.inverse_kinematic" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">inverse_kinematic</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">inverse_kinematic</span><span class="p">(</span><span class="n">rm</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">initial_theta</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>机械臂逆运动学求解。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rm</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>目标姿态旋转矩阵 (3x3)。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pos</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>目标位置坐标 [x, y, z]。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>initial_theta</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>初始关节角度猜测值，用于选择最优解。</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[float]: 最优关节角度解（弧度）。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">引发：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>如果未找到有效的逆运动学解。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/kinematic_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">inverse_kinematic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rm</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">initial_theta</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;机械臂逆运动学求解。</span>

<span class="sd">    Args:</span>
<span class="sd">        rm (np.ndarray): 目标姿态旋转矩阵 (3x3)。</span>
<span class="sd">        pos (np.ndarray): 目标位置坐标 [x, y, z]。</span>
<span class="sd">        initial_theta (list[float] | None, optional): 初始关节角度猜测值，用于选择最优解。</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[float]: 最优关节角度解（弧度）。</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: 如果未找到有效的逆运动学解。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">initial_theta</span><span class="p">:</span>
        <span class="n">initial_theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_dh</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">valid_solutions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># rotation matrix</span>
    <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span> <span class="o">=</span> <span class="n">rm</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">ox</span><span class="p">,</span> <span class="n">oy</span><span class="p">,</span> <span class="n">oz</span> <span class="o">=</span> <span class="n">rm</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">ax</span><span class="p">,</span> <span class="n">ay</span><span class="p">,</span> <span class="n">az</span> <span class="o">=</span> <span class="n">rm</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">pz</span> <span class="o">=</span> <span class="n">pos</span>

    <span class="c1"># DH参数</span>
    <span class="n">a3</span> <span class="o">=</span> <span class="mf">0.425</span> 
    <span class="n">a4</span> <span class="o">=</span> <span class="mf">0.401</span> 
    <span class="n">d4</span> <span class="o">=</span> <span class="mf">0.0856</span> 
    <span class="n">d5</span> <span class="o">=</span> <span class="mf">0.086</span> 
    <span class="n">d6</span> <span class="o">=</span> <span class="mf">0.231</span>

    <span class="c1"># 添加奇异性判断</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ax</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ay</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">d4</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-6</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">valid_solutions</span>

    <span class="c1"># theta1计算</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">ay</span> <span class="o">*</span> <span class="n">d6</span> <span class="o">-</span> <span class="n">py</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">ax</span> <span class="o">*</span> <span class="n">d6</span> <span class="o">-</span> <span class="n">px</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="n">m</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">d4</span><span class="o">**</span><span class="mi">2</span>

        <span class="k">if</span> <span class="n">delta</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">valid_solutions</span>

        <span class="n">theta1_0</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="n">atan2</span><span class="p">(</span><span class="o">-</span><span class="n">d4</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">d4</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">theta1_1</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="n">atan2</span><span class="p">(</span><span class="o">-</span><span class="n">d4</span><span class="p">,</span> <span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">d4</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">theta1_candidate</span> <span class="o">=</span> <span class="p">[</span><span class="n">theta1_0</span><span class="p">,</span> <span class="n">theta1_1</span><span class="p">]</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">valid_solutions</span>

    <span class="c1"># theta5</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">theta1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">theta1_candidate</span><span class="p">):</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta1</span><span class="p">)</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta1</span><span class="p">)</span>
        <span class="c1"># 修改theta5的计算方式</span>
        <span class="n">cos_theta5</span> <span class="o">=</span> <span class="o">-</span><span class="n">s1</span> <span class="o">*</span> <span class="n">ax</span> <span class="o">+</span> <span class="n">c1</span> <span class="o">*</span> <span class="n">ay</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">cos_theta5</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">cos_theta5</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">cos_theta5</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>

        <span class="n">theta5_val</span> <span class="o">=</span> <span class="n">acos</span><span class="p">(</span><span class="n">cos_theta5</span><span class="p">)</span>
        <span class="n">theta5_candidate</span> <span class="o">=</span> <span class="p">[</span><span class="n">theta5_val</span><span class="p">,</span> <span class="o">-</span><span class="n">theta5_val</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">theta5</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">theta5_candidate</span><span class="p">):</span>
            <span class="n">s5</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta5</span><span class="p">)</span>
            <span class="n">c5</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta5</span><span class="p">)</span>

            <span class="c1"># theta6</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">s5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-6</span><span class="p">:</span>
                <span class="c1"># 腕部奇异性</span>
                <span class="n">theta6</span> <span class="o">=</span> <span class="n">initial_theta</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">m1</span> <span class="o">=</span> <span class="o">-</span><span class="n">s1</span> <span class="o">*</span> <span class="n">nx</span> <span class="o">+</span> <span class="n">c1</span> <span class="o">*</span> <span class="n">ny</span>
                <span class="n">n1</span> <span class="o">=</span> <span class="o">-</span><span class="n">s1</span> <span class="o">*</span> <span class="n">ox</span> <span class="o">+</span> <span class="n">c1</span> <span class="o">*</span> <span class="n">oy</span>
                <span class="n">theta6</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="o">-</span><span class="n">n1</span> <span class="o">/</span> <span class="n">s5</span><span class="p">,</span> <span class="n">m1</span> <span class="o">/</span> <span class="n">s5</span><span class="p">)</span>

            <span class="c1"># theta3</span>
            <span class="n">s6</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta6</span><span class="p">)</span>
            <span class="n">c6</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta6</span><span class="p">)</span>
            <span class="n">m2</span> <span class="o">=</span> <span class="n">d5</span> <span class="o">*</span> <span class="p">(</span><span class="n">s6</span> <span class="o">*</span> <span class="p">(</span><span class="n">nx</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">ny</span> <span class="o">*</span> <span class="n">s1</span><span class="p">)</span> <span class="o">+</span> <span class="n">c6</span> <span class="o">*</span> <span class="p">(</span><span class="n">ox</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">oy</span> <span class="o">*</span> <span class="n">s1</span><span class="p">))</span> <span class="o">-</span> <span class="n">d6</span> <span class="o">*</span> <span class="p">(</span><span class="n">ax</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">ay</span> <span class="o">*</span> <span class="n">s1</span><span class="p">)</span> <span class="o">+</span> <span class="n">px</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">py</span> <span class="o">*</span> <span class="n">s1</span>
            <span class="n">n2</span> <span class="o">=</span> <span class="n">d5</span> <span class="o">*</span> <span class="p">(</span><span class="n">oz</span> <span class="o">*</span> <span class="n">c6</span> <span class="o">+</span> <span class="n">nz</span> <span class="o">*</span> <span class="n">s6</span><span class="p">)</span> <span class="o">+</span> <span class="n">pz</span> <span class="o">-</span> <span class="n">az</span> <span class="o">*</span> <span class="n">d6</span>

            <span class="c1"># 计算到关节3的距离</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">m2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">n2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">a3</span> <span class="o">+</span> <span class="n">a4</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.2</span> <span class="ow">or</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a3</span> <span class="o">-</span> <span class="n">a4</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">:</span>  <span class="c1"># 进一步放宽工作空间限制</span>
                <span class="k">continue</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="p">(</span><span class="n">m2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">n2</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a3</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a4</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">a4</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">temp</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">theta3_candidate</span> <span class="o">=</span> <span class="p">[</span><span class="n">acos</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span> <span class="o">-</span><span class="n">acos</span><span class="p">(</span><span class="n">temp</span><span class="p">)]</span>

            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">theta3</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">theta3_candidate</span><span class="p">):</span>
                <span class="c1"># theta2</span>
                <span class="n">s3</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta3</span><span class="p">)</span>
                <span class="n">c3</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta3</span><span class="p">)</span>
                <span class="c1"># 修改theta2的计算方式</span>
                <span class="n">k1</span> <span class="o">=</span> <span class="n">a3</span> <span class="o">+</span> <span class="n">a4</span> <span class="o">*</span> <span class="n">c3</span>
                <span class="n">k2</span> <span class="o">=</span> <span class="n">a4</span> <span class="o">*</span> <span class="n">s3</span>
                <span class="n">s2</span> <span class="o">=</span> <span class="p">(</span><span class="n">k1</span> <span class="o">*</span> <span class="n">n2</span> <span class="o">-</span> <span class="n">k2</span> <span class="o">*</span> <span class="n">m2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">k1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">k2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">c2</span> <span class="o">=</span> <span class="p">(</span><span class="n">k1</span> <span class="o">*</span> <span class="n">m2</span> <span class="o">+</span> <span class="n">k2</span> <span class="o">*</span> <span class="n">n2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">k1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">k2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">theta2</span> <span class="o">=</span> <span class="o">-</span><span class="n">atan2</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">c2</span><span class="p">)</span>

                <span class="c1"># theta4</span>
                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">s5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-6</span><span class="p">:</span>
                    <span class="c1"># 在腕部奇异性时，使用更稳定的计算方式</span>
                    <span class="k">if</span> <span class="n">initial_theta</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">theta4_candidate</span> <span class="o">=</span> <span class="p">[</span><span class="n">initial_theta</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">theta4_candidate</span> <span class="o">=</span> <span class="p">[</span><span class="n">initial_theta</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">T01</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_utils</span><span class="o">.</span><span class="n">dh2rm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kinematic_dh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_dh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_dh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">theta1</span><span class="p">)</span>
                    <span class="n">T12</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_utils</span><span class="o">.</span><span class="n">dh2rm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kinematic_dh</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_dh</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_dh</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">theta2</span><span class="p">)</span>
                    <span class="n">T23</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_utils</span><span class="o">.</span><span class="n">dh2rm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kinematic_dh</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_dh</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_dh</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">theta3</span><span class="p">)</span>
                    <span class="n">R03</span> <span class="o">=</span> <span class="p">(</span><span class="n">T01</span> <span class="o">@</span> <span class="n">T12</span> <span class="o">@</span> <span class="n">T23</span><span class="p">)[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
                    <span class="n">R36</span> <span class="o">=</span> <span class="n">R03</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">rm</span>
                    <span class="n">theta4</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">R36</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">R36</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
                    <span class="n">theta4_candidate</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">theta4</span><span class="p">,</span> <span class="n">pi</span> <span class="o">-</span> <span class="n">theta4</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">theta4</span> <span class="ow">in</span> <span class="n">theta4_candidate</span><span class="p">:</span>
                    <span class="n">candidate</span> <span class="o">=</span> <span class="p">[</span><span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span><span class="p">,</span> <span class="n">theta3</span><span class="p">,</span> <span class="n">theta4</span><span class="p">,</span> <span class="n">theta5</span><span class="p">,</span> <span class="n">theta6</span><span class="p">]</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verify_solution</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">pz</span><span class="p">)):</span>
                        <span class="n">valid_solutions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_solutions</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No valid solutions found&quot;</span><span class="p">)</span>
    <span class="n">valid_solutions</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kinematic_utils</span><span class="o">.</span><span class="n">normalize_angle</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">]</span> <span class="k">for</span> <span class="n">sol</span> <span class="ow">in</span> <span class="n">valid_solutions</span>
    <span class="p">]</span>

    <span class="n">norm_initial_theta</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kinematic_utils</span><span class="o">.</span><span class="n">normalize_angle</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">initial_theta</span><span class="p">]</span>
    <span class="n">final_solution</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">valid_solutions</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">sol</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">norm_initial_theta</span><span class="p">)))</span>

    <span class="n">gap</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="n">i</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">norm_initial_theta</span><span class="p">,</span> <span class="n">initial_theta</span><span class="p">)]</span>
    <span class="n">final_solution</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="o">-</span> <span class="n">g</span> <span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">final_solution</span><span class="p">,</span> <span class="n">gap</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">final_solution</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.KinematicDomainService.verify_solution" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">verify_solution</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">verify_solution</span><span class="p">(</span><span class="n">theta_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">target_pos</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>验证逆运动学解的准确性。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>theta_list</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>待验证的关节角度解。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_pos</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>目标位置坐标。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>如果正解位置与目标位置误差小于 1e-5 则返回 True。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/kinematic_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">verify_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">target_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;验证逆运动学解的准确性。</span>

<span class="sd">    Args:</span>
<span class="sd">        theta_list (list[float]): 待验证的关节角度解。</span>
<span class="sd">        target_pos (np.ndarray): 目标位置坐标。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 如果正解位置与目标位置误差小于 1e-5 则返回 True。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">get_gripper2base</span><span class="p">(</span><span class="n">theta_list</span><span class="p">)</span>
    <span class="n">current_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gripper2base</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">current_pos</span> <span class="o">-</span> <span class="n">target_pos</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">error</span> <span class="o">&lt;</span> <span class="mf">1e-5</span> 
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.DynamicDomainService" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">DynamicDomainService</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">DynamicDomainService</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>动力学领域服务 - 计算重力补偿力矩。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.DynamicDomainService.link_masses">link_masses</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>连杆质量列表 (kg)。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.DynamicDomainService.dh_matrix">dh_matrix</span></code></td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>动力学 DH 参数矩阵。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.DynamicDomainService.link_com_positions">link_com_positions</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>连杆质心在本体坐标系下的位置 (m)。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.DynamicDomainService.g_vector">g_vector</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>重力向量 (m/s²)。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.DynamicDomainService.n">n</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>关节数量。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.DynamicDomainService.compensation_factor_front">compensation_factor_front</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>前3个关节的补偿系数。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.DynamicDomainService.compensation_factor_rear">compensation_factor_rear</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>后3个关节的补偿系数。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/dynamic_domain_service.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># 连杆质量 (kg)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">link_masses</span> <span class="o">=</span> <span class="p">[</span><span class="mf">4.64</span><span class="p">,</span> <span class="mf">10.755</span><span class="p">,</span> <span class="mf">3.925</span><span class="p">,</span> <span class="mf">1.24</span><span class="p">,</span> <span class="mf">1.24</span><span class="p">,</span> <span class="mf">1.546</span><span class="p">]</span>

    <span class="c1"># 使用动力学DH参数</span>
    <span class="n">dh_param</span> <span class="o">=</span> <span class="n">DHParam</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dh_matrix</span> <span class="o">=</span> <span class="n">dh_param</span><span class="o">.</span><span class="n">get_dynamic_dh</span><span class="p">()</span>

    <span class="c1"># 连杆质心在本体坐标系下的位置 (m)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">link_com_positions</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2125</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.134</span><span class="p">]),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1818</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">])</span>
    <span class="p">]</span>

    <span class="c1"># 重力向量 (m/s²)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">g_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.81</span><span class="p">])</span>

    <span class="c1"># 关节数量</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="mi">6</span>

    <span class="c1"># 补偿系数（根据实际机械臂调整）</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">compensation_factor_front</span> <span class="o">=</span> <span class="mf">0.35</span>  <span class="c1"># 前3个关节</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">compensation_factor_rear</span> <span class="o">=</span> <span class="mf">0.25</span>   <span class="c1"># 后3个关节</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">







<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.DynamicDomainService.compute_gravity_compensation" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">compute_gravity_compensation</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">compute_gravity_compensation</span><span class="p">(</span><span class="n">joint_angles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>计算重力补偿力矩。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>joint_angles</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>当前关节角度（弧度），6维数组。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[float]: 每个关节的重力补偿力矩（Nm），6维数组。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">引发：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>如果 joint_angles 的长度不等于 6。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/dynamic_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_gravity_compensation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">joint_angles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;计算重力补偿力矩。</span>

<span class="sd">    Args:</span>
<span class="sd">        joint_angles (list[float]): 当前关节角度（弧度），6维数组。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[float]: 每个关节的重力补偿力矩（Nm），6维数组。</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: 如果 joint_angles 的长度不等于 6。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">joint_angles</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">6</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;关节角度必须是6维数组&quot;</span><span class="p">)</span>

    <span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">joint_angles</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">tau_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>  <span class="c1"># 初始化补偿力矩</span>

    <span class="c1"># 对每个关节计算重力补偿力矩</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">):</span>
        <span class="c1"># 对每个后续连杆（含自身）累加力矩贡献</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">):</span>
            <span class="c1"># 1. 计算第j连杆质心在基坐标系下的位置</span>
            <span class="n">com_base</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_link_com_in_base</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>

            <span class="c1"># 2. 计算该质心对第i关节的雅可比列</span>
            <span class="n">jacobian_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_jacobian_column</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">com_base</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

            <span class="c1"># 3. 计算重力对该关节的力矩贡献</span>
            <span class="n">tau_g</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">link_masses</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_vector</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">jacobian_col</span><span class="p">)</span>

    <span class="c1"># 应用补偿系数（根据实际机械臂调整）</span>
    <span class="n">tau_g</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compensation_factor_front</span>
    <span class="n">tau_g</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compensation_factor_rear</span>

    <span class="c1"># 返回负值（因为是补偿力矩）</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">tau_g</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.MessageDomainService" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MessageDomainService</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">MessageDomainService</span><span class="p">(</span><span class="n">message_encoder</span><span class="p">:</span> <span class="n">MessageEncoder</span><span class="p">,</span> <span class="n">message_decoder</span><span class="p">:</span> <span class="n">MessageDecoder</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>消息领域服务。</p>
<p>负责消息的编码和解码，作为 MessageEncoder 和 MessageDecoder 的门面。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MessageDomainService.message_encoder">message_encoder</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MessageEncoder (controller.domain.utils.MessageEncoder)" href="#controller.shared.config.service_registry.MessageEncoder">MessageEncoder</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>消息编码器。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MessageDomainService.message_decoder">message_decoder</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MessageDecoder (controller.domain.utils.MessageDecoder)" href="#controller.shared.config.service_registry.MessageDecoder">MessageDecoder</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>消息解码器。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化消息领域服务。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>message_encoder</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MessageEncoder (controller.domain.utils.MessageEncoder)" href="#controller.shared.config.service_registry.MessageEncoder">MessageEncoder</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>注入的消息编码器。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>message_decoder</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MessageDecoder (controller.domain.utils.MessageDecoder)" href="#controller.shared.config.service_registry.MessageDecoder">MessageDecoder</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>注入的消息解码器。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/domain/services/communication/message_domain_service.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message_encoder</span><span class="p">:</span> <span class="n">MessageEncoder</span><span class="p">,</span> <span class="n">message_decoder</span><span class="p">:</span> <span class="n">MessageDecoder</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化消息领域服务。</span>

<span class="sd">    Args:</span>
<span class="sd">        message_encoder (MessageEncoder): 注入的消息编码器。</span>
<span class="sd">        message_decoder (MessageDecoder): 注入的消息解码器。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">message_encoder</span> <span class="o">=</span> <span class="n">message_encoder</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">message_decoder</span> <span class="o">=</span> <span class="n">message_decoder</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MessageDomainService.encode_message" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">encode_message</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">encode_message</span><span class="p">(</span><span class="o">**</span><span class="n">message</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>编码消息。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>**message</code>
            </td>
            <td>
                  <code><span title="Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>消息字段键值对。</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>编码后的十六进制消息字符串。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/communication/message_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">encode_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">message</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;编码消息。</span>

<span class="sd">    Args:</span>
<span class="sd">        **message: 消息字段键值对。</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: 编码后的十六进制消息字符串。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">message_encoder</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span><span class="o">**</span><span class="n">message</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">message_encoder</span><span class="o">.</span><span class="n">interpret_message</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MessageDomainService.decode_message" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">decode_message</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">decode_message</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>解码消息。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>十六进制消息字符串。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Any</code></td>            <td>
                  <code><span title="Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>解码后的消息对象 (MessageIn)。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/communication/message_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">decode_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;解码消息。</span>

<span class="sd">    Args:</span>
<span class="sd">        message (str): 十六进制消息字符串。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Any: 解码后的消息对象 (MessageIn)。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">message_decoder</span><span class="o">.</span><span class="n">decode_message</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.SCurve" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">SCurve</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">SCurve</span><span class="p">(</span><span class="n">v_max</span><span class="o">=</span><span class="p">[</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">acc_max</span><span class="o">=</span><span class="p">[</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">8</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">t_j</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>S曲线速度规划算法。</p>
<p>实现基于加加速度(Jerk)限制的S型速度曲线规划。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.SCurve.v_max">v_max</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>最大速度限制。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.SCurve.acc_max">acc_max</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>最大加速度限制。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.SCurve.t_j">t_j</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>加加减速段时间。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化 S 曲线规划器。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>v_max</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>最大速度. Defaults to [pi/4]*6.</p>
              </div>
            </td>
            <td>
                  <code>[<span title="math.pi">pi</span> / 4] * 6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>acc_max</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>最大加速度. Defaults to [pi/8]*6.</p>
              </div>
            </td>
            <td>
                  <code>[<span title="math.pi">pi</span> / 8] * 6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t_j</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Jerk 时间参数. Defaults to 0.5.</p>
              </div>
            </td>
            <td>
                  <code>0.5</code>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/trajectory_domain_service.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v_max</span><span class="o">=</span><span class="p">[</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">acc_max</span><span class="o">=</span><span class="p">[</span><span class="n">pi</span><span class="o">/</span><span class="mi">8</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">t_j</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化 S 曲线规划器。</span>

<span class="sd">    Args:</span>
<span class="sd">        v_max (list[float], optional): 最大速度. Defaults to [pi/4]*6.</span>
<span class="sd">        acc_max (list[float], optional): 最大加速度. Defaults to [pi/8]*6.</span>
<span class="sd">        t_j (float, optional): Jerk 时间参数. Defaults to 0.5.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">v_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v_max</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">acc_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">acc_max</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">t_j</span> <span class="o">=</span> <span class="n">t_j</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SCurve.solve_cubic_numeric" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">solve_cubic_numeric</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">solve_cubic_numeric</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-08</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>求解三次方程实根。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/trajectory_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">solve_cubic_numeric</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-8</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;求解三次方程实根。&quot;&quot;&quot;</span>
    <span class="n">roots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">])</span>
    <span class="n">real_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">roots</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">tol</span><span class="p">)</span>
    <span class="n">real_roots</span> <span class="o">=</span> <span class="n">roots</span><span class="p">[</span><span class="n">real_mask</span><span class="p">]</span><span class="o">.</span><span class="n">real</span>

    <span class="k">return</span> <span class="n">real_roots</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SCurve.solve_quadratic" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">solve_quadratic</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">solve_quadratic</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-08</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>求解二次方程实根。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/trajectory_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">solve_quadratic</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;求解二次方程实根。&quot;&quot;&quot;</span>
    <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span>
    <span class="n">roots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>
    <span class="n">real_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">roots</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">tol</span><span class="p">)</span>
    <span class="n">real_roots</span> <span class="o">=</span> <span class="n">roots</span><span class="p">[</span><span class="n">real_mask</span><span class="p">]</span><span class="o">.</span><span class="n">real</span>

    <span class="k">return</span> <span class="n">real_roots</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SCurve.base_method" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">base_method</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">base_method</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">jerk</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">a_start</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">v_start</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">s_start</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>基础运动学方程计算。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(a, v, s) 当前时刻的加速度、速度、位移。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/trajectory_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">base_method</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">jerk</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">a_start</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">v_start</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">s_start</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;基础运动学方程计算。</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: (a, v, s) 当前时刻的加速度、速度、位移。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">jerk</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">a_start</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">jerk</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">a_start</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">v_start</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">jerk</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">6</span> <span class="o">+</span> <span class="n">a_start</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">v_start</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">s_start</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">s</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SCurve.planning" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">planning</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">planning</span><span class="p">(</span><span class="n">start_angles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">target_angles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">v_start</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>规划从起点到终点的S曲线轨迹。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>start_angles</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>起点角度。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_angles</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>终点角度。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>v_start</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>起始速度. Defaults to [0]*6.</p>
              </div>
            </td>
            <td>
                  <code>[0] * 6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dt</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>时间步长. Defaults to 0.01.</p>
              </div>
            </td>
            <td>
                  <code>0.01</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code><span title="tuple">tuple</span>[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(times, accelerations, velocities, positions) 规划结果。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/trajectory_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">planning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_angles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">target_angles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">v_start</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;规划从起点到终点的S曲线轨迹。</span>

<span class="sd">    Args:</span>
<span class="sd">        start_angles (list[float]): 起点角度。</span>
<span class="sd">        target_angles (list[float]): 终点角度。</span>
<span class="sd">        v_start (list[float], optional): 起始速度. Defaults to [0]*6.</span>
<span class="sd">        dt (float, optional): 时间步长. Defaults to 0.01.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: (times, accelerations, velocities, positions) 规划结果。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start_angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">start_angles</span><span class="p">)</span>
    <span class="n">target_angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">target_angles</span><span class="p">)</span>
    <span class="n">displacements</span> <span class="o">=</span> <span class="n">target_angles</span> <span class="o">-</span> <span class="n">start_angles</span>
    <span class="n">abs_displacements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">displacements</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">abs_displacements</span> <span class="o">&lt;</span> <span class="mf">1e-6</span><span class="p">):</span>
        <span class="n">num_samples</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">])</span>
        <span class="n">velocities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_samples</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">accelerations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_samples</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">start_angles</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">num_samples</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="c1"># 保持与其他返回路径一致的顺序：times, accelerations, velocities, positions</span>
        <span class="k">return</span> <span class="n">times</span><span class="p">,</span> <span class="n">accelerations</span><span class="p">,</span> <span class="n">velocities</span><span class="p">,</span> <span class="n">positions</span>
    <span class="n">max_displacement_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">abs_displacements</span><span class="p">)</span>
    <span class="n">max_displacement</span> <span class="o">=</span> <span class="n">abs_displacements</span><span class="p">[</span><span class="n">max_displacement_idx</span><span class="p">]</span>
    <span class="n">a_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">acc_max</span><span class="p">[</span><span class="n">max_displacement_idx</span><span class="p">]</span>
    <span class="n">v_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_max</span><span class="p">[</span><span class="n">max_displacement_idx</span><span class="p">]</span>
    <span class="n">max_v_start</span> <span class="o">=</span> <span class="n">v_start</span><span class="p">[</span><span class="n">max_displacement_idx</span><span class="p">]</span>
    <span class="n">jerk</span> <span class="o">=</span> <span class="n">a_max</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_j</span>
    <span class="n">s_1</span><span class="p">,</span> <span class="n">list_t_1</span><span class="p">,</span> <span class="n">list_a_1</span><span class="p">,</span> <span class="n">list_v_1</span><span class="p">,</span> <span class="n">list_s_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_boundary_1</span><span class="p">(</span><span class="n">jerk</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max_v_start</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">v_max</span><span class="p">,</span> <span class="n">a_max</span><span class="p">)</span>
    <span class="n">s_2</span><span class="p">,</span> <span class="n">t_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_boundary_2</span><span class="p">(</span><span class="n">jerk</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max_v_start</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">s_1</span> <span class="o">&lt;</span> <span class="n">max_displacement</span><span class="p">:</span>
        <span class="n">t_acc_1</span><span class="p">,</span> <span class="n">t_acc_2</span><span class="p">,</span> <span class="n">t_acc_3</span><span class="p">,</span> <span class="n">t_dec_1</span><span class="p">,</span> <span class="n">t_dec_2</span><span class="p">,</span> <span class="n">t_dec_3</span> <span class="o">=</span> <span class="n">list_t_1</span>
        <span class="n">a_acc_1</span><span class="p">,</span> <span class="n">a_acc_2</span><span class="p">,</span> <span class="n">a_acc_3</span><span class="p">,</span> <span class="n">a_dec_1</span><span class="p">,</span> <span class="n">a_dec_2</span><span class="p">,</span> <span class="n">a_dec_3</span> <span class="o">=</span> <span class="n">list_a_1</span>
        <span class="n">v_acc_1</span><span class="p">,</span> <span class="n">v_acc_2</span><span class="p">,</span> <span class="n">v_acc_3</span><span class="p">,</span> <span class="n">v_dec_1</span><span class="p">,</span> <span class="n">v_dec_2</span><span class="p">,</span> <span class="n">v_dec_3</span> <span class="o">=</span> <span class="n">list_v_1</span>
        <span class="n">s_acc_1</span><span class="p">,</span> <span class="n">s_acc_2</span><span class="p">,</span> <span class="n">s_acc_3</span><span class="p">,</span> <span class="n">s_dec_1</span><span class="p">,</span> <span class="n">s_dec_2</span><span class="p">,</span> <span class="n">s_dec_3</span> <span class="o">=</span> <span class="n">list_s_1</span>
        <span class="n">s_const</span> <span class="o">=</span> <span class="n">max_displacement</span> <span class="o">-</span> <span class="n">s_1</span>
        <span class="n">t_const</span> <span class="o">=</span> <span class="n">s_const</span> <span class="o">/</span> <span class="n">v_max</span>
        <span class="n">target_time</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">list_t_1</span><span class="p">)</span> <span class="o">+</span> <span class="n">t_const</span>
        <span class="n">param_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="n">t_acc_1</span><span class="p">,</span> <span class="n">jerk</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max_v_start</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="n">t_acc_1</span> <span class="o">+</span> <span class="n">t_acc_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a_acc_1</span><span class="p">,</span> <span class="n">v_acc_1</span><span class="p">,</span> <span class="n">s_acc_1</span><span class="p">],</span>
            <span class="p">[</span><span class="n">t_acc_1</span> <span class="o">+</span> <span class="n">t_acc_2</span> <span class="o">+</span> <span class="n">t_acc_3</span><span class="p">,</span> <span class="o">-</span><span class="n">jerk</span><span class="p">,</span> <span class="n">a_acc_2</span><span class="p">,</span> <span class="n">v_acc_2</span><span class="p">,</span> <span class="n">s_acc_2</span><span class="p">],</span>
            <span class="p">[</span><span class="n">t_acc_1</span> <span class="o">+</span> <span class="n">t_acc_2</span> <span class="o">+</span> <span class="n">t_acc_3</span> <span class="o">+</span> <span class="n">t_const</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a_acc_3</span><span class="p">,</span> <span class="n">v_acc_3</span><span class="p">,</span> <span class="n">s_acc_3</span><span class="p">],</span>
            <span class="p">[</span><span class="n">t_acc_1</span> <span class="o">+</span> <span class="n">t_acc_2</span> <span class="o">+</span> <span class="n">t_acc_3</span> <span class="o">+</span> <span class="n">t_const</span> <span class="o">+</span> <span class="n">t_dec_1</span><span class="p">,</span> <span class="o">-</span><span class="n">jerk</span><span class="p">,</span> <span class="n">a_acc_3</span><span class="p">,</span> <span class="n">v_acc_3</span><span class="p">,</span> <span class="n">s_acc_3</span> <span class="o">+</span> <span class="n">s_const</span><span class="p">],</span>
            <span class="p">[</span><span class="n">t_acc_1</span> <span class="o">+</span> <span class="n">t_acc_2</span> <span class="o">+</span> <span class="n">t_acc_3</span> <span class="o">+</span> <span class="n">t_const</span> <span class="o">+</span> <span class="n">t_dec_1</span> <span class="o">+</span> <span class="n">t_dec_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a_dec_1</span><span class="p">,</span> <span class="n">v_dec_1</span><span class="p">,</span> <span class="n">s_dec_1</span> <span class="o">+</span> <span class="n">s_const</span><span class="p">],</span>
            <span class="p">[</span><span class="n">t_acc_1</span> <span class="o">+</span> <span class="n">t_acc_2</span> <span class="o">+</span> <span class="n">t_acc_3</span> <span class="o">+</span> <span class="n">t_const</span> <span class="o">+</span> <span class="n">t_dec_1</span> <span class="o">+</span> <span class="n">t_dec_2</span> <span class="o">+</span> <span class="n">t_dec_3</span><span class="p">,</span> <span class="n">jerk</span><span class="p">,</span> <span class="n">a_dec_2</span><span class="p">,</span> <span class="n">v_dec_2</span><span class="p">,</span> <span class="n">s_dec_2</span> <span class="o">+</span> <span class="n">s_const</span><span class="p">],</span>
        <span class="p">])</span>
        <span class="n">times</span><span class="p">,</span> <span class="n">accelerations</span><span class="p">,</span> <span class="n">velocities</span><span class="p">,</span> <span class="n">positions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result</span><span class="p">(</span><span class="n">param_arr</span><span class="p">,</span> <span class="n">target_time</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">max_displacement_idx</span><span class="p">)</span>
        <span class="n">accelerations</span><span class="p">,</span> <span class="n">velocities</span><span class="p">,</span> <span class="n">positions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_result</span><span class="p">(</span><span class="n">accelerations</span><span class="p">,</span> 
                                                                 <span class="n">velocities</span><span class="p">,</span>
                                                                 <span class="n">positions</span><span class="p">,</span>
                                                                 <span class="n">max_displacement_idx</span><span class="p">,</span> 
                                                                 <span class="n">displacements</span><span class="p">,</span> 
                                                                 <span class="n">abs_displacements</span><span class="p">,</span>
                                                                 <span class="n">start_angles</span><span class="p">,</span> 
                                                                 <span class="n">target_angles</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">times</span><span class="p">,</span> <span class="n">accelerations</span><span class="p">,</span> <span class="n">velocities</span><span class="p">,</span> <span class="n">positions</span>

    <span class="k">elif</span> <span class="n">s_2</span> <span class="o">&gt;</span> <span class="n">max_displacement</span><span class="p">:</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">max_v_start</span> <span class="o">/</span> <span class="n">jerk</span>
        <span class="n">a</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">jerk</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">jerk</span> <span class="o">*</span> <span class="n">t0</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">c</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">max_v_start</span> <span class="o">-</span> <span class="n">jerk</span> <span class="o">*</span> <span class="n">t0</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">d</span> <span class="o">=</span> <span class="o">-</span><span class="n">max_displacement</span>
        <span class="n">t_j</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solve_cubic_numeric</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="n">t_j</span> <span class="o">=</span> <span class="n">t_j</span><span class="p">[(</span><span class="n">t_j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">t_j</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_j</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">s_acc_5</span><span class="p">,</span> <span class="n">list_t_3</span><span class="p">,</span> <span class="n">list_a_3</span><span class="p">,</span> <span class="n">list_v_3</span><span class="p">,</span> <span class="n">list_s_3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_stage_3</span><span class="p">(</span><span class="n">jerk</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max_v_start</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">t_j</span><span class="p">,</span> <span class="n">t0</span><span class="p">)</span>
        <span class="n">t_acc_1</span><span class="p">,</span> <span class="n">t_acc_2</span><span class="p">,</span> <span class="n">t_dec_1</span><span class="p">,</span> <span class="n">t_dec_2</span><span class="p">,</span> <span class="n">t_dec_3</span> <span class="o">=</span> <span class="n">list_t_3</span>
        <span class="n">a_acc_1</span><span class="p">,</span> <span class="n">a_acc_2</span><span class="p">,</span> <span class="n">a_dec_1</span><span class="p">,</span> <span class="n">a_dec_2</span><span class="p">,</span> <span class="n">a_dec_3</span> <span class="o">=</span> <span class="n">list_a_3</span>
        <span class="n">v_acc_1</span><span class="p">,</span> <span class="n">v_acc_2</span><span class="p">,</span> <span class="n">v_dec_1</span><span class="p">,</span> <span class="n">v_dec_2</span><span class="p">,</span> <span class="n">v_dec_3</span> <span class="o">=</span> <span class="n">list_v_3</span>
        <span class="n">s_acc_1</span><span class="p">,</span> <span class="n">s_acc_2</span><span class="p">,</span> <span class="n">s_dec_1</span><span class="p">,</span> <span class="n">s_dec_2</span><span class="p">,</span> <span class="n">s_dec_3</span> <span class="o">=</span> <span class="n">list_s_3</span>
        <span class="n">target_time</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">list_t_3</span><span class="p">)</span>
        <span class="n">param_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="n">t_acc_1</span><span class="p">,</span> <span class="n">jerk</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max_v_start</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="n">t_acc_1</span> <span class="o">+</span> <span class="n">t_acc_2</span><span class="p">,</span> <span class="o">-</span><span class="n">jerk</span><span class="p">,</span> <span class="n">a_acc_1</span><span class="p">,</span> <span class="n">v_acc_1</span><span class="p">,</span> <span class="n">s_acc_1</span><span class="p">],</span>
            <span class="p">[</span><span class="n">t_acc_1</span> <span class="o">+</span> <span class="n">t_acc_2</span> <span class="o">+</span> <span class="n">t_dec_1</span><span class="p">,</span> <span class="o">-</span><span class="n">jerk</span><span class="p">,</span> <span class="n">a_acc_2</span><span class="p">,</span> <span class="n">v_acc_2</span><span class="p">,</span> <span class="n">s_acc_2</span><span class="p">],</span>
            <span class="p">[</span><span class="n">t_acc_1</span> <span class="o">+</span> <span class="n">t_acc_2</span> <span class="o">+</span> <span class="n">t_dec_1</span> <span class="o">+</span> <span class="n">t_dec_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a_dec_1</span><span class="p">,</span> <span class="n">v_dec_1</span><span class="p">,</span> <span class="n">s_dec_1</span><span class="p">],</span>
            <span class="p">[</span><span class="n">t_acc_1</span> <span class="o">+</span> <span class="n">t_acc_2</span> <span class="o">+</span> <span class="n">t_dec_1</span> <span class="o">+</span> <span class="n">t_dec_2</span> <span class="o">+</span> <span class="n">t_dec_3</span><span class="p">,</span> <span class="n">jerk</span><span class="p">,</span> <span class="n">a_dec_2</span><span class="p">,</span> <span class="n">v_dec_2</span><span class="p">,</span> <span class="n">s_dec_2</span><span class="p">],</span>
        <span class="p">])</span>
        <span class="n">times</span><span class="p">,</span> <span class="n">accelerations</span><span class="p">,</span> <span class="n">velocities</span><span class="p">,</span> <span class="n">positions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result</span><span class="p">(</span><span class="n">param_arr</span><span class="p">,</span> <span class="n">target_time</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">max_displacement_idx</span><span class="p">)</span>
        <span class="n">accelerations</span><span class="p">,</span> <span class="n">velocities</span><span class="p">,</span> <span class="n">positions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_result</span><span class="p">(</span><span class="n">accelerations</span><span class="p">,</span> 
                                                                 <span class="n">velocities</span><span class="p">,</span>
                                                                 <span class="n">positions</span><span class="p">,</span>
                                                                 <span class="n">max_displacement_idx</span><span class="p">,</span> 
                                                                 <span class="n">displacements</span><span class="p">,</span> 
                                                                 <span class="n">abs_displacements</span><span class="p">,</span>
                                                                 <span class="n">start_angles</span><span class="p">,</span> 
                                                                 <span class="n">target_angles</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">times</span><span class="p">,</span> <span class="n">accelerations</span><span class="p">,</span> <span class="n">velocities</span><span class="p">,</span> <span class="n">positions</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a_acc_1</span><span class="p">,</span> <span class="n">v_acc_1</span><span class="p">,</span> <span class="n">s_acc_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_method</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_j</span><span class="p">,</span> <span class="n">jerk</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max_v_start</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">max_v_start</span> <span class="o">/</span> <span class="n">a_acc_1</span>
        <span class="n">s_t0</span> <span class="o">=</span> <span class="n">a_max</span> <span class="o">*</span> <span class="n">t0</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">jerk</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_j</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">t0</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">s_dec_3</span> <span class="o">=</span> <span class="n">jerk</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_j</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">6</span>
        <span class="n">delta_s</span> <span class="o">=</span> <span class="n">max_displacement</span> <span class="o">-</span> <span class="n">s_t0</span> <span class="o">-</span> <span class="n">s_dec_3</span> <span class="o">-</span> <span class="n">s_acc_1</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a_max</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">b</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a_max</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_j</span> <span class="o">+</span> <span class="n">max_v_start</span>
        <span class="n">c</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">/</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">a_max</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_j</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">max_v_start</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_j</span> <span class="o">-</span> <span class="n">delta_s</span> <span class="o">/</span> <span class="mi">2</span> 
        <span class="n">t_k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solve_quadratic</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
        <span class="n">t_k</span> <span class="o">=</span> <span class="n">t_k</span><span class="p">[(</span><span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_j</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">t_k</span> <span class="o">+</span> <span class="n">t0</span> <span class="o">&gt;</span> <span class="n">t_2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_j</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">t_k</span> <span class="o">+</span> <span class="n">t0</span> <span class="o">&lt;</span> <span class="nb">sum</span><span class="p">(</span><span class="n">list_t_1</span><span class="p">))][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">s_dec_4</span><span class="p">,</span> <span class="n">list_t_2</span><span class="p">,</span> <span class="n">list_a_2</span><span class="p">,</span> <span class="n">list_v_2</span><span class="p">,</span> <span class="n">list_s_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_stage_2</span><span class="p">(</span><span class="n">jerk</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max_v_start</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">t_k</span><span class="p">,</span> <span class="n">t0</span><span class="p">)</span>
        <span class="n">t_acc_1</span><span class="p">,</span> <span class="n">t_acc_2</span><span class="p">,</span> <span class="n">t_acc_3</span><span class="p">,</span> <span class="n">t_dec_1</span><span class="p">,</span> <span class="n">t_dec_2</span><span class="p">,</span> <span class="n">t_dec_3</span><span class="p">,</span> <span class="n">t_dec_4</span> <span class="o">=</span> <span class="n">list_t_2</span>
        <span class="n">a_acc_1</span><span class="p">,</span> <span class="n">a_acc_2</span><span class="p">,</span> <span class="n">a_acc_3</span><span class="p">,</span> <span class="n">a_dec_1</span><span class="p">,</span> <span class="n">a_dec_2</span><span class="p">,</span> <span class="n">a_dec_3</span><span class="p">,</span> <span class="n">a_dec_4</span> <span class="o">=</span> <span class="n">list_a_2</span>
        <span class="n">v_acc_1</span><span class="p">,</span> <span class="n">v_acc_2</span><span class="p">,</span> <span class="n">v_acc_3</span><span class="p">,</span> <span class="n">v_dec_1</span><span class="p">,</span> <span class="n">v_dec_2</span><span class="p">,</span> <span class="n">v_dec_3</span><span class="p">,</span> <span class="n">v_dec_4</span> <span class="o">=</span> <span class="n">list_v_2</span>
        <span class="n">s_acc_1</span><span class="p">,</span> <span class="n">s_acc_2</span><span class="p">,</span> <span class="n">s_acc_3</span><span class="p">,</span> <span class="n">s_dec_1</span><span class="p">,</span> <span class="n">s_dec_2</span><span class="p">,</span> <span class="n">s_dec_3</span><span class="p">,</span> <span class="n">s_dec_4</span> <span class="o">=</span> <span class="n">list_s_2</span>

        <span class="n">target_time</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">list_t_2</span><span class="p">)</span>
        <span class="n">param_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="n">t_acc_1</span><span class="p">,</span> <span class="n">jerk</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max_v_start</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="n">t_acc_1</span> <span class="o">+</span> <span class="n">t_acc_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a_acc_1</span><span class="p">,</span> <span class="n">v_acc_1</span><span class="p">,</span> <span class="n">s_acc_1</span><span class="p">],</span>
            <span class="p">[</span><span class="n">t_acc_1</span> <span class="o">+</span> <span class="n">t_acc_2</span> <span class="o">+</span> <span class="n">t_acc_3</span><span class="p">,</span> <span class="o">-</span><span class="n">jerk</span><span class="p">,</span> <span class="n">a_acc_2</span><span class="p">,</span> <span class="n">v_acc_2</span><span class="p">,</span> <span class="n">s_acc_2</span><span class="p">],</span>
            <span class="p">[</span><span class="n">t_acc_1</span> <span class="o">+</span> <span class="n">t_acc_2</span> <span class="o">+</span> <span class="n">t_acc_3</span> <span class="o">+</span> <span class="n">t_dec_1</span><span class="p">,</span> <span class="o">-</span><span class="n">jerk</span><span class="p">,</span> <span class="n">a_acc_3</span><span class="p">,</span> <span class="n">v_acc_3</span><span class="p">,</span> <span class="n">s_acc_3</span><span class="p">],</span>
            <span class="p">[</span><span class="n">t_acc_1</span> <span class="o">+</span> <span class="n">t_acc_2</span> <span class="o">+</span> <span class="n">t_acc_3</span> <span class="o">+</span> <span class="n">t_dec_1</span> <span class="o">+</span> <span class="n">t_dec_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a_dec_1</span><span class="p">,</span> <span class="n">v_dec_1</span><span class="p">,</span> <span class="n">s_dec_1</span><span class="p">],</span>
            <span class="p">[</span><span class="n">t_acc_1</span> <span class="o">+</span> <span class="n">t_acc_2</span> <span class="o">+</span> <span class="n">t_acc_3</span> <span class="o">+</span> <span class="n">t_dec_1</span> <span class="o">+</span> <span class="n">t_dec_2</span> <span class="o">+</span> <span class="n">t_dec_3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a_dec_2</span><span class="p">,</span> <span class="n">v_dec_2</span><span class="p">,</span> <span class="n">s_dec_2</span><span class="p">],</span>
            <span class="p">[</span><span class="n">t_acc_1</span> <span class="o">+</span> <span class="n">t_acc_2</span> <span class="o">+</span> <span class="n">t_acc_3</span> <span class="o">+</span> <span class="n">t_dec_1</span> <span class="o">+</span> <span class="n">t_dec_2</span> <span class="o">+</span> <span class="n">t_dec_3</span> <span class="o">+</span> <span class="n">t_dec_4</span><span class="p">,</span> <span class="n">jerk</span><span class="p">,</span> <span class="n">a_dec_3</span><span class="p">,</span> <span class="n">v_dec_3</span><span class="p">,</span> <span class="n">s_dec_3</span><span class="p">],</span>
        <span class="p">])</span>
        <span class="n">times</span><span class="p">,</span> <span class="n">accelerations</span><span class="p">,</span> <span class="n">velocities</span><span class="p">,</span> <span class="n">positions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_result</span><span class="p">(</span><span class="n">param_arr</span><span class="p">,</span> <span class="n">target_time</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">max_displacement_idx</span><span class="p">)</span>
        <span class="n">accelerations</span><span class="p">,</span> <span class="n">velocities</span><span class="p">,</span> <span class="n">positions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_result</span><span class="p">(</span><span class="n">accelerations</span><span class="p">,</span> 
                                                        <span class="n">velocities</span><span class="p">,</span>
                                                        <span class="n">positions</span><span class="p">,</span>
                                                        <span class="n">max_displacement_idx</span><span class="p">,</span> 
                                                        <span class="n">displacements</span><span class="p">,</span> 
                                                        <span class="n">abs_displacements</span><span class="p">,</span>
                                                        <span class="n">start_angles</span><span class="p">,</span> 
                                                        <span class="n">target_angles</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">times</span><span class="p">,</span> <span class="n">accelerations</span><span class="p">,</span> <span class="n">velocities</span><span class="p">,</span> <span class="n">positions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.SmoothDomainService" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">SmoothDomainService</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">SmoothDomainService</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>轨迹平滑服务。</p>
<p>提供多种平滑算法：
1. Cubic Spline + Savitzky-Golay 滤波（默认，旧版）
2. TOPPRA 时间参数化平滑（可选，旧版测试方法）</p>
<p>适用场景：
- 示教轨迹播放
- 多点轨迹规划
- 任何需要轨迹平滑的场景</p>

        <p>初始化平滑服务。</p>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/smooth_domain_service.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化平滑服务。&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SmoothDomainService.smooth_trajectory" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">smooth_trajectory</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">smooth_trajectory</span><span class="p">(</span><span class="n">angles_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;spline_savgol&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>平滑轨迹（统一接口）。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>angles_list</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>原始轨迹 [[θ1,...,θ6], ...]。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>平滑方法 ("spline_savgol" 或 "toppra"). Defaults to "spline_savgol".</p>
              </div>
            </td>
            <td>
                  <code>&#39;spline_savgol&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>各算法的特定参数。</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[List[float]]: 平滑后的轨迹点列表。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">引发：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>如果指定了未知的平滑方法。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/smooth_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">smooth_trajectory</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">angles_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> 
    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;spline_savgol&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;平滑轨迹（统一接口）。</span>

<span class="sd">    Args:</span>
<span class="sd">        angles_list (List[List[float]]): 原始轨迹 [[θ1,...,θ6], ...]。</span>
<span class="sd">        method (str, optional): 平滑方法 (&quot;spline_savgol&quot; 或 &quot;toppra&quot;). Defaults to &quot;spline_savgol&quot;.</span>
<span class="sd">        **kwargs: 各算法的特定参数。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[List[float]]: 平滑后的轨迹点列表。</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: 如果指定了未知的平滑方法。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;spline_savgol&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">spline_then_savgol</span><span class="p">(</span><span class="n">angles_list</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;toppra&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">toppra_smooth</span><span class="p">(</span><span class="n">angles_list</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;未知的平滑方法: </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SmoothDomainService.spline_then_savgol" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">spline_then_savgol</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">spline_then_savgol</span><span class="p">(</span><span class="n">angles_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="n">upsample</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">sg_window</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">211</span><span class="p">,</span> <span class="n">sg_poly</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Cubic Spline + Savitzky-Golay 滤波（参考旧版）。</p>
<p>流程：
1. Savitzky-Golay 平滑原始数据
2. Cubic Spline 上采样插值
3. 重采样回原始点数
4. 再次 Savitzky-Golay 平滑</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>angles_list</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>原始轨迹 N×6。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>upsample</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>上采样倍数. Defaults to 5.</p>
              </div>
            </td>
            <td>
                  <code>5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sg_window</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Savgol 滤波窗口（必须是奇数）. Defaults to 211.</p>
              </div>
            </td>
            <td>
                  <code>211</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sg_poly</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Savgol 多项式阶数. Defaults to 3.</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[List[float]]: 平滑后的轨迹列表。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/smooth_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">spline_then_savgol</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">angles_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span>
    <span class="n">upsample</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">sg_window</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">211</span><span class="p">,</span>
    <span class="n">sg_poly</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cubic Spline + Savitzky-Golay 滤波（参考旧版）。</span>

<span class="sd">    流程：</span>
<span class="sd">    1. Savitzky-Golay 平滑原始数据</span>
<span class="sd">    2. Cubic Spline 上采样插值</span>
<span class="sd">    3. 重采样回原始点数</span>
<span class="sd">    4. 再次 Savitzky-Golay 平滑</span>

<span class="sd">    Args:</span>
<span class="sd">        angles_list (List[List[float]]): 原始轨迹 N×6。</span>
<span class="sd">        upsample (int, optional): 上采样倍数. Defaults to 5.</span>
<span class="sd">        sg_window (int, optional): Savgol 滤波窗口（必须是奇数）. Defaults to 211.</span>
<span class="sd">        sg_poly (int, optional): Savgol 多项式阶数. Defaults to 3.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[List[float]]: 平滑后的轨迹列表。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">angles_list</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span>

    <span class="c1"># 确保窗口大小不超过数据点数</span>
    <span class="n">sg_window</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">sg_window</span><span class="p">,</span> <span class="n">N</span> <span class="k">if</span> <span class="n">N</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sg_window</span> <span class="o">&lt;</span> <span class="n">sg_poly</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">sg_window</span> <span class="o">=</span> <span class="n">sg_poly</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">sg_window</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sg_window</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># 1. Savitzky–Golay平滑（先平滑）</span>
    <span class="n">smoothed</span> <span class="o">=</span> <span class="n">savgol_filter</span><span class="p">(</span>
        <span class="n">arr</span><span class="p">,</span>
        <span class="n">window_length</span><span class="o">=</span><span class="n">sg_window</span><span class="p">,</span>
        <span class="n">polyorder</span><span class="o">=</span><span class="n">sg_poly</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
    <span class="p">)</span>

    <span class="c1"># 2. 三次样条插值（再插值）</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">t_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">*</span> <span class="n">upsample</span><span class="p">)</span>
    <span class="n">interp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">t_new</span><span class="p">),</span> <span class="n">D</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">D</span><span class="p">):</span>
        <span class="n">cs</span> <span class="o">=</span> <span class="n">CubicSpline</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">smoothed</span><span class="p">[:,</span> <span class="n">j</span><span class="p">])</span>
        <span class="n">interp</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">cs</span><span class="p">(</span><span class="n">t_new</span><span class="p">)</span>

    <span class="c1"># 3. 重采样回原始点数</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_new</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">resampled</span> <span class="o">=</span> <span class="n">interp</span><span class="p">[</span><span class="n">indices</span><span class="p">,</span> <span class="p">:]</span>

    <span class="c1"># 4. 再次平滑</span>
    <span class="n">resampled</span> <span class="o">=</span> <span class="n">savgol_filter</span><span class="p">(</span>
        <span class="n">resampled</span><span class="p">,</span>
        <span class="n">window_length</span><span class="o">=</span><span class="n">sg_window</span><span class="p">,</span>
        <span class="n">polyorder</span><span class="o">=</span><span class="n">sg_poly</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">resampled</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SmoothDomainService.toppra_smooth" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">toppra_smooth</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">toppra_smooth</span><span class="p">(</span><span class="n">waypoints</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">v_max</span><span class="p">:</span> <span class="n">ndarray</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span> <span class="n">a_max</span><span class="p">:</span> <span class="n">ndarray</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span> <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">grid_n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">800</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>使用 TOPPRA 进行平滑处理。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>waypoints</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>路径点 (N, dof)。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>v_max</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>最大速度。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>a_max</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>最大加速度。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dt</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>时间步长. Defaults to 0.01.</p>
              </div>
            </td>
            <td>
                  <code>0.01</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>grid_n</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>网格数. Defaults to 800.</p>
              </div>
            </td>
            <td>
                  <code>800</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>平滑后的关节位置列表。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">引发：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>参数错误。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>求解失败。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/smooth_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">toppra_smooth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
    <span class="n">waypoints</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">v_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">a_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="n">grid_n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">800</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;使用 TOPPRA 进行平滑处理。</span>

<span class="sd">    Args:</span>
<span class="sd">        waypoints (np.ndarray): 路径点 (N, dof)。</span>
<span class="sd">        v_max (np.ndarray | float): 最大速度。</span>
<span class="sd">        a_max (np.ndarray | float): 最大加速度。</span>
<span class="sd">        dt (float, optional): 时间步长. Defaults to 0.01.</span>
<span class="sd">        grid_n (int, optional): 网格数. Defaults to 800.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: 平滑后的关节位置列表。</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: 参数错误。</span>
<span class="sd">        RuntimeError: 求解失败。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">waypoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">waypoints</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">waypoints</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">waypoints</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">6</span> <span class="ow">or</span> <span class="n">waypoints</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;waypoints 必须是 (N,6) 且 N&gt;=2&quot;</span><span class="p">)</span>

    <span class="n">dof</span> <span class="o">=</span> <span class="n">waypoints</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># 1) 几何路径：用样条在路径参数 s∈[0,1] 上插值</span>
    <span class="n">breaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">waypoints</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">ta</span><span class="o">.</span><span class="n">SplineInterpolator</span><span class="p">(</span><span class="n">breaks</span><span class="p">,</span> <span class="n">waypoints</span><span class="p">)</span>  <span class="c1"># 官方示例同款 API</span>

    <span class="c1"># 2) 速度/加速度约束（上下界格式）</span>
    <span class="n">v_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">dof</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">v_max</span><span class="p">))</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">v_max</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">v_max</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">a_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">dof</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">a_max</span><span class="p">))</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">a_max</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a_max</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">v_max</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="n">dof</span><span class="p">,)</span> <span class="ow">or</span> <span class="n">a_max</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="n">dof</span><span class="p">,):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;v_max/a_max 需为标量或 shape=(6,)&quot;</span><span class="p">)</span>

    <span class="n">v_bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">v_max</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">v_max</span><span class="p">)))</span>  <span class="c1"># (2,6) -&gt; [v_min; v_max]</span>
    <span class="n">a_bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">a_max</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">a_max</span><span class="p">)))</span>  <span class="c1"># (2,6) -&gt; [a_min; a_max]</span>

    <span class="n">pc_vel</span> <span class="o">=</span> <span class="n">constraint</span><span class="o">.</span><span class="n">JointVelocityConstraint</span><span class="p">(</span><span class="n">v_bounds</span><span class="p">)</span>
    <span class="n">pc_acc</span> <span class="o">=</span> <span class="n">constraint</span><span class="o">.</span><span class="n">JointAccelerationConstraint</span><span class="p">(</span><span class="n">a_bounds</span><span class="p">)</span>

    <span class="c1"># 3) TOPPRA 主算法 + 常用参数化器（常用且满足边界/约束）</span>
    <span class="n">gridpoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">duration</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">grid_n</span><span class="p">))</span>
    <span class="n">instance</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">TOPPRA</span><span class="p">([</span><span class="n">pc_vel</span><span class="p">,</span> <span class="n">pc_acc</span><span class="p">],</span> <span class="n">path</span><span class="p">,</span> <span class="n">gridpoints</span><span class="o">=</span><span class="n">gridpoints</span><span class="p">,</span> <span class="n">parametrizer</span><span class="o">=</span><span class="s2">&quot;ParametrizeConstAccel&quot;</span><span class="p">)</span>

    <span class="c1"># 4) 求解时间参数化，得到可按时间采样的 jnt_traj</span>
    <span class="n">jnt_traj</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">compute_trajectory</span><span class="p">(</span><span class="n">sd_start</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">sd_end</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">jnt_traj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;TOPPRA 求解失败：给定约束下不可行，或路径异常。&quot;</span><span class="p">)</span>

    <span class="c1"># 5) 按 dt 采样</span>
    <span class="n">T</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">jnt_traj</span><span class="o">.</span><span class="n">duration</span><span class="p">)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">T</span> <span class="o">/</span> <span class="n">dt</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>

    <span class="n">q</span>   <span class="o">=</span> <span class="n">jnt_traj</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">qd</span>  <span class="o">=</span> <span class="n">jnt_traj</span><span class="o">.</span><span class="n">evald</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">qdd</span> <span class="o">=</span> <span class="n">jnt_traj</span><span class="o">.</span><span class="n">evaldd</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">q</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SmoothDomainService.remove_redundant_points" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">remove_redundant_points</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">remove_redundant_points</span><span class="p">(</span><span class="n">q_teach</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0001</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>改进版去除重复点：保留“任意一个关节角变化超过阈值”的点。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>q_teach</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>示教点列表。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>eps</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>变化阈值. Defaults to 1e-4.</p>
              </div>
            </td>
            <td>
                  <code>0.0001</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[List[float]]: 去重后的点列表。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/smooth_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_redundant_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q_teach</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;改进版去除重复点：保留“任意一个关节角变化超过阈值”的点。</span>

<span class="sd">    Args:</span>
<span class="sd">        q_teach (List[List[float]]): 示教点列表。</span>
<span class="sd">        eps (float, optional): 变化阈值. Defaults to 1e-4.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[List[float]]: 去重后的点列表。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">q_teach</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">q_teach</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">dq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">q_teach</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>  <span class="c1"># 相邻关节角绝对差</span>
    <span class="n">moving_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">dq</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># 只要任意一轴动了就认为在动</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([[</span><span class="kc">True</span><span class="p">],</span> <span class="n">moving_mask</span><span class="p">])</span>  <span class="c1"># 保留第一个点</span>
    <span class="k">return</span> <span class="n">q_teach</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SmoothDomainService.resample_equal_arclen" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">resample_equal_arclen</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">resample_equal_arclen</span><span class="p">(</span><span class="n">q_points</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="n">step</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.002</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>按弧长重采样，使路径在关节空间中分布均匀。</p>
<p>原理：
- 计算相邻点的欧氏距离（弧长）
- 将弧长积分得到累计s
- 对s均匀取样后，用插值函数生成新点</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>q_points</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>原始点列表。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>step</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>重采样步长. Defaults to 0.002.</p>
              </div>
            </td>
            <td>
                  <code>0.002</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[List[float]]: 重采样后的点列表。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/smooth_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">resample_equal_arclen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q_points</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="n">step</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.002</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;按弧长重采样，使路径在关节空间中分布均匀。</span>

<span class="sd">    原理：</span>
<span class="sd">    - 计算相邻点的欧氏距离（弧长）</span>
<span class="sd">    - 将弧长积分得到累计s</span>
<span class="sd">    - 对s均匀取样后，用插值函数生成新点</span>

<span class="sd">    Args:</span>
<span class="sd">        q_points (List[List[float]]): 原始点列表。</span>
<span class="sd">        step (float, optional): 重采样步长. Defaults to 0.002.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[List[float]]: 重采样后的点列表。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">q_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">q_points</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># 计算相邻点差值与长度（即弧长增量）</span>
    <span class="n">diffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">q_points</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">diffs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># 累计弧长 s[0]=0, s[-1]=总弧长</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">ds</span><span class="p">)])</span>
    <span class="n">s_total</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>


    <span class="c1"># 如果路径几乎没有长度（所有点都相同）</span>
    <span class="k">if</span> <span class="n">s_total</span> <span class="o">&lt;</span> <span class="mf">1e-8</span><span class="p">:</span>
        <span class="c1"># 直接返回重复的同一个点</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">q_points</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">num_points</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">s_total</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="mf">1e-12</span><span class="p">)))</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">num_points</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_points</span><span class="p">)</span>
    <span class="c1"># 均匀取样 num_points 个弧长点</span>
    <span class="n">s_uniform</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s_total</span><span class="p">,</span> <span class="n">num_points</span><span class="p">)</span>

    <span class="c1"># 构造弧长到关节角的插值函数（每个维度自动插值）</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;cubic&#39;</span> <span class="k">if</span> <span class="n">q_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">4</span> <span class="k">else</span> <span class="s1">&#39;linear&#39;</span>
    <span class="n">interp_fun</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">q_points</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">kind</span><span class="p">)</span>

    <span class="c1"># 根据均匀弧长取样，生成重采样轨迹</span>
    <span class="n">q_eq</span> <span class="o">=</span> <span class="n">interp_fun</span><span class="p">(</span><span class="n">s_uniform</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">q_eq</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SmoothDomainService.affine_align_to_fixed_ends" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">affine_align_to_fixed_ends</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">affine_align_to_fixed_ends</span><span class="p">(</span><span class="n">q_eq</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="n">q_start_req</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">q_end_req</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>对弧长重采样后的轨迹做仿射变换（线性缩放+平移），使轨迹的首尾点精确对齐到指定的起点和终点。</p>
<p>数学形式：
q_aligned = q_start_req + (q_eq - q0) * scale
其中 scale = (q_end_req - q_start_req) / (q1 - q0)</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>q_eq</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>重采样后的轨迹。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q_start_req</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>要求的起点。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q_end_req</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>要求的终点。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[List[float]]: 对齐后的轨迹。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/smooth_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">affine_align_to_fixed_ends</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">q_eq</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span>
    <span class="n">q_start_req</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">q_end_req</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;对弧长重采样后的轨迹做仿射变换（线性缩放+平移），使轨迹的首尾点精确对齐到指定的起点和终点。</span>

<span class="sd">    数学形式：</span>
<span class="sd">    q_aligned = q_start_req + (q_eq - q0) * scale</span>
<span class="sd">    其中 scale = (q_end_req - q_start_req) / (q1 - q0)</span>

<span class="sd">    Args:</span>
<span class="sd">        q_eq (List[List[float]]): 重采样后的轨迹。</span>
<span class="sd">        q_start_req (np.ndarray): 要求的起点。</span>
<span class="sd">        q_end_req (np.ndarray): 要求的终点。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[List[float]]: 对齐后的轨迹。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">q_eq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">q_eq</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">q_start_req</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">q_start_req</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">q_end_req</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">q_end_req</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># 获取原轨迹的首尾点</span>
    <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span> <span class="o">=</span> <span class="n">q_eq</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q_eq</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># 防止除0：若某个关节起终角度相同，则强制除数不为0</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="p">(</span><span class="n">q1</span> <span class="o">-</span> <span class="n">q0</span><span class="p">)</span>
    <span class="n">denom</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">denom</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-9</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-9</span>

    <span class="c1"># 每个关节单独计算缩放比例</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="p">(</span><span class="n">q_end_req</span> <span class="o">-</span> <span class="n">q_start_req</span><span class="p">)</span> <span class="o">/</span> <span class="n">denom</span>

    <span class="c1"># 仿射变换（线性缩放 + 平移）</span>
    <span class="n">q_aligned</span> <span class="o">=</span> <span class="n">q_start_req</span> <span class="o">+</span> <span class="p">(</span><span class="n">q_eq</span> <span class="o">-</span> <span class="n">q0</span><span class="p">)</span> <span class="o">*</span> <span class="n">scale</span>

    <span class="c1"># 确保边界精确匹配</span>
    <span class="n">q_aligned</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">q_start_req</span>
    <span class="n">q_aligned</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">q_end_req</span>

    <span class="k">return</span> <span class="n">q_aligned</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SmoothDomainService.teach_smooth" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">teach_smooth</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">teach_smooth</span><span class="p">(</span><span class="n">q_teach</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="n">q_start_req</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">q_end_req</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">step</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.002</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-06</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>示教轨迹整体平滑处理。</p>
<p>流程：
1. 去除停顿/重复点
2. 按弧长重采样（空间均匀）
3. 仿射缩放和平移对齐指定的起点/终点</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>q_teach</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>原始示教轨迹。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q_start_req</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>要求的起点。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q_end_req</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>要求的终点。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>step</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>重采样步长. Defaults to 0.002.</p>
              </div>
            </td>
            <td>
                  <code>0.002</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>eps</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>去重阈值. Defaults to 1e-6.</p>
              </div>
            </td>
            <td>
                  <code>1e-06</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[List[float]]: 最终平滑轨迹。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/smooth_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">teach_smooth</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">q_teach</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span>
    <span class="n">q_start_req</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">q_end_req</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">step</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.002</span><span class="p">,</span>
    <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;示教轨迹整体平滑处理。</span>

<span class="sd">    流程：</span>
<span class="sd">    1. 去除停顿/重复点</span>
<span class="sd">    2. 按弧长重采样（空间均匀）</span>
<span class="sd">    3. 仿射缩放和平移对齐指定的起点/终点</span>

<span class="sd">    Args:</span>
<span class="sd">        q_teach (List[List[float]]): 原始示教轨迹。</span>
<span class="sd">        q_start_req (np.ndarray): 要求的起点。</span>
<span class="sd">        q_end_req (np.ndarray): 要求的终点。</span>
<span class="sd">        step (float, optional): 重采样步长. Defaults to 0.002.</span>
<span class="sd">        eps (float, optional): 去重阈值. Defaults to 1e-6.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[List[float]]: 最终平滑轨迹。</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.LinearMotionDomainService" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">LinearMotionDomainService</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">LinearMotionDomainService</span><span class="p">(</span><span class="n">v_max</span><span class="o">=</span><span class="p">[</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">a_max</span><span class="o">=</span><span class="p">[</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">8</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">j_max</span><span class="o">=</span><span class="p">[</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">16</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>直线运动规划服务。</p>
<p>提供空间直线插值运动规划功能，支持指定起点终点或指定方向距离的规划。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.LinearMotionDomainService.v_max">v_max</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>各关节最大速度。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.LinearMotionDomainService.a_max">a_max</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>各关节最大加速度。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.LinearMotionDomainService.j_max">j_max</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>各关节最大加加速度。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.LinearMotionDomainService.dt">dt</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>时间步长。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.LinearMotionDomainService.kinematic_solver">kinematic_solver</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="KinematicDomainService (controller.domain.services.algorithm.kinematic_domain_service.KinematicDomainService)" href="../../../domain/algorithm/#controller.domain.services.algorithm.kinematic_domain_service.KinematicDomainService">KinematicDomainService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运动学求解器。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化直线运动服务。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>v_max</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>最大速度列表. Defaults to [pi/4]*6.</p>
              </div>
            </td>
            <td>
                  <code>[<span title="math.pi">pi</span> / 4] * 6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>a_max</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>最大加速度列表. Defaults to [pi/8]*6.</p>
              </div>
            </td>
            <td>
                  <code>[<span title="math.pi">pi</span> / 8] * 6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>j_max</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>最大加加速度列表. Defaults to [pi/16]*6.</p>
              </div>
            </td>
            <td>
                  <code>[<span title="math.pi">pi</span> / 16] * 6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dt</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>时间步长. Defaults to 0.01.</p>
              </div>
            </td>
            <td>
                  <code>0.01</code>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/linear_motion_domain_service.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v_max</span><span class="o">=</span><span class="p">[</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">a_max</span><span class="o">=</span><span class="p">[</span><span class="n">pi</span><span class="o">/</span><span class="mi">8</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">j_max</span><span class="o">=</span><span class="p">[</span><span class="n">pi</span><span class="o">/</span><span class="mi">16</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化直线运动服务。</span>

<span class="sd">    Args:</span>
<span class="sd">        v_max (list[float], optional): 最大速度列表. Defaults to [pi/4]*6.</span>
<span class="sd">        a_max (list[float], optional): 最大加速度列表. Defaults to [pi/8]*6.</span>
<span class="sd">        j_max (list[float], optional): 最大加加速度列表. Defaults to [pi/16]*6.</span>
<span class="sd">        dt (float, optional): 时间步长. Defaults to 0.01.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">v_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">v_max</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">a_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a_max</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">j_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">j_max</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_solver</span> <span class="o">=</span> <span class="n">KinematicDomainService</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nearest_position</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.LinearMotionDomainService.clamp" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clamp</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">clamp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>限制数值范围。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/linear_motion_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">clamp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;限制数值范围。&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">high</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.LinearMotionDomainService.linear_motion" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">linear_motion</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">linear_motion</span><span class="p">(</span><span class="n">start_position</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">end_position</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>规划两点间的直线运动。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>start_position</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>起点关节角度。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_position</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>终点关节角度。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code><span title="tuple">tuple</span>[<span title="list">list</span>[<span title="float">float</span>], <span title="list">list</span>[<span title="list">list</span>[<span title="float">float</span>]], <span title="list">list</span>[<span title="list">list</span>[<span title="float">float</span>]], <span title="list">list</span>[<span title="list">list</span>[<span title="float">float</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(t_list, positions, qd, qdd) 轨迹数据。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/linear_motion_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">linear_motion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_position</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">end_position</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;规划两点间的直线运动。</span>

<span class="sd">    Args:</span>
<span class="sd">        start_position (list[float]): 起点关节角度。</span>
<span class="sd">        end_position (list[float]): 终点关节角度。</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: (t_list, positions, qd, qdd) 轨迹数据。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nearest_position</span> <span class="o">=</span> <span class="n">start_position</span>
    <span class="n">start_quat</span><span class="p">,</span> <span class="n">start_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_solver</span><span class="o">.</span><span class="n">get_gripper2base</span><span class="p">(</span><span class="n">start_position</span><span class="p">)</span>
    <span class="n">end_quat</span><span class="p">,</span> <span class="n">end_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_solver</span><span class="o">.</span><span class="n">get_gripper2base</span><span class="p">(</span><span class="n">end_position</span><span class="p">)</span>
    <span class="n">quat_list</span><span class="p">,</span> <span class="n">pos_list</span><span class="p">,</span> <span class="n">n_seg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling</span><span class="p">(</span><span class="n">start_quat</span><span class="p">,</span> <span class="n">start_pos</span><span class="p">,</span> <span class="n">end_quat</span><span class="p">,</span> <span class="n">end_pos</span><span class="p">)</span>
    <span class="n">t_list</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">qd</span><span class="p">,</span> <span class="n">qdd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span><span class="n">quat_list</span><span class="p">,</span> <span class="n">pos_list</span><span class="p">,</span> <span class="n">n_seg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t_list</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">qd</span><span class="p">,</span> <span class="n">qdd</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.LinearMotionDomainService.linear_motion_z_axis" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">linear_motion_z_axis</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">linear_motion_z_axis</span><span class="p">(</span><span class="n">start_position</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">distance</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">direction</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">ds</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.002</span><span class="p">,</span> <span class="n">include_end</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>沿指定方向矢量进行直线运动规划。</p>
<p>注意：此模式下末端姿态保持不变，仅位置发生位移。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>start_position</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>起点关节角度。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>distance</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>移动距离 (m)。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>direction</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>方向矢量 [x, y, z]。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ds</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>空间采样步长. Defaults to 0.002.</p>
              </div>
            </td>
            <td>
                  <code>0.002</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>include_end</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否包含终点. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code><span title="tuple">tuple</span>[<span title="list">list</span>[<span title="float">float</span>], <span title="list">list</span>[<span title="list">list</span>[<span title="float">float</span>]], <span title="list">list</span>[<span title="list">list</span>[<span title="float">float</span>]], <span title="list">list</span>[<span title="list">list</span>[<span title="float">float</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(t_list, positions, qd, qdd) 轨迹数据。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">引发：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>如果方向向量模长过小。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/linear_motion_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">linear_motion_z_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_position</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">distance</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">direction</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">ds</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.002</span><span class="p">,</span> <span class="n">include_end</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;沿指定方向矢量进行直线运动规划。</span>

<span class="sd">    注意：此模式下末端姿态保持不变，仅位置发生位移。</span>

<span class="sd">    Args:</span>
<span class="sd">        start_position (list[float]): 起点关节角度。</span>
<span class="sd">        distance (float): 移动距离 (m)。</span>
<span class="sd">        direction (list[float]): 方向矢量 [x, y, z]。</span>
<span class="sd">        ds (float, optional): 空间采样步长. Defaults to 0.002.</span>
<span class="sd">        include_end (bool, optional): 是否包含终点. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: (t_list, positions, qd, qdd) 轨迹数据。</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: 如果方向向量模长过小。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nearest_position</span> <span class="o">=</span> <span class="n">start_position</span>
    <span class="n">start_quat</span><span class="p">,</span> <span class="n">start_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_solver</span><span class="o">.</span><span class="n">get_gripper2base</span><span class="p">(</span><span class="n">start_position</span><span class="p">)</span>
    <span class="c1"># todo: 按照distance计算终点位置</span>
    <span class="n">p0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">start_pos</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">q0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_q_normalize</span><span class="p">(</span><span class="n">start_quat</span><span class="p">)</span>

    <span class="n">direction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">direction</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">norm</span> <span class="o">&lt;</span> <span class="mf">1e-9</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Direction vector is zero or too small&quot;</span><span class="p">)</span>
    <span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span> <span class="o">/</span> <span class="n">norm</span>

    <span class="c1"># 需要的段数（保证每步不超过 ds）</span>
    <span class="n">L</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">distance</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">L</span> <span class="o">&lt;</span> <span class="mf">1e-12</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span> <span class="k">if</span> <span class="n">include_end</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n_seg</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">L</span> <span class="o">/</span> <span class="n">ds</span><span class="p">)))</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">n_seg</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">include_end</span> <span class="k">else</span> <span class="n">n_seg</span><span class="p">)</span>

    <span class="c1"># 直线方向：xiangliang</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">direction</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>

    <span class="c1"># 位置线性采样；姿态保持不变</span>
    <span class="n">pos_list</span> <span class="o">=</span> <span class="n">p0</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">t</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">d</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">quat_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">q0</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:],</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">t_list</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">qd</span><span class="p">,</span> <span class="n">qdd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span><span class="n">quat_list</span><span class="p">,</span> <span class="n">pos_list</span><span class="p">,</span> <span class="n">n_seg</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">t_list</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">qd</span><span class="p">,</span> <span class="n">qdd</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.LinearMotionDomainService.sampling" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sampling</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">sampling</span><span class="p">(</span><span class="n">start_quat</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">start_pos</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">end_quat</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">end_pos</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">sampling_dis</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.002</span><span class="p">,</span> <span class="n">include_end</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>对起点和终点进行空间线性插值采样。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>start_quat</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>起点四元数。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>start_pos</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>起点位置。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_quat</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>终点四元数。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_pos</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>终点位置。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sampling_dis</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>采样间距. Defaults to 0.002.</p>
              </div>
            </td>
            <td>
                  <code>0.002</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>include_end</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否包含终点. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code><span title="tuple">tuple</span>[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(quat_list, pos_list, n_seg)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/linear_motion_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sampling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_quat</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">start_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">end_quat</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">end_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">sampling_dis</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.002</span><span class="p">,</span> <span class="n">include_end</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;对起点和终点进行空间线性插值采样。</span>

<span class="sd">    Args:</span>
<span class="sd">        start_quat (np.ndarray): 起点四元数。</span>
<span class="sd">        start_pos (np.ndarray): 起点位置。</span>
<span class="sd">        end_quat (np.ndarray): 终点四元数。</span>
<span class="sd">        end_pos (np.ndarray): 终点位置。</span>
<span class="sd">        sampling_dis (float, optional): 采样间距. Defaults to 0.002.</span>
<span class="sd">        include_end (bool, optional): 是否包含终点. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: (quat_list, pos_list, n_seg)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">quat_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">pos_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># todo: 按照起始四元数+位置和终点四元数+位置以及采样间隔0.02m，进行采样</span>
    <span class="n">p0</span><span class="o">=</span><span class="n">start_pos</span>
    <span class="n">p1</span><span class="o">=</span><span class="n">end_pos</span>
    <span class="n">p0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1"># 兼容两种四元数顺序：若最后一项绝对值最大，视为 [x,y,z,w]，转成 [w,x,y,z]</span>
    <span class="n">q0</span><span class="o">=</span><span class="n">start_quat</span>
    <span class="n">q1</span><span class="o">=</span><span class="n">end_quat</span>
    <span class="n">q0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">q1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="c1"># if np.argmax(np.abs(q0)) == 3:  # 可能是 [x,y,z,w]</span>
    <span class="c1">#     q0 = np.roll(q0, 1)</span>
    <span class="c1"># if np.argmax(np.abs(q1)) == 3:</span>
    <span class="c1">#     q1 = np.roll(q1, 1)</span>

    <span class="c1"># 计算需要的采样点数</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">p1</span> <span class="o">-</span> <span class="n">p0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">L</span> <span class="o">&lt;</span> <span class="mf">1e-9</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span> <span class="k">if</span> <span class="n">include_end</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n_seg</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">L</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">sampling_dis</span><span class="p">))))</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">n_seg</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">include_end</span> <span class="k">else</span> <span class="n">n_seg</span><span class="p">)</span>

    <span class="c1"># 位置线性插值</span>
    <span class="n">pos_list</span> <span class="o">=</span> <span class="p">(</span><span class="n">p0</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="p">(</span><span class="n">p1</span> <span class="o">-</span> <span class="n">p0</span><span class="p">)[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">t</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span>

    <span class="c1"># 姿态 SLERP</span>
    <span class="n">quat_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_q_slerp</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">ti</span><span class="p">)</span> <span class="k">for</span> <span class="n">ti</span> <span class="ow">in</span> <span class="n">t</span><span class="p">])</span>


    <span class="k">return</span> <span class="n">quat_list</span><span class="p">,</span> <span class="n">pos_list</span><span class="p">,</span> <span class="n">n_seg</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.LinearMotionDomainService.smooth" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">smooth</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">smooth</span><span class="p">(</span><span class="n">quat_list</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">pos_list</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">n_seg</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>对采样点序列进行逆运动学求解和时间参数化平滑。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>quat_list</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>四元数序列。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pos_list</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>位置序列。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_seg</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>分段数。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code><span title="tuple">tuple</span>[<span title="list">list</span>[<span title="float">float</span>], <span title="list">list</span>[<span title="list">list</span>[<span title="float">float</span>]], <span title="list">list</span>[<span title="list">list</span>[<span title="float">float</span>]], <span title="list">list</span>[<span title="list">list</span>[<span title="float">float</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(t_list, positions, qd, qdd)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/linear_motion_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">smooth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quat_list</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pos_list</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">n_seg</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;对采样点序列进行逆运动学求解和时间参数化平滑。</span>

<span class="sd">    Args:</span>
<span class="sd">        quat_list (np.ndarray): 四元数序列。</span>
<span class="sd">        pos_list (np.ndarray): 位置序列。</span>
<span class="sd">        n_seg (int): 分段数。</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: (t_list, positions, qd, qdd) </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">quat</span><span class="p">,</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">quat_list</span><span class="p">,</span> <span class="n">pos_list</span><span class="p">):</span>
        <span class="n">position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inverse_kinematic</span><span class="p">(</span><span class="n">quat</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="n">positions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
    <span class="c1"># todo: 基于这个positions列表，规划rucking smooth</span>

    <span class="n">q_wp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensure_2d_array</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
    <span class="n">grid_n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">n_seg</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">3000</span><span class="p">)</span>    
    <span class="n">t_list</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">qd</span><span class="p">,</span> <span class="n">qdd</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">toppra_time_parameterize</span><span class="p">(</span><span class="n">q_wp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a_max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">,</span> <span class="n">grid_n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t_list</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">qd</span><span class="p">,</span> <span class="n">qdd</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.LinearMotionDomainService.inverse_kinematic" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">inverse_kinematic</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">inverse_kinematic</span><span class="p">(</span><span class="n">quat</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>单点逆运动学求解（利用上一位置作为初值）。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/linear_motion_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">inverse_kinematic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quat</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;单点逆运动学求解（利用上一位置作为初值）。&quot;&quot;&quot;</span>
    <span class="n">rm</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="n">quat</span><span class="p">)</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
    <span class="n">inverse_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_solver</span><span class="o">.</span><span class="n">inverse_kinematic</span><span class="p">(</span><span class="n">rm</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">initial_theta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nearest_position</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nearest_position</span> <span class="o">=</span> <span class="n">inverse_position</span>
    <span class="k">return</span> <span class="n">inverse_position</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.LinearMotionDomainService.wrap_to_pi" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">wrap_to_pi</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">wrap_to_pi</span><span class="p">(</span><span class="n">q</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>将角度包裹到 (-pi, pi]，避免 2π 跳变影响计算。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/linear_motion_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">wrap_to_pi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">q</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;将角度包裹到 (-pi, pi]，避免 2π 跳变影响计算。&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">q</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.LinearMotionDomainService.ensure_2d_array" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ensure_2d_array</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">ensure_2d_array</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>将输入转换为二维数组 (N, dof) 并做基本校验。</p>


<p><span class="doc-section-title">引发：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>当路标数少于 2（缺少起点或终点）时抛出。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/linear_motion_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ensure_2d_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">arr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    将输入转换为二维数组 (N, dof) 并做基本校验。</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: 当路标数少于 2（缺少起点或终点）时抛出。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">q</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">q</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Q_waypoints 至少需要两个点（起点与终点）且维度为 (N, dof)。&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">q</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.LinearMotionDomainService.toppra_time_parameterize" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">toppra_time_parameterize</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">toppra_time_parameterize</span><span class="p">(</span><span class="n">waypoints</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">v_max</span><span class="p">:</span> <span class="n">ndarray</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span> <span class="n">a_max</span><span class="p">:</span> <span class="n">ndarray</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span> <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">grid_n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">800</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>使用 TOPPRA 进行时间参数化。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>waypoints</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>路径点 (N, dof)。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>v_max</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>最大速度。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>a_max</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>最大加速度。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dt</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>时间步长. Defaults to 0.01.</p>
              </div>
            </td>
            <td>
                  <code>0.01</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>grid_n</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>网格点数. Defaults to 800.</p>
              </div>
            </td>
            <td>
                  <code>800</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code><span title="tuple">tuple</span>[<span title="list">list</span>[<span title="float">float</span>], <span title="list">list</span>[<span title="list">list</span>[<span title="float">float</span>]], <span title="list">list</span>[<span title="list">list</span>[<span title="float">float</span>]], <span title="list">list</span>[<span title="list">list</span>[<span title="float">float</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(t, q, qd, qdd).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">引发：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>如果参数形状不正确。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>如果求解失败。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/linear_motion_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">toppra_time_parameterize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<span class="n">waypoints</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span class="n">v_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span>
<span class="n">a_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span>
<span class="n">dt</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
<span class="n">grid_n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">800</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;使用 TOPPRA 进行时间参数化。</span>

<span class="sd">    Args:</span>
<span class="sd">        waypoints (np.ndarray): 路径点 (N, dof)。</span>
<span class="sd">        v_max (np.ndarray | float): 最大速度。</span>
<span class="sd">        a_max (np.ndarray | float): 最大加速度。</span>
<span class="sd">        dt (float, optional): 时间步长. Defaults to 0.01.</span>
<span class="sd">        grid_n (int, optional): 网格点数. Defaults to 800.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: (t, q, qd, qdd).</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: 如果参数形状不正确。</span>
<span class="sd">        RuntimeError: 如果求解失败。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">waypoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">waypoints</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">waypoints</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">waypoints</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">6</span> <span class="ow">or</span> <span class="n">waypoints</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;waypoints 必须是 (N,6) 且 N&gt;=2&quot;</span><span class="p">)</span>

    <span class="n">dof</span> <span class="o">=</span> <span class="n">waypoints</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># 1) 几何路径：用样条在路径参数 s∈[0,1] 上插值</span>
    <span class="n">breaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">waypoints</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">ta</span><span class="o">.</span><span class="n">SplineInterpolator</span><span class="p">(</span><span class="n">breaks</span><span class="p">,</span> <span class="n">waypoints</span><span class="p">)</span>  <span class="c1"># 官方示例同款 API</span>

    <span class="c1"># 2) 速度/加速度约束（上下界格式）</span>
    <span class="n">v_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">dof</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">v_max</span><span class="p">))</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">v_max</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">v_max</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">a_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">dof</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">a_max</span><span class="p">))</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">a_max</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a_max</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">v_max</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="n">dof</span><span class="p">,)</span> <span class="ow">or</span> <span class="n">a_max</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="n">dof</span><span class="p">,):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;v_max/a_max 需为标量或 shape=(6,)&quot;</span><span class="p">)</span>

    <span class="n">v_bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">v_max</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">v_max</span><span class="p">)))</span>  <span class="c1"># (2,6) -&gt; [v_min; v_max]</span>
    <span class="n">a_bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">a_max</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">a_max</span><span class="p">)))</span>  <span class="c1"># (2,6) -&gt; [a_min; a_max]</span>

    <span class="n">pc_vel</span> <span class="o">=</span> <span class="n">constraint</span><span class="o">.</span><span class="n">JointVelocityConstraint</span><span class="p">(</span><span class="n">v_bounds</span><span class="p">)</span>
    <span class="n">pc_acc</span> <span class="o">=</span> <span class="n">constraint</span><span class="o">.</span><span class="n">JointAccelerationConstraint</span><span class="p">(</span><span class="n">a_bounds</span><span class="p">)</span>

    <span class="c1"># 3) TOPPRA 主算法 + 常用参数化器（常用且满足边界/约束）</span>
    <span class="n">gridpoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">duration</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">grid_n</span><span class="p">))</span>
    <span class="n">instance</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">TOPPRA</span><span class="p">([</span><span class="n">pc_vel</span><span class="p">,</span> <span class="n">pc_acc</span><span class="p">],</span> <span class="n">path</span><span class="p">,</span> <span class="n">gridpoints</span><span class="o">=</span><span class="n">gridpoints</span><span class="p">,</span> <span class="n">parametrizer</span><span class="o">=</span><span class="s2">&quot;ParametrizeConstAccel&quot;</span><span class="p">)</span>

    <span class="c1"># 4) 求解时间参数化，得到可按时间采样的 jnt_traj</span>
    <span class="n">jnt_traj</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">compute_trajectory</span><span class="p">(</span><span class="n">sd_start</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">sd_end</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">jnt_traj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;TOPPRA 求解失败：给定约束下不可行，或路径异常。&quot;</span><span class="p">)</span>

    <span class="c1"># 5) 按 dt 采样</span>
    <span class="n">T</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">jnt_traj</span><span class="o">.</span><span class="n">duration</span><span class="p">)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">T</span> <span class="o">/</span> <span class="n">dt</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>

    <span class="n">q</span>   <span class="o">=</span> <span class="n">jnt_traj</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">qd</span>  <span class="o">=</span> <span class="n">jnt_traj</span><span class="o">.</span><span class="n">evald</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">qdd</span> <span class="o">=</span> <span class="n">jnt_traj</span><span class="o">.</span><span class="n">evaldd</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">q</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">qd</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">qdd</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.CurveMotionDomainService" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">CurveMotionDomainService</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">CurveMotionDomainService</span><span class="p">(</span><span class="n">kinematic_solver</span><span class="p">:</span> <span class="n">KinematicDomainService</span><span class="p">,</span> <span class="n">v_max</span><span class="o">=</span><span class="p">[</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">a_max</span><span class="o">=</span><span class="p">[</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">8</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">j_max</span><span class="o">=</span><span class="p">[</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">16</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>曲线运动规划服务。</p>
<p>提供基于弧长参数化的空间曲线规划、姿态平滑插值以及基于 TOPPRA 的时间参数化功能。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CurveMotionDomainService.v_max">v_max</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>各关节最大速度 (rad/s)。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CurveMotionDomainService.a_max">a_max</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>各关节最大加速度 (rad/s²)。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CurveMotionDomainService.j_max">j_max</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>各关节最大加加速度 (rad/s³)。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CurveMotionDomainService.dt">dt</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>时间步长 (s)。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CurveMotionDomainService.kinematic_solver">kinematic_solver</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="KinematicDomainService (controller.domain.services.algorithm.kinematic_domain_service.KinematicDomainService)" href="../../../domain/algorithm/#controller.domain.services.algorithm.kinematic_domain_service.KinematicDomainService">KinematicDomainService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运动学求解器实例。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化曲线运动服务。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>kinematic_solver</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="KinematicDomainService (controller.domain.services.algorithm.kinematic_domain_service.KinematicDomainService)" href="../../../domain/algorithm/#controller.domain.services.algorithm.kinematic_domain_service.KinematicDomainService">KinematicDomainService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运动学求解器服务实例。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>v_max</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>最大速度列表. Defaults to [pi/4]*6.</p>
              </div>
            </td>
            <td>
                  <code>[<span title="math.pi">pi</span> / 4] * 6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>a_max</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>最大加速度列表. Defaults to [pi/8]*6.</p>
              </div>
            </td>
            <td>
                  <code>[<span title="math.pi">pi</span> / 8] * 6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>j_max</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>最大加加速度列表. Defaults to [pi/16]*6.</p>
              </div>
            </td>
            <td>
                  <code>[<span title="math.pi">pi</span> / 16] * 6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dt</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>采样时间步长. Defaults to 0.01.</p>
              </div>
            </td>
            <td>
                  <code>0.01</code>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">kinematic_solver</span><span class="p">:</span> <span class="n">KinematicDomainService</span><span class="p">,</span>
    <span class="n">v_max</span><span class="o">=</span><span class="p">[</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> 
    <span class="n">a_max</span><span class="o">=</span><span class="p">[</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">8</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> 
    <span class="n">j_max</span><span class="o">=</span><span class="p">[</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">16</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> 
    <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化曲线运动服务。</span>

<span class="sd">    Args:</span>
<span class="sd">        kinematic_solver: 运动学求解器服务实例。</span>
<span class="sd">        v_max (list[float], optional): 最大速度列表. Defaults to [pi/4]*6.</span>
<span class="sd">        a_max (list[float], optional): 最大加速度列表. Defaults to [pi/8]*6.</span>
<span class="sd">        j_max (list[float], optional): 最大加加速度列表. Defaults to [pi/16]*6.</span>
<span class="sd">        dt (float, optional): 采样时间步长. Defaults to 0.01.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">v_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">v_max</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">a_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a_max</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">j_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">j_max</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_solver</span> <span class="o">=</span> <span class="n">kinematic_solver</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nearest_position</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CurveMotionDomainService.clamp" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clamp</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">clamp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>将值 x 限制在 [low, high] 区间内。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">clamp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;将值 x 限制在 [low, high] 区间内。&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">high</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CurveMotionDomainService.curve_motion" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">curve_motion</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">curve_motion</span><span class="p">(</span><span class="n">pos_fun</span><span class="p">,</span> <span class="n">u0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">u1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">start_position</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">end_position</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ds</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.002</span><span class="p">,</span> <span class="n">include_end</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">orientation_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;slerp&#39;</span><span class="p">,</span> <span class="n">tool_axis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">up_hint</span><span class="p">:</span> <span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]))</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>执行曲线运动规划。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pos_fun</code>
            </td>
            <td>
                  <code><span title="callable">callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>位置函数，接受参数 u 返回 (3,) 坐标。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>u0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>参数起始值。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>u1</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>参数终止值。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>start_position</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>起点关节角度。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_position</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>终点关节角度。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ds</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>采样弧长步长. Defaults to 0.002.</p>
              </div>
            </td>
            <td>
                  <code>0.002</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>include_end</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否包含终点. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>orientation_mode</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>姿态插值模式 ('fixed'|'slerp'|'tangent'). Defaults to "slerp".</p>
              </div>
            </td>
            <td>
                  <code>&#39;slerp&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tool_axis</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>工具轴方向 ('x'|'y'|'z'). Defaults to "z".</p>
              </div>
            </td>
            <td>
                  <code>&#39;z&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>up_hint</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>向上向量提示，用于切向跟随模式. Defaults to [0, 0, 1.0].</p>
              </div>
            </td>
            <td>
                  <code><span title="numpy.array">array</span>([0, 0, 1.0])</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code><span title="tuple">tuple</span>[<span title="list">list</span>[<span title="float">float</span>], <span title="list">list</span>[<span title="list">list</span>[<span title="float">float</span>]], <span title="list">list</span>[<span title="list">list</span>[<span title="float">float</span>]], <span title="list">list</span>[<span title="list">list</span>[<span title="float">float</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(t_list, positions, qd, qdd)
- t_list: 时间戳列表
- positions: 关节角度轨迹列表
- qd: 关节速度轨迹列表
- qdd: 关节加速度轨迹列表</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">引发：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>如果 orientation_mode 无效或 slerp 模式下未提供 end_position。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">curve_motion</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">pos_fun</span><span class="p">,</span>  <span class="c1"># callable u -&gt; (3,)</span>
        <span class="n">u0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">u1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">start_position</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
        <span class="n">end_position</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ds</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.002</span><span class="p">,</span>
        <span class="n">include_end</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">orientation_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;slerp&quot;</span><span class="p">,</span>
        <span class="n">tool_axis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span>
        <span class="n">up_hint</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;执行曲线运动规划。</span>

<span class="sd">    Args:</span>
<span class="sd">        pos_fun (callable): 位置函数，接受参数 u 返回 (3,) 坐标。</span>
<span class="sd">        u0 (float): 参数起始值。</span>
<span class="sd">        u1 (float): 参数终止值。</span>
<span class="sd">        start_position (list[float]): 起点关节角度。</span>
<span class="sd">        end_position (list[float] | None): 终点关节角度。</span>
<span class="sd">        ds (float, optional): 采样弧长步长. Defaults to 0.002.</span>
<span class="sd">        include_end (bool, optional): 是否包含终点. Defaults to True.</span>
<span class="sd">        orientation_mode (str, optional): 姿态插值模式 (&#39;fixed&#39;|&#39;slerp&#39;|&#39;tangent&#39;). Defaults to &quot;slerp&quot;.</span>
<span class="sd">        tool_axis (str, optional): 工具轴方向 (&#39;x&#39;|&#39;y&#39;|&#39;z&#39;). Defaults to &quot;z&quot;.</span>
<span class="sd">        up_hint (np.ndarray, optional): 向上向量提示，用于切向跟随模式. Defaults to [0, 0, 1.0].</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: (t_list, positions, qd, qdd)</span>
<span class="sd">            - t_list: 时间戳列表</span>
<span class="sd">            - positions: 关节角度轨迹列表</span>
<span class="sd">            - qd: 关节速度轨迹列表</span>
<span class="sd">            - qdd: 关节加速度轨迹列表</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: 如果 orientation_mode 无效或 slerp 模式下未提供 end_position。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 起点姿态来自起点关节角的正解</span>
    <span class="n">start_quat</span><span class="p">,</span> <span class="n">start_pos_fk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_solver</span><span class="o">.</span><span class="n">get_gripper2base</span><span class="p">(</span><span class="n">start_position</span><span class="p">)</span>
    <span class="c1"># 1) 等弧长采样</span>
    <span class="n">pos_list</span><span class="p">,</span> <span class="n">u_eq</span><span class="p">,</span> <span class="n">n_seg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_parametric_equal_arclen</span><span class="p">(</span><span class="n">pos_fun</span><span class="p">,</span> <span class="n">u0</span><span class="p">,</span> <span class="n">u1</span><span class="p">,</span> <span class="n">ds</span><span class="p">,</span> <span class="n">include_end</span><span class="p">)</span>

    <span class="c1"># 2) 姿态生成</span>
    <span class="k">if</span> <span class="n">orientation_mode</span> <span class="o">==</span> <span class="s2">&quot;fixed&quot;</span><span class="p">:</span>
        <span class="n">quat_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_q_normalize</span><span class="p">(</span><span class="n">start_quat</span><span class="p">)[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:],</span> <span class="nb">len</span><span class="p">(</span><span class="n">pos_list</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">orientation_mode</span> <span class="o">==</span> <span class="s2">&quot;slerp&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">end_position</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;slerp 模式需要提供 end_position 以确定终止姿态。&quot;</span><span class="p">)</span>
        <span class="n">end_quat</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_solver</span><span class="o">.</span><span class="n">get_gripper2base</span><span class="p">(</span><span class="n">end_position</span><span class="p">)</span>
        <span class="n">q0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_q_normalize</span><span class="p">(</span><span class="n">start_quat</span><span class="p">)</span>
        <span class="n">q1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_q_normalize</span><span class="p">(</span><span class="n">end_quat</span><span class="p">)</span>
        <span class="n">tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">pos_list</span><span class="p">))</span>
        <span class="n">quat_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_q_slerp</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">ti</span><span class="p">)</span> <span class="k">for</span> <span class="n">ti</span> <span class="ow">in</span> <span class="n">tau</span><span class="p">])</span>

    <span class="k">elif</span> <span class="n">orientation_mode</span> <span class="o">==</span> <span class="s2">&quot;tangent&quot;</span><span class="p">:</span>
        <span class="n">quat_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_quat_follow_tangent</span><span class="p">(</span><span class="n">pos_list</span><span class="p">,</span> <span class="n">tool_axis</span><span class="o">=</span><span class="n">tool_axis</span><span class="p">,</span> <span class="n">up_hint</span><span class="o">=</span><span class="n">up_hint</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;orientation_mode 必须是 {&#39;fixed&#39;,&#39;slerp&#39;,&#39;tangent&#39;}&quot;</span><span class="p">)</span>

    <span class="c1"># 3) 原有平滑/IK/TOPPRA 管线复用</span>
    <span class="n">t_list</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">qd</span><span class="p">,</span> <span class="n">qdd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span><span class="n">quat_list</span><span class="p">,</span> <span class="n">pos_list</span><span class="p">,</span> <span class="n">n_seg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t_list</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">qd</span><span class="p">,</span> <span class="n">qdd</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CurveMotionDomainService.make_pos_fun_spline" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">make_pos_fun_spline</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_pos_fun_spline</span><span class="p">(</span><span class="n">start_position</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">end_position</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">mid_points</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">bc_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;natural&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">callable</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>构造基于三次样条的位置函数。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>start_position</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>起点关节角度。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_position</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>终点关节角度。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mid_points</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>中间点坐标列表 (N, 3)。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bc_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>边界条件类型. Defaults to "natural".</p>
              </div>
            </td>
            <td>
                  <code>&#39;natural&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code><span title="tuple">tuple</span>[<span title="callable">callable</span>, <span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(pos_fun, s)
- pos_fun: 位置函数 callable
- s: 累积弦长数组</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">引发：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>如果点集形状不正确。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_pos_fun_spline</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">start_position</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="n">end_position</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="n">mid_points</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> 
    <span class="n">bc_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;natural&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">callable</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;构造基于三次样条的位置函数。</span>

<span class="sd">    Args:</span>
<span class="sd">        start_position (list[float]): 起点关节角度。</span>
<span class="sd">        end_position (list[float]): 终点关节角度。</span>
<span class="sd">        mid_points (list): 中间点坐标列表 (N, 3)。</span>
<span class="sd">        bc_type (str, optional): 边界条件类型. Defaults to &quot;natural&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: (pos_fun, s)</span>
<span class="sd">            - pos_fun: 位置函数 callable</span>
<span class="sd">            - s: 累积弦长数组</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: 如果点集形状不正确。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">start_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_solver</span><span class="o">.</span><span class="n">get_gripper2base</span><span class="p">(</span><span class="n">start_position</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">end_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_solver</span><span class="o">.</span><span class="n">get_gripper2base</span><span class="p">(</span><span class="n">end_position</span><span class="p">)</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">start_pos</span><span class="p">,</span> <span class="n">mid_points</span><span class="p">,</span> <span class="n">end_pos</span><span class="p">])</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">P</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">P</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">P</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;points 形状必须是 (N,3) 或 (N,2)，且 N&gt;=2&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">P</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">P</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">P</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))])</span>  <span class="c1"># 2D 自动补 z=0</span>

    <span class="c1"># --- 弦长参数化，避免参数拥挤 ---</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">d</span><span class="p">)])</span>
    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;所有点重合，无法构造曲线&quot;</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">s</span> <span class="o">/</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># 归一化到 [0,1]</span>

    <span class="c1"># 分别构造 x,y,z 的样条</span>
    <span class="n">cs_x</span> <span class="o">=</span> <span class="n">CubicSpline</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">P</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">bc_type</span><span class="o">=</span><span class="n">bc_type</span><span class="p">)</span>
    <span class="n">cs_y</span> <span class="o">=</span> <span class="n">CubicSpline</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">P</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">bc_type</span><span class="o">=</span><span class="n">bc_type</span><span class="p">)</span>
    <span class="n">cs_z</span> <span class="o">=</span> <span class="n">CubicSpline</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">P</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">bc_type</span><span class="o">=</span><span class="n">bc_type</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_eval</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="c1"># 可选：夹紧到 [0,1]，避免数值越界</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">cs_x</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">cs_y</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">cs_z</span><span class="p">(</span><span class="n">u</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># (..., 3)</span>
        <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># 标量 u -&gt; (3,)</span>
            <span class="k">return</span> <span class="n">X</span>
        <span class="k">return</span> <span class="n">X</span>  <span class="c1"># 数组 u -&gt; (M,3)</span>

    <span class="k">return</span> <span class="n">_eval</span><span class="p">,</span> <span class="n">s</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CurveMotionDomainService.sample_parametric_equal_arclen" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sample_parametric_equal_arclen</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">sample_parametric_equal_arclen</span><span class="p">(</span><span class="n">pos_fun</span><span class="p">,</span> <span class="n">u0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">u1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ds</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.002</span><span class="p">,</span> <span class="n">include_end</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">dense</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4000</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>对参数曲线 r(u) 做等弧长采样。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pos_fun</code>
            </td>
            <td>
                  <code><span title="callable">callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>参数曲线函数 r(u)。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>u0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>参数起始值。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>u1</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>参数终止值。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ds</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>目标弧长采样间隔. Defaults to 0.002.</p>
              </div>
            </td>
            <td>
                  <code>0.002</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>include_end</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>结果是否必须包含终点. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dense</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>初始密采样的点数. Defaults to 4000.</p>
              </div>
            </td>
            <td>
                  <code>4000</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code><span title="tuple">tuple</span>[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(pos_list, u_eq, n_seg)
- pos_list: 等弧长采样后的坐标列表 (M, 3)
- u_eq: 对应的参数值列表 (M,)
- n_seg: 分段数</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sample_parametric_equal_arclen</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">pos_fun</span><span class="p">,</span>  <span class="c1"># callable: u -&gt; (3,) numpy array</span>
        <span class="n">u0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">u1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">ds</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.002</span><span class="p">,</span>
        <span class="n">include_end</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">dense</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4000</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;对参数曲线 r(u) 做等弧长采样。</span>

<span class="sd">    Args:</span>
<span class="sd">        pos_fun (callable): 参数曲线函数 r(u)。</span>
<span class="sd">        u0 (float): 参数起始值。</span>
<span class="sd">        u1 (float): 参数终止值。</span>
<span class="sd">        ds (float, optional): 目标弧长采样间隔. Defaults to 0.002.</span>
<span class="sd">        include_end (bool, optional): 结果是否必须包含终点. Defaults to True.</span>
<span class="sd">        dense (int, optional): 初始密采样的点数. Defaults to 4000.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: (pos_list, u_eq, n_seg)</span>
<span class="sd">            - pos_list: 等弧长采样后的坐标列表 (M, 3)</span>
<span class="sd">            - u_eq: 对应的参数值列表 (M,)</span>
<span class="sd">            - n_seg: 分段数</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 1) 先在参数上做均匀密采样，估算弧长</span>
    <span class="n">u_dense</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">u0</span><span class="p">,</span> <span class="n">u1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">u1</span> <span class="o">-</span> <span class="n">u0</span><span class="p">)</span> <span class="o">*</span> <span class="n">dense</span><span class="p">)))</span>
    <span class="n">XYZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pos_fun</span><span class="p">(</span><span class="n">ui</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">ui</span> <span class="ow">in</span> <span class="n">u_dense</span><span class="p">])</span>
    <span class="n">seg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">XYZ</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">s_cum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">seg</span><span class="p">)])</span>
    <span class="n">L</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">s_cum</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">L</span> <span class="o">&lt;</span> <span class="mf">1e-12</span><span class="p">:</span>
        <span class="c1"># 退化：几乎零长</span>
        <span class="n">pos_list</span> <span class="o">=</span> <span class="n">XYZ</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">:]</span> <span class="k">if</span> <span class="n">include_end</span> <span class="k">else</span> <span class="n">XYZ</span><span class="p">[[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:]</span>
        <span class="n">u_eq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">u_dense</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">u_dense</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span> <span class="k">if</span> <span class="n">include_end</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">u_dense</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="k">return</span> <span class="n">pos_list</span><span class="p">,</span> <span class="n">u_eq</span><span class="p">,</span> <span class="mf">0.0</span>

    <span class="c1"># 2) 弧长 -&gt; u 的反查，用插值近似</span>
    <span class="n">s2u</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">s_cum</span><span class="p">,</span> <span class="n">u_dense</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="p">(</span><span class="n">u_dense</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">u_dense</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

    <span class="c1"># 3) 目标等弧长序列</span>
    <span class="n">n_seg</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">L</span> <span class="o">/</span> <span class="n">ds</span><span class="p">)))</span>
    <span class="n">s_target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">n_seg</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">include_end</span> <span class="k">else</span> <span class="n">n_seg</span><span class="p">)</span>
    <span class="n">u_eq</span> <span class="o">=</span> <span class="n">s2u</span><span class="p">(</span><span class="n">s_target</span><span class="p">)</span>

    <span class="c1"># 4) 得到等弧长位置</span>
    <span class="n">pos_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pos_fun</span><span class="p">(</span><span class="n">ui</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">ui</span> <span class="ow">in</span> <span class="n">u_eq</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">pos_list</span><span class="p">,</span> <span class="n">u_eq</span><span class="p">,</span> <span class="n">n_seg</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CurveMotionDomainService.wrap_to_pi" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">wrap_to_pi</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">wrap_to_pi</span><span class="p">(</span><span class="n">q</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>将角度包裹到 (-pi, pi]，避免 2π 跳变影响计算。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">wrap_to_pi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;将角度包裹到 (-pi, pi]，避免 2π 跳变影响计算。&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">q</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CurveMotionDomainService.ensure_2d_array" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ensure_2d_array</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">ensure_2d_array</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>将输入转换为二维数组 (N, dof) 并做基本校验。</p>
<h6 id="controller.shared.config.service_registry.CurveMotionDomainService.ensure_2d_array--raises">Raises</h6>
<p>ValueError
    当路标数少于 2（缺少起点或终点）时抛出。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ensure_2d_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    将输入转换为二维数组 (N, dof) 并做基本校验。</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        当路标数少于 2（缺少起点或终点）时抛出。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">q</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">q</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Q_waypoints 至少需要两个点（起点与终点）且维度为 (N, dof)。&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">q</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CurveMotionDomainService.toppra_time_parameterize" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">toppra_time_parameterize</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">toppra_time_parameterize</span><span class="p">(</span><span class="n">waypoints</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">v_max</span><span class="p">:</span> <span class="n">ndarray</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span> <span class="n">a_max</span><span class="p">:</span> <span class="n">ndarray</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span> <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">grid_n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>使用 TOPPRA 对路径进行时间参数化。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>waypoints</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>路径点数组 (N, dof)。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>v_max</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>最大速度约束。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>a_max</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>最大加速度约束。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dt</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>输出轨迹的时间步长. Defaults to 0.01.</p>
              </div>
            </td>
            <td>
                  <code>0.01</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>grid_n</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TOPPRA 离散化网格点数. Defaults to 400.</p>
              </div>
            </td>
            <td>
                  <code>400</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code><span title="tuple">tuple</span>[<span title="list">list</span>[<span title="float">float</span>], <span title="list">list</span>[<span title="list">list</span>[<span title="float">float</span>]], <span title="list">list</span>[<span title="list">list</span>[<span title="float">float</span>]], <span title="list">list</span>[<span title="list">list</span>[<span title="float">float</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(t, q, qd, qdd)
- t: 时间戳列表
- q: 关节位置列表
- qd: 关节速度列表
- qdd: 关节加速度列表</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">引发：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>如果 waypoints 维度不正确或约束格式错误。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>如果 TOPPRA 求解失败。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">toppra_time_parameterize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                             <span class="n">waypoints</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
                             <span class="n">v_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span>
                             <span class="n">a_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span>
                             <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
                             <span class="n">grid_n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span>
                             <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;使用 TOPPRA 对路径进行时间参数化。</span>

<span class="sd">    Args:</span>
<span class="sd">        waypoints (np.ndarray): 路径点数组 (N, dof)。</span>
<span class="sd">        v_max (np.ndarray | float): 最大速度约束。</span>
<span class="sd">        a_max (np.ndarray | float): 最大加速度约束。</span>
<span class="sd">        dt (float, optional): 输出轨迹的时间步长. Defaults to 0.01.</span>
<span class="sd">        grid_n (int, optional): TOPPRA 离散化网格点数. Defaults to 400.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: (t, q, qd, qdd)</span>
<span class="sd">            - t: 时间戳列表</span>
<span class="sd">            - q: 关节位置列表</span>
<span class="sd">            - qd: 关节速度列表</span>
<span class="sd">            - qdd: 关节加速度列表</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: 如果 waypoints 维度不正确或约束格式错误。</span>
<span class="sd">        RuntimeError: 如果 TOPPRA 求解失败。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">waypoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">waypoints</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">waypoints</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">waypoints</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">6</span> <span class="ow">or</span> <span class="n">waypoints</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;waypoints 必须是 (N,6) 且 N&gt;=2&quot;</span><span class="p">)</span>

    <span class="n">dof</span> <span class="o">=</span> <span class="n">waypoints</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># 1) 几何路径：用样条在路径参数 s∈[0,1] 上插值</span>
    <span class="n">breaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">waypoints</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">ta</span><span class="o">.</span><span class="n">SplineInterpolator</span><span class="p">(</span><span class="n">breaks</span><span class="p">,</span> <span class="n">waypoints</span><span class="p">)</span>  <span class="c1"># 官方示例同款 API</span>

    <span class="c1"># 2) 速度/加速度约束（上下界格式）</span>
    <span class="n">v_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">dof</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">v_max</span><span class="p">))</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">v_max</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">v_max</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">a_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">dof</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">a_max</span><span class="p">))</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">a_max</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a_max</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">v_max</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="n">dof</span><span class="p">,)</span> <span class="ow">or</span> <span class="n">a_max</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="n">dof</span><span class="p">,):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;v_max/a_max 需为标量或 shape=(6,)&quot;</span><span class="p">)</span>

    <span class="n">v_bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">v_max</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">v_max</span><span class="p">)))</span>  <span class="c1"># (2,6) -&gt; [v_min; v_max]</span>
    <span class="n">a_bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">a_max</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">a_max</span><span class="p">)))</span>  <span class="c1"># (2,6) -&gt; [a_min; a_max]</span>

    <span class="n">pc_vel</span> <span class="o">=</span> <span class="n">constraint</span><span class="o">.</span><span class="n">JointVelocityConstraint</span><span class="p">(</span><span class="n">v_bounds</span><span class="p">)</span>
    <span class="n">pc_acc</span> <span class="o">=</span> <span class="n">constraint</span><span class="o">.</span><span class="n">JointAccelerationConstraint</span><span class="p">(</span><span class="n">a_bounds</span><span class="p">)</span>

    <span class="c1"># 3) TOPPRA 主算法 + 常用参数化器（常用且满足边界/约束）</span>
    <span class="n">gridpoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">duration</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">grid_n</span><span class="p">))</span>
    <span class="n">instance</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">TOPPRA</span><span class="p">([</span><span class="n">pc_vel</span><span class="p">,</span> <span class="n">pc_acc</span><span class="p">],</span> <span class="n">path</span><span class="p">,</span> <span class="n">gridpoints</span><span class="o">=</span><span class="n">gridpoints</span><span class="p">,</span> <span class="n">parametrizer</span><span class="o">=</span><span class="s2">&quot;ParametrizeConstAccel&quot;</span><span class="p">)</span>

    <span class="c1"># 4) 求解时间参数化，得到可按时间采样的 jnt_traj</span>
    <span class="n">jnt_traj</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">compute_trajectory</span><span class="p">(</span><span class="n">sd_start</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">sd_end</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">jnt_traj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;TOPPRA 求解失败：给定约束下不可行，或路径异常。&quot;</span><span class="p">)</span>

    <span class="c1"># 5) 按 dt 采样</span>
    <span class="n">T</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">jnt_traj</span><span class="o">.</span><span class="n">duration</span><span class="p">)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">T</span> <span class="o">/</span> <span class="n">dt</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>

    <span class="n">q</span> <span class="o">=</span> <span class="n">jnt_traj</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">qd</span> <span class="o">=</span> <span class="n">jnt_traj</span><span class="o">.</span><span class="n">evald</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">qdd</span> <span class="o">=</span> <span class="n">jnt_traj</span><span class="o">.</span><span class="n">evaldd</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">q</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">qd</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">qdd</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.SerialDomainService" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">SerialDomainService</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">SerialDomainService</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="PyQt5.QtCore.QObject">QObject</span></code></p>



        <p>串口领域服务 - 管理串口连接的核心业务逻辑</p>

        <p>初始化串口领域服务</p>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化串口领域服务&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="c1"># 串口相关对象</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">serial_adapter</span> <span class="o">=</span> <span class="n">SerialAdapter</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">serial_reader</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SerialReader</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">serial_writer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SerialWriter</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># 线程管理</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reader_thread</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SerialReaderThread</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writer_thread</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SerialWriterThread</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialDomainService.scan_available_ports" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">scan_available_ports</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">scan_available_ports</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>扫描可用端口列表</p>


<details class="返回" open>
  <summary>返回</summary>
  <p>List[str]: 可用端口名称列表</p>
</details>

            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">scan_available_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    扫描可用端口列表</span>

<span class="sd">    返回:</span>
<span class="sd">        List[str]: 可用端口名称列表</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PortScanner</span><span class="o">.</span><span class="n">scan_ports</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;扫描端口失败: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialDomainService.get_port_info" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_port_info</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_port_info</span><span class="p">(</span><span class="n">port_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取指定端口信息</p>


<details class="参数" open>
  <summary>参数</summary>
  <p>port_name: 端口名称</p>
</details>

<details class="返回" open>
  <summary>返回</summary>
  <p>Optional[Dict[str, str]]: 端口信息字典，失败时返回None</p>
</details>

            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_port_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">port_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    获取指定端口信息</span>

<span class="sd">    参数:</span>
<span class="sd">        port_name: 端口名称</span>

<span class="sd">    返回:</span>
<span class="sd">        Optional[Dict[str, str]]: 端口信息字典，失败时返回None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PortScanner</span><span class="o">.</span><span class="n">get_port_info</span><span class="p">(</span><span class="n">port_name</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;获取端口信息失败: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialDomainService.get_current_port" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_current_port</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_current_port</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取当前连接的端口名称</p>


<details class="返回" open>
  <summary>返回</summary>
  <p>Optional[str]: 端口名称，未连接时返回None</p>
</details>

            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_current_port</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    获取当前连接的端口名称</span>

<span class="sd">    返回:</span>
<span class="sd">        Optional[str]: 端口名称，未连接时返回None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_adapter</span><span class="o">.</span><span class="n">get_port_name</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialDomainService.is_connected" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">is_connected</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_connected</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>检查串口是否已连接</p>


<details class="返回" open>
  <summary>返回</summary>
  <p>bool: 是否已连接</p>
</details>

            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    检查串口是否已连接</span>

<span class="sd">    返回:</span>
<span class="sd">        bool: 是否已连接</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_adapter</span><span class="o">.</span><span class="n">is_connected</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialDomainService.connect_port" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">connect_port</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">connect_port</span><span class="p">(</span><span class="n">port</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>连接串口</p>


<details class="参数" open>
  <summary>参数</summary>
  <p>port: 串口名称
config: 串口配置参数</p>
</details>

<details class="返回" open>
  <summary>返回</summary>
  <p>bool: 连接是否成功</p>
</details>

            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">connect_port</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    连接串口</span>

<span class="sd">    参数:</span>
<span class="sd">        port: 串口名称</span>
<span class="sd">        config: 串口配置参数</span>

<span class="sd">    返回:</span>
<span class="sd">        bool: 连接是否成功</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 如果已连接，先断开</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_connected</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disconnect_port</span><span class="p">()</span>

        <span class="c1"># 尝试连接串口</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_adapter</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">port</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;连接端口 </span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2"> 失败&quot;</span><span class="p">)</span>

        <span class="c1"># 获取串口对象</span>
        <span class="n">serial_port</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_adapter</span><span class="o">.</span><span class="n">get_serial_port</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">serial_port</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;获取串口对象失败&quot;</span><span class="p">)</span>

        <span class="c1"># 创建读写器</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serial_reader</span> <span class="o">=</span> <span class="n">SerialReader</span><span class="p">(</span><span class="n">serial_port</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serial_writer</span> <span class="o">=</span> <span class="n">SerialWriter</span><span class="p">(</span><span class="n">serial_port</span><span class="p">)</span>

        <span class="c1"># 连接Infrastructure层信号到Domain层</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_connect_infrastructure_signals</span><span class="p">()</span>

        <span class="c1"># 启动线程</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_start_threads</span><span class="p">()</span>

        <span class="c1"># 发送连接成功信号</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connection_status_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disconnect_port</span><span class="p">()</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;连接失败: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialDomainService.disconnect_port" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">disconnect_port</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">disconnect_port</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>断开串口连接</p>


<details class="返回" open>
  <summary>返回</summary>
  <p>bool: 断开是否成功</p>
</details>

            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">disconnect_port</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    断开串口连接</span>

<span class="sd">    返回:</span>
<span class="sd">        bool: 断开是否成功</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 停止线程</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_threads</span><span class="p">()</span>

        <span class="c1"># 断开信号连接</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_disconnect_infrastructure_signals</span><span class="p">()</span>

        <span class="c1"># 停止读写器</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_reader</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">serial_reader</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">serial_reader</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_writer</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">serial_writer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">serial_writer</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># 断开适配器连接</span>
        <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_adapter</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

        <span class="c1"># 发送断开连接信号</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connection_status_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">success</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;断开连接失败: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialDomainService.send_data" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">send_data</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">send_data</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>发送数据</p>


<details class="参数" open>
  <summary>参数</summary>
  <p>data: 要发送的数据</p>
</details>

<details class="返回" open>
  <summary>返回</summary>
  <p>bool: 是否成功添加到发送队列</p>
</details>

            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">send_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    发送数据</span>

<span class="sd">    参数:</span>
<span class="sd">        data: 要发送的数据</span>

<span class="sd">    返回:</span>
<span class="sd">        bool: 是否成功添加到发送队列</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_writer</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_connected</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serial_writer</span><span class="o">.</span><span class="n">add_to_queue</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;串口未连接，无法发送数据&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialDomainService.cleanup" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">cleanup</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">cleanup</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>清理资源</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;清理资源&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disconnect_port</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># 忽略清理时的异常</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.MotionRunner" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MotionRunner</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">MotionRunner</span><span class="p">(</span><span class="n">serial_domain_service</span><span class="p">:</span> <span class="n">SerialDomainService</span><span class="p">,</span> <span class="n">message_domain_service</span><span class="p">:</span> <span class="n">MessageDomainService</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="PyQt5.QtCore.QObject">QObject</span></code></p>



        <p>运动执行器。</p>
<p>负责按时间步长定时发送运动和夹爪指令。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionRunner.motion_msg_signal">motion_msg_signal</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运动消息发送信号，携带 (消息内容, 类型)。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionRunner.serial_domain_service">serial_domain_service</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>串口领域服务。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionRunner.message_domain_service">message_domain_service</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>消息领域服务。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionRunner.data_list">data_list</span></code></td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>待发送的数据列表。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionRunner.data_index">data_index</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>当前发送索引。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionRunner.timer">timer</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.QTimer">QTimer</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>定时器。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化运动执行器。</p>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/domain/services/motion/motion_runner.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">serial_domain_service</span><span class="p">:</span> <span class="n">SerialDomainService</span><span class="p">,</span> 
    <span class="n">message_domain_service</span><span class="p">:</span> <span class="n">MessageDomainService</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化运动执行器。&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">serial_domain_service</span> <span class="o">=</span> <span class="n">serial_domain_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">message_domain_service</span> <span class="o">=</span> <span class="n">message_domain_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">timer</span> <span class="o">=</span> <span class="n">QTimer</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">setInterval</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">motion_timeout</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionRunner.add_motion_data" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_motion_data</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_motion_data</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>添加运动数据点序列。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>positions</code>
            </td>
            <td>
                  <code><span title="list">list</span> | <span title="np.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>关节角度列表序列。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/motion/motion_runner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_motion_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">positions</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;添加运动数据点序列。</span>

<span class="sd">    Args:</span>
<span class="sd">        positions (list | np.ndarray): 关节角度列表序列。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
        <span class="n">msg_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;control&#39;</span><span class="p">:</span> <span class="mh">0x06</span><span class="p">,</span>
            <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="mh">0x08</span><span class="p">,</span>
            <span class="s1">&#39;joint_angles&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">message_domain_service</span><span class="o">.</span><span class="n">encode_message</span><span class="p">(</span><span class="o">**</span><span class="n">msg_dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionRunner.add_gripper_data" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_gripper_data</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_gripper_data</span><span class="p">(</span><span class="n">effector_mode</span><span class="p">,</span> <span class="n">effector_data</span><span class="p">,</span> <span class="n">pre_delay</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">post_delay</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>添加夹爪命令。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>effector_mode</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>夹爪模式。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>effector_data</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>夹爪参数。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pre_delay</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>前置等待时间（秒）. Defaults to 0.0.</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>post_delay</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>后置等待时间（秒）. Defaults to 1.0.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/motion/motion_runner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_gripper_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">effector_mode</span><span class="p">,</span> <span class="n">effector_data</span><span class="p">,</span> <span class="n">pre_delay</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">post_delay</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;添加夹爪命令。</span>

<span class="sd">    Args:</span>
<span class="sd">        effector_mode (int): 夹爪模式。</span>
<span class="sd">        effector_data (float): 夹爪参数。</span>
<span class="sd">        pre_delay (float, optional): 前置等待时间（秒）. Defaults to 0.0.</span>
<span class="sd">        post_delay (float, optional): 后置等待时间（秒）. Defaults to 1.0.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 添加前置延迟（如果&gt;0）</span>
    <span class="k">if</span> <span class="n">pre_delay</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DelayCommand</span><span class="p">(</span><span class="n">delay_s</span><span class="o">=</span><span class="n">pre_delay</span><span class="p">))</span>

    <span class="c1"># 添加夹爪命令</span>
    <span class="n">msg_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;control&#39;</span><span class="p">:</span> <span class="mh">0x00</span><span class="p">,</span>
        <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="mh">0x08</span><span class="p">,</span>
        <span class="s1">&#39;effector_mode&#39;</span><span class="p">:</span> <span class="n">effector_mode</span><span class="p">,</span>
        <span class="s1">&#39;effector_data&#39;</span><span class="p">:</span> <span class="n">effector_data</span>
    <span class="p">}</span>
    <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">message_domain_service</span><span class="o">.</span><span class="n">encode_message</span><span class="p">(</span><span class="o">**</span><span class="n">msg_dict</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="c1"># 添加后置延迟（如果&gt;0）</span>
    <span class="k">if</span> <span class="n">post_delay</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DelayCommand</span><span class="p">(</span><span class="n">delay_s</span><span class="o">=</span><span class="n">post_delay</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionRunner.start_motion" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">start_motion</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">start_motion</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>开始执行运动序列。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/motion/motion_runner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">start_motion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;开始执行运动序列。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionRunner.stop_motion" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">stop_motion</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">stop_motion</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>停止执行运动。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/motion/motion_runner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stop_motion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;停止执行运动。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionRunner.clear_data" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clear_data</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">clear_data</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>清空所有待发送数据。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/motion/motion_runner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">clear_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;清空所有待发送数据。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionRunner.motion_timeout" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">motion_timeout</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">motion_timeout</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>定时器回调函数，负责单步发送或延迟等待。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/motion/motion_runner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">motion_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;定时器回调函数，负责单步发送或延迟等待。&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_list</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="k">return</span>
    <span class="n">current_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data_index</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">current_item</span><span class="p">,</span> <span class="s1">&#39;is_delay&#39;</span><span class="p">):</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">current_item</span><span class="o">.</span><span class="n">delay_s</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serial_domain_service</span><span class="o">.</span><span class="n">send_data</span><span class="p">(</span><span class="n">current_item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">motion_msg_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">current_item</span><span class="p">,</span> <span class="s2">&quot;发送&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data_index</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.MotionConstructor" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MotionConstructor</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">MotionConstructor</span><span class="p">(</span><span class="n">motion_runner</span><span class="p">:</span> <span class="n">MotionRunner</span><span class="p">,</span> <span class="n">trajectory_planner</span><span class="p">:</span> <span class="n">TrajectoryPlanningService</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>运动构造器 - 领域服务。</p>
<p>职责：
1. 管理操作状态（执行/保存/预览）
2. 协调 TrajectoryPlanningService（规划）
3. 协调 MotionRunner（执行）</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionConstructor.motion_runner">motion_runner</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MotionRunner (controller.domain.services.motion.motion_runner.MotionRunner)" href="../../../domain/motion/#controller.domain.services.motion.motion_runner.MotionRunner">MotionRunner</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运动执行器。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionConstructor.trajectory_planner">trajectory_planner</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TrajectoryPlanningService (controller.domain.services.motion.trajectory_planning_service.TrajectoryPlanningService)" href="../../../domain/motion/#controller.domain.services.motion.trajectory_planning_service.TrajectoryPlanningService">TrajectoryPlanningService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>轨迹规划服务。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化运动构造器。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>motion_runner</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MotionRunner (controller.domain.services.motion.motion_runner.MotionRunner)" href="../../../domain/motion/#controller.domain.services.motion.motion_runner.MotionRunner">MotionRunner</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运动执行器。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>trajectory_planner</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TrajectoryPlanningService (controller.domain.services.motion.trajectory_planning_service.TrajectoryPlanningService)" href="../../../domain/motion/#controller.domain.services.motion.trajectory_planning_service.TrajectoryPlanningService">TrajectoryPlanningService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>轨迹规划服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/domain/services/motion/motion_constructor.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">motion_runner</span><span class="p">:</span> <span class="n">MotionRunner</span><span class="p">,</span>
    <span class="n">trajectory_planner</span><span class="p">:</span> <span class="n">TrajectoryPlanningService</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化运动构造器。</span>

<span class="sd">    Args:</span>
<span class="sd">        motion_runner (MotionRunner): 运动执行器。</span>
<span class="sd">        trajectory_planner (TrajectoryPlanningService): 轨迹规划服务。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">motion_runner</span> <span class="o">=</span> <span class="n">motion_runner</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">trajectory_planner</span> <span class="o">=</span> <span class="n">trajectory_planner</span>

    <span class="c1"># 统一的操作状态</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_operation_mode</span> <span class="o">=</span> <span class="n">MotionOperationMode</span><span class="o">.</span><span class="n">NONE</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_pending_tasks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_operation_context</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionConstructor.prepare_operation" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">prepare_operation</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">prepare_operation</span><span class="p">(</span><span class="n">mode</span><span class="p">:</span> <span class="n">MotionOperationMode</span><span class="p">,</span> <span class="n">tasks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">],</span> <span class="n">context</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>准备操作（统一入口）。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>mode</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MotionOperationMode (controller.domain.MotionOperationMode)" href="#controller.shared.config.service_registry.MotionOperationMode">MotionOperationMode</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>操作模式。
- EXECUTE: 执行运动
- SAVE: 保存轨迹
- PREVIEW: 预览轨迹</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tasks</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>任务列表。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>操作上下文。
- EXECUTE: {}
- SAVE: {"filename": "xxx", "type": "node|plan"}
- PREVIEW: {"type": "node|plan", "node_index": 0}</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/motion/motion_constructor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">prepare_operation</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">mode</span><span class="p">:</span> <span class="n">MotionOperationMode</span><span class="p">,</span>
    <span class="n">tasks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">],</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;准备操作（统一入口）。</span>

<span class="sd">    Args:</span>
<span class="sd">        mode (MotionOperationMode): 操作模式。</span>
<span class="sd">            - EXECUTE: 执行运动</span>
<span class="sd">            - SAVE: 保存轨迹</span>
<span class="sd">            - PREVIEW: 预览轨迹</span>
<span class="sd">        tasks (List[Dict]): 任务列表。</span>
<span class="sd">        context (Dict, optional): 操作上下文。</span>
<span class="sd">            - EXECUTE: {}</span>
<span class="sd">            - SAVE: {&quot;filename&quot;: &quot;xxx&quot;, &quot;type&quot;: &quot;node|plan&quot;}</span>
<span class="sd">            - PREVIEW: {&quot;type&quot;: &quot;node|plan&quot;, &quot;node_index&quot;: 0}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_operation_mode</span> <span class="o">=</span> <span class="n">mode</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_pending_tasks</span> <span class="o">=</span> <span class="n">tasks</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_operation_context</span> <span class="o">=</span> <span class="n">context</span> <span class="ow">or</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionConstructor.has_pending_operation" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">has_pending_operation</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">has_pending_operation</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>检查是否有待处理的操作。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True=有待处理的操作, False=无操作。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/motion/motion_constructor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">has_pending_operation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;检查是否有待处理的操作。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True=有待处理的操作, False=无操作。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_operation_mode</span> <span class="o">!=</span> <span class="n">MotionOperationMode</span><span class="o">.</span><span class="n">NONE</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionConstructor.get_operation_mode" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_operation_mode</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_operation_mode</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">MotionOperationMode</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取当前操作模式。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>MotionOperationMode</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="MotionOperationMode (controller.domain.MotionOperationMode)" href="#controller.shared.config.service_registry.MotionOperationMode">MotionOperationMode</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>当前操作模式枚举。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/motion/motion_constructor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_operation_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MotionOperationMode</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取当前操作模式。</span>

<span class="sd">    Returns:</span>
<span class="sd">        MotionOperationMode: 当前操作模式枚举。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_operation_mode</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionConstructor.get_pending_tasks" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_pending_tasks</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_pending_tasks</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取待处理的任务列表。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict]: 任务列表的副本。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/motion/motion_constructor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_pending_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取待处理的任务列表。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict]: 任务列表的副本。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending_tasks</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionConstructor.get_operation_context" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_operation_context</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_operation_context</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取操作上下文。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Dict</code></td>            <td>
                  <code><span title="typing.Dict">Dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>上下文字典的副本。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/motion/motion_constructor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_operation_context</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取操作上下文。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict: 上下文字典的副本。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_operation_context</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionConstructor.clear_operation" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clear_operation</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">clear_operation</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>清除操作状态。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/motion/motion_constructor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">clear_operation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;清除操作状态。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_operation_mode</span> <span class="o">=</span> <span class="n">MotionOperationMode</span><span class="o">.</span><span class="n">NONE</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_pending_tasks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_operation_context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionConstructor.execute_motion" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">execute_motion</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">execute_motion</span><span class="p">(</span><span class="n">start_position</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>执行运动（仅用于EXECUTE模式）。</p>
<p>流程：
1. 按任务顺序规划每个任务
2. 按顺序添加运动数据和夹爪命令
3. 清除状态</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>start_position</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>起始位置（当前关节角度）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">引发：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>如果当前模式不是EXECUTE。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/motion/motion_constructor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">execute_motion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_position</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;执行运动（仅用于EXECUTE模式）。</span>

<span class="sd">    流程：</span>
<span class="sd">    1. 按任务顺序规划每个任务</span>
<span class="sd">    2. 按顺序添加运动数据和夹爪命令</span>
<span class="sd">    3. 清除状态</span>

<span class="sd">    Args:</span>
<span class="sd">        start_position (List[float]): 起始位置（当前关节角度）。</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: 如果当前模式不是EXECUTE。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_operation_mode</span> <span class="o">!=</span> <span class="n">MotionOperationMode</span><span class="o">.</span><span class="n">EXECUTE</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;当前模式不是EXECUTE: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_operation_mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending_tasks</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="c1"># 执行</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">motion_runner</span><span class="o">.</span><span class="n">clear_data</span><span class="p">()</span>

    <span class="c1"># 按顺序处理每个任务，保持原有顺序</span>
    <span class="n">current_position</span> <span class="o">=</span> <span class="n">start_position</span>

    <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending_tasks</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">task</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;gripper&quot;</span><span class="p">:</span>
            <span class="c1"># 夹爪任务：直接添加夹爪命令（带延迟）</span>
            <span class="n">effector_mode</span> <span class="o">=</span> <span class="n">task</span><span class="p">[</span><span class="s2">&quot;effector_mode&quot;</span><span class="p">]</span>
            <span class="n">effector_data</span> <span class="o">=</span> <span class="n">task</span><span class="p">[</span><span class="s2">&quot;effector_data&quot;</span><span class="p">]</span>
            <span class="n">pre_delay</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pre_delay&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
            <span class="n">post_delay</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;post_delay&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">motion_runner</span><span class="o">.</span><span class="n">add_gripper_data</span><span class="p">(</span>
                <span class="n">effector_mode</span><span class="p">,</span> 
                <span class="n">effector_data</span><span class="p">,</span>
                <span class="n">pre_delay</span><span class="o">=</span><span class="n">pre_delay</span><span class="p">,</span>
                <span class="n">post_delay</span><span class="o">=</span><span class="n">post_delay</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># 运动任务：规划轨迹并添加</span>
            <span class="n">positions</span><span class="p">,</span> <span class="n">end_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trajectory_planner</span><span class="o">.</span><span class="n">_plan_single_task</span><span class="p">(</span>
                <span class="n">task</span><span class="p">,</span> 
                <span class="n">current_position</span>
            <span class="p">)</span>
            <span class="c1"># 注意：positions 可能是 numpy 数组，不能直接用 if positions</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">motion_runner</span><span class="o">.</span><span class="n">add_motion_data</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
                <span class="n">current_position</span> <span class="o">=</span> <span class="n">end_position</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">motion_runner</span><span class="o">.</span><span class="n">start_motion</span><span class="p">()</span>

    <span class="c1"># 清理</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">clear_operation</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.TrajectoryPlanningService" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">TrajectoryPlanningService</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">TrajectoryPlanningService</span><span class="p">(</span><span class="n">s_curve</span><span class="p">:</span> <span class="n">SCurve</span><span class="p">,</span> <span class="n">smooth_service</span><span class="p">:</span> <span class="n">SmoothDomainService</span><span class="p">,</span> <span class="n">linear_motion_service</span><span class="p">:</span> <span class="n">LinearMotionDomainService</span><span class="p">,</span> <span class="n">curve_motion_service</span><span class="p">:</span> <span class="n">CurveMotionDomainService</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>轨迹规划服务 - 领域服务。</p>
<p>职责：
1. 根据任务类型规划轨迹点序列
2. 维护位置状态（起点-&gt;终点）
3. 返回纯数据，不执行任何副作用</p>
<p>核心原则：纯函数，可测试，可复用</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.TrajectoryPlanningService.s_curve">s_curve</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SCurve (controller.domain.services.algorithm.SCurve)" href="#controller.shared.config.service_registry.SCurve">SCurve</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>S曲线算法服务。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.TrajectoryPlanningService.smooth_service">smooth_service</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SmoothDomainService (controller.domain.services.algorithm.SmoothDomainService)" href="#controller.shared.config.service_registry.SmoothDomainService">SmoothDomainService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>平滑算法服务。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.TrajectoryPlanningService.linear_motion_service">linear_motion_service</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="LinearMotionDomainService (controller.domain.services.algorithm.LinearMotionDomainService)" href="#controller.shared.config.service_registry.LinearMotionDomainService">LinearMotionDomainService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>直线运动服务。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.TrajectoryPlanningService.curve_motion_service">curve_motion_service</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CurveMotionDomainService (controller.domain.services.algorithm.CurveMotionDomainService)" href="#controller.shared.config.service_registry.CurveMotionDomainService">CurveMotionDomainService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>曲线运动服务。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化轨迹规划服务。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>s_curve</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SCurve (controller.domain.services.algorithm.SCurve)" href="#controller.shared.config.service_registry.SCurve">SCurve</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>S曲线算法服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>smooth_service</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SmoothDomainService (controller.domain.services.algorithm.SmoothDomainService)" href="#controller.shared.config.service_registry.SmoothDomainService">SmoothDomainService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>平滑算法服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>linear_motion_service</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="LinearMotionDomainService (controller.domain.services.algorithm.LinearMotionDomainService)" href="#controller.shared.config.service_registry.LinearMotionDomainService">LinearMotionDomainService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>直线运动服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>curve_motion_service</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CurveMotionDomainService (controller.domain.services.algorithm.CurveMotionDomainService)" href="#controller.shared.config.service_registry.CurveMotionDomainService">CurveMotionDomainService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>曲线运动服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/domain/services/motion/trajectory_planning_service.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">s_curve</span><span class="p">:</span> <span class="n">SCurve</span><span class="p">,</span>
    <span class="n">smooth_service</span><span class="p">:</span> <span class="n">SmoothDomainService</span><span class="p">,</span>
    <span class="n">linear_motion_service</span><span class="p">:</span> <span class="n">LinearMotionDomainService</span><span class="p">,</span>
    <span class="n">curve_motion_service</span><span class="p">:</span> <span class="n">CurveMotionDomainService</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化轨迹规划服务。</span>

<span class="sd">    Args:</span>
<span class="sd">        s_curve (SCurve): S曲线算法服务。</span>
<span class="sd">        smooth_service (SmoothDomainService): 平滑算法服务。</span>
<span class="sd">        linear_motion_service (LinearMotionDomainService): 直线运动服务。</span>
<span class="sd">        curve_motion_service (CurveMotionDomainService): 曲线运动服务。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">s_curve</span> <span class="o">=</span> <span class="n">s_curve</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">smooth_service</span> <span class="o">=</span> <span class="n">smooth_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">linear_motion_service</span> <span class="o">=</span> <span class="n">linear_motion_service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">curve_motion_service</span> <span class="o">=</span> <span class="n">curve_motion_service</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.TrajectoryPlanningService.plan_task_sequence" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">plan_task_sequence</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plan_task_sequence</span><span class="p">(</span><span class="n">tasks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">],</span> <span class="n">start_position</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>规划任务序列（仅返回位置）。</p>
<p>用于：执行运动、保存轨迹。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tasks</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>任务列表。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>start_position</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>起始位置。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[List[float]]: 轨迹点序列 [[q1,...,q6], ...]。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/motion/trajectory_planning_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plan_task_sequence</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">tasks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">],</span>
    <span class="n">start_position</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;规划任务序列（仅返回位置）。</span>

<span class="sd">    用于：执行运动、保存轨迹。</span>

<span class="sd">    Args:</span>
<span class="sd">        tasks (List[Dict]): 任务列表。</span>
<span class="sd">        start_position (List[float]): 起始位置。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[List[float]]: 轨迹点序列 [[q1,...,q6], ...]。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">all_positions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">current_position</span> <span class="o">=</span> <span class="n">start_position</span>

    <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">tasks</span><span class="p">:</span>
        <span class="n">positions</span><span class="p">,</span> <span class="n">end_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plan_single_task</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">current_position</span><span class="p">)</span>
        <span class="n">all_positions</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
        <span class="n">current_position</span> <span class="o">=</span> <span class="n">end_position</span>

    <span class="k">return</span> <span class="n">all_positions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.TrajectoryPlanningService.plan_task_sequence_with_derivatives" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">plan_task_sequence_with_derivatives</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plan_task_sequence_with_derivatives</span><span class="p">(</span><span class="n">tasks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">],</span> <span class="n">start_position</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>规划任务序列（返回位置、速度、加速度、时间）。</p>
<p>用于：预览轨迹曲线。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tasks</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>任务列表。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>start_position</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>起始位置。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Dict</code></td>            <td>
                  <code><span title="typing.Dict">Dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>包含以下键的字典:
- time: [t0, t1, ...]
- positions: [[q1,...,q6], ...]
- velocities: [[qd1,...,qd6], ...]
- accelerations: [[qdd1,...,qdd6], ...]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/motion/trajectory_planning_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plan_task_sequence_with_derivatives</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">tasks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">],</span>
    <span class="n">start_position</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;规划任务序列（返回位置、速度、加速度、时间）。</span>

<span class="sd">    用于：预览轨迹曲线。</span>

<span class="sd">    Args:</span>
<span class="sd">        tasks (List[Dict]): 任务列表。</span>
<span class="sd">        start_position (List[float]): 起始位置。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict: 包含以下键的字典:</span>
<span class="sd">            - time: [t0, t1, ...]</span>
<span class="sd">            - positions: [[q1,...,q6], ...]</span>
<span class="sd">            - velocities: [[qd1,...,qd6], ...]</span>
<span class="sd">            - accelerations: [[qdd1,...,qdd6], ...]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">all_time</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">all_positions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">all_velocities</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">all_accelerations</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">current_position</span> <span class="o">=</span> <span class="n">start_position</span>
    <span class="n">current_time</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">tasks</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plan_single_task_full</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">current_position</span><span class="p">)</span>

        <span class="c1"># 合并数据（时间累加）</span>
        <span class="n">all_time</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">t</span> <span class="o">+</span> <span class="n">current_time</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]])</span>
        <span class="n">all_positions</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;positions&quot;</span><span class="p">])</span>
        <span class="n">all_velocities</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;velocities&quot;</span><span class="p">])</span>
        <span class="n">all_accelerations</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;accelerations&quot;</span><span class="p">])</span>

        <span class="c1"># 更新状态</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;positions&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">current_position</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;positions&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">current_time</span> <span class="o">=</span> <span class="n">all_time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">all_time</span><span class="p">,</span>
        <span class="s2">&quot;positions&quot;</span><span class="p">:</span> <span class="n">all_positions</span><span class="p">,</span>
        <span class="s2">&quot;velocities&quot;</span><span class="p">:</span> <span class="n">all_velocities</span><span class="p">,</span>
        <span class="s2">&quot;accelerations&quot;</span><span class="p">:</span> <span class="n">all_accelerations</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.RobotStateDomainService" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">RobotStateDomainService</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">RobotStateDomainService</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="PyQt5.QtCore.QObject">QObject</span></code></p>



        <p>机械臂状态领域服务 - 单一数据源。</p>
<p>职责：
1. 维护当前机械臂状态（最新快照）
2. 维护历史状态缓冲（滑动窗口）
3. 计算静摩擦补偿（基于历史数据）
4. 发射信号通知订阅者</p>
<p>设计原则：
- Single Source of Truth: 所有状态只在这里维护
- Pub-Sub Pattern: 支持多个订阅者
- Thread Safe: 使用锁保护可变数据</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.RobotStateDomainService.state_updated">state_updated</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>状态更新信号，携带 RobotStateSnapshot。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.RobotStateDomainService.angles_changed">angles_changed</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>角度显著变化信号，携带 [θ1, θ2, ..., θ6] 列表。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.RobotStateDomainService.torque_compensation_requested">torque_compensation_requested</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>力矩补偿请求信号，携带当前角度列表。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/domain/services/state/robot_state_domain_service.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="c1"># ════════════════════════════════════════════════════════</span>
    <span class="c1"># 状态存储</span>
    <span class="c1"># ════════════════════════════════════════════════════════</span>

    <span class="c1"># 当前状态（最新快照）</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_current_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RobotStateSnapshot</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># 历史缓冲（滑动窗口，用于静摩擦计算）</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_position_history</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

    <span class="c1"># ════════════════════════════════════════════════════════</span>
    <span class="c1"># 静摩擦计算相关（用于示教模式）</span>
    <span class="c1"># ════════════════════════════════════════════════════════</span>

    <span class="c1"># 静摩擦状态（每个关节：0=静止, 1=运动）</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_friction_state</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span>

    <span class="c1"># 静摩擦补偿值（Nm）</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_friction_compensation</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span>

    <span class="c1"># 静摩擦配置（阈值）</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_friction_config</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>

    <span class="c1"># ════════════════════════════════════════════════════════</span>
    <span class="c1"># 其他状态</span>
    <span class="c1"># ════════════════════════════════════════════════════════</span>

    <span class="c1"># 示教模式标志</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_teaching_mode</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># 线程锁（保护可变数据）</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">RLock</span><span class="p">()</span>

    <span class="c1"># 最后更新时间</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_last_update_time</span> <span class="o">=</span> <span class="mf">0.0</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">







<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RobotStateDomainService.update_state" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">update_state</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">update_state</span><span class="p">(</span><span class="n">decoded_message</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>更新机械臂状态（核心方法）。</p>
<p>由 MessageResponseService 调用，每次接收到串口数据并解码后调用。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>decoded_message</code>
            </td>
            <td>
                  <code><span title="Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>解码后的消息对象。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/state/robot_state_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">decoded_message</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;更新机械臂状态（核心方法）。</span>

<span class="sd">    由 MessageResponseService 调用，每次接收到串口数据并解码后调用。</span>

<span class="sd">    Args:</span>
<span class="sd">        decoded_message (Any): 解码后的消息对象。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_snapshot</span> <span class="o">=</span> <span class="n">RobotStateSnapshot</span><span class="o">.</span><span class="n">from_decoded_message</span><span class="p">(</span><span class="n">decoded_message</span><span class="p">)</span>
    <span class="n">old_snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_state</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_current_state</span> <span class="o">=</span> <span class="n">new_snapshot</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_last_update_time</span> <span class="o">=</span> <span class="n">new_snapshot</span><span class="o">.</span><span class="n">timestamp</span>

    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_position_history</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">new_snapshot</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span>
            <span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">new_snapshot</span><span class="o">.</span><span class="n">joint_angles</span><span class="p">),</span>
            <span class="s1">&#39;positions&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">new_snapshot</span><span class="o">.</span><span class="n">joint_positions</span><span class="p">)</span>
        <span class="p">})</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_teaching_mode</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_position_history</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">20</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_friction_compensation</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">state_updated</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">new_snapshot</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">old_snapshot</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angles_changed_significantly</span><span class="p">(</span><span class="n">old_snapshot</span><span class="p">,</span> <span class="n">new_snapshot</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angles_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">new_snapshot</span><span class="o">.</span><span class="n">joint_angles</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">new_snapshot</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="mh">0x0A</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_teaching_mode</span> <span class="ow">and</span> <span class="n">new_snapshot</span><span class="o">.</span><span class="n">control</span> <span class="ow">in</span> <span class="p">[</span><span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">]:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">pi</span>
            <span class="n">init_offset</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
            <span class="n">adjusted_angles</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">a</span> <span class="o">-</span> <span class="n">offset</span> 
                <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">offset</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">new_snapshot</span><span class="o">.</span><span class="n">joint_angles</span><span class="p">,</span> <span class="n">init_offset</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">torque_compensation_requested</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">adjusted_angles</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RobotStateDomainService.get_current_state" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_current_state</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_current_state</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RobotStateSnapshot</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取当前状态快照（不可变，线程安全）。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="RobotStateSnapshot


  
      dataclass
   (controller.domain.value_objects.RobotStateSnapshot)" href="#controller.shared.config.service_registry.RobotStateSnapshot">RobotStateSnapshot</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[RobotStateSnapshot]: 当前状态快照。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/state/robot_state_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_current_state</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RobotStateSnapshot</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取当前状态快照（不可变，线程安全）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[RobotStateSnapshot]: 当前状态快照。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_state</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RobotStateDomainService.get_current_angles" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_current_angles</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_current_angles</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取当前关节角度（弧度）。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[float]: 6个关节的角度列表。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/state/robot_state_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_current_angles</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取当前关节角度（弧度）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[float]: 6个关节的角度列表。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_state</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_current_state</span><span class="o">.</span><span class="n">joint_angles</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RobotStateDomainService.get_current_positions" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_current_positions</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_current_positions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取当前关节位置（编码器值）。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[int]: 6个关节的编码器位置列表。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/state/robot_state_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_current_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取当前关节位置（编码器值）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[int]: 6个关节的编码器位置列表。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_state</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_current_state</span><span class="o">.</span><span class="n">joint_positions</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RobotStateDomainService.get_position_history" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_position_history</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_position_history</span><span class="p">(</span><span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取历史位置数据。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>count</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>获取的记录数量. Defaults to 20.</p>
              </div>
            </td>
            <td>
                  <code>20</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict]: 历史位置数据列表，每个元素包含 timestamp, angles, positions。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/state/robot_state_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_position_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取历史位置数据。</span>

<span class="sd">    Args:</span>
<span class="sd">        count (int, optional): 获取的记录数量. Defaults to 20.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict]: 历史位置数据列表，每个元素包含 timestamp, angles, positions。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_position_history</span><span class="p">)[</span><span class="o">-</span><span class="n">count</span><span class="p">:]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RobotStateDomainService.get_friction_compensation" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_friction_compensation</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_friction_compensation</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取当前静摩擦补偿值。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[float]: 6个关节的静摩擦补偿值列表。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/state/robot_state_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_friction_compensation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取当前静摩擦补偿值。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[float]: 6个关节的静摩擦补偿值列表。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_friction_compensation</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RobotStateDomainService.set_teaching_mode" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">set_teaching_mode</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_teaching_mode</span><span class="p">(</span><span class="n">enabled</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>设置示教模式。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>enabled</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True=开启, False=关闭。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/state/robot_state_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_teaching_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enabled</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;设置示教模式。</span>

<span class="sd">    Args:</span>
<span class="sd">        enabled (bool): True=开启, False=关闭。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_teaching_mode</span> <span class="o">=</span> <span class="n">enabled</span>
    <span class="k">if</span> <span class="n">enabled</span><span class="p">:</span>
        <span class="c1"># 开启示教时，清空历史</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_position_history</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_friction_state</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_friction_compensation</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RobotStateDomainService.set_friction_config" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">set_friction_config</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_friction_config</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>设置静摩擦配置。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>6个关节的静摩擦阈值列表。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/state/robot_state_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_friction_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;设置静摩擦配置。</span>

<span class="sd">    Args:</span>
<span class="sd">        config (List[float]): 6个关节的静摩擦阈值列表。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_friction_config</span> <span class="o">=</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RobotStateDomainService.clear_history" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clear_history</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">clear_history</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>清空历史数据。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/state/robot_state_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">clear_history</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;清空历史数据。&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_position_history</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_friction_state</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_friction_compensation</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.TeachRecordDomainService" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">TeachRecordDomainService</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">TeachRecordDomainService</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="PyQt5.QtCore.QObject">QObject</span></code></p>



        <p>示教记录领域服务 - Domain层。</p>
<p>职责：
1. 管理示教记录数据（内存中）
2. 控制记录的开始/停止
3. 提供记录的增删改查操作
4. 生成记录名称</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.TeachRecordDomainService.recording_state_changed">recording_state_changed</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>记录状态变化信号，携带是否正在记录。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.TeachRecordDomainService.record_added">record_added</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>记录添加信号，携带新增的记录名称。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.TeachRecordDomainService.record_deleted">record_deleted</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>记录删除信号，携带删除的记录名称。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化示教记录服务。</p>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化示教记录服务。&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="c1"># 记录数据 {记录名: 角度列表}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_records</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># 当前记录状态</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_is_recording</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_current_record_angles</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_record_counter</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># 记录定时器（10ms间隔，100Hz采样率）</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_record_timer</span> <span class="o">=</span> <span class="n">QTimer</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_record_timer</span><span class="o">.</span><span class="n">setInterval</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_record_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_record_timer_timeout</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.TeachRecordDomainService.start_recording" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">start_recording</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">start_recording</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>开始记录。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">start_recording</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;开始记录。&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_recording</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_recording</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_record_angles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_record_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_record_timer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recording_state_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.TeachRecordDomainService.stop_recording" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">stop_recording</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">stop_recording</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>停止记录并保存。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[str]: 新生成的记录名称，如果没有数据则返回 None。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stop_recording</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;停止记录并保存。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[str]: 新生成的记录名称，如果没有数据则返回 None。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_recording</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_recording</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_record_timer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recording_state_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># 保存当前记录</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_record_angles</span><span class="p">:</span>
            <span class="n">record_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_record_name</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_records</span><span class="p">[</span><span class="n">record_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_record_angles</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">record_added</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">record_name</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">record_name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.TeachRecordDomainService.is_recording" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">is_recording</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_recording</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>查询是否正在记录。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否正在记录。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_recording</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;查询是否正在记录。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 是否正在记录。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_recording</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.TeachRecordDomainService.add_angle_to_current_record" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_angle_to_current_record</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_angle_to_current_record</span><span class="p">(</span><span class="n">angles</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>添加角度到当前记录。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>angles</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>6维关节角度。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_angle_to_current_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angles</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;添加角度到当前记录。</span>

<span class="sd">    Args:</span>
<span class="sd">        angles (List[float]): 6维关节角度。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_recording</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_record_angles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angles</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_record_counter</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.TeachRecordDomainService.get_record_timer" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_record_timer</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_record_timer</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">QTimer</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取记录定时器（用于外部连接）。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>QTimer</code></td>            <td>
                  <code><span title="PyQt5.QtCore.QTimer">QTimer</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>记录定时器。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_record_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">QTimer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取记录定时器（用于外部连接）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        QTimer: 记录定时器。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_record_timer</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.TeachRecordDomainService.get_all_records" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_all_records</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_all_records</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取所有记录。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict[str, List[List[float]]]: 所有记录字典。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_all_records</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取所有记录。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, List[List[float]]]: 所有记录字典。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_records</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.TeachRecordDomainService.get_record_names" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_record_names</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_record_names</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取所有记录名称。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[str]: 记录名称列表。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_record_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取所有记录名称。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: 记录名称列表。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_records</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.TeachRecordDomainService.get_record" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_record</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_record</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取指定记录。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>记录名称。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[List[List[float]]]: 角度列表，如果不存在返回 None。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取指定记录。</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): 记录名称。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[List[List[float]]]: 角度列表，如果不存在返回 None。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_records</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.TeachRecordDomainService.delete_record" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">delete_record</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">delete_record</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>删除指定记录。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>记录名称。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否删除成功。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;删除指定记录。</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): 记录名称。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 是否删除成功。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_records</span><span class="p">:</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_records</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">record_deleted</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.TeachRecordDomainService.reverse_record" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">reverse_record</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">reverse_record</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>反转指定记录并另存为新记录。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>原记录名称。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[str]: 新记录名称，如果失败返回 None。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reverse_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;反转指定记录并另存为新记录。</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): 原记录名称。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[str]: 新记录名称，如果失败返回 None。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_records</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 反转角度序列</span>
        <span class="n">original_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_records</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="n">reversed_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">original_list</span><span class="p">))</span>

        <span class="c1"># 生成新名称：原名-反转（如已存在则追加序号）</span>
        <span class="n">base_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">-反转&quot;</span>
        <span class="n">new_name</span> <span class="o">=</span> <span class="n">base_name</span>
        <span class="n">suffix</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">while</span> <span class="n">new_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_records</span><span class="p">:</span>
            <span class="n">new_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">suffix</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># 保存新记录</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_records</span><span class="p">[</span><span class="n">new_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">reversed_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">record_added</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">new_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_name</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.TeachRecordDomainService.load_records" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">load_records</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">load_records</span><span class="p">(</span><span class="n">records</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]])</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>加载记录数据（从Repository）。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>records</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>记录数据字典。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">records</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;加载记录数据（从Repository）。</span>

<span class="sd">    Args:</span>
<span class="sd">        records (Dict[str, List[List[float]]]): 记录数据字典。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_records</span> <span class="o">=</span> <span class="n">records</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.TeachRecordDomainService.clear_all_records" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clear_all_records</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">clear_all_records</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>清空所有记录。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">clear_all_records</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;清空所有记录。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_records</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.MotionPlanningDomainService" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MotionPlanningDomainService</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">MotionPlanningDomainService</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>运动规划Domain服务。</p>
<p>职责：
1. 管理多个方案（内存）
2. 维护当前激活的方案
3. 提供方案和节点的增删改查
4. 实施业务规则</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionPlanningDomainService._plans">_plans</span></code></td>
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="MotionPlan


  
      dataclass
   (controller.domain.entities.motion_plan.MotionPlan)" href="../../../domain/entities/#controller.domain.entities.motion_plan.MotionPlan">MotionPlan</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>方案列表。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionPlanningDomainService._current_index">_current_index</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>当前激活方案的索引。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化服务。</p>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化服务。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_plans</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">MotionPlan</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_current_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningDomainService.initialize" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">initialize</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">initialize</span><span class="p">(</span><span class="n">plans</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">MotionPlan</span><span class="p">],</span> <span class="n">current_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>初始化数据（从Repository加载后调用）。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>plans</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="MotionPlan


  
      dataclass
   (controller.domain.entities.motion_plan.MotionPlan)" href="../../../domain/entities/#controller.domain.entities.motion_plan.MotionPlan">MotionPlan</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>方案列表。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>当前方案索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plans</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">MotionPlan</span><span class="p">],</span> <span class="n">current_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化数据（从Repository加载后调用）。</span>

<span class="sd">    Args:</span>
<span class="sd">        plans (List[MotionPlan]): 方案列表。</span>
<span class="sd">        current_index (int): 当前方案索引。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_plans</span> <span class="o">=</span> <span class="n">plans</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_current_index</span> <span class="o">=</span> <span class="n">current_index</span> <span class="k">if</span> <span class="n">plans</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningDomainService.get_all_plans" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_all_plans</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_all_plans</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">MotionPlan</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取所有方案（用于持久化）。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="MotionPlan


  
      dataclass
   (controller.domain.entities.motion_plan.MotionPlan)" href="../../../domain/entities/#controller.domain.entities.motion_plan.MotionPlan">MotionPlan</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[MotionPlan]: 方案列表的副本。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_all_plans</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">MotionPlan</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取所有方案（用于持久化）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[MotionPlan]: 方案列表的副本。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plans</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningDomainService.create_plan" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_plan</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_plan</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>创建方案，返回索引。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>方案名称。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>新创建方案的索引。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;创建方案，返回索引。</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): 方案名称。</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: 新创建方案的索引。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plan</span> <span class="o">=</span> <span class="n">MotionPlan</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_plans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plan</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_current_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plans</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_index</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningDomainService.get_plan_names" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_plan_names</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_plan_names</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取所有方案名称（用于下拉框）。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[str]: 方案名称列表。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_plan_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取所有方案名称（用于下拉框）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: 方案名称列表。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">plan</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">plan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plans</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningDomainService.get_current_index" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_current_index</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_current_index</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取当前方案索引。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>当前索引。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_current_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取当前方案索引。</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: 当前索引。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_index</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningDomainService.set_current_index" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">set_current_index</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_current_index</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>切换方案。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>目标索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否切换成功。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_current_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;切换方案。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 目标索引。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 是否切换成功。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plans</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_index</span> <span class="o">=</span> <span class="n">index</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningDomainService.delete_plan" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">delete_plan</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">delete_plan</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>删除方案。</p>
<p>业务规则：至少保留一个方案。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>方案索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True=删除成功, False=删除失败（违反业务规则或索引无效）。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;删除方案。</span>

<span class="sd">    业务规则：至少保留一个方案。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 方案索引。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True=删除成功, False=删除失败（违反业务规则或索引无效）。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 业务规则：至少保留一个方案</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plans</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plans</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plans</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="c1"># 调整当前索引</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plans</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_current_index</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plans</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plans</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_current_index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningDomainService.can_delete_plan" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">can_delete_plan</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">can_delete_plan</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>检查是否可以删除方案。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True=可以删除, False=不能删除（只有一个方案）。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">can_delete_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;检查是否可以删除方案。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True=可以删除, False=不能删除（只有一个方案）。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plans</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningDomainService.rename_plan" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">rename_plan</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">rename_plan</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>重命名方案。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>方案索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>new_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>新名称。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否成功。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rename_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;重命名方案。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 方案索引。</span>
<span class="sd">        new_name (str): 新名称。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 是否成功。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plans</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plans</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">new_name</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningDomainService.get_current_plan" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_current_plan</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_current_plan</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MotionPlan</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取当前方案。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="MotionPlan


  
      dataclass
   (controller.domain.entities.motion_plan.MotionPlan)" href="../../../domain/entities/#controller.domain.entities.motion_plan.MotionPlan">MotionPlan</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[MotionPlan]: 当前方案对象，无方案时返回 None。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_current_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MotionPlan</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取当前方案。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[MotionPlan]: 当前方案对象，无方案时返回 None。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plans</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plans</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_current_index</span><span class="p">]</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningDomainService.get_plan_count" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_plan_count</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_plan_count</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取方案数量。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>方案数量。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_plan_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取方案数量。</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: 方案数量。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plans</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningDomainService.add_point" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_point</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_point</span><span class="p">(</span><span class="n">point_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>添加节点到当前方案。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>point_data</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点数据。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;添加节点到当前方案。</span>

<span class="sd">    Args:</span>
<span class="sd">        point_data (dict): 节点数据。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_current_plan</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">plan</span><span class="p">:</span>
        <span class="n">plan</span><span class="o">.</span><span class="n">add_point</span><span class="p">(</span><span class="n">point_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningDomainService.remove_point" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">remove_point</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">remove_point</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>删除节点。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;删除节点。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 节点索引。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_current_plan</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">plan</span><span class="p">:</span>
        <span class="n">plan</span><span class="o">.</span><span class="n">remove_point</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningDomainService.move_point_up" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">move_point_up</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">move_point_up</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>上移节点。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否成功。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_point_up</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;上移节点。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 节点索引。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 是否成功。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_current_plan</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">plan</span><span class="o">.</span><span class="n">move_point_up</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="k">if</span> <span class="n">plan</span> <span class="k">else</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningDomainService.move_point_down" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">move_point_down</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">move_point_down</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>下移节点。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否成功。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_point_down</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;下移节点。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 节点索引。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 是否成功。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_current_plan</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">plan</span><span class="o">.</span><span class="n">move_point_down</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="k">if</span> <span class="n">plan</span> <span class="k">else</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningDomainService.update_point" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">update_point</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">update_point</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">point_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>更新节点。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>point_data</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>新数据。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">point_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;更新节点。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 节点索引。</span>
<span class="sd">        point_data (dict): 新数据。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_current_plan</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">plan</span><span class="p">:</span>
        <span class="n">plan</span><span class="o">.</span><span class="n">update_point</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">point_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanningDomainService.get_all_points" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_all_points</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_all_points</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取当前方案的所有节点。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[dict]: 节点列表的副本。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_all_points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取当前方案的所有节点。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[dict]: 节点列表的副本。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_current_plan</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">plan</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="n">plan</span> <span class="k">else</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.CameraDomainService" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">CameraDomainService</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">CameraDomainService</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="PyQt5.QtCore.QObject">QObject</span></code></p>



        <p>摄像头领域服务。</p>
<p>职责：
- 管理 ROS2 摄像头订阅节点的生命周期
- 维护最新的彩色/深度图像数据（线程安全）
- 发射图像接收信号
- 深度图可视化处理</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CameraDomainService.color_image_received">color_image_received</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>彩色图像接收信号，携带图像数据 (np.ndarray)。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CameraDomainService.depth_image_received">depth_image_received</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>深度图像接收信号，携带图像数据 (np.ndarray)。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CameraDomainService.connection_status_changed">connection_status_changed</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>连接状态变更信号，携带 (connected, message)。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.CameraDomainService.error_occurred">error_occurred</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>错误信号，携带错误信息。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化摄像头领域服务。</p>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化摄像头领域服务。&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="c1"># ROS节点和执行器</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">color_subscriber</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">depth_subscriber</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ros_executor</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ros_thread</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># cv_bridge</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bridge</span> <span class="o">=</span> <span class="n">CvBridge</span><span class="p">()</span>

    <span class="c1"># 图像数据存储（线程安全）</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">latest_color_image</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">latest_depth_image</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">color_image_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">depth_image_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

    <span class="c1"># 连接状态</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_connected</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">color_connected</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># 彩色流是否有数据</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">depth_connected</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># 深度流是否有数据</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraDomainService.connect" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">connect</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">connect</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>连接摄像头（启动 ROS 订阅）。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>连接成功返回 True，失败返回 False。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;连接摄像头（启动 ROS 订阅）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 连接成功返回 True，失败返回 False。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_connected</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="c1"># 检查并初始化ROS（灵活策略，参考旧版）</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">rclpy</span><span class="o">.</span><span class="n">ok</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">rclpy</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="c1"># ROS已经初始化但状态异常</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">error_occurred</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ROS状态异常: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># 创建订阅节点</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_subscriber</span> <span class="o">=</span> <span class="n">ColorImageSubscriber</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_color_image_received</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">depth_subscriber</span> <span class="o">=</span> <span class="n">DepthImageSubscriber</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_depth_image_received</span><span class="p">)</span>

        <span class="c1"># 创建executor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ros_executor</span> <span class="o">=</span> <span class="n">MultiThreadedExecutor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ros_executor</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color_subscriber</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ros_executor</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">depth_subscriber</span><span class="p">)</span>

        <span class="c1"># 在独立线程运行executor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ros_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ros_spin_worker</span><span class="p">,</span> <span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ros_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_connected</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connection_status_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;摄像头连接成功&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_occurred</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;连接摄像头失败: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraDomainService.disconnect" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">disconnect</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">disconnect</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>断开摄像头（关闭 ROS 订阅）。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>断开成功返回 True，失败返回 False。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;断开摄像头（关闭 ROS 订阅）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 断开成功返回 True，失败返回 False。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_connected</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_connected</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_connected</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">depth_connected</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># 停止executor（只影响摄像头节点）</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ros_executor</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ros_executor</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>

        <span class="c1"># 销毁节点</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_subscriber</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">color_subscriber</span><span class="o">.</span><span class="n">destroy_node</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">color_subscriber</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth_subscriber</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">depth_subscriber</span><span class="o">.</span><span class="n">destroy_node</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">depth_subscriber</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># 等待线程结束</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ros_thread</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ros_thread</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ros_thread</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ros_executor</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ros_thread</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># 清空图像数据</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_image_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">latest_color_image</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth_image_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">latest_depth_image</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">connection_status_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;摄像头已断开&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_occurred</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;断开摄像头失败: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraDomainService.get_latest_color_image" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_latest_color_image</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_latest_color_image</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取最新彩色图像（线程安全）。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[np.ndarray]: 图像数据，无数据返回 None。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_latest_color_image</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取最新彩色图像（线程安全）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[np.ndarray]: 图像数据，无数据返回 None。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_image_lock</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">latest_color_image</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latest_color_image</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraDomainService.get_latest_depth_image" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_latest_depth_image</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_latest_depth_image</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取最新深度图像（线程安全）。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[np.ndarray]: 图像数据，无数据返回 None。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_latest_depth_image</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取最新深度图像（线程安全）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[np.ndarray]: 图像数据，无数据返回 None。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth_image_lock</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">latest_depth_image</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latest_depth_image</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraDomainService.is_color_available" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">is_color_available</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_color_available</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>检查彩色图像是否可用。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否可用。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_color_available</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;检查彩色图像是否可用。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 是否可用。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_connected</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">latest_color_image</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraDomainService.is_depth_available" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">is_depth_available</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_depth_available</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>检查深度图像是否可用。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否可用。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_depth_available</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;检查深度图像是否可用。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 是否可用。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth_connected</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">latest_depth_image</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.CameraDomainService.visualize_depth_image" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">visualize_depth_image</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">visualize_depth_image</span><span class="p">(</span><span class="n">depth_image</span><span class="p">:</span> <span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>深度图可视化为伪彩色图。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>depth_image</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>原始深度图（16位或32位浮点）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: 伪彩色深度图（BGR, uint8）。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">visualize_depth_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">depth_image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;深度图可视化为伪彩色图。</span>

<span class="sd">    Args:</span>
<span class="sd">        depth_image (np.ndarray): 原始深度图（16位或32位浮点）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: 伪彩色深度图（BGR, uint8）。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 过滤无效值（depth &lt;= 0 或 nan）</span>
        <span class="n">valid_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">depth_image</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">depth_image</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">valid_mask</span><span class="p">):</span>
            <span class="c1"># 如果没有有效数据，返回黑色图像</span>
            <span class="n">depth_display</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">depth_image</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># 归一化到 0-255</span>
            <span class="n">min_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">depth_image</span><span class="p">[</span><span class="n">valid_mask</span><span class="p">])</span>
            <span class="n">max_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">depth_image</span><span class="p">[</span><span class="n">valid_mask</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">max_val</span> <span class="o">-</span> <span class="n">min_val</span> <span class="o">&lt;</span> <span class="mf">1e-6</span><span class="p">:</span>
                <span class="n">depth_display</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">depth_image</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">depth_image</span> <span class="o">-</span> <span class="n">min_val</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">max_val</span> <span class="o">-</span> <span class="n">min_val</span><span class="p">)</span>
                <span class="n">norm</span><span class="p">[</span><span class="o">~</span><span class="n">valid_mask</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">depth_display</span> <span class="o">=</span> <span class="p">(</span><span class="n">norm</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

        <span class="c1"># 应用伪彩色映射</span>
        <span class="n">depth_colormap</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">applyColorMap</span><span class="p">(</span><span class="n">depth_display</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLORMAP_JET</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">depth_colormap</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># 如果可视化失败，返回黑色图像</span>
        <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">depth_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.RecognitionDomainService" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">RecognitionDomainService</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">RecognitionDomainService</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="PyQt5.QtCore.QObject">QObject</span></code></p>



        <p>零件识别领域服务。</p>
<p>职责：
- 订阅 recognition_result ROS 话题
- 维护最新检测结果（线程安全）
- 独立于摄像头服务运行
- 发射检测结果信号</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.RecognitionDomainService.detection_result_received">detection_result_received</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>检测结果接收信号，携带结果字典。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.RecognitionDomainService.detection_status_changed">detection_status_changed</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>检测状态变更信号，携带 (is_running, message)。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.RecognitionDomainService.error_occurred">error_occurred</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>错误信号，携带错误信息。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化零件识别领域服务。</p>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/domain/services/vision/recognition_domain_service.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化零件识别领域服务。&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="c1"># ROS节点和执行器</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">detection_subscriber</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ros_executor</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ros_thread</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># 检测结果存储（线程安全）</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">latest_detection_result</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">detection_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

    <span class="c1"># 运行状态</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_running</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RecognitionDomainService.start_detection" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">start_detection</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">start_detection</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>开始检测（启动 ROS 订阅）。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>启动成功返回 True，失败返回 False。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/vision/recognition_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">start_detection</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;开始检测（启动 ROS 订阅）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 启动成功返回 True，失败返回 False。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_running</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="c1"># 检查并初始化ROS（灵活策略，参考旧版）</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">rclpy</span><span class="o">.</span><span class="n">ok</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">rclpy</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="c1"># ROS已经初始化但状态异常</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">error_occurred</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ROS状态异常: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">error_occurred</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ROS初始化失败: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># 创建订阅节点</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detection_subscriber</span> <span class="o">=</span> <span class="n">DetectionSubscriberNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_detection_received</span><span class="p">)</span>

        <span class="c1"># 创建executor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ros_executor</span> <span class="o">=</span> <span class="n">SingleThreadedExecutor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ros_executor</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detection_subscriber</span><span class="p">)</span>

        <span class="c1"># 在独立线程运行executor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ros_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ros_spin_worker</span><span class="p">,</span> <span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ros_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_running</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detection_status_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;开始零件识别&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_occurred</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;启动检测失败: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RecognitionDomainService.stop_detection" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">stop_detection</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">stop_detection</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>停止检测（关闭 ROS 订阅）。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>停止成功返回 True，失败返回 False。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/vision/recognition_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stop_detection</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;停止检测（关闭 ROS 订阅）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 停止成功返回 True，失败返回 False。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_running</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_running</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># 停止executor（只影响检测节点）</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ros_executor</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ros_executor</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>

        <span class="c1"># 销毁节点</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">detection_subscriber</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">detection_subscriber</span><span class="o">.</span><span class="n">destroy_node</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">detection_subscriber</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># 等待线程结束</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ros_thread</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ros_thread</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ros_thread</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ros_executor</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ros_thread</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># 清空检测结果</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">detection_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">latest_detection_result</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">detection_status_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;停止零件识别&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_occurred</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;停止检测失败: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RecognitionDomainService.get_latest_result" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_latest_result</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_latest_result</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取最新检测结果（线程安全）。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[Dict]: 检测结果字典，无结果返回 None。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/vision/recognition_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_latest_result</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取最新检测结果（线程安全）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[Dict]: 检测结果字典，无结果返回 None。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">detection_lock</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latest_detection_result</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latest_detection_result</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RecognitionDomainService.is_detection_running" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">is_detection_running</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_detection_running</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>检查检测是否正在运行。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否正在运行。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/vision/recognition_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_detection_running</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;检查检测是否正在运行。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 是否正在运行。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_running</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RecognitionDomainService.clear_result" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clear_result</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">clear_result</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>清除检测结果。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/vision/recognition_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">clear_result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;清除检测结果。&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">detection_lock</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">latest_detection_result</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.HandEyeTransformDomainService" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">HandEyeTransformDomainService</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">HandEyeTransformDomainService</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">HandEyeCalibrationConfig</span><span class="p">,</span> <span class="n">kinematic_service</span><span class="p">:</span> <span class="n">KinematicDomainService</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>手眼标定变换服务。</p>
<p>职责：
1. 像素坐标 → 相机坐标系
2. 相机坐标系 → 基坐标系
3. 计算目标位姿（包含偏移和姿态调整）
4. 提供逆运动学求解</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.HandEyeTransformDomainService.config">config</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="HandEyeCalibrationConfig


  
      dataclass
   (controller.domain.value_objects.HandEyeCalibrationConfig)" href="#controller.shared.config.service_registry.HandEyeCalibrationConfig">HandEyeCalibrationConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>手眼标定配置。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.HandEyeTransformDomainService.kinematic_service">kinematic_service</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="KinematicDomainService (controller.domain.services.algorithm.kinematic_domain_service.KinematicDomainService)" href="../../../domain/algorithm/#controller.domain.services.algorithm.kinematic_domain_service.KinematicDomainService">KinematicDomainService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运动学服务实例。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化手眼标定变换服务。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="HandEyeCalibrationConfig


  
      dataclass
   (controller.domain.value_objects.HandEyeCalibrationConfig)" href="#controller.shared.config.service_registry.HandEyeCalibrationConfig">HandEyeCalibrationConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>手眼标定配置（通过DI注入）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kinematic_service</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="KinematicDomainService (controller.domain.services.algorithm.kinematic_domain_service.KinematicDomainService)" href="../../../domain/algorithm/#controller.domain.services.algorithm.kinematic_domain_service.KinematicDomainService">KinematicDomainService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>运动学服务。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/hand_eye_transform_domain_service.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">HandEyeCalibrationConfig</span><span class="p">,</span>
    <span class="n">kinematic_service</span><span class="p">:</span> <span class="n">KinematicDomainService</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化手眼标定变换服务。</span>

<span class="sd">    Args:</span>
<span class="sd">        config: 手眼标定配置（通过DI注入）。</span>
<span class="sd">        kinematic_service: 运动学服务。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_service</span> <span class="o">=</span> <span class="n">kinematic_service</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.HandEyeTransformDomainService.calculate_target_joint_angles" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">calculate_target_joint_angles</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">calculate_target_joint_angles</span><span class="p">(</span><span class="n">central_center</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">depth</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">real_center</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">real_depth</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">current_joint_angles</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>计算运动到零件位置所需的目标关节角度。</p>
<p>完整流程：
1. 像素坐标 → 相机坐标系
2. 正运动学：当前关节角度 → 末端位姿
3. 相机坐标系 → 基坐标系
4. 计算零件方向 + 偏移量
5. 逆运动学：目标位姿 → 目标关节角度</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>central_center</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>中心点像素坐标 [u, v]。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>depth</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>中心点深度 (mm)。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>real_center</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>实际中心点像素坐标 [u, v]。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>real_depth</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>实际中心点深度 (mm)。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>angle</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>零件角度（弧度）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_joint_angles</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>当前关节角度列表（弧度）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[List[float]]: 目标关节角度列表（弧度），如果无解则返回 None。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/hand_eye_transform_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_target_joint_angles</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">central_center</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>      <span class="c1"># [u, v] 像素坐标</span>
    <span class="n">depth</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>                     <span class="c1"># 深度 (mm)</span>
    <span class="n">real_center</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>         <span class="c1"># 实际中心点 [u, v]</span>
    <span class="n">real_depth</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>                <span class="c1"># 实际深度 (mm)</span>
    <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>                     <span class="c1"># 零件角度（弧度）</span>
    <span class="n">current_joint_angles</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="c1"># 当前关节角度（弧度）</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;计算运动到零件位置所需的目标关节角度。</span>

<span class="sd">    完整流程：</span>
<span class="sd">    1. 像素坐标 → 相机坐标系</span>
<span class="sd">    2. 正运动学：当前关节角度 → 末端位姿</span>
<span class="sd">    3. 相机坐标系 → 基坐标系</span>
<span class="sd">    4. 计算零件方向 + 偏移量</span>
<span class="sd">    5. 逆运动学：目标位姿 → 目标关节角度</span>

<span class="sd">    Args:</span>
<span class="sd">        central_center (List[float]): 中心点像素坐标 [u, v]。</span>
<span class="sd">        depth (float): 中心点深度 (mm)。</span>
<span class="sd">        real_center (List[float]): 实际中心点像素坐标 [u, v]。</span>
<span class="sd">        real_depth (float): 实际中心点深度 (mm)。</span>
<span class="sd">        angle (float): 零件角度（弧度）。</span>
<span class="sd">        current_joint_angles (List[float]): 当前关节角度列表（弧度）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[List[float]]: 目标关节角度列表（弧度），如果无解则返回 None。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 获取配置参数</span>
    <span class="n">intrinsics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">camera_intrinsics</span>

    <span class="c1"># 1. 像素坐标 → 相机坐标系（齐次坐标）</span>
    <span class="n">px1</span><span class="p">,</span> <span class="n">py1</span><span class="p">,</span> <span class="n">pz1</span> <span class="o">=</span> <span class="n">central_center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">central_center</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">depth</span>
    <span class="n">px2</span><span class="p">,</span> <span class="n">py2</span><span class="p">,</span> <span class="n">pz2</span> <span class="o">=</span> <span class="n">real_center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">real_center</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">real_depth</span>

    <span class="c1"># 深度单位转换：mm → m</span>
    <span class="n">pz1</span> <span class="o">*=</span> <span class="mf">0.001</span>
    <span class="n">pz2</span> <span class="o">*=</span> <span class="mf">0.001</span>

    <span class="c1"># 使用针孔相机模型</span>
    <span class="n">px1</span> <span class="o">=</span> <span class="p">(</span><span class="n">px1</span> <span class="o">-</span> <span class="n">intrinsics</span><span class="o">.</span><span class="n">cx</span><span class="p">)</span> <span class="o">*</span> <span class="n">pz1</span> <span class="o">/</span> <span class="n">intrinsics</span><span class="o">.</span><span class="n">fx</span>
    <span class="n">py1</span> <span class="o">=</span> <span class="p">(</span><span class="n">py1</span> <span class="o">-</span> <span class="n">intrinsics</span><span class="o">.</span><span class="n">cy</span><span class="p">)</span> <span class="o">*</span> <span class="n">pz1</span> <span class="o">/</span> <span class="n">intrinsics</span><span class="o">.</span><span class="n">fy</span>
    <span class="n">px2</span> <span class="o">=</span> <span class="p">(</span><span class="n">px2</span> <span class="o">-</span> <span class="n">intrinsics</span><span class="o">.</span><span class="n">cx</span><span class="p">)</span> <span class="o">*</span> <span class="n">pz2</span> <span class="o">/</span> <span class="n">intrinsics</span><span class="o">.</span><span class="n">fx</span>
    <span class="n">py2</span> <span class="o">=</span> <span class="p">(</span><span class="n">py2</span> <span class="o">-</span> <span class="n">intrinsics</span><span class="o">.</span><span class="n">cy</span><span class="p">)</span> <span class="o">*</span> <span class="n">pz2</span> <span class="o">/</span> <span class="n">intrinsics</span><span class="o">.</span><span class="n">fy</span>

    <span class="n">p1_cam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">px1</span><span class="p">,</span> <span class="n">py1</span><span class="p">,</span> <span class="n">pz1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">p2_cam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">px2</span><span class="p">,</span> <span class="n">py2</span><span class="p">,</span> <span class="n">pz2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

    <span class="c1"># 2. 正运动学：获取当前末端位姿（4x4变换矩阵）</span>
    <span class="n">forward_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_service</span><span class="o">.</span><span class="n">get_gripper2base_rm</span><span class="p">(</span><span class="n">current_joint_angles</span><span class="p">)</span>

    <span class="c1"># 3. 相机坐标系 → 基坐标系</span>
    <span class="n">T_cam2base</span> <span class="o">=</span> <span class="n">forward_matrix</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">hand_eye_matrix</span>

    <span class="n">p1_base</span> <span class="o">=</span> <span class="n">T_cam2base</span> <span class="o">@</span> <span class="n">p1_cam</span>
    <span class="n">p2_base</span> <span class="o">=</span> <span class="n">T_cam2base</span> <span class="o">@</span> <span class="n">p2_cam</span>
    <span class="n">v_base</span> <span class="o">=</span> <span class="n">p2_base</span> <span class="o">-</span> <span class="n">p1_base</span>

    <span class="c1"># 4. 计算目标位姿</span>
    <span class="c1"># 4.1 计算零件方向向量</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">v_base</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">v_base</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># 4.2 构建绕 Z 轴旋转的变换矩阵</span>
    <span class="n">T_target2base</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_z_rotation_matrix</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">T_target2base</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">p2_base</span>

    <span class="c1"># 4.3 添加偏移量</span>
    <span class="n">T_offset2target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">T_offset2target</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">target_offset</span><span class="o">.</span><span class="n">to_array</span><span class="p">()</span>
    <span class="n">T_target2base</span> <span class="o">=</span> <span class="n">T_target2base</span> <span class="o">@</span> <span class="n">T_offset2target</span>

    <span class="c1"># 4.4 调整末端姿态</span>
    <span class="n">adjustment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">end_effector_adjustment</span>
    <span class="n">T_target2base</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">T_target2base</span> 
        <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_z_rotation_matrix</span><span class="p">(</span><span class="n">adjustment</span><span class="o">.</span><span class="n">z_rotation</span><span class="p">)</span> 
        <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_y_rotation_matrix</span><span class="p">(</span><span class="n">adjustment</span><span class="o">.</span><span class="n">y_rotation</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># 5. 逆运动学求解</span>
    <span class="n">theta_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kinematic_service</span><span class="o">.</span><span class="n">inverse_kinematic</span><span class="p">(</span>
        <span class="n">T_target2base</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">],</span> 
        <span class="n">T_target2base</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="n">initial_theta</span><span class="o">=</span><span class="n">current_joint_angles</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">theta_list</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.HandEyeTransformDomainService.get_z_rotation_matrix" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_z_rotation_matrix</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_z_rotation_matrix</span><span class="p">(</span><span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取绕 Z 轴旋转的齐次变换矩阵。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>angle</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>旋转角度（弧度）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: 4x4 齐次变换矩阵。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/hand_eye_transform_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_z_rotation_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取绕 Z 轴旋转的齐次变换矩阵。</span>

<span class="sd">    Args:</span>
<span class="sd">        angle (float): 旋转角度（弧度）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: 4x4 齐次变换矩阵。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="p">[</span><span class="n">c</span><span class="p">,</span> <span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="n">s</span><span class="p">,</span>  <span class="n">c</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.HandEyeTransformDomainService.get_y_rotation_matrix" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_y_rotation_matrix</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_y_rotation_matrix</span><span class="p">(</span><span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取绕 Y 轴旋转的齐次变换矩阵。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>angle</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>旋转角度（弧度）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: 4x4 齐次变换矩阵。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/hand_eye_transform_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_y_rotation_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取绕 Y 轴旋转的齐次变换矩阵。</span>

<span class="sd">    Args:</span>
<span class="sd">        angle (float): 旋转角度（弧度）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: 4x4 齐次变换矩阵。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="p">[</span> <span class="n">c</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.HandEyeTransformDomainService.get_x_rotation_matrix" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_x_rotation_matrix</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_x_rotation_matrix</span><span class="p">(</span><span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取绕 X 轴旋转的齐次变换矩阵。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>angle</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>旋转角度（弧度）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: 4x4 齐次变换矩阵。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/services/algorithm/hand_eye_transform_domain_service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_x_rotation_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取绕 X 轴旋转的齐次变换矩阵。</span>

<span class="sd">    Args:</span>
<span class="sd">        angle (float): 旋转角度（弧度）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: 4x4 齐次变换矩阵。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="n">c</span><span class="p">,</span> <span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="n">s</span><span class="p">,</span>  <span class="n">c</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.MotionPlan" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MotionPlan</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">MotionPlan</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">points</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">())</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>运动规划方案实体。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionPlan.name">name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>方案名称。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionPlan.points">points</span></code></td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点列表。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">







<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlan.add_point" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_point</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_point</span><span class="p">(</span><span class="n">point_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>添加节点。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>point_data</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点数据。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/entities/motion_plan.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;添加节点。</span>

<span class="sd">    Args:</span>
<span class="sd">        point_data (dict): 节点数据。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlan.remove_point" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">remove_point</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">remove_point</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>删除节点。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/entities/motion_plan.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;删除节点。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 节点索引。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlan.move_point_up" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">move_point_up</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">move_point_up</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>上移节点。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否成功移动。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/entities/motion_plan.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_point_up</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;上移节点。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 节点索引。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 是否成功移动。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlan.move_point_down" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">move_point_down</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">move_point_down</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>下移节点。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否成功移动。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/entities/motion_plan.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_point_down</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;下移节点。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 节点索引。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 是否成功移动。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlan.update_point" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">update_point</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">update_point</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">point_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>更新节点。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>节点索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>point_data</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>新的节点数据。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/domain/entities/motion_plan.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">point_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;更新节点。</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): 节点索引。</span>
<span class="sd">        point_data (dict): 新的节点数据。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">point_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.PortScanner" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">PortScanner</span>


</h3>


    <div class="doc doc-contents ">



        <p>串口端口扫描器。</p>
<p>负责扫描可用的串口端口，包含真实串口和虚拟串口。</p>











<div class="doc doc-children">







<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.PortScanner.scan_ports" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">scan_ports</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">scan_ports</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>扫描可用的串口端口（包含真实串口和虚拟串口）。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[str]: 可用端口名称列表。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/communication/port_scanner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">scan_ports</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;扫描可用的串口端口（包含真实串口和虚拟串口）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: 可用端口名称列表。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">all_ports</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 1. 扫描真实硬件串口</span>
        <span class="n">ports</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">list_ports</span><span class="o">.</span><span class="n">comports</span><span class="p">()</span>
        <span class="n">all_ports</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">port</span><span class="o">.</span><span class="n">device</span> <span class="k">for</span> <span class="n">port</span> <span class="ow">in</span> <span class="n">ports</span><span class="p">])</span>

        <span class="c1"># 2. 扫描虚拟串口（伪终端）</span>
        <span class="n">virtual_port_patterns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;/dev/pts/*&#39;</span><span class="p">,</span>      <span class="c1"># 伪终端</span>
            <span class="s1">&#39;/tmp/tty*&#39;</span><span class="p">,</span>       <span class="c1"># 临时虚拟串口（socat创建的）</span>
            <span class="s1">&#39;/dev/ttyV*&#39;</span><span class="p">,</span>      <span class="c1"># 虚拟串口设备</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">virtual_port_patterns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">pattern</span><span class="p">):</span>
                <span class="c1"># 检查是否是字符设备且可访问</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="ow">and</span> <span class="n">PortScanner</span><span class="o">.</span><span class="n">_is_accessible</span><span class="p">(</span><span class="n">device</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">device</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_ports</span><span class="p">:</span>
                        <span class="n">all_ports</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

        <span class="c1"># 排序：真实串口在前，虚拟串口在后</span>
        <span class="n">all_ports</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;/dev/ttyUSB&#39;</span><span class="p">),</span> 
                                     <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;/dev/ttyACM&#39;</span><span class="p">),</span> 
                                     <span class="n">x</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">all_ports</span>

    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">all_ports</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.PortScanner.get_port_info" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_port_info</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_port_info</span><span class="p">(</span><span class="n">port_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取指定端口的详细信息（支持真实串口和虚拟串口）。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>port_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>端口名称。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[Dict[str, str]]: 端口信息字典，包含 description 和 hwid。如果端口不可用则返回 None。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/communication/port_scanner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_port_info</span><span class="p">(</span><span class="n">port_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取指定端口的详细信息（支持真实串口和虚拟串口）。</span>

<span class="sd">    Args:</span>
<span class="sd">        port_name (str): 端口名称。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[Dict[str, str]]: 端口信息字典，包含 description 和 hwid。如果端口不可用则返回 None。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 1. 先尝试从真实硬件串口获取信息</span>
        <span class="n">ports</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">list_ports</span><span class="o">.</span><span class="n">comports</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">port</span> <span class="ow">in</span> <span class="n">ports</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">port</span><span class="o">.</span><span class="n">device</span> <span class="o">==</span> <span class="n">port_name</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">{</span>
                    <span class="s1">&#39;device&#39;</span><span class="p">:</span> <span class="n">port</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
                    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="n">port</span><span class="o">.</span><span class="n">description</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;hwid&#39;</span><span class="p">:</span> <span class="n">port</span><span class="o">.</span><span class="n">hwid</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span>
                <span class="p">}</span>

        <span class="c1"># 2. 如果是虚拟串口，返回自定义信息</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">port_name</span><span class="p">):</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;虚拟串口&quot;</span>

            <span class="c1"># 根据路径判断类型</span>
            <span class="k">if</span> <span class="n">port_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;/tmp/&#39;</span><span class="p">):</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;临时虚拟串口 (socat)&quot;</span>
            <span class="k">elif</span> <span class="n">port_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;/dev/pts/&#39;</span><span class="p">):</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;伪终端 (pty)&quot;</span>
            <span class="k">elif</span> <span class="n">port_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;/dev/ttyV&#39;</span><span class="p">):</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;虚拟串口设备&quot;</span>

            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;device&#39;</span><span class="p">:</span> <span class="n">port_name</span><span class="p">,</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span>
                <span class="s1">&#39;hwid&#39;</span><span class="p">:</span> <span class="s1">&#39;VIRTUAL&#39;</span>
            <span class="p">}</span>

        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.PortScanner.get_all_port_info" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_all_port_info</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_all_port_info</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取所有可用端口的详细信息（包含真实串口和虚拟串口）。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, str]]: 所有端口信息列表。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/communication/port_scanner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_all_port_info</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取所有可用端口的详细信息（包含真实串口和虚拟串口）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, str]]: 所有端口信息列表。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">all_port_info</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># 获取所有端口</span>
        <span class="n">all_ports</span> <span class="o">=</span> <span class="n">PortScanner</span><span class="o">.</span><span class="n">scan_ports</span><span class="p">()</span>

        <span class="c1"># 为每个端口获取信息</span>
        <span class="k">for</span> <span class="n">port_name</span> <span class="ow">in</span> <span class="n">all_ports</span><span class="p">:</span>
            <span class="n">port_info</span> <span class="o">=</span> <span class="n">PortScanner</span><span class="o">.</span><span class="n">get_port_info</span><span class="p">(</span><span class="n">port_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">port_info</span><span class="p">:</span>
                <span class="n">all_port_info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">port_info</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">all_port_info</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span> 
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.SerialAdapter" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">SerialAdapter</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">SerialAdapter</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>串口连接适配器。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.SerialAdapter.serial_port">serial_port</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="serial.Serial">Serial</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PySerial 实例。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.SerialAdapter.current_config">current_config</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>当前配置字典。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化串口适配器。</p>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/infrastructure/communication/serial_adapter.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化串口适配器。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">serial_port</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialAdapter.connect" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">connect</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">connect</span><span class="p">(</span><span class="n">port</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>连接串口。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>port</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>串口名称。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>串口配置参数。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>连接是否成功。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/communication/serial_adapter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;连接串口。</span>

<span class="sd">    Args:</span>
<span class="sd">        port (str): 串口名称。</span>
<span class="sd">        config (Dict[str, Any]): 串口配置参数。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 连接是否成功。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 如果已经连接，先断开</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_connected</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

        <span class="c1"># 创建串口连接</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serial_port</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span>
            <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
            <span class="n">baudrate</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;baudrate&#39;</span><span class="p">,</span> <span class="mi">115200</span><span class="p">),</span>
            <span class="n">bytesize</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bytesize&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
            <span class="n">parity</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parity&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">),</span>
            <span class="n">stopbits</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;stopbits&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">timeout</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;timeout&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">xonxoff</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xonxoff&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
            <span class="n">rtscts</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rtscts&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
            <span class="n">dsrdtr</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dsrdtr&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># 保存配置</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_config</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">port</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serial_port</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_config</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialAdapter.disconnect" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">disconnect</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">disconnect</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>断开串口连接。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>断开是否成功。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/communication/serial_adapter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;断开串口连接。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 断开是否成功。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_port</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_port</span><span class="o">.</span><span class="n">is_open</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">serial_port</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serial_port</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_config</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialAdapter.is_connected" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">is_connected</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_connected</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>检查串口是否已连接。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否已连接。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/communication/serial_adapter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;检查串口是否已连接。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 是否已连接。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">serial_port</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">serial_port</span><span class="o">.</span><span class="n">is_open</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialAdapter.get_serial_port" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_serial_port</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_serial_port</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取串口对象。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="serial.Serial">Serial</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[serial.Serial]: 串口对象，未连接时返回None。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/communication/serial_adapter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_serial_port</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取串口对象。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[serial.Serial]: 串口对象，未连接时返回None。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_connected</span><span class="p">():</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_port</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialAdapter.get_current_config" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_current_config</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_current_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取当前连接配置。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[Dict[str, Any]]: 当前配置，未连接时返回 None。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/communication/serial_adapter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_current_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取当前连接配置。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[Dict[str, Any]]: 当前配置，未连接时返回 None。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_config</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_config</span> <span class="k">else</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialAdapter.get_port_name" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_port_name</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_port_name</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>获取当前连接的端口名称。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[str]: 端口名称，未连接时返回 None。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/communication/serial_adapter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_port_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;获取当前连接的端口名称。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[str]: 端口名称，未连接时返回 None。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_config</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;port&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.SerialReader" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">SerialReader</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">SerialReader</span><span class="p">(</span><span class="n">serial_port</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Serial</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="PyQt5.QtCore.QObject">QObject</span></code></p>



        <p>串口读取处理类。</p>
<p>负责在独立线程中读取串口数据，支持多种编码格式。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.SerialReader.data_received">data_received</span></code></td>
            <td>
                  <code><span title="PyQt5.QtCore.pyqtSignal">pyqtSignal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>接收到数据时发送信号，携带十六进制字符串。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化串口读取器。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>serial_port</code>
            </td>
            <td>
                  <code><span title="serial.Serial">Serial</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>串口对象。</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/infrastructure/communication/serial_reader.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">serial_port</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化串口读取器。</span>

<span class="sd">    Args:</span>
<span class="sd">        serial_port (serial.Serial, optional): 串口对象。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">serial_port</span> <span class="o">=</span> <span class="n">serial_port</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stop_flag</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialReader.stop" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">stop</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">stop</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>停止读取。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/communication/serial_reader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;停止读取。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stop_flag</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialReader.read_data" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">read_data</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">read_data</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>读取串口数据 - 在独立线程中运行。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/communication/serial_reader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">read_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;读取串口数据 - 在独立线程中运行。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stop_flag</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_flag</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_port</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_port</span><span class="o">.</span><span class="n">is_open</span><span class="p">:</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">waiting_bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_port</span><span class="o">.</span><span class="n">in_waiting</span>
        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">waiting_bytes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_port</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">waiting_bytes</span><span class="p">)</span>

                <span class="c1"># 固定使用十六进制格式</span>
                <span class="n">hex_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data_received</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">hex_data</span><span class="p">)</span>

            <span class="k">except</span> <span class="n">serial</span><span class="o">.</span><span class="n">SerialException</span><span class="p">:</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
                <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>

        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span> 
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.SerialWriter" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">SerialWriter</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">SerialWriter</span><span class="p">(</span><span class="n">serial_port</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Serial</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="PyQt5.QtCore.QObject">QObject</span></code></p>



        <p>串口发送处理类。</p>
<p>负责在独立线程中发送串口数据，使用队列管理发送任务。</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.SerialWriter.serial_port">serial_port</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="serial.Serial">Serial</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>串口对象。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.SerialWriter.send_queue">send_queue</span></code></td>
            <td>
                  <code><span title="queue.Queue">Queue</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>发送任务队列。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化串口写入器。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>serial_port</code>
            </td>
            <td>
                  <code><span title="serial.Serial">Serial</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>串口对象。</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/infrastructure/communication/serial_writer.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">serial_port</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化串口写入器。</span>

<span class="sd">    Args:</span>
<span class="sd">        serial_port (serial.Serial, optional): 串口对象。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">serial_port</span> <span class="o">=</span> <span class="n">serial_port</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">send_queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stop_flag</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialWriter.stop" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">stop</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">stop</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>停止发送。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/communication/serial_writer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;停止发送。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stop_flag</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialWriter.add_to_queue" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_to_queue</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_to_queue</span><span class="p">(</span><span class="n">cmd</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>添加命令到发送队列。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cmd</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="bytes">bytes</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>待发送的命令（十六进制字符串或字节）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/communication/serial_writer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_to_queue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;添加命令到发送队列。</span>

<span class="sd">    Args:</span>
<span class="sd">        cmd (Union[str, bytes]): 待发送的命令（十六进制字符串或字节）。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">send_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.SerialWriter.send_data" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">send_data</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">send_data</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>发送串口数据 - 在独立线程中运行。</p>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/communication/serial_writer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">send_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;发送串口数据 - 在独立线程中运行。&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stop_flag</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_flag</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_port</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_port</span><span class="o">.</span><span class="n">is_open</span><span class="p">:</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_queue</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">cmd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                        <span class="n">cmd</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">cmd</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">serial_port</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">serial_port</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">send_queue</span><span class="o">.</span><span class="n">task_done</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="c1"># 静默处理错误，不发送信号</span>
                    <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># 队列为空时短暂休眠，避免CPU空转</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># 静默处理错误，不发送信号</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span> 
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.RecordRepository" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">RecordRepository</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">RecordRepository</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;teach_record.json&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>示教记录持久化仓库 - Infrastructure层。</p>
<p>职责：
- 从JSON文件加载记录数据
- 保存记录数据到JSON文件
- 管理记录文件的读写</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.RecordRepository.file_path">file_path</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>记录文件路径。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化记录仓库。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>记录文件路径. Defaults to "teach_record.json".</p>
              </div>
            </td>
            <td>
                  <code>&#39;teach_record.json&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/infrastructure/persistence/record_repository.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;teach_record.json&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化记录仓库。</span>

<span class="sd">    Args:</span>
<span class="sd">        file_path (str, optional): 记录文件路径. Defaults to &quot;teach_record.json&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RecordRepository.load_records" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">load_records</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">load_records</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>从文件加载记录数据。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict[str, List[List[float]]]: 记录数据字典 {记录名: 角度列表}。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/persistence/record_repository.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_records</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;从文件加载记录数据。</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, List[List[float]]]: 记录数据字典 {记录名: 角度列表}。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">):</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{}</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RecordRepository.save_records" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">save_records</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">save_records</span><span class="p">(</span><span class="n">records</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]])</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>保存记录数据到文件。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>records</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>记录数据字典。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否保存成功。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/persistence/record_repository.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">records</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;保存记录数据到文件。</span>

<span class="sd">    Args:</span>
<span class="sd">        records (Dict[str, List[List[float]]]): 记录数据字典。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 是否保存成功。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">records</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.RecordRepository.delete_file" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">delete_file</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">delete_file</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>删除记录文件。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>是否删除成功。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/persistence/record_repository.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;删除记录文件。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: 是否删除成功。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.MotionPlanRepository" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MotionPlanRepository</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">MotionPlanRepository</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;./motion_planning_plans.json&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>运动方案持久化仓库。</p>
<p>职责：
1. 保存/加载方案到JSON文件
2. 管理文件系统操作</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.MotionPlanRepository.file_path">file_path</span></code></td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>方案文件路径。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化仓库。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>文件路径. Defaults to "./motion_planning_plans.json".</p>
              </div>
            </td>
            <td>
                  <code>&#39;./motion_planning_plans.json&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/infrastructure/persistence/motion_plan_repository.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;./motion_planning_plans.json&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化仓库。</span>

<span class="sd">    Args:</span>
<span class="sd">        file_path (str, optional): 文件路径. Defaults to &quot;./motion_planning_plans.json&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanRepository.save" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">save</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">save</span><span class="p">(</span><span class="n">plans_data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">],</span> <span class="n">current_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>保存方案数据到文件。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>plans_data</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>方案数据列表。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>当前选中方案索引。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/persistence/motion_plan_repository.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plans_data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">],</span> <span class="n">current_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;保存方案数据到文件。</span>

<span class="sd">    Args:</span>
<span class="sd">        plans_data (List[Dict]): 方案数据列表。</span>
<span class="sd">        current_index (int): 当前选中方案索引。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;current_index&quot;</span><span class="p">:</span> <span class="n">current_index</span><span class="p">,</span>
        <span class="s2">&quot;plans&quot;</span><span class="p">:</span> <span class="n">plans_data</span>
    <span class="p">}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.MotionPlanRepository.load" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">load</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">load</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">],</span> <span class="nb">int</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>从文件加载方案数据。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>], <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[List[Dict], int]: (plans_data, current_index)。
如果文件不存在或加载失败，返回默认方案。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/persistence/motion_plan_repository.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">],</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;从文件加载方案数据。</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[List[Dict], int]: (plans_data, current_index)。</span>
<span class="sd">            如果文件不存在或加载失败，返回默认方案。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="c1"># 返回默认方案</span>
        <span class="k">return</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;默认方案&quot;</span><span class="p">,</span> <span class="s2">&quot;points&quot;</span><span class="p">:</span> <span class="p">[]}],</span> <span class="mi">0</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="n">plans</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;plans&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">current_index</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;current_index&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># 如果没有方案，创建默认方案</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">plans</span><span class="p">:</span>
            <span class="n">plans</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;默认方案&quot;</span><span class="p">,</span> <span class="s2">&quot;points&quot;</span><span class="p">:</span> <span class="p">[]}]</span>
            <span class="n">current_index</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">return</span> <span class="n">plans</span><span class="p">,</span> <span class="n">current_index</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;默认方案&quot;</span><span class="p">,</span> <span class="s2">&quot;points&quot;</span><span class="p">:</span> <span class="p">[]}],</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.HandEyeCalibrationRepository" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">HandEyeCalibrationRepository</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">HandEyeCalibrationRepository</span><span class="p">(</span><span class="n">config_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>手眼标定配置仓储 - Infrastructure层。</p>
<p>负责从文件系统读取配置。</p>
<p>职责：
- 从 JSON 文件加载配置
- 转换为 Domain 层的值对象
- 处理文件不存在等异常</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.HandEyeCalibrationRepository.config_path">config_path</span></code></td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>配置文件路径。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化配置仓储。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>配置文件路径. Defaults to None.
如果为 None，则按以下优先级查找：
1. ROS2 share 目录 (controller/config/hand_eye_calibration.json)
2. 开发环境相对路径 (../../config/hand_eye_calibration.json)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/infrastructure/persistence/hand_eye_calibration_repository.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化配置仓储。</span>

<span class="sd">    Args:</span>
<span class="sd">        config_path (str, optional): 配置文件路径. Defaults to None.</span>
<span class="sd">            如果为 None，则按以下优先级查找：</span>
<span class="sd">            1. ROS2 share 目录 (controller/config/hand_eye_calibration.json)</span>
<span class="sd">            2. 开发环境相对路径 (../../config/hand_eye_calibration.json)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">config_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># 使用 ROS2 包资源管理方式查找配置文件</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># ROS2 方式：从 share 目录加载</span>
            <span class="n">package_share_dir</span> <span class="o">=</span> <span class="n">get_package_share_directory</span><span class="p">(</span><span class="s1">&#39;controller&#39;</span><span class="p">)</span>
            <span class="n">config_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">package_share_dir</span><span class="p">)</span> <span class="o">/</span> <span class="s1">&#39;config&#39;</span> <span class="o">/</span> <span class="s1">&#39;hand_eye_calibration.json&#39;</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># 如果包未安装，使用相对路径（开发模式）</span>
            <span class="n">current_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
            <span class="n">controller_root</span> <span class="o">=</span> <span class="n">current_file</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span>
            <span class="n">config_path</span> <span class="o">=</span> <span class="n">controller_root</span> <span class="o">/</span> <span class="s2">&quot;config&quot;</span> <span class="o">/</span> <span class="s2">&quot;hand_eye_calibration.json&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">config_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.HandEyeCalibrationRepository.load" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">load</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">load</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">HandEyeCalibrationConfig</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>加载手眼标定配置。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>HandEyeCalibrationConfig</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="HandEyeCalibrationConfig


  
      dataclass
   (controller.domain.value_objects.HandEyeCalibrationConfig)" href="#controller.shared.config.service_registry.HandEyeCalibrationConfig">HandEyeCalibrationConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>配置值对象。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">引发：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="FileNotFoundError">FileNotFoundError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>配置文件不存在。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>配置格式错误。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/persistence/hand_eye_calibration_repository.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HandEyeCalibrationConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;加载手眼标定配置。</span>

<span class="sd">    Returns:</span>
<span class="sd">        HandEyeCalibrationConfig: 配置值对象。</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: 配置文件不存在。</span>
<span class="sd">        ValueError: 配置格式错误。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;配置文件不存在: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;请在 controller/config/ 目录下创建 hand_eye_calibration.json&quot;</span>
        <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;配置文件格式错误: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># 解析手眼标定矩阵</span>
    <span class="n">hand_eye_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;hand_eye_matrix&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># 解析相机内参</span>
    <span class="n">intrinsics_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;camera_intrinsics&#39;</span><span class="p">]</span>
    <span class="n">camera_intrinsics</span> <span class="o">=</span> <span class="n">CameraIntrinsics</span><span class="p">(</span>
        <span class="n">fx</span><span class="o">=</span><span class="n">intrinsics_data</span><span class="p">[</span><span class="s1">&#39;fx&#39;</span><span class="p">],</span>
        <span class="n">fy</span><span class="o">=</span><span class="n">intrinsics_data</span><span class="p">[</span><span class="s1">&#39;fy&#39;</span><span class="p">],</span>
        <span class="n">cx</span><span class="o">=</span><span class="n">intrinsics_data</span><span class="p">[</span><span class="s1">&#39;cx&#39;</span><span class="p">],</span>
        <span class="n">cy</span><span class="o">=</span><span class="n">intrinsics_data</span><span class="p">[</span><span class="s1">&#39;cy&#39;</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="c1"># 解析目标偏移量</span>
    <span class="n">offset_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target_offset&#39;</span><span class="p">]</span>
    <span class="n">target_offset</span> <span class="o">=</span> <span class="n">TargetOffset</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">offset_data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">offset_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
        <span class="n">z</span><span class="o">=</span><span class="n">offset_data</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="c1"># 解析末端姿态调整（角度转弧度）</span>
    <span class="n">adjustment_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;end_effector_adjustment&#39;</span><span class="p">]</span>
    <span class="n">end_effector_adjustment</span> <span class="o">=</span> <span class="n">EndEffectorAdjustment</span><span class="p">(</span>
        <span class="n">z_rotation</span><span class="o">=</span><span class="n">radians</span><span class="p">(</span><span class="n">adjustment_data</span><span class="p">[</span><span class="s1">&#39;z_rotation_deg&#39;</span><span class="p">]),</span>
        <span class="n">y_rotation</span><span class="o">=</span><span class="n">radians</span><span class="p">(</span><span class="n">adjustment_data</span><span class="p">[</span><span class="s1">&#39;y_rotation_deg&#39;</span><span class="p">]),</span>
        <span class="n">x_rotation</span><span class="o">=</span><span class="n">radians</span><span class="p">(</span><span class="n">adjustment_data</span><span class="p">[</span><span class="s1">&#39;x_rotation_deg&#39;</span><span class="p">])</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">HandEyeCalibrationConfig</span><span class="p">(</span>
        <span class="n">hand_eye_matrix</span><span class="o">=</span><span class="n">hand_eye_matrix</span><span class="p">,</span>
        <span class="n">camera_intrinsics</span><span class="o">=</span><span class="n">camera_intrinsics</span><span class="p">,</span>
        <span class="n">target_offset</span><span class="o">=</span><span class="n">target_offset</span><span class="p">,</span>
        <span class="n">end_effector_adjustment</span><span class="o">=</span><span class="n">end_effector_adjustment</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.HandEyeCalibrationRepository.save" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">save</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">save</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">HandEyeCalibrationConfig</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>保存配置到文件（可选功能，用于标定工具）。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="HandEyeCalibrationConfig


  
      dataclass
   (controller.domain.value_objects.HandEyeCalibrationConfig)" href="#controller.shared.config.service_registry.HandEyeCalibrationConfig">HandEyeCalibrationConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>手眼标定配置对象。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/persistence/hand_eye_calibration_repository.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">HandEyeCalibrationConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;保存配置到文件（可选功能，用于标定工具）。</span>

<span class="sd">    Args:</span>
<span class="sd">        config (HandEyeCalibrationConfig): 手眼标定配置对象。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 确保目录存在</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">config_path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;hand_eye_matrix&quot;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">hand_eye_matrix</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
        <span class="s2">&quot;camera_intrinsics&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;fx&quot;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">camera_intrinsics</span><span class="o">.</span><span class="n">fx</span><span class="p">,</span>
            <span class="s2">&quot;fy&quot;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">camera_intrinsics</span><span class="o">.</span><span class="n">fy</span><span class="p">,</span>
            <span class="s2">&quot;cx&quot;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">camera_intrinsics</span><span class="o">.</span><span class="n">cx</span><span class="p">,</span>
            <span class="s2">&quot;cy&quot;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">camera_intrinsics</span><span class="o">.</span><span class="n">cy</span>
        <span class="p">},</span>
        <span class="s2">&quot;target_offset&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">target_offset</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
            <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">target_offset</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
            <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">target_offset</span><span class="o">.</span><span class="n">z</span><span class="p">,</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;相对于零件位置的偏移量（米）&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;end_effector_adjustment&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;z_rotation_deg&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">end_effector_adjustment</span><span class="o">.</span><span class="n">z_rotation</span><span class="p">),</span>
            <span class="s2">&quot;y_rotation_deg&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">end_effector_adjustment</span><span class="o">.</span><span class="n">y_rotation</span><span class="p">),</span>
            <span class="s2">&quot;x_rotation_deg&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">end_effector_adjustment</span><span class="o">.</span><span class="n">x_rotation</span><span class="p">),</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;末端姿态调整（角度）&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="controller.shared.config.service_registry.TrajectoryRepository" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">TrajectoryRepository</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">TrajectoryRepository</span><span class="p">(</span><span class="n">plans_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;./plans&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">



        <p>轨迹数据仓库 - Infrastructure层。</p>
<p>职责：
1. 保存轨迹数据到文件系统
2. 加载轨迹数据
3. 管理存储目录</p>


<p><span class="doc-section-title">属性：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="controller.shared.config.service_registry.TrajectoryRepository.plans_dir">plans_dir</span></code></td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>轨迹存储目录。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>初始化轨迹仓库。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>plans_dir</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>存储目录. Defaults to "./plans".</p>
              </div>
            </td>
            <td>
                  <code>&#39;./plans&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>源代码位于： <code>src/controller/controller/infrastructure/persistence/trajectory_repository.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plans_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;./plans&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;初始化轨迹仓库。</span>

<span class="sd">    Args:</span>
<span class="sd">        plans_dir (str, optional): 存储目录. Defaults to &quot;./plans&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">plans_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">plans_dir</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">plans_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.TrajectoryRepository.save_trajectory" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">save_trajectory</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">save_trajectory</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">positions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>保存轨迹数据。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>文件名（不含扩展名）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>positions</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>轨迹点序列 [[q1,...,q6], ...]。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/persistence/trajectory_repository.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_trajectory</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
    <span class="n">positions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;保存轨迹数据。</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): 文件名（不含扩展名）。</span>
<span class="sd">        positions (List[List[float]]): 轨迹点序列 [[q1,...,q6], ...]。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">clean_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sanitize_filename</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plans_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">clean_name</span><span class="si">}</span><span class="s2">.json&quot;</span>

    <span class="c1"># 将numpy数组转换为Python列表</span>
    <span class="n">positions_serializable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_to_serializable</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">positions_serializable</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.TrajectoryRepository.load_trajectory" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">load_trajectory</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">load_trajectory</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>加载轨迹数据。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>文件名（不含扩展名）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[List[float]]: 轨迹点序列。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/persistence/trajectory_repository.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;加载轨迹数据。</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): 文件名（不含扩展名）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[List[float]]: 轨迹点序列。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plans_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.json&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.TrajectoryRepository.list_trajectory_files" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">list_trajectory_files</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">list_trajectory_files</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>列出所有可用的轨迹文件。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[str]: 文件名列表（不带扩展名）。</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>例如</code></td>            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>["默认方案-0", "默认方案-1", "test_trajectory"]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/persistence/trajectory_repository.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_trajectory_files</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;列出所有可用的轨迹文件。</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: 文件名列表（不带扩展名）。</span>
<span class="sd">        例如: [&quot;默认方案-0&quot;, &quot;默认方案-1&quot;, &quot;test_trajectory&quot;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">plans_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plans_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.json&quot;</span><span class="p">):</span>
        <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">stem</span><span class="p">)</span>  <span class="c1"># 文件名不带扩展名</span>

    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="controller.shared.config.service_registry.TrajectoryRepository.trajectory_exists" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">trajectory_exists</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">trajectory_exists</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>检查轨迹文件是否存在。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>文件名（不含扩展名）。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True=文件存在, False=文件不存在。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/infrastructure/persistence/trajectory_repository.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">trajectory_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;检查轨迹文件是否存在。</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): 文件名（不含扩展名）。</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True=文件存在, False=文件不存在。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plans_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.json&quot;</span>
    <span class="k">return</span> <span class="n">filepath</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-function">


<h3 id="controller.shared.config.service_registry.register_infrastructure_services" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">register_infrastructure_services</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">register_infrastructure_services</span><span class="p">(</span><span class="n">container</span><span class="p">:</span> <span class="n">DIContainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>注册 Infrastructure 层服务。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>container</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DIContainer (controller.shared.config.di_container.DIContainer)" href="../di_container/#controller.shared.config.di_container.DIContainer">DIContainer</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DI 容器实例。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/shared/config/service_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">register_infrastructure_services</span><span class="p">(</span><span class="n">container</span><span class="p">:</span> <span class="n">DIContainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;注册 Infrastructure 层服务。</span>

<span class="sd">    Args:</span>
<span class="sd">        container (DIContainer): DI 容器实例。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 记录数据持久化仓库</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">RecordRepository</span><span class="p">)</span>
    <span class="c1"># 运动规划方案持久化仓库</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">MotionPlanRepository</span><span class="p">)</span>
    <span class="c1"># 手眼标定配置仓库</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">HandEyeCalibrationRepository</span><span class="p">)</span>
    <span class="c1"># 轨迹数据仓库</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">TrajectoryRepository</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h3 id="controller.shared.config.service_registry.register_domain_services" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">register_domain_services</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">register_domain_services</span><span class="p">(</span><span class="n">container</span><span class="p">:</span> <span class="n">DIContainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>注册 Domain 层服务。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>container</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DIContainer (controller.shared.config.di_container.DIContainer)" href="../di_container/#controller.shared.config.di_container.DIContainer">DIContainer</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DI 容器实例。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/shared/config/service_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">register_domain_services</span><span class="p">(</span><span class="n">container</span><span class="p">:</span> <span class="n">DIContainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;注册 Domain 层服务。</span>

<span class="sd">    Args:</span>
<span class="sd">        container (DIContainer): DI 容器实例。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">SerialDomainService</span><span class="p">)</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">MessageEncoder</span><span class="p">)</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">MessageDecoder</span><span class="p">)</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">MessageDomainService</span><span class="p">)</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">MotionRunner</span><span class="p">)</span>
    <span class="c1"># 轨迹平滑服务</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">SmoothDomainService</span><span class="p">)</span>
    <span class="c1"># 运动学和轨迹规划服务</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">KinematicDomainService</span><span class="p">)</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">LinearMotionDomainService</span><span class="p">)</span>  <span class="c1"># 依赖 KinematicDomainService</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">CurveMotionDomainService</span><span class="p">)</span>  <span class="c1"># 依赖 KinematicDomainService</span>
    <span class="c1"># S曲线算法</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">SCurve</span><span class="p">)</span>
    <span class="c1"># 轨迹规划服务（依赖 SCurve, SmoothDomainService, LinearMotionDomainService, CurveMotionDomainService）</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">TrajectoryPlanningService</span><span class="p">)</span>
    <span class="c1"># 运动构造器（依赖 MotionRunner, TrajectoryPlanningService）</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">MotionConstructor</span><span class="p">)</span>
    <span class="c1"># 机械臂状态服务</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">RobotStateDomainService</span><span class="p">)</span>
    <span class="c1"># 动力学服务</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">DynamicDomainService</span><span class="p">)</span>
    <span class="c1"># 示教记录服务</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">TeachRecordDomainService</span><span class="p">)</span>
    <span class="c1"># 运动规划服务</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">MotionPlanningDomainService</span><span class="p">)</span>
    <span class="c1"># 视觉服务</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">CameraDomainService</span><span class="p">)</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">RecognitionDomainService</span><span class="p">)</span>

    <span class="c1"># 手眼标定配置（作为值对象注入）</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_hand_eye_config</span><span class="p">():</span>
        <span class="n">repo</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">HandEyeCalibrationRepository</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">repo</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">HandEyeCalibrationConfig</span><span class="p">,</span> <span class="n">create_hand_eye_config</span><span class="p">)</span>

    <span class="c1"># 手眼标定服务（会自动注入 HandEyeCalibrationConfig 和 KinematicDomainService）</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">HandEyeTransformDomainService</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h3 id="controller.shared.config.service_registry.register_application_services" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">register_application_services</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">register_application_services</span><span class="p">(</span><span class="n">container</span><span class="p">:</span> <span class="n">DIContainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>注册 Application 层服务。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>container</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DIContainer (controller.shared.config.di_container.DIContainer)" href="../di_container/#controller.shared.config.di_container.DIContainer">DIContainer</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DI 容器实例。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/shared/config/service_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">register_application_services</span><span class="p">(</span><span class="n">container</span><span class="p">:</span> <span class="n">DIContainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;注册 Application 层服务。</span>

<span class="sd">    Args:</span>
<span class="sd">        container (DIContainer): DI 容器实例。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">MessageDisplay</span><span class="p">)</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">SerialApplicationService</span><span class="p">)</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">CommandHubService</span><span class="p">)</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">MessageResponseService</span><span class="p">)</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">MotionListener</span><span class="p">)</span>
    <span class="c1"># 运动规划应用服务</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">MotionPlanningApplicationService</span><span class="p">)</span>
    <span class="c1"># 摄像头应用服务</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">CameraApplicationService</span><span class="p">)</span>
    <span class="c1"># 工具应用服务</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">ToolsApplicationService</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h3 id="controller.shared.config.service_registry.register_presentation_services" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">register_presentation_services</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">register_presentation_services</span><span class="p">(</span><span class="n">container</span><span class="p">:</span> <span class="n">DIContainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>注册 Presentation 层服务。</p>


<p><span class="doc-section-title">参数：</span></p>
    <table>
      <thead>
        <tr>
          <th>名称</th>
          <th>类型</th>
          <th>描述</th>
          <th>默认</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>container</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DIContainer (controller.shared.config.di_container.DIContainer)" href="../di_container/#controller.shared.config.di_container.DIContainer">DIContainer</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DI 容器实例。</p>
              </div>
            </td>
            <td>
                <em>必需</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/shared/config/service_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">register_presentation_services</span><span class="p">(</span><span class="n">container</span><span class="p">:</span> <span class="n">DIContainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;注册 Presentation 层服务。</span>

<span class="sd">    Args:</span>
<span class="sd">        container (DIContainer): DI 容器实例。</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">DisplayViewModel</span><span class="p">)</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">SerialViewModel</span><span class="p">)</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">StatusViewModel</span><span class="p">)</span>  
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">ControlViewModel</span><span class="p">)</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">EffectorViewModel</span><span class="p">)</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">TrajectoryViewModel</span><span class="p">)</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">DynamicsViewModel</span><span class="p">)</span>  
    <span class="c1"># CameraViewModel 只依赖 CameraApplicationService（Application层）</span>
    <span class="c1"># DI容器会自动根据构造函数注入依赖</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">CameraViewModel</span><span class="p">)</span>
    <span class="c1"># 运动规划ViewModel</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">MotionPlanningViewModel</span><span class="p">)</span>
    <span class="c1"># 工具ViewModel</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">ToolsViewModel</span><span class="p">)</span>
    <span class="n">container</span><span class="o">.</span><span class="n">register_singleton</span><span class="p">(</span><span class="n">MainViewModel</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h3 id="controller.shared.config.service_registry.configure_services" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">configure_services</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">configure_services</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">DIContainer</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>配置所有服务。</p>
<p>按层次注册所有依赖服务。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>DIContainer</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="DIContainer (controller.shared.config.di_container.DIContainer)" href="../di_container/#controller.shared.config.di_container.DIContainer">DIContainer</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>配置好的容器实例。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/shared/config/service_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">configure_services</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">DIContainer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;配置所有服务。</span>

<span class="sd">    按层次注册所有依赖服务。</span>

<span class="sd">    Returns:</span>
<span class="sd">        DIContainer: 配置好的容器实例。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">container</span> <span class="o">=</span> <span class="n">get_container</span><span class="p">()</span>

    <span class="c1"># 按层次注册服务</span>
    <span class="n">register_infrastructure_services</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
    <span class="n">register_domain_services</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
    <span class="n">register_application_services</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
    <span class="n">register_presentation_services</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">container</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h3 id="controller.shared.config.service_registry.get_main_view_model" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_main_view_model</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_main_view_model</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">MainViewModel</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>便捷方法：获取主视图模型。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>MainViewModel</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="MainViewModel (controller.presentation.MainViewModel)" href="#controller.shared.config.service_registry.MainViewModel">MainViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>主视图模型实例。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/shared/config/service_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_main_view_model</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">MainViewModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;便捷方法：获取主视图模型。</span>

<span class="sd">    Returns:</span>
<span class="sd">        MainViewModel: 主视图模型实例。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">resolve</span><span class="p">(</span><span class="n">MainViewModel</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h3 id="controller.shared.config.service_registry.get_serial_service" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_serial_service</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_serial_service</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">SerialApplicationService</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>便捷方法：获取串口服务。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>SerialApplicationService</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="SerialApplicationService (controller.application.SerialApplicationService)" href="#controller.shared.config.service_registry.SerialApplicationService">SerialApplicationService</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>串口应用服务实例。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/shared/config/service_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_serial_service</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">SerialApplicationService</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;便捷方法：获取串口服务。</span>

<span class="sd">    Returns:</span>
<span class="sd">        SerialApplicationService: 串口应用服务实例。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">resolve</span><span class="p">(</span><span class="n">SerialApplicationService</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h3 id="controller.shared.config.service_registry.get_serial_view_model" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_serial_view_model</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_serial_view_model</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">SerialViewModel</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>便捷方法：获取串口视图模型。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>SerialViewModel</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="SerialViewModel (controller.presentation.SerialViewModel)" href="#controller.shared.config.service_registry.SerialViewModel">SerialViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>串口视图模型实例。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/shared/config/service_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_serial_view_model</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">SerialViewModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;便捷方法：获取串口视图模型。</span>

<span class="sd">    Returns:</span>
<span class="sd">        SerialViewModel: 串口视图模型实例。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">resolve</span><span class="p">(</span><span class="n">SerialViewModel</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h3 id="controller.shared.config.service_registry.get_display_view_model" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_display_view_model</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_display_view_model</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">DisplayViewModel</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>便捷方法：获取显示视图模型。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>DisplayViewModel</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="DisplayViewModel (controller.presentation.DisplayViewModel)" href="#controller.shared.config.service_registry.DisplayViewModel">DisplayViewModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>显示视图模型实例。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/shared/config/service_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_display_view_model</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">DisplayViewModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;便捷方法：获取显示视图模型。</span>

<span class="sd">    Returns:</span>
<span class="sd">        DisplayViewModel: 显示视图模型实例。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">resolve</span><span class="p">(</span><span class="n">DisplayViewModel</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h3 id="controller.shared.config.service_registry.get_listener_service" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_listener_service</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_listener_service</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">MotionListener</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>便捷方法：获取监听服务。</p>


    <p><span class="doc-section-title">返回：</span></p>
    <table>
      <thead>
        <tr>
<th>名称</th>          <th>类型</th>
          <th>描述</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>MotionListener</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="MotionListener (controller.application.MotionListener)" href="#controller.shared.config.service_registry.MotionListener">MotionListener</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>监听服务实例。</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>源代码位于： <code>src/controller/controller/shared/config/service_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_listener_service</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">MotionListener</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;便捷方法：获取监听服务。</span>

<span class="sd">    Returns:</span>
<span class="sd">        MotionListener: 监听服务实例。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">resolve</span><span class="p">(</span><span class="n">MotionListener</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "toc.integrate", "search.suggest", "search.highlight", "content.tabs.link", "content.code.copy"], "search": "../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>