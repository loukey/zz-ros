{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"\u6b22\u8fce\u6765\u5230\u9547\u4e2d\u79d1\u6280\u673a\u68b0\u81c2\u63a7\u5236\u7cfb\u7edf\u6587\u6863","text":"<p>\u8fd9\u91cc\u662f\u9547\u4e2d\u79d1\u6280\u673a\u68b0\u81c2\u63a7\u5236\u7cfb\u7edf\u7684\u5b98\u65b9\u6587\u6863\u3002</p> <p>\u672c\u7cfb\u7edf\u65e8\u5728\u63d0\u4f9b\u4e00\u4e2a\u7075\u6d3b\u3001\u9ad8\u6548\u4e14\u6613\u4e8e\u6269\u5c55\u7684\u6846\u67b6\uff0c\u7528\u4e8e\u63a7\u5236\u673a\u68b0\u81c2\u8fdb\u884c\u5404\u79cd\u4efb\u52a1\uff0c\u5305\u62ec\u8fd0\u52a8\u63a7\u5236\u3001\u8f68\u8ff9\u89c4\u5212\u3001\u89c6\u89c9\u8bc6\u522b\u548c\u793a\u6559\u8bb0\u5f55\u7b49\u3002</p>"},{"location":"#_2","title":"\u9879\u76ee\u7ed3\u6784\u6982\u89c8","text":"<p>\u672c\u9879\u76ee\u7684\u4ee3\u7801\u7ed3\u6784\u9075\u5faa \u9886\u57df\u9a71\u52a8\u8bbe\u8ba1 (DDD) \u539f\u5219\u3002\u4e0b\u6587\u5c06\u4e25\u683c\u6309\u7167 <code>src/controller/controller</code> \u76ee\u5f55\u4e0b\u7684\u5b9e\u9645\u6587\u4ef6\u5206\u5e03\u8fdb\u884c\u4ecb\u7ecd\u3002</p>"},{"location":"#1-application","title":"1. Application (\u5e94\u7528\u5c42)","text":"<p>\u76ee\u5f55\u8def\u5f84: <code>src/controller/controller/application</code></p> <p>\u4e1a\u52a1\u6d41\u7a0b\u7684\u534f\u8c03\u8005\u3002\u8d1f\u8d23\u7f16\u6392\u9886\u57df\u5bf9\u8c61\u6765\u5b8c\u6210\u5177\u4f53\u7684\u5e94\u7528\u7528\u4f8b\u3002</p> <ul> <li>commands (<code>application/commands</code>): \u5c01\u88c5\u5177\u4f53\u7684\u547d\u4ee4\u5bf9\u8c61\u3002<ul> <li><code>message_display.py</code>: \u5904\u7406\u6d88\u606f\u663e\u793a\u7684\u547d\u4ee4\u903b\u8f91\u3002</li> </ul> </li> <li>listener (<code>application/listener</code>): \u4e8b\u4ef6\u76d1\u542c\u5668\u3002<ul> <li><code>motion_listener.py</code>: \u76d1\u542c\u8fd0\u52a8\u72b6\u6001\u53d8\u5316\u7684\u4e8b\u4ef6\u5904\u7406\u5668\u3002</li> </ul> </li> <li>services (<code>application/services</code>): \u5e94\u7528\u670d\u52a1\uff0c\u5c01\u88c5\u5177\u4f53\u7684\u4e1a\u52a1\u573a\u666f\u3002<ul> <li><code>camera_application_service.py</code>: \u534f\u8c03\u76f8\u673a\u8fde\u63a5\u3001\u56fe\u50cf\u83b7\u53d6\u4e0e\u89c6\u89c9\u7b97\u6cd5\u3002</li> <li><code>motion_planning_application_service.py</code>: \u534f\u8c03\u8fd0\u52a8\u89c4\u5212\u8bf7\u6c42\u4e0e\u8f68\u8ff9\u751f\u6210\u3002</li> <li><code>command_hub_service.py</code>: \u7edf\u4e00\u7684\u6307\u4ee4\u5206\u53d1\u4e2d\u5fc3\uff0c\u5904\u7406\u7528\u6237\u547d\u4ee4\u5e76\u8def\u7531\u5230\u76f8\u5e94\u7684\u9886\u57df\u670d\u52a1\u3002</li> <li><code>serial_application_service.py</code>: \u4e32\u53e3\u8fde\u63a5\u7ba1\u7406\u670d\u52a1\u3002</li> <li><code>message_response_service.py</code>: \u5904\u7406\u4e0b\u4f4d\u673a\u53cd\u9988\u6d88\u606f\u7684\u670d\u52a1\u3002</li> <li><code>tools_application_service.py</code>: \u63d0\u4f9b\u5de5\u5177\u7c7b\u529f\u80fd\uff08\u5982\u6b63\u9006\u89e3\u8ba1\u7b97\uff09\u7684\u5e94\u7528\u670d\u52a1\u3002</li> <li><code>base_service.py</code>: \u5e94\u7528\u670d\u52a1\u57fa\u7c7b\u3002</li> </ul> </li> </ul>"},{"location":"#2-config","title":"2. Config (\u7cfb\u7edf\u914d\u7f6e)","text":"<p>\u76ee\u5f55\u8def\u5f84: <code>src/controller/controller/config</code></p> <p>\u5b58\u653e\u7cfb\u7edf\u8fd0\u884c\u6240\u9700\u7684\u9759\u6001\u914d\u7f6e\u6587\u4ef6\uff08YAML \u683c\u5f0f\uff09\uff0c\u4e3b\u8981\u7528\u4e8e\u5b9a\u4e49\u901a\u4fe1\u534f\u8bae\u3002</p> <ul> <li><code>message_decoder_config.yaml</code>: \u5b9a\u4e49\u63a5\u6536\u6d88\u606f\u7684\u89e3\u7801\u89c4\u5219\u3002</li> <li><code>message_encoder_config.yaml</code>: \u5b9a\u4e49\u53d1\u9001\u6d88\u606f\u7684\u7f16\u7801\u89c4\u5219\u3002</li> </ul>"},{"location":"#3-domain","title":"3. Domain (\u9886\u57df\u5c42)","text":"<p>\u76ee\u5f55\u8def\u5f84: <code>src/controller/controller/domain</code></p> <p>\u6838\u5fc3\u4e1a\u52a1\u903b\u8f91\u7684\u5fc3\u810f\u3002\u5305\u542b\u7eaf\u7cb9\u7684\u4e1a\u52a1\u89c4\u5219\u3001\u7b97\u6cd5\u548c\u72b6\u6001\u6a21\u578b\u3002</p> <ul> <li>entities (<code>domain/entities</code>): \u5177\u6709\u552f\u4e00\u6807\u8bc6\u7684\u9886\u57df\u5b9e\u4f53\u3002<ul> <li><code>motion_plan.py</code>: \u5b9a\u4e49\u8fd0\u52a8\u8ba1\u5212\u5b9e\u4f53\u3002</li> </ul> </li> <li>services (<code>domain/services</code>): \u9886\u57df\u670d\u52a1\uff0c\u5c01\u88c5\u6838\u5fc3\u4e1a\u52a1\u80fd\u529b\u3002<ul> <li>algorithm: \u6838\u5fc3\u7b97\u6cd5\u3002<ul> <li><code>kinematic_domain_service.py</code>: \u6b63\u9006\u8fd0\u52a8\u5b66\u89e3\u7b97\u3002</li> <li><code>trajectory_domain_service.py</code>: S\u578b\u901f\u5ea6\u66f2\u7ebf\u89c4\u5212\u3002</li> <li><code>curve_motion.py</code>: \u7a7a\u95f4\u66f2\u7ebf\u8fd0\u52a8\u89c4\u5212\uff08TOPPRA\uff09\u3002</li> <li><code>smooth_domain_service.py</code>: \u8f68\u8ff9\u5e73\u6ed1\u7b97\u6cd5\u3002</li> <li><code>hand_eye_transform_domain_service.py</code>: \u624b\u773c\u6807\u5b9a\u8ba1\u7b97\u3002</li> <li><code>dynamic_domain_service.py</code>: \u52a8\u529b\u5b66\u4e0e\u91cd\u529b\u8865\u507f\u8ba1\u7b97\u3002</li> </ul> </li> <li>communication: \u901a\u4fe1\u903b\u8f91\u3002<ul> <li><code>message_domain_service.py</code>: \u6d88\u606f\u7f16\u89e3\u7801\u670d\u52a1\u3002</li> <li><code>serial_domain_service.py</code>: \u4e32\u53e3\u6570\u636e\u6536\u53d1\u903b\u8f91\u3002</li> </ul> </li> <li>motion: \u8fd0\u52a8\u63a7\u5236\u3002<ul> <li><code>motion_constructor.py</code>: \u8fd0\u52a8\u6307\u4ee4\u6784\u9020\u5668\u3002</li> <li><code>motion_runner.py</code>: \u8fd0\u52a8\u6267\u884c\u5668\u3002</li> <li><code>trajectory_planning_service.py</code>: \u8f68\u8ff9\u89c4\u5212\u670d\u52a1\u3002</li> </ul> </li> <li>planning: \u9ad8\u7ea7\u89c4\u5212\u3002<ul> <li><code>motion_planning_domain_service.py</code>: \u8fd0\u52a8\u8ba1\u5212\u7ba1\u7406\u3002</li> </ul> </li> <li>state: \u72b6\u6001\u7ba1\u7406\u3002<ul> <li><code>robot_state_domain_service.py</code>: \u673a\u5668\u4eba\u8fd0\u884c\u65f6\u72b6\u6001\u7ba1\u7406\u3002</li> <li><code>teach_record_domain_service.py</code>: \u793a\u6559\u8bb0\u5f55\u7ba1\u7406\u3002</li> </ul> </li> <li>vision: \u89c6\u89c9\u5904\u7406\u3002<ul> <li><code>camera_domain_service.py</code>: \u76f8\u673a\u56fe\u50cf\u6d41\u5904\u7406\u3002</li> <li><code>recognition_domain_service.py</code>: \u89c6\u89c9\u8bc6\u522b\u7ed3\u679c\u5904\u7406\u3002</li> </ul> </li> </ul> </li> <li>utils (<code>domain/utils</code>): \u9886\u57df\u5c42\u901a\u7528\u5de5\u5177\u3002<ul> <li><code>message_decoder.py</code> / <code>message_encoder.py</code>: \u534f\u8bae\u89e3\u6790\u5de5\u5177\u3002</li> <li><code>kinematic_utils.py</code>: \u8fd0\u52a8\u5b66\u6570\u5b66\u5de5\u5177\u3002</li> <li><code>image_drawing_utils.py</code>: \u56fe\u50cf\u7ed8\u5236\u5de5\u5177\u3002</li> </ul> </li> <li>value_objects (<code>domain/value_objects</code>): \u4e0d\u53ef\u53d8\u7684\u503c\u5bf9\u8c61\u3002<ul> <li><code>robot_state_snapshot.py</code>: \u673a\u5668\u4eba\u72b6\u6001\u5feb\u7167\u3002</li> <li><code>dh_param.py</code>: DH \u53c2\u6570\u914d\u7f6e\u3002</li> <li><code>hand_eye_calibration_config.py</code>: \u6807\u5b9a\u914d\u7f6e\u3002</li> </ul> </li> </ul>"},{"location":"#4-infrastructure","title":"4. Infrastructure (\u57fa\u7840\u8bbe\u65bd\u5c42)","text":"<p>\u76ee\u5f55\u8def\u5f84: <code>src/controller/controller/infrastructure</code></p> <p>\u4e0e\u5916\u90e8\u4e16\u754c\u7684\u8fde\u63a5\u5668\u3002\u63d0\u4f9b\u6280\u672f\u5b9e\u73b0\u7ec6\u8282\u3002</p> <ul> <li>communication (<code>infrastructure/communication</code>): \u901a\u4fe1\u57fa\u7840\u8bbe\u65bd\u3002<ul> <li><code>serial_adapter.py</code>: <code>pyserial</code> \u9002\u914d\u5668\u3002</li> <li><code>serial_reader.py</code> / <code>serial_writer.py</code>: \u4e32\u53e3\u8bfb\u5199\u7ebf\u7a0b\u5b9e\u73b0\u3002</li> <li><code>port_scanner.py</code>: \u4e32\u53e3\u626b\u63cf\u5de5\u5177\u3002</li> </ul> </li> <li>persistence (<code>infrastructure/persistence</code>): \u6570\u636e\u6301\u4e45\u5316\u4ed3\u50a8 (Repository)\u3002<ul> <li><code>trajectory_repository.py</code>: \u8f68\u8ff9\u6587\u4ef6\u5b58\u53d6\u3002</li> <li><code>record_repository.py</code>: \u793a\u6559\u8bb0\u5f55\u5b58\u53d6\u3002</li> <li><code>motion_plan_repository.py</code>: \u8fd0\u52a8\u8ba1\u5212\u5b58\u53d6\u3002</li> <li><code>hand_eye_calibration_repository.py</code>: \u6807\u5b9a\u53c2\u6570\u5b58\u53d6\u3002</li> </ul> </li> <li>external / hardware: \uff08\u9884\u7559\uff09\u5916\u90e8\u5e93\u9002\u914d\u4e0e\u786c\u4ef6\u9a71\u52a8\u3002</li> </ul>"},{"location":"#5-presentation","title":"5. Presentation (\u5c55\u793a\u5c42)","text":"<p>\u76ee\u5f55\u8def\u5f84: <code>src/controller/controller/presentation</code></p> <p>\u7528\u6237\u4ea4\u4e92\u754c\u9762\u3002\u91c7\u7528 MVVM \u6a21\u5f0f\u3002</p> <ul> <li>components (<code>presentation/components</code>): \u53ef\u590d\u7528\u7684 UI \u7ec4\u4ef6\uff08\u6309\u529f\u80fd\u6a21\u5757\u5206\u7c7b\uff09\u3002<ul> <li>\u5305\u542b <code>camera</code>, <code>display</code>, <code>dynamics</code>, <code>effector</code>, <code>main</code>, <code>motion_planning</code>, <code>settings</code>, <code>status</code>, <code>tools</code> \u7b49\u5b50\u76ee\u5f55\u3002</li> </ul> </li> <li>gui (<code>presentation/gui</code>): \u4e3b\u7a97\u53e3\u5b9e\u73b0\u3002<ul> <li><code>main_window.py</code>: \u5e94\u7528\u7a0b\u5e8f\u4e3b\u7a97\u53e3\u7ec4\u88c5\u3002</li> </ul> </li> <li>view_models (<code>presentation/view_models</code>): \u89c6\u56fe\u6a21\u578b\uff0c\u8fde\u63a5 UI \u4e0e Application/Domain\u3002<ul> <li><code>main_view_model.py</code>: \u4e3b\u89c6\u56fe\u6a21\u578b\u3002</li> <li><code>control_view_model.py</code>: \u63a7\u5236\u903b\u8f91\u89c6\u56fe\u6a21\u578b\u3002</li> <li><code>camera_view_model.py</code>: \u76f8\u673a\u89c6\u56fe\u6a21\u578b\u3002</li> <li><code>dynamics_view_model.py</code>: \u52a8\u529b\u5b66\u89c6\u56fe\u6a21\u578b\u3002</li> <li><code>status_view_model.py</code>: \u72b6\u6001\u663e\u793a\u89c6\u56fe\u6a21\u578b\u3002</li> <li>... (\u4ee5\u53ca\u5176\u4ed6\u529f\u80fd\u5bf9\u5e94\u7684 ViewModel)</li> </ul> </li> </ul>"},{"location":"#6-shared","title":"6. Shared (\u5171\u4eab\u5c42)","text":"<p>\u76ee\u5f55\u8def\u5f84: <code>src/controller/controller/shared</code></p> <p>\u8de8\u5c42\u901a\u7528\u7684\u5de5\u5177\u4e0e\u914d\u7f6e\u3002</p> <ul> <li>config (<code>shared/config</code>): \u5168\u5c40\u4ee3\u7801\u914d\u7f6e\u3002<ul> <li><code>di_container.py</code>: \u4f9d\u8d56\u6ce8\u5165 (DI) \u5bb9\u5668\u5b9e\u73b0\u3002</li> <li><code>service_registry.py</code>: \u670d\u52a1\u6ce8\u518c\u4e0e\u7ec4\u88c5\u903b\u8f91\u3002</li> </ul> </li> </ul>"},{"location":"api/application/commands/message_display/","title":"Message Display Command","text":""},{"location":"api/application/commands/message_display/#controller.application.commands.message_display","title":"controller.application.commands.message_display","text":""},{"location":"api/application/commands/message_display/#controller.application.commands.message_display.MessageDisplay","title":"MessageDisplay","text":"<pre><code>MessageDisplay()\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u6d88\u606f\u663e\u793a\u670d\u52a1\u3002</p> <p>\u8d1f\u8d23\u5728\u754c\u9762\u4e0a\u663e\u793a\u65e5\u5fd7\u548c\u72b6\u6001\u6d88\u606f\uff0c\u901a\u8fc7\u4fe1\u53f7\u5206\u53d1\u7ed9 UI \u7ec4\u4ef6\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>message_display_signal</code> <code>pyqtSignal</code> <p>\u6d88\u606f\u663e\u793a\u4fe1\u53f7\uff0c\u643a\u5e26 (\u6d88\u606f\u5185\u5bb9, \u6d88\u606f\u7c7b\u578b)\u3002</p> <code>clear_requested</code> <code>pyqtSignal</code> <p>\u6e05\u9664\u6d88\u606f\u8bf7\u6c42\u4fe1\u53f7\u3002</p> <p>\u521d\u59cb\u5316\u6d88\u606f\u663e\u793a\u670d\u52a1\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/commands/message_display.py</code> <pre><code>def __init__(self):\n    \"\"\"\u521d\u59cb\u5316\u6d88\u606f\u663e\u793a\u670d\u52a1\u3002\"\"\"\n    super().__init__()\n</code></pre>"},{"location":"api/application/commands/message_display/#controller.application.commands.message_display.MessageDisplay.display_message","title":"display_message","text":"<pre><code>display_message(message: str, message_type: str) -&gt; None\n</code></pre> <p>\u663e\u793a\u4e00\u6761\u6d88\u606f\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>message</code> <code>str</code> <p>\u6d88\u606f\u5185\u5bb9\u3002</p> \u5fc5\u9700 <code>message_type</code> <code>str</code> <p>\u6d88\u606f\u7c7b\u578b\uff08\u5982 \"info\", \"error\", \"warning\"\uff09\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/commands/message_display.py</code> <pre><code>def display_message(self, message: str, message_type: str) -&gt; None:\n    \"\"\"\u663e\u793a\u4e00\u6761\u6d88\u606f\u3002\n\n    Args:\n        message (str): \u6d88\u606f\u5185\u5bb9\u3002\n        message_type (str): \u6d88\u606f\u7c7b\u578b\uff08\u5982 \"info\", \"error\", \"warning\"\uff09\u3002\n    \"\"\"\n    self.message_display_signal.emit(message, message_type)\n</code></pre>"},{"location":"api/application/commands/message_display/#controller.application.commands.message_display.MessageDisplay.clear_messages","title":"clear_messages","text":"<pre><code>clear_messages() -&gt; None\n</code></pre> <p>\u6e05\u9664\u6240\u6709\u6d88\u606f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/commands/message_display.py</code> <pre><code>def clear_messages(self) -&gt; None:\n    \"\"\"\u6e05\u9664\u6240\u6709\u6d88\u606f\u3002\"\"\"\n    self.clear_requested.emit()\n</code></pre>"},{"location":"api/application/listeners/motion_listener/","title":"Motion Listener","text":""},{"location":"api/application/listeners/motion_listener/#controller.application.listener.motion_listener","title":"controller.application.listener.motion_listener","text":""},{"location":"api/application/listeners/motion_listener/#controller.application.listener.motion_listener.MotionListener","title":"MotionListener","text":"<pre><code>MotionListener(motion_runner: MotionRunner, message_display: MessageDisplay)\n</code></pre> <p>\u8fd0\u52a8\u6d88\u606f\u76d1\u542c\u5668\u3002</p> <p>\u8d1f\u8d23\u76d1\u542c\u8fd0\u52a8\u6267\u884c\u5668\u53d1\u9001\u7684\u6d88\u606f\uff0c\u89e3\u7801\u4f4d\u7f6e\u6570\u636e\u5e76\u663e\u793a\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>motion_runner</code> <code>MotionRunner</code> <p>\u8fd0\u52a8\u6267\u884c\u5668\u3002</p> <code>message_display</code> <code>MessageDisplay</code> <p>\u6d88\u606f\u663e\u793a\u670d\u52a1\u3002</p> <code>robot_utils</code> <code>RobotUtils</code> <p>\u673a\u5668\u4eba\u5de5\u5177\u7c7b\uff0c\u7528\u4e8e\u5750\u6807\u8f6c\u6362\u3002</p> <p>\u521d\u59cb\u5316\u8fd0\u52a8\u76d1\u542c\u5668\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>motion_runner</code> <code>MotionRunner</code> <p>\u8fd0\u52a8\u6267\u884c\u5668\u3002</p> \u5fc5\u9700 <code>message_display</code> <code>MessageDisplay</code> <p>\u6d88\u606f\u663e\u793a\u670d\u52a1\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/listener/motion_listener.py</code> <pre><code>def __init__(self, motion_runner: MotionRunner, message_display: MessageDisplay):\n    \"\"\"\u521d\u59cb\u5316\u8fd0\u52a8\u76d1\u542c\u5668\u3002\n\n    Args:\n        motion_runner (MotionRunner): \u8fd0\u52a8\u6267\u884c\u5668\u3002\n        message_display (MessageDisplay): \u6d88\u606f\u663e\u793a\u670d\u52a1\u3002\n    \"\"\"\n    self.motion_runner = motion_runner\n    self.message_display = message_display\n    self.robot_utils = RobotUtils()\n    self._connect_signals()\n</code></pre>"},{"location":"api/application/listeners/motion_listener/#controller.application.listener.motion_listener.MotionListener.handle_motion_msg","title":"handle_motion_msg","text":"<pre><code>handle_motion_msg(message, message_type)\n</code></pre> <p>\u5904\u7406\u8fd0\u52a8\u6d88\u606f\uff0c\u624b\u52a8\u89e3\u6790\u4f4d\u7f6e\u6570\u636e\u3002</p> <p>\u6d88\u606f\u683c\u5f0f\uff1aAA55 + control(1) + mode(1) + joint_angles(24) + ... + CRC(2) + 0D0A \u7f16\u7801\u8fc7\u7a0b\uff1a\u5f27\u5ea6 -&gt; radian2position -&gt; \u4f4d\u7f6e\u503c(32\u4f4d) -&gt; \u5927\u7aef\u5e8f16\u8fdb\u5236</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>message</code> <code>str</code> <p>\u539f\u59cb16\u8fdb\u5236\u6d88\u606f\u5b57\u7b26\u4e32\u3002</p> \u5fc5\u9700 <code>message_type</code> <code>str</code> <p>\u6d88\u606f\u7c7b\u578b\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/listener/motion_listener.py</code> <pre><code>def handle_motion_msg(self, message, message_type):\n    \"\"\"\u5904\u7406\u8fd0\u52a8\u6d88\u606f\uff0c\u624b\u52a8\u89e3\u6790\u4f4d\u7f6e\u6570\u636e\u3002\n\n    \u6d88\u606f\u683c\u5f0f\uff1aAA55 + control(1) + mode(1) + joint_angles(24) + ... + CRC(2) + 0D0A\n    \u7f16\u7801\u8fc7\u7a0b\uff1a\u5f27\u5ea6 -&gt; radian2position -&gt; \u4f4d\u7f6e\u503c(32\u4f4d) -&gt; \u5927\u7aef\u5e8f16\u8fdb\u5236\n\n    Args:\n        message (str): \u539f\u59cb16\u8fdb\u5236\u6d88\u606f\u5b57\u7b26\u4e32\u3002\n        message_type (str): \u6d88\u606f\u7c7b\u578b\u3002\n    \"\"\"\n    try:\n        # \u624b\u52a8\u89e3\u6790\u4f4d\u7f6e\u6570\u636e\n        joint_angles = self._extract_joint_angles(message)\n\n        if joint_angles:\n            # \u683c\u5f0f\u5316\u663e\u793a\u5f27\u5ea6\u503c\n            angles_str = \", \".join([f\"{angle:.4f}\" for angle in joint_angles])\n            display_text = f\"[{message_type}] \u4f4d\u7f6e(\u5f27\u5ea6): [{angles_str}]\"\n            self.message_display.display_message(display_text, message_type)\n\n            # \u540c\u65f6\u663e\u793a\u539f\u59cb16\u8fdb\u5236\u6570\u636e\n            raw_text = f\"[{message_type}] \u539f\u59cb\u6570\u636e: {message}\"\n            self.message_display.display_message(raw_text, message_type)\n        else:\n            # \u65e0\u6cd5\u89e3\u6790\uff0c\u53ea\u663e\u793a\u539f\u59cb\u6d88\u606f\n            self.message_display.display_message(str(message), message_type)\n\n    except Exception as e:\n        # \u89e3\u6790\u5931\u8d25\uff0c\u663e\u793a\u539f\u59cb\u6d88\u606f\n        self.message_display.display_message(str(message), message_type)\n</code></pre>"},{"location":"api/application/services/base/","title":"Base Service","text":""},{"location":"api/application/services/base/#controller.application.services.base_service","title":"controller.application.services.base_service","text":""},{"location":"api/application/services/base/#controller.application.services.base_service.BaseService","title":"BaseService","text":"<pre><code>BaseService(message_display: MessageDisplay)\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u5e94\u7528\u5c42\u57fa\u7840\u670d\u52a1\u3002</p> <p>\u6240\u6709 Application Service \u7684\u57fa\u7c7b\uff0c\u63d0\u4f9b\u901a\u7528\u7684\u6d88\u606f\u663e\u793a\u529f\u80fd\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>message_display</code> <code>MessageDisplay</code> <p>\u6d88\u606f\u663e\u793a\u670d\u52a1\u5b9e\u4f8b\u3002</p> <p>\u521d\u59cb\u5316\u57fa\u7840\u670d\u52a1\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>message_display</code> <code>MessageDisplay</code> <p>\u6d88\u606f\u663e\u793a\u670d\u52a1\u5b9e\u4f8b\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/base_service.py</code> <pre><code>def __init__(self, message_display: MessageDisplay):\n    \"\"\"\u521d\u59cb\u5316\u57fa\u7840\u670d\u52a1\u3002\n\n    Args:\n        message_display (MessageDisplay): \u6d88\u606f\u663e\u793a\u670d\u52a1\u5b9e\u4f8b\u3002\n    \"\"\"\n    super().__init__()\n    self.message_display = message_display\n</code></pre>"},{"location":"api/application/services/camera/","title":"Camera Application Service","text":""},{"location":"api/application/services/camera/#controller.application.services.camera_application_service","title":"controller.application.services.camera_application_service","text":"<p>\u6444\u50cf\u5934\u5e94\u7528\u670d\u52a1 - Application\u5c42 \u534f\u8c03\u6444\u50cf\u5934Domain\u670d\u52a1\u3001\u68c0\u6d4b\u670d\u52a1\u548c\u6d88\u606f\u663e\u793a \u63d0\u4f9b\u7edf\u4e00\u7684\u67e5\u8be2\u63a5\u53e3\uff0c\u907f\u514dViewModel\u76f4\u63a5\u8bbf\u95eeDomain\u5c42</p>"},{"location":"api/application/services/camera/#controller.application.services.camera_application_service.CameraApplicationService","title":"CameraApplicationService","text":"<pre><code>CameraApplicationService(camera_service: CameraDomainService, recognition_service: RecognitionDomainService, hand_eye_service: HandEyeTransformDomainService, kinematic_service: KinematicDomainService, robot_state_service: RobotStateDomainService, motion_constructor: MotionConstructor, command_hub: CommandHubService, message_display: MessageDisplay)\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u6444\u50cf\u5934\u5e94\u7528\u670d\u52a1\u3002</p> <p>\u534f\u8c03\u6444\u50cf\u5934Domain\u670d\u52a1\u3001\u68c0\u6d4b\u670d\u52a1\u548c\u6d88\u606f\u663e\u793a\uff0c\u63d0\u4f9b\u7edf\u4e00\u7684\u67e5\u8be2\u63a5\u53e3\uff0c\u907f\u514dViewModel\u76f4\u63a5\u8bbf\u95eeDomain\u5c42\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>connection_status_changed</code> <code>pyqtSignal</code> <p>\u6444\u50cf\u5934\u8fde\u63a5\u72b6\u6001\u53d8\u5316\u4fe1\u53f7\u3002</p> <code>detection_status_changed</code> <code>pyqtSignal</code> <p>\u68c0\u6d4b\u72b6\u6001\u53d8\u5316\u4fe1\u53f7\u3002</p> <p>\u521d\u59cb\u5316\u6444\u50cf\u5934\u5e94\u7528\u670d\u52a1\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def __init__(\n    self,\n    camera_service: CameraDomainService,\n    recognition_service: RecognitionDomainService,\n    hand_eye_service: HandEyeTransformDomainService,\n    kinematic_service: KinematicDomainService,\n    robot_state_service: RobotStateDomainService,\n    motion_constructor: MotionConstructor,\n    command_hub: CommandHubService,\n    message_display: MessageDisplay\n):\n    \"\"\"\u521d\u59cb\u5316\u6444\u50cf\u5934\u5e94\u7528\u670d\u52a1\u3002\"\"\"\n    super().__init__()\n    self.camera_service = camera_service\n    self.recognition_service = recognition_service\n    self.hand_eye_service = hand_eye_service\n    self.kinematic_service = kinematic_service\n    self.robot_state_service = robot_state_service\n    self.motion_constructor = motion_constructor\n    self.command_hub = command_hub\n    self.message_display = message_display\n\n    # \u8fde\u63a5Domain Service\u4fe1\u53f7\n    self._connect_signals()\n</code></pre>"},{"location":"api/application/services/camera/#controller.application.services.camera_application_service.CameraApplicationService.connect_camera","title":"connect_camera","text":"<pre><code>connect_camera()\n</code></pre> <p>\u8fde\u63a5\u6444\u50cf\u5934\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def connect_camera(self):\n    \"\"\"\u8fde\u63a5\u6444\u50cf\u5934\u3002\"\"\"\n    self.message_display.clear_messages()\n    self._display_message(\"\u6b63\u5728\u8fde\u63a5\u6444\u50cf\u5934...\", \"\u6444\u50cf\u5934\")\n\n    success = self.camera_service.connect()\n\n    if success:\n        self._display_message(\"\u6444\u50cf\u5934\u8fde\u63a5\u6210\u529f\", \"\u6444\u50cf\u5934\")\n        self.connection_status_changed.emit(True)\n    else:\n        self._display_message(\"\u6444\u50cf\u5934\u8fde\u63a5\u5931\u8d25\", \"\u9519\u8bef\")\n        self.connection_status_changed.emit(False)\n</code></pre>"},{"location":"api/application/services/camera/#controller.application.services.camera_application_service.CameraApplicationService.disconnect_camera","title":"disconnect_camera","text":"<pre><code>disconnect_camera()\n</code></pre> <p>\u65ad\u5f00\u6444\u50cf\u5934\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def disconnect_camera(self):\n    \"\"\"\u65ad\u5f00\u6444\u50cf\u5934\u3002\"\"\"\n    self.message_display.clear_messages()\n    self._display_message(\"\u6b63\u5728\u65ad\u5f00\u6444\u50cf\u5934...\", \"\u6444\u50cf\u5934\")\n\n    success = self.camera_service.disconnect()\n\n    if success:\n        self._display_message(\"\u6444\u50cf\u5934\u5df2\u65ad\u5f00\", \"\u6444\u50cf\u5934\")\n        self.connection_status_changed.emit(False)\n    else:\n        self._display_message(\"\u65ad\u5f00\u6444\u50cf\u5934\u5931\u8d25\", \"\u9519\u8bef\")\n</code></pre>"},{"location":"api/application/services/camera/#controller.application.services.camera_application_service.CameraApplicationService.start_detection","title":"start_detection","text":"<pre><code>start_detection()\n</code></pre> <p>\u5f00\u59cb\u68c0\u6d4b\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def start_detection(self):\n    \"\"\"\u5f00\u59cb\u68c0\u6d4b\u3002\"\"\"\n    self.message_display.clear_messages()\n    self._display_message(\"\u6b63\u5728\u542f\u52a8\u68c0\u6d4b...\", \"\u68c0\u6d4b\")\n\n    success = self.recognition_service.start_detection()\n\n    if success:\n        self._display_message(\"\u5f00\u59cb\u96f6\u4ef6\u8bc6\u522b\", \"\u68c0\u6d4b\")\n        self.detection_status_changed.emit(True)\n    else:\n        self._display_message(\"\u542f\u52a8\u68c0\u6d4b\u5931\u8d25\", \"\u9519\u8bef\")\n        self.detection_status_changed.emit(False)\n</code></pre>"},{"location":"api/application/services/camera/#controller.application.services.camera_application_service.CameraApplicationService.stop_detection","title":"stop_detection","text":"<pre><code>stop_detection()\n</code></pre> <p>\u505c\u6b62\u68c0\u6d4b\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def stop_detection(self):\n    \"\"\"\u505c\u6b62\u68c0\u6d4b\u3002\"\"\"\n    self.message_display.clear_messages()\n    self._display_message(\"\u6b63\u5728\u505c\u6b62\u68c0\u6d4b...\", \"\u68c0\u6d4b\")\n\n    success = self.recognition_service.stop_detection()\n\n    if success:\n        self._display_message(\"\u505c\u6b62\u96f6\u4ef6\u8bc6\u522b\", \"\u68c0\u6d4b\")\n        self.detection_status_changed.emit(False)\n    else:\n        self._display_message(\"\u505c\u6b62\u68c0\u6d4b\u5931\u8d25\", \"\u9519\u8bef\")\n</code></pre>"},{"location":"api/application/services/camera/#controller.application.services.camera_application_service.CameraApplicationService.move_to_detected_part","title":"move_to_detected_part","text":"<pre><code>move_to_detected_part()\n</code></pre> <p>\u8fd0\u52a8\u5230\u68c0\u6d4b\u5230\u7684\u96f6\u4ef6\u4f4d\u7f6e\u3002</p> <p>\u5b8c\u6574\u6d41\u7a0b\uff1a 1. \u68c0\u67e5\u68c0\u6d4b\u72b6\u6001 2. \u83b7\u53d6\u68c0\u6d4b\u7ed3\u679c 3. \u83b7\u53d6\u5f53\u524d\u5173\u8282\u89d2\u5ea6 4. \u624b\u773c\u6807\u5b9a\u8ba1\u7b97\u76ee\u6807\u5173\u8282\u89d2\u5ea6 5. \u6784\u5efa\u8fd0\u52a8\u4efb\u52a1 6. \u89e6\u53d1\u8fd0\u52a8\u6267\u884c 7. \u505c\u6b62\u68c0\u6d4b\uff08\u53ef\u9009\uff09</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def move_to_detected_part(self):\n    \"\"\"\u8fd0\u52a8\u5230\u68c0\u6d4b\u5230\u7684\u96f6\u4ef6\u4f4d\u7f6e\u3002\n\n    \u5b8c\u6574\u6d41\u7a0b\uff1a\n    1. \u68c0\u67e5\u68c0\u6d4b\u72b6\u6001\n    2. \u83b7\u53d6\u68c0\u6d4b\u7ed3\u679c\n    3. \u83b7\u53d6\u5f53\u524d\u5173\u8282\u89d2\u5ea6\n    4. \u624b\u773c\u6807\u5b9a\u8ba1\u7b97\u76ee\u6807\u5173\u8282\u89d2\u5ea6\n    5. \u6784\u5efa\u8fd0\u52a8\u4efb\u52a1\n    6. \u89e6\u53d1\u8fd0\u52a8\u6267\u884c\n    7. \u505c\u6b62\u68c0\u6d4b\uff08\u53ef\u9009\uff09\n    \"\"\"\n    # 1. \u68c0\u67e5\u68c0\u6d4b\u662f\u5426\u8fd0\u884c\n    if not self.recognition_service.is_detection_running():\n        self._display_message(\"\u68c0\u6d4b\u672a\u8fd0\u884c\uff0c\u65e0\u6cd5\u6267\u884c\u8fd0\u52a8\", \"\u9519\u8bef\")\n        return\n\n    # 2. \u83b7\u53d6\u6700\u65b0\u68c0\u6d4b\u7ed3\u679c\n    detection_result = self.recognition_service.get_latest_result()\n    if not detection_result:\n        self._display_message(\"\u672a\u68c0\u6d4b\u5230\u96f6\u4ef6\uff0c\u65e0\u6cd5\u6267\u884c\u8fd0\u52a8\", \"\u8b66\u544a\")\n        return\n\n    # 3. \u83b7\u53d6\u5f53\u524d\u5173\u8282\u89d2\u5ea6\n    current_state = self.robot_state_service.get_current_state()\n    if not current_state:\n        self._display_message(\"\u65e0\u6cd5\u83b7\u53d6\u5f53\u524d\u673a\u5668\u4eba\u72b6\u6001\", \"\u9519\u8bef\")\n        return\n\n    current_joint_angles = current_state.joint_angles  # \u2705 \u4fee\u590d\uff1a\u6b63\u786e\u7684\u5c5e\u6027\u540d\uff08\u5f27\u5ea6\uff09\n\n    # 4. \u624b\u773c\u6807\u5b9a\u8ba1\u7b97\u76ee\u6807\u5173\u8282\u89d2\u5ea6\n    try:\n        target_angles = self.hand_eye_service.calculate_target_joint_angles(\n            central_center=detection_result['central_center'],\n            depth=detection_result['depth'],\n            real_center=detection_result['real_center'],\n            real_depth=detection_result['real_depth'],\n            angle=detection_result['angle'],\n            current_joint_angles=current_joint_angles\n        )\n\n        if target_angles is None:\n            self._display_message(\"\u9006\u8fd0\u52a8\u5b66\u65e0\u89e3\uff0c\u65e0\u6cd5\u5230\u8fbe\u76ee\u6807\u4f4d\u7f6e\", \"\u9519\u8bef\")\n            return\n\n    except Exception as e:\n        self._display_message(f\"\u8ba1\u7b97\u76ee\u6807\u4f4d\u59ff\u5931\u8d25: {str(e)}\", \"\u9519\u8bef\")\n        return\n\n    # 5. \u6784\u5efa\u8fd0\u52a8\u4efb\u52a1\n    motion_task = {\n        'type': 'motion',\n        'target_angles': target_angles,\n        'curve_type': 's_curve',  # 's_curve' \u6216 'linear'\uff08\u7b1b\u5361\u5c14\u76f4\u7ebf\uff09\n        'frequency': 0.01\n    }\n\n    # 6. \u51c6\u5907\u8fd0\u52a8\u5e76\u89e6\u53d1\u6267\u884c\n    try:\n        # \u4f7f\u7528\u7edf\u4e00\u7684 prepare_operation \u63a5\u53e3\n        self.motion_constructor.prepare_operation(\n            MotionOperationMode.EXECUTE,\n            [motion_task]  # \u9700\u8981\u4f20\u5165\u4efb\u52a1\u5217\u8868\n        )\n        self.command_hub.get_current_position()  # \u89e6\u53d1\u8fd0\u52a8\u6267\u884c\n\n        self._display_message(\n            f\"\u5f00\u59cb\u8fd0\u52a8\u5230\u96f6\u4ef6\u4f4d\u7f6e \"\n            f\"(\u4e2d\u5fc3: {detection_result['central_center']}, \"\n            f\"\u6df1\u5ea6: {detection_result['depth']:.2f}mm, \"\n            f\"\u89d2\u5ea6: {np.degrees(detection_result['angle']):.1f}\u00b0)\",\n            \"\u8fd0\u52a8\"\n        )\n\n    except Exception as e:\n        self._display_message(f\"\u542f\u52a8\u8fd0\u52a8\u5931\u8d25: {str(e)}\", \"\u9519\u8bef\")\n        return\n</code></pre>"},{"location":"api/application/services/camera/#controller.application.services.camera_application_service.CameraApplicationService.is_camera_connected","title":"is_camera_connected","text":"<pre><code>is_camera_connected() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u6444\u50cf\u5934\u662f\u5426\u8fde\u63a5\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u5df2\u8fde\u63a5, False=\u672a\u8fde\u63a5\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def is_camera_connected(self) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u6444\u50cf\u5934\u662f\u5426\u8fde\u63a5\u3002\n\n    Returns:\n        bool: True=\u5df2\u8fde\u63a5, False=\u672a\u8fde\u63a5\u3002\n    \"\"\"\n    return self.camera_service.is_connected\n</code></pre>"},{"location":"api/application/services/camera/#controller.application.services.camera_application_service.CameraApplicationService.is_color_available","title":"is_color_available","text":"<pre><code>is_color_available() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u5f69\u8272\u56fe\u50cf\u662f\u5426\u53ef\u7528\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u6709\u6570\u636e, False=\u65e0\u6570\u636e\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def is_color_available(self) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u5f69\u8272\u56fe\u50cf\u662f\u5426\u53ef\u7528\u3002\n\n    Returns:\n        bool: True=\u6709\u6570\u636e, False=\u65e0\u6570\u636e\u3002\n    \"\"\"\n    return self.camera_service.is_color_available()\n</code></pre>"},{"location":"api/application/services/camera/#controller.application.services.camera_application_service.CameraApplicationService.is_depth_available","title":"is_depth_available","text":"<pre><code>is_depth_available() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u6df1\u5ea6\u56fe\u50cf\u662f\u5426\u53ef\u7528\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u6709\u6570\u636e, False=\u65e0\u6570\u636e\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def is_depth_available(self) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u6df1\u5ea6\u56fe\u50cf\u662f\u5426\u53ef\u7528\u3002\n\n    Returns:\n        bool: True=\u6709\u6570\u636e, False=\u65e0\u6570\u636e\u3002\n    \"\"\"\n    return self.camera_service.is_depth_available()\n</code></pre>"},{"location":"api/application/services/camera/#controller.application.services.camera_application_service.CameraApplicationService.get_latest_color_image","title":"get_latest_color_image","text":"<pre><code>get_latest_color_image() -&gt; Optional[np.ndarray]\n</code></pre> <p>\u83b7\u53d6\u6700\u65b0\u5f69\u8272\u56fe\u50cf\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[ndarray]</code> <p>Optional[np.ndarray]: \u5f69\u8272\u56fe\u50cf\uff08BGR\u683c\u5f0f\uff09\uff0c\u5982\u679c\u65e0\u6570\u636e\u5219\u8fd4\u56deNone\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def get_latest_color_image(self) -&gt; Optional[np.ndarray]:\n    \"\"\"\u83b7\u53d6\u6700\u65b0\u5f69\u8272\u56fe\u50cf\u3002\n\n    Returns:\n        Optional[np.ndarray]: \u5f69\u8272\u56fe\u50cf\uff08BGR\u683c\u5f0f\uff09\uff0c\u5982\u679c\u65e0\u6570\u636e\u5219\u8fd4\u56deNone\u3002\n    \"\"\"\n    return self.camera_service.get_latest_color_image()\n</code></pre>"},{"location":"api/application/services/camera/#controller.application.services.camera_application_service.CameraApplicationService.get_latest_depth_image","title":"get_latest_depth_image","text":"<pre><code>get_latest_depth_image() -&gt; Optional[np.ndarray]\n</code></pre> <p>\u83b7\u53d6\u6700\u65b0\u6df1\u5ea6\u56fe\u50cf\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[ndarray]</code> <p>Optional[np.ndarray]: \u6df1\u5ea6\u56fe\u50cf\uff0816\u4f4d\u621632\u4f4d\u6d6e\u70b9\uff09\uff0c\u5982\u679c\u65e0\u6570\u636e\u5219\u8fd4\u56deNone\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def get_latest_depth_image(self) -&gt; Optional[np.ndarray]:\n    \"\"\"\u83b7\u53d6\u6700\u65b0\u6df1\u5ea6\u56fe\u50cf\u3002\n\n    Returns:\n        Optional[np.ndarray]: \u6df1\u5ea6\u56fe\u50cf\uff0816\u4f4d\u621632\u4f4d\u6d6e\u70b9\uff09\uff0c\u5982\u679c\u65e0\u6570\u636e\u5219\u8fd4\u56deNone\u3002\n    \"\"\"\n    return self.camera_service.get_latest_depth_image()\n</code></pre>"},{"location":"api/application/services/camera/#controller.application.services.camera_application_service.CameraApplicationService.visualize_depth_image","title":"visualize_depth_image","text":"<pre><code>visualize_depth_image(depth_image: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u6df1\u5ea6\u56fe\u53ef\u89c6\u5316\u4e3a\u4f2a\u5f69\u8272\u56fe\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>depth_image</code> <code>ndarray</code> <p>\u539f\u59cb\u6df1\u5ea6\u56fe\uff0816\u4f4d\u621632\u4f4d\u6d6e\u70b9\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u4f2a\u5f69\u8272\u6df1\u5ea6\u56fe\uff08BGR, uint8\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def visualize_depth_image(self, depth_image: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u6df1\u5ea6\u56fe\u53ef\u89c6\u5316\u4e3a\u4f2a\u5f69\u8272\u56fe\u3002\n\n    Args:\n        depth_image (np.ndarray): \u539f\u59cb\u6df1\u5ea6\u56fe\uff0816\u4f4d\u621632\u4f4d\u6d6e\u70b9\uff09\u3002\n\n    Returns:\n        np.ndarray: \u4f2a\u5f69\u8272\u6df1\u5ea6\u56fe\uff08BGR, uint8\uff09\u3002\n    \"\"\"\n    return self.camera_service.visualize_depth_image(depth_image)\n</code></pre>"},{"location":"api/application/services/camera/#controller.application.services.camera_application_service.CameraApplicationService.is_detection_running","title":"is_detection_running","text":"<pre><code>is_detection_running() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u68c0\u6d4b\u662f\u5426\u6b63\u5728\u8fd0\u884c\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u8fd0\u884c\u4e2d, False=\u672a\u8fd0\u884c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def is_detection_running(self) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u68c0\u6d4b\u662f\u5426\u6b63\u5728\u8fd0\u884c\u3002\n\n    Returns:\n        bool: True=\u8fd0\u884c\u4e2d, False=\u672a\u8fd0\u884c\u3002\n    \"\"\"\n    return self.recognition_service.is_detection_running()\n</code></pre>"},{"location":"api/application/services/camera/#controller.application.services.camera_application_service.CameraApplicationService.get_latest_detection_result","title":"get_latest_detection_result","text":"<pre><code>get_latest_detection_result() -&gt; Optional[Dict]\n</code></pre> <p>\u83b7\u53d6\u6700\u65b0\u68c0\u6d4b\u7ed3\u679c\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[Dict]</code> <p>Optional[Dict]: \u68c0\u6d4b\u7ed3\u679c\u5b57\u5178\uff0c\u5982\u679c\u65e0\u6570\u636e\u5219\u8fd4\u56deNone\u3002 \u5305\u542b\u5b57\u6bb5\uff1ahead_center, central_center, real_center, angle, depth, real_depth\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def get_latest_detection_result(self) -&gt; Optional[Dict]:\n    \"\"\"\u83b7\u53d6\u6700\u65b0\u68c0\u6d4b\u7ed3\u679c\u3002\n\n    Returns:\n        Optional[Dict]: \u68c0\u6d4b\u7ed3\u679c\u5b57\u5178\uff0c\u5982\u679c\u65e0\u6570\u636e\u5219\u8fd4\u56deNone\u3002\n            \u5305\u542b\u5b57\u6bb5\uff1ahead_center, central_center, real_center, angle, depth, real_depth\u3002\n    \"\"\"\n    return self.recognition_service.get_latest_result()\n</code></pre>"},{"location":"api/application/services/camera/#controller.application.services.camera_application_service.CameraApplicationService.get_image_with_detection","title":"get_image_with_detection","text":"<pre><code>get_image_with_detection(image: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u83b7\u53d6\u53e0\u52a0\u4e86\u68c0\u6d4b\u7ed3\u679c\u7684\u56fe\u50cf\u3002</p> <p>\u5c01\u88c5\u4e86\u68c0\u6d4b\u72b6\u6001\u68c0\u67e5\u548c\u56fe\u50cf\u7ed8\u5236\u903b\u8f91\uff0c\u63d0\u4f9b\u9ad8\u5c42\u4e1a\u52a1\u63a5\u53e3\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>image</code> <code>ndarray</code> <p>\u539f\u59cb\u56fe\u50cf\uff08BGR\u683c\u5f0f\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u5982\u679c\u68c0\u6d4b\u6b63\u5728\u8fd0\u884c\u4e14\u6709\u7ed3\u679c\uff0c\u8fd4\u56de\u53e0\u52a0\u4e86\u68c0\u6d4b\u6807\u6ce8\u7684\u56fe\u50cf\uff1b        \u5426\u5219\u8fd4\u56de\u539f\u56fe\u50cf\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def get_image_with_detection(self, image: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u83b7\u53d6\u53e0\u52a0\u4e86\u68c0\u6d4b\u7ed3\u679c\u7684\u56fe\u50cf\u3002\n\n    \u5c01\u88c5\u4e86\u68c0\u6d4b\u72b6\u6001\u68c0\u67e5\u548c\u56fe\u50cf\u7ed8\u5236\u903b\u8f91\uff0c\u63d0\u4f9b\u9ad8\u5c42\u4e1a\u52a1\u63a5\u53e3\u3002\n\n    Args:\n        image (np.ndarray): \u539f\u59cb\u56fe\u50cf\uff08BGR\u683c\u5f0f\uff09\u3002\n\n    Returns:\n        np.ndarray: \u5982\u679c\u68c0\u6d4b\u6b63\u5728\u8fd0\u884c\u4e14\u6709\u7ed3\u679c\uff0c\u8fd4\u56de\u53e0\u52a0\u4e86\u68c0\u6d4b\u6807\u6ce8\u7684\u56fe\u50cf\uff1b\n                   \u5426\u5219\u8fd4\u56de\u539f\u56fe\u50cf\u3002\n    \"\"\"\n    # \u68c0\u67e5\u68c0\u6d4b\u662f\u5426\u8fd0\u884c\n    if self.recognition_service.is_detection_running():\n        # \u83b7\u53d6\u6700\u65b0\u68c0\u6d4b\u7ed3\u679c\n        detection = self.recognition_service.get_latest_result()\n        if detection:\n            # \u7ed8\u5236\u68c0\u6d4b\u7ed3\u679c\u5230\u56fe\u50cf\u4e0a\n            return ImageDrawingUtils.draw_detection_result(image, detection)\n\n    # \u65e0\u68c0\u6d4b\u6216\u65e0\u7ed3\u679c\uff0c\u8fd4\u56de\u539f\u56fe\n    return image\n</code></pre>"},{"location":"api/application/services/command_hub/","title":"Command Hub Service","text":""},{"location":"api/application/services/command_hub/#controller.application.services.command_hub_service","title":"controller.application.services.command_hub_service","text":""},{"location":"api/application/services/command_hub/#controller.application.services.command_hub_service.CommandHubService","title":"CommandHubService","text":"<pre><code>CommandHubService(message_domain_service: MessageDomainService, motion_runner: MotionRunner, serial_domain_service: SerialDomainService, message_display: MessageDisplay, motion_constructor: MotionConstructor)\n</code></pre> <p>               Bases: <code>BaseService</code></p> <p>\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1 - Application\u5c42\u3002</p> <p>\u804c\u8d23\uff1a 1. \u5206\u53d1\u7528\u6237\u547d\u4ee4\u5230\u4e0d\u540c\u7684\u5904\u7406\u903b\u8f91 2. \u534f\u8c03\u8fd0\u52a8\u4efb\u52a1\u7684\u51c6\u5907\u548c\u6267\u884c 3. \u7ba1\u7406\u6d88\u606f\u663e\u793a</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>message_domain_service</code> <p>\u6d88\u606f\u9886\u57df\u670d\u52a1\u3002</p> <code>motion_runner</code> <p>\u8fd0\u52a8\u6267\u884c\u5668\u3002</p> <code>serial_domain_service</code> <p>\u4e32\u53e3\u9886\u57df\u670d\u52a1\u3002</p> <code>motion_constructor</code> <p>\u8fd0\u52a8\u6784\u9020\u5668\u3002</p> <p>\u521d\u59cb\u5316\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/command_hub_service.py</code> <pre><code>def __init__(self, \nmessage_domain_service: MessageDomainService, \nmotion_runner: MotionRunner,\nserial_domain_service: SerialDomainService, \nmessage_display: MessageDisplay,\nmotion_constructor: MotionConstructor):\n    \"\"\"\u521d\u59cb\u5316\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002\"\"\"\n    super().__init__(message_display)\n    self.message_domain_service = message_domain_service\n    self.motion_runner = motion_runner\n    self.serial_domain_service = serial_domain_service\n    self.motion_constructor = motion_constructor\n</code></pre>"},{"location":"api/application/services/command_hub/#controller.application.services.command_hub_service.CommandHubService.single_send_command","title":"single_send_command","text":"<pre><code>single_send_command(**kwargs: Any) -&gt; bool\n</code></pre> <p>\u53d1\u9001\u5355\u4e2a\u547d\u4ee4\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>**kwargs</code> <code>Any</code> <p>\u547d\u4ee4\u53c2\u6570\uff0c\u5c06\u88ab\u7f16\u7801\u4e3a\u6d88\u606f\u5e27\u3002</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u53d1\u9001\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/command_hub_service.py</code> <pre><code>def single_send_command(self, **kwargs: Any) -&gt; bool:\n    \"\"\"\u53d1\u9001\u5355\u4e2a\u547d\u4ee4\u3002\n\n    Args:\n        **kwargs: \u547d\u4ee4\u53c2\u6570\uff0c\u5c06\u88ab\u7f16\u7801\u4e3a\u6d88\u606f\u5e27\u3002\n\n    Returns:\n        bool: \u662f\u5426\u53d1\u9001\u6210\u529f\u3002\n    \"\"\"\n    try:\n        msg = self.message_domain_service.encode_message(**kwargs)\n        self._display_message(msg, \"\u53d1\u9001\")\n        success = self.serial_domain_service.send_data(msg)\n        if not success:\n            self._display_message(\"\u53d1\u9001\u5931\u8d25\uff1a\u4e32\u53e3\u672a\u8fde\u63a5\", \"\u9519\u8bef\")\n        return success\n    except Exception as e:\n        self._display_message(f\"\u53d1\u9001\u547d\u4ee4\u5931\u8d25: {str(e)}\", \"\u9519\u8bef\")\n        return False\n</code></pre>"},{"location":"api/application/services/command_hub/#controller.application.services.command_hub_service.CommandHubService.command_distribution","title":"command_distribution","text":"<pre><code>command_distribution(config_dict: dict)\n</code></pre> <p>\u5206\u53d1\u7528\u6237\u547d\u4ee4\u5230\u5bf9\u5e94\u7684\u5904\u7406\u903b\u8f91\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config_dict</code> <code>dict</code> <p>\u914d\u7f6e\u5b57\u5178\uff0c\u5305\u542b control, mode \u7b49\u53c2\u6570\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/command_hub_service.py</code> <pre><code>def command_distribution(self, config_dict: dict):\n    \"\"\"\u5206\u53d1\u7528\u6237\u547d\u4ee4\u5230\u5bf9\u5e94\u7684\u5904\u7406\u903b\u8f91\u3002\n\n    Args:\n        config_dict (dict): \u914d\u7f6e\u5b57\u5178\uff0c\u5305\u542b control, mode \u7b49\u53c2\u6570\u3002\n    \"\"\"\n    control = config_dict.get('control')\n    mode = config_dict.get('mode')\n\n    if control in [0x00, 0x01, 0x02, 0x03, 0x04]:\n        self.single_send_command(**config_dict)\n        self.get_current_position()\n\n    elif control == 0x05:\n        if mode == 0x0A:\n            self._display_message(\"\u5173\u95ed\u793a\u6559\u6a21\u5f0f\", \"\u52a8\u529b\u5b66\")\n        self.single_send_command(**config_dict)\n        self.motion_runner.stop_motion()\n\n    elif control == 0x07:\n        if mode == 0x0A:\n            self._display_message(\"\u5f00\u542f\u793a\u6559\u6a21\u5f0f\", \"\u52a8\u529b\u5b66\")\n        self.single_send_command(**config_dict)\n        if mode != 0x0A:\n            self.get_current_position()\n\n    elif control == 0x06:\n        if mode == 0x0A:\n            torque_values = config_dict.get('torque')\n            self._display_message(f\"\u53d1\u9001\u529b\u77e9: {torque_values}\", \"\u52a8\u529b\u5b66\")\n            self.single_send_command(**config_dict)\n        else:\n            # \u89d2\u5ea6\u63a7\u5236\uff1a\u9ed8\u8ba4\u4f7f\u7528 S \u66f2\u7ebf\u548c 0.01 \u9891\u7387\n            target_angles = config_dict.get('target_angles')\n            task = {\n                \"type\": \"motion\",\n                \"target_angles\": target_angles,\n                \"curve_type\": \"s_curve\",\n                \"frequency\": 0.01\n            }\n            self.motion_constructor.prepare_operation(\n                MotionOperationMode.EXECUTE,\n                [task]\n            )\n            self._display_message(f\"\u51c6\u5907\u8fd0\u52a8\u5230\u76ee\u6807\u4f4d\u7f6e: {target_angles}\", \"\u63a7\u5236\")\n            self.get_current_position()\n\n    elif control == 0x08:\n        self.single_send_command(**config_dict)\n        self.motion_runner.stop_motion()\n</code></pre>"},{"location":"api/application/services/command_hub/#controller.application.services.command_hub_service.CommandHubService.get_current_position","title":"get_current_position","text":"<pre><code>get_current_position()\n</code></pre> <p>\u8bf7\u6c42\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/command_hub_service.py</code> <pre><code>def get_current_position(self):\n    \"\"\"\u8bf7\u6c42\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\u3002\"\"\"\n    self.message_display.clear_messages()\n    self._display_message(\"\u6b63\u5728\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e...\", \"\u63a7\u5236\")\n    self.single_send_command(control=0x07)\n</code></pre>"},{"location":"api/application/services/command_hub/#controller.application.services.command_hub_service.CommandHubService.run_teach_record","title":"run_teach_record","text":"<pre><code>run_teach_record(angles_list: list)\n</code></pre> <p>\u8fd0\u884c\u793a\u6559\u8bb0\u5f55\uff08\u64ad\u653e\u793a\u6559\u8f68\u8ff9\uff09\u3002</p> <p>\u6d41\u7a0b\uff1a 1. \u51c6\u5907\u793a\u6559\u8fd0\u52a8\u4efb\u52a1 2. \u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e 3. \u5f02\u6b65\u56de\u8c03\u65f6\u81ea\u52a8\u6784\u5efa\u5e73\u6ed1\u8f68\u8ff9\u5e76\u6267\u884c</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>angles_list</code> <code>list[list[float]]</code> <p>\u793a\u6559\u8bb0\u5f55\u7684\u89d2\u5ea6\u5217\u8868 [[\u03b81,...,\u03b86], ...]\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/command_hub_service.py</code> <pre><code>def run_teach_record(self, angles_list: list):\n    \"\"\"\u8fd0\u884c\u793a\u6559\u8bb0\u5f55\uff08\u64ad\u653e\u793a\u6559\u8f68\u8ff9\uff09\u3002\n\n    \u6d41\u7a0b\uff1a\n    1. \u51c6\u5907\u793a\u6559\u8fd0\u52a8\u4efb\u52a1\n    2. \u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\n    3. \u5f02\u6b65\u56de\u8c03\u65f6\u81ea\u52a8\u6784\u5efa\u5e73\u6ed1\u8f68\u8ff9\u5e76\u6267\u884c\n\n    Args:\n        angles_list (list[list[float]]): \u793a\u6559\u8bb0\u5f55\u7684\u89d2\u5ea6\u5217\u8868 [[\u03b81,...,\u03b86], ...]\u3002\n    \"\"\"\n    task = {\n        \"type\": \"teach\",\n        \"teach_data\": angles_list\n    }\n    self.motion_constructor.prepare_operation(\n        MotionOperationMode.EXECUTE,\n        [task]\n    )\n    self._display_message(f\"\u51c6\u5907\u64ad\u653e\u793a\u6559\u8f68\u8ff9\uff0c\u5171 {len(angles_list)} \u4e2a\u70b9\", \"\u793a\u6559\")\n    self.get_current_position()\n</code></pre>"},{"location":"api/application/services/command_hub/#controller.application.services.command_hub_service.CommandHubService.run_motion_sequence","title":"run_motion_sequence","text":"<pre><code>run_motion_sequence()\n</code></pre> <p>\u5f00\u59cb\u6267\u884c\u8fd0\u52a8\u5e8f\u5217\uff08\u7528\u4e8e\u8fd0\u52a8\u89c4\u5212\u65b9\u6848\uff09\u3002</p> <p>\u6d41\u7a0b\uff1a 1. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e 2. \u6536\u5230\u4f4d\u7f6e\u53cd\u9988\u540e\uff0cMotionConstructor \u81ea\u52a8\u89c4\u5212\u6240\u6709\u4efb\u52a1</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/command_hub_service.py</code> <pre><code>def run_motion_sequence(self):\n    \"\"\"\u5f00\u59cb\u6267\u884c\u8fd0\u52a8\u5e8f\u5217\uff08\u7528\u4e8e\u8fd0\u52a8\u89c4\u5212\u65b9\u6848\uff09\u3002\n\n    \u6d41\u7a0b\uff1a\n    1. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e\n    2. \u6536\u5230\u4f4d\u7f6e\u53cd\u9988\u540e\uff0cMotionConstructor \u81ea\u52a8\u89c4\u5212\u6240\u6709\u4efb\u52a1\n    \"\"\"\n    self._display_message(\"\u5f00\u59cb\u6267\u884c\u8fd0\u52a8\u89c4\u5212\u65b9\u6848...\", \"\u8fd0\u52a8\u89c4\u5212\")\n    self.get_current_position()\n</code></pre>"},{"location":"api/application/services/message_response/","title":"Message Response Service","text":""},{"location":"api/application/services/message_response/#controller.application.services.message_response_service","title":"controller.application.services.message_response_service","text":"<p>\u6d88\u606f\u54cd\u5e94\u670d\u52a1 - Application\u5c42 \u5904\u7406\u4e32\u53e3\u63a5\u6536\u7684\u6570\u636e\uff0c\u89e3\u7801\u5e76\u66f4\u65b0\u72b6\u6001\u670d\u52a1</p>"},{"location":"api/application/services/message_response/#controller.application.services.message_response_service.MessageResponseService","title":"MessageResponseService","text":"<pre><code>MessageResponseService(message_display: MessageDisplay, serial_domain_service: SerialDomainService, message_domain_service: MessageDomainService, robot_state_service: RobotStateDomainService, motion_runner: MotionRunner, motion_constructor: MotionConstructor, trajectory_planner: TrajectoryPlanningService, trajectory_repository: TrajectoryRepository)\n</code></pre> <p>               Bases: <code>BaseService</code></p> <p>\u6d88\u606f\u54cd\u5e94\u670d\u52a1 - Application\u5c42\u3002</p> <p>\u5904\u7406\u4e32\u53e3\u63a5\u6536\u7684\u6570\u636e\uff0c\u89e3\u7801\u5e76\u66f4\u65b0\u72b6\u6001\u670d\u52a1\u3002</p> <p>\u804c\u8d23\uff1a 1. \u63a5\u6536\u4e32\u53e3\u6570\u636e 2. \u62fc\u63a5\u7f13\u51b2\uff0c\u68c0\u6d4b\u5b8c\u6574\u5e27 3. \u89e3\u7801\u6d88\u606f 4. \u66f4\u65b0\u72b6\u6001\u670d\u52a1\uff08\u7edf\u4e00\u5165\u53e3\uff09 5. \u6839\u636e\u64cd\u4f5c\u6a21\u5f0f\u5206\u53d1\u5904\u7406\uff08\u6267\u884c/\u4fdd\u5b58/\u9884\u89c8\uff09</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>get_current_position_signal</code> <code>pyqtSignal</code> <p>\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\u4fe1\u53f7\uff08\u7528\u4e8eUI\u663e\u793a\uff09\u3002</p> <code>trajectory_preview_signal</code> <code>pyqtSignal</code> <p>\u8f68\u8ff9\u9884\u89c8\u6570\u636e\u4fe1\u53f7\u3002</p> <p>\u521d\u59cb\u5316\u6d88\u606f\u54cd\u5e94\u670d\u52a1\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/message_response_service.py</code> <pre><code>def __init__(\n    self, \n    message_display: MessageDisplay,\n    serial_domain_service: SerialDomainService,\n    message_domain_service: MessageDomainService,\n    robot_state_service: RobotStateDomainService,\n    motion_runner: MotionRunner,\n    motion_constructor: MotionConstructor,\n    trajectory_planner: TrajectoryPlanningService,\n    trajectory_repository: TrajectoryRepository\n):\n    \"\"\"\u521d\u59cb\u5316\u6d88\u606f\u54cd\u5e94\u670d\u52a1\u3002\"\"\"\n    super().__init__(message_display)\n    self.serial_domain_service = serial_domain_service\n    self.message_domain_service = message_domain_service\n    self.robot_state_service = robot_state_service\n    self.motion_runner = motion_runner\n    self.motion_constructor = motion_constructor\n    self.trajectory_planner = trajectory_planner\n    self.trajectory_repository = trajectory_repository\n\n    self._connect_signals()\n    self.message_buffer = \"\"\n\n    # \u64cd\u4f5c\u5904\u7406\u5668\u6620\u5c04\uff08\u7b56\u7565\u6a21\u5f0f\uff09\n    self._operation_handlers = {\n        MotionOperationMode.EXECUTE: self._handle_execute,\n        MotionOperationMode.SAVE: self._handle_save,\n        MotionOperationMode.PREVIEW: self._handle_preview,\n    }\n</code></pre>"},{"location":"api/application/services/message_response/#controller.application.services.message_response_service.MessageResponseService.handle_message","title":"handle_message","text":"<pre><code>handle_message(message_in: str)\n</code></pre> <p>\u5904\u7406\u63a5\u6536\u5230\u7684\u6d88\u606f\u3002</p> <p>\u6d41\u7a0b\uff1a 1. \u62fc\u63a5\u7f13\u51b2 2. \u68c0\u6d4b\u5b8c\u6574\u5e27\uff08AA55...0D0A\uff09 3. \u89e3\u7801\u6d88\u606f 4. \u66f4\u65b0\u72b6\u6001\u670d\u52a1 5. \u5904\u7406\u8fd0\u52a8\u6d88\u606f</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>message_in</code> <code>str</code> <p>\u8f93\u5165\u7684\u539f\u59cb\u4e32\u53e3\u6570\u636e\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/message_response_service.py</code> <pre><code>def handle_message(self, message_in: str):\n    \"\"\"\u5904\u7406\u63a5\u6536\u5230\u7684\u6d88\u606f\u3002\n\n    \u6d41\u7a0b\uff1a\n    1. \u62fc\u63a5\u7f13\u51b2\n    2. \u68c0\u6d4b\u5b8c\u6574\u5e27\uff08AA55...0D0A\uff09\n    3. \u89e3\u7801\u6d88\u606f\n    4. \u66f4\u65b0\u72b6\u6001\u670d\u52a1\n    5. \u5904\u7406\u8fd0\u52a8\u6d88\u606f\n\n    Args:\n        message_in (str): \u8f93\u5165\u7684\u539f\u59cb\u4e32\u53e3\u6570\u636e\u3002\n    \"\"\"\n    self.message_buffer += message_in\n    if \"0D0A\" in self.message_buffer:\n        if self.message_buffer.startswith(\"AA55\") and len(self.message_buffer) &lt; 120:\n            return\n        lines = self.message_buffer.rsplit(\"0D0A\", 1)            \n        self.message_buffer = lines[-1]\n        command_line = lines[0]\n        self._display_message(command_line + \"0D0A\", \"\u63a5\u6536\")\n\n        if command_line.startswith(\"AA55\"):\n            try:\n                # \u89e3\u7801\u6d88\u606f\n                decoded_message = self.message_domain_service.decode_message(\n                    command_line + \"0D0A\"\n                )\n                # \u66f4\u65b0\u7edf\u4e00\u7684\u72b6\u6001\u670d\u52a1\uff08\u5355\u4e00\u5165\u53e3\uff09\n                self.robot_state_service.update_state(decoded_message)\n\n                # \u5904\u7406\u8fd0\u52a8\u6d88\u606f\n                if decoded_message.control == 0x07 and decoded_message.mode == 0x08:\n                    self.handle_motion_message(decoded_message.positions)\n\n            except Exception as e:\n                self._display_message(f\"\u89e3\u7801\u6d88\u606f\u5931\u8d25: {str(e)}\", \"\u9519\u8bef\")\n        else:\n            try:\n                ascii_text = bytes.fromhex(command_line).decode('ascii', errors='replace')\n                printable_text = ''.join(\n                    c if c.isprintable() or c in '\\n\\r\\t' \n                    else f'\\\\x{ord(c):02x}' \n                    for c in ascii_text\n                )\n                if printable_text.strip():\n                    self._display_message(f\"ASCII: {printable_text}\", \"\u63a5\u6536\")\n            except Exception:\n                pass\n</code></pre>"},{"location":"api/application/services/message_response/#controller.application.services.message_response_service.MessageResponseService.handle_motion_message","title":"handle_motion_message","text":"<pre><code>handle_motion_message(current_position)\n</code></pre> <p>\u5904\u7406\u8fd0\u52a8\u6d88\u606f\uff08\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\u7684\u56de\u590d\uff09\u3002</p> <p>\u6839\u636e\u72b6\u6001\u51b3\u5b9a\u884c\u4e3a\uff1a 1. \u6709\u5f85\u5904\u7406\u7684\u64cd\u4f5c \u2192 \u8c03\u7528\u5bf9\u5e94\u7684\u5904\u7406\u5668 2. \u65e0\u64cd\u4f5c \u2192 \u4ec5\u53d1\u5c04\u4fe1\u53f7\u4f9bUI\u663e\u793a</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>current_position</code> <code>list[float]</code> <p>\u5f53\u524d\u5173\u8282\u4f4d\u7f6e\uff08\u7f16\u7801\u5668\u503c\uff09\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/message_response_service.py</code> <pre><code>def handle_motion_message(self, current_position):\n    \"\"\"\u5904\u7406\u8fd0\u52a8\u6d88\u606f\uff08\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\u7684\u56de\u590d\uff09\u3002\n\n    \u6839\u636e\u72b6\u6001\u51b3\u5b9a\u884c\u4e3a\uff1a\n    1. \u6709\u5f85\u5904\u7406\u7684\u64cd\u4f5c \u2192 \u8c03\u7528\u5bf9\u5e94\u7684\u5904\u7406\u5668\n    2. \u65e0\u64cd\u4f5c \u2192 \u4ec5\u53d1\u5c04\u4fe1\u53f7\u4f9bUI\u663e\u793a\n\n    Args:\n        current_position (list[float]): \u5f53\u524d\u5173\u8282\u4f4d\u7f6e\uff08\u7f16\u7801\u5668\u503c\uff09\u3002\n    \"\"\"\n    if self.motion_constructor.has_pending_operation():\n        # \u83b7\u53d6\u64cd\u4f5c\u6a21\u5f0f\n        mode = self.motion_constructor.get_operation_mode()\n\n        # \u4ece\u5b57\u5178\u4e2d\u83b7\u53d6\u5bf9\u5e94\u7684\u5904\u7406\u51fd\u6570\n        handler = self._operation_handlers.get(mode)\n\n        if handler:\n            # \u8c03\u7528\u5904\u7406\u51fd\u6570\n            handler(current_position)\n        else:\n            self._display_message(f\"\u672a\u77e5\u64cd\u4f5c\u6a21\u5f0f: {mode}\", \"\u9519\u8bef\")\n            self.motion_constructor.clear_operation()\n    else:\n        # \u65e0\u64cd\u4f5c\uff1a\u4ec5\u53d1\u5c04\u4fe1\u53f7\u4f9bUI\u663e\u793a\n        self.get_current_position_signal.emit(current_position)\n</code></pre>"},{"location":"api/application/services/motion_planning/","title":"Motion Planning Application Service","text":""},{"location":"api/application/services/motion_planning/#controller.application.services.motion_planning_application_service","title":"controller.application.services.motion_planning_application_service","text":"<p>\u8fd0\u52a8\u89c4\u5212\u5e94\u7528\u670d\u52a1</p>"},{"location":"api/application/services/motion_planning/#controller.application.services.motion_planning_application_service.MotionPlanningApplicationService","title":"MotionPlanningApplicationService","text":"<pre><code>MotionPlanningApplicationService(domain_service: MotionPlanningDomainService, repository: MotionPlanRepository, motion_constructor: MotionConstructor, command_hub: CommandHubService, message_response: MessageResponseService, trajectory_repository: TrajectoryRepository)\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u8fd0\u52a8\u89c4\u5212\u5e94\u7528\u670d\u52a1\u3002</p> <p>\u804c\u8d23\uff1a 1. \u534f\u8c03Domain\u548cInfrastructure 2. \u81ea\u52a8\u4fdd\u5b58 3. \u53d1\u9001UI\u66f4\u65b0\u4fe1\u53f7 4. \u6267\u884c\u8fd0\u52a8\u89c4\u5212\uff08\u5355\u70b9\u548c\u6574\u4f53\u65b9\u6848\uff09 5. \u5904\u7406\"\u83b7\u53d6\u4f4d\u7f6e\"\u529f\u80fd</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>plan_list_changed</code> <code>pyqtSignal</code> <p>\u65b9\u6848\u5217\u8868\u53d8\u5316\u4fe1\u53f7\u3002</p> <code>current_plan_changed</code> <code>pyqtSignal</code> <p>\u5f53\u524d\u65b9\u6848\u5207\u6362\u4fe1\u53f7\u3002</p> <code>point_list_changed</code> <code>pyqtSignal</code> <p>\u8282\u70b9\u5217\u8868\u53d8\u5316\u4fe1\u53f7\u3002</p> <code>current_position_received</code> <code>pyqtSignal</code> <p>\u5f53\u524d\u4f4d\u7f6e\u6570\u636e\u4fe1\u53f7\uff08\u5f27\u5ea6\u503c\uff09\u3002</p> <code>trajectory_preview_signal</code> <code>pyqtSignal</code> <p>\u8f68\u8ff9\u9884\u89c8\u6570\u636e\u4fe1\u53f7\uff08\u8f68\u8ff9\u6570\u636e\uff0c\u4e0a\u4e0b\u6587\uff09\u3002</p> <p>\u521d\u59cb\u5316\u8fd0\u52a8\u89c4\u5212\u5e94\u7528\u670d\u52a1\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>domain_service</code> <code>MotionPlanningDomainService</code> <p>\u8fd0\u52a8\u89c4\u5212\u9886\u57df\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>repository</code> <code>MotionPlanRepository</code> <p>\u8fd0\u52a8\u65b9\u6848\u4ed3\u50a8\u3002</p> \u5fc5\u9700 <code>motion_constructor</code> <code>MotionConstructor</code> <p>\u8fd0\u52a8\u6784\u9020\u5668\u3002</p> \u5fc5\u9700 <code>command_hub</code> <code>CommandHubService</code> <p>\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>message_response</code> <code>MessageResponseService</code> <p>\u6d88\u606f\u54cd\u5e94\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>trajectory_repository</code> <code>TrajectoryRepository</code> <p>\u8f68\u8ff9\u4ed3\u50a8\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def __init__(\n    self,\n    domain_service: MotionPlanningDomainService,\n    repository: MotionPlanRepository,\n    motion_constructor: MotionConstructor,\n    command_hub: CommandHubService,\n    message_response: MessageResponseService,\n    trajectory_repository: TrajectoryRepository\n):\n    \"\"\"\u521d\u59cb\u5316\u8fd0\u52a8\u89c4\u5212\u5e94\u7528\u670d\u52a1\u3002\n\n    Args:\n        domain_service: \u8fd0\u52a8\u89c4\u5212\u9886\u57df\u670d\u52a1\u3002\n        repository: \u8fd0\u52a8\u65b9\u6848\u4ed3\u50a8\u3002\n        motion_constructor: \u8fd0\u52a8\u6784\u9020\u5668\u3002\n        command_hub: \u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002\n        message_response: \u6d88\u606f\u54cd\u5e94\u670d\u52a1\u3002\n        trajectory_repository: \u8f68\u8ff9\u4ed3\u50a8\u3002\n    \"\"\"\n    super().__init__()\n    self.domain_service = domain_service\n    self.repository = repository\n    self.motion_constructor = motion_constructor\n    self.command_hub = command_hub\n    self.message_response = message_response\n    self.trajectory_repository = trajectory_repository\n\n    # \u8fde\u63a5MessageResponse\u7684\u4f4d\u7f6e\u6570\u636e\u4fe1\u53f7\n    self.message_response.get_current_position_signal.connect(\n        self.current_position_received.emit\n    )\n\n    # \u8fde\u63a5MessageResponse\u7684\u8f68\u8ff9\u9884\u89c8\u4fe1\u53f7\n    self.message_response.trajectory_preview_signal.connect(\n        self.trajectory_preview_signal.emit\n    )\n\n    self._load_data()\n</code></pre>"},{"location":"api/application/services/motion_planning/#controller.application.services.motion_planning_application_service.MotionPlanningApplicationService.create_plan","title":"create_plan","text":"<pre><code>create_plan(name: str)\n</code></pre> <p>\u521b\u5efa\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>name</code> <code>str</code> <p>\u65b9\u6848\u540d\u79f0\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def create_plan(self, name: str):\n    \"\"\"\u521b\u5efa\u65b9\u6848\u3002\n\n    Args:\n        name (str): \u65b9\u6848\u540d\u79f0\u3002\n    \"\"\"\n    new_index = self.domain_service.create_plan(name)\n    self._save_data()\n    self.plan_list_changed.emit()\n    self.current_plan_changed.emit(new_index)\n    self.point_list_changed.emit()\n</code></pre>"},{"location":"api/application/services/motion_planning/#controller.application.services.motion_planning_application_service.MotionPlanningApplicationService.delete_plan","title":"delete_plan","text":"<pre><code>delete_plan(index: int) -&gt; bool\n</code></pre> <p>\u5220\u9664\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u65b9\u6848\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u5220\u9664\u6210\u529f, False=\u5220\u9664\u5931\u8d25\uff08\u8fdd\u53cd\u4e1a\u52a1\u89c4\u5219\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def delete_plan(self, index: int) -&gt; bool:\n    \"\"\"\u5220\u9664\u65b9\u6848\u3002\n\n    Args:\n        index (int): \u65b9\u6848\u7d22\u5f15\u3002\n\n    Returns:\n        bool: True=\u5220\u9664\u6210\u529f, False=\u5220\u9664\u5931\u8d25\uff08\u8fdd\u53cd\u4e1a\u52a1\u89c4\u5219\uff09\u3002\n    \"\"\"\n    if self.domain_service.delete_plan(index):\n        self._save_data()\n        self.plan_list_changed.emit()\n        self.current_plan_changed.emit(self.domain_service.get_current_index())\n        self.point_list_changed.emit()\n        return True\n    return False\n</code></pre>"},{"location":"api/application/services/motion_planning/#controller.application.services.motion_planning_application_service.MotionPlanningApplicationService.switch_plan","title":"switch_plan","text":"<pre><code>switch_plan(index: int)\n</code></pre> <p>\u5207\u6362\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u76ee\u6807\u65b9\u6848\u7d22\u5f15\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def switch_plan(self, index: int):\n    \"\"\"\u5207\u6362\u65b9\u6848\u3002\n\n    Args:\n        index (int): \u76ee\u6807\u65b9\u6848\u7d22\u5f15\u3002\n    \"\"\"\n    if self.domain_service.set_current_index(index):\n        self._save_data()\n        self.current_plan_changed.emit(index)\n        self.point_list_changed.emit()\n</code></pre>"},{"location":"api/application/services/motion_planning/#controller.application.services.motion_planning_application_service.MotionPlanningApplicationService.rename_plan","title":"rename_plan","text":"<pre><code>rename_plan(index: int, new_name: str)\n</code></pre> <p>\u91cd\u547d\u540d\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u65b9\u6848\u7d22\u5f15\u3002</p> \u5fc5\u9700 <code>new_name</code> <code>str</code> <p>\u65b0\u540d\u79f0\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def rename_plan(self, index: int, new_name: str):\n    \"\"\"\u91cd\u547d\u540d\u65b9\u6848\u3002\n\n    Args:\n        index (int): \u65b9\u6848\u7d22\u5f15\u3002\n        new_name (str): \u65b0\u540d\u79f0\u3002\n    \"\"\"\n    if self.domain_service.rename_plan(index, new_name):\n        self._save_data()\n        self.plan_list_changed.emit()\n</code></pre>"},{"location":"api/application/services/motion_planning/#controller.application.services.motion_planning_application_service.MotionPlanningApplicationService.add_point","title":"add_point","text":"<pre><code>add_point(point_data: dict)\n</code></pre> <p>\u6dfb\u52a0\u8282\u70b9</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def add_point(self, point_data: dict):\n    \"\"\"\u6dfb\u52a0\u8282\u70b9\"\"\"\n    self.domain_service.add_point(point_data)\n    self._save_data()\n    self.point_list_changed.emit()\n</code></pre>"},{"location":"api/application/services/motion_planning/#controller.application.services.motion_planning_application_service.MotionPlanningApplicationService.delete_point","title":"delete_point","text":"<pre><code>delete_point(index: int)\n</code></pre> <p>\u5220\u9664\u8282\u70b9</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def delete_point(self, index: int):\n    \"\"\"\u5220\u9664\u8282\u70b9\"\"\"\n    self.domain_service.remove_point(index)\n    self._save_data()\n    self.point_list_changed.emit()\n</code></pre>"},{"location":"api/application/services/motion_planning/#controller.application.services.motion_planning_application_service.MotionPlanningApplicationService.move_point_up","title":"move_point_up","text":"<pre><code>move_point_up(index: int)\n</code></pre> <p>\u4e0a\u79fb\u8282\u70b9</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def move_point_up(self, index: int):\n    \"\"\"\u4e0a\u79fb\u8282\u70b9\"\"\"\n    if self.domain_service.move_point_up(index):\n        self._save_data()\n        self.point_list_changed.emit()\n</code></pre>"},{"location":"api/application/services/motion_planning/#controller.application.services.motion_planning_application_service.MotionPlanningApplicationService.move_point_down","title":"move_point_down","text":"<pre><code>move_point_down(index: int)\n</code></pre> <p>\u4e0b\u79fb\u8282\u70b9</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def move_point_down(self, index: int):\n    \"\"\"\u4e0b\u79fb\u8282\u70b9\"\"\"\n    if self.domain_service.move_point_down(index):\n        self._save_data()\n        self.point_list_changed.emit()\n</code></pre>"},{"location":"api/application/services/motion_planning/#controller.application.services.motion_planning_application_service.MotionPlanningApplicationService.update_point","title":"update_point","text":"<pre><code>update_point(index: int, point_data: dict)\n</code></pre> <p>\u66f4\u65b0\u8282\u70b9</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def update_point(self, index: int, point_data: dict):\n    \"\"\"\u66f4\u65b0\u8282\u70b9\"\"\"\n    self.domain_service.update_point(index, point_data)\n    self._save_data()\n    self.point_list_changed.emit()\n</code></pre>"},{"location":"api/application/services/motion_planning/#controller.application.services.motion_planning_application_service.MotionPlanningApplicationService.get_single_point","title":"get_single_point","text":"<pre><code>get_single_point(index: int) -&gt; dict\n</code></pre> <p>\u83b7\u53d6\u5355\u4e2a\u8282\u70b9\u6570\u636e\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>dict</code> <code>dict</code> <p>\u8282\u70b9\u6570\u636e\u5b57\u5178\uff0c\u5982\u679c\u7d22\u5f15\u65e0\u6548\u5219\u8fd4\u56deNone\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def get_single_point(self, index: int) -&gt; dict:\n    \"\"\"\u83b7\u53d6\u5355\u4e2a\u8282\u70b9\u6570\u636e\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n\n    Returns:\n        dict: \u8282\u70b9\u6570\u636e\u5b57\u5178\uff0c\u5982\u679c\u7d22\u5f15\u65e0\u6548\u5219\u8fd4\u56deNone\u3002\n    \"\"\"\n    points = self.domain_service.get_all_points()\n    if 0 &lt;= index &lt; len(points):\n        return points[index]\n    return None\n</code></pre>"},{"location":"api/application/services/motion_planning/#controller.application.services.motion_planning_application_service.MotionPlanningApplicationService.execute_single_point","title":"execute_single_point","text":"<pre><code>execute_single_point(index: int)\n</code></pre> <p>\u6267\u884c\u5355\u4e2a\u8282\u70b9\u3002</p> <p>\u6d41\u7a0b\uff1a 1. \u83b7\u53d6\u8282\u70b9\u6570\u636e 2. \u89e3\u6790\u4e3a\u4efb\u52a1\u5217\u8868 3. \u51c6\u5907\u6267\u884c\u64cd\u4f5c 4. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def execute_single_point(self, index: int):\n    \"\"\"\u6267\u884c\u5355\u4e2a\u8282\u70b9\u3002\n\n    \u6d41\u7a0b\uff1a\n    1. \u83b7\u53d6\u8282\u70b9\u6570\u636e\n    2. \u89e3\u6790\u4e3a\u4efb\u52a1\u5217\u8868\n    3. \u51c6\u5907\u6267\u884c\u64cd\u4f5c\n    4. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n    \"\"\"\n    tasks = self._get_node_tasks(index)\n    if not tasks:\n        return\n\n    # \u51c6\u5907\u6267\u884c\u64cd\u4f5c\n    self.motion_constructor.prepare_operation(\n        MotionOperationMode.EXECUTE,\n        tasks\n    )\n\n    # \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e\uff0c\u89e6\u53d1\u6267\u884c\n    self.command_hub.get_current_position()\n</code></pre>"},{"location":"api/application/services/motion_planning/#controller.application.services.motion_planning_application_service.MotionPlanningApplicationService.execute_motion_plan","title":"execute_motion_plan","text":"<pre><code>execute_motion_plan()\n</code></pre> <p>\u6267\u884c\u6574\u4e2a\u8fd0\u52a8\u89c4\u5212\u65b9\u6848\u3002</p> <p>\u6d41\u7a0b\uff1a 1. \u83b7\u53d6\u6240\u6709\u8282\u70b9\u7684\u4efb\u52a1 2. \u51c6\u5907\u6267\u884c\u64cd\u4f5c 3. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e\uff0c\u89e6\u53d1\u6267\u884c</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def execute_motion_plan(self):\n    \"\"\"\u6267\u884c\u6574\u4e2a\u8fd0\u52a8\u89c4\u5212\u65b9\u6848\u3002\n\n    \u6d41\u7a0b\uff1a\n    1. \u83b7\u53d6\u6240\u6709\u8282\u70b9\u7684\u4efb\u52a1\n    2. \u51c6\u5907\u6267\u884c\u64cd\u4f5c\n    3. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e\uff0c\u89e6\u53d1\u6267\u884c\n    \"\"\"\n    tasks = self._get_plan_tasks()\n    if not tasks:\n        return\n\n    # \u51c6\u5907\u6267\u884c\u64cd\u4f5c\n    self.motion_constructor.prepare_operation(\n        MotionOperationMode.EXECUTE,\n        tasks\n    )\n\n    # \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e\uff0c\u89e6\u53d1\u6267\u884c\n    self.command_hub.run_motion_sequence()\n</code></pre>"},{"location":"api/application/services/motion_planning/#controller.application.services.motion_planning_application_service.MotionPlanningApplicationService.request_current_position","title":"request_current_position","text":"<pre><code>request_current_position()\n</code></pre> <p>\u8bf7\u6c42\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\uff08\u4ec5\u7528\u4e8eUI\u663e\u793a\uff09\u3002</p> <p>\u6d41\u7a0b\uff1a 1. \u53d1\u9001 0x07 \u547d\u4ee4\u67e5\u8be2\u4f4d\u7f6e 2. \u4e32\u53e3\u8fd4\u56de\u6570\u636e\u540e\uff0cMessageResponseService \u68c0\u67e5 has_pending_operation() 3. \u56e0\u4e3a\u6ca1\u6709\u8c03\u7528 prepare_operation\uff0c\u6240\u4ee5\u8fd4\u56de False 4. MessageResponseService emit get_current_position_signal 5. \u672cService\u8f6c\u53d1\u4fe1\u53f7\u7ed9ViewModel</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def request_current_position(self):\n    \"\"\"\u8bf7\u6c42\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\uff08\u4ec5\u7528\u4e8eUI\u663e\u793a\uff09\u3002\n\n    \u6d41\u7a0b\uff1a\n    1. \u53d1\u9001 0x07 \u547d\u4ee4\u67e5\u8be2\u4f4d\u7f6e\n    2. \u4e32\u53e3\u8fd4\u56de\u6570\u636e\u540e\uff0cMessageResponseService \u68c0\u67e5 has_pending_operation()\n    3. \u56e0\u4e3a\u6ca1\u6709\u8c03\u7528 prepare_operation\uff0c\u6240\u4ee5\u8fd4\u56de False\n    4. MessageResponseService emit get_current_position_signal\n    5. \u672cService\u8f6c\u53d1\u4fe1\u53f7\u7ed9ViewModel\n    \"\"\"\n    self.command_hub.single_send_command(control=0x07)\n</code></pre>"},{"location":"api/application/services/motion_planning/#controller.application.services.motion_planning_application_service.MotionPlanningApplicationService.save_node_trajectory","title":"save_node_trajectory","text":"<pre><code>save_node_trajectory(node_index: int) -&gt; bool\n</code></pre> <p>\u4fdd\u5b58\u5355\u4e2a\u8282\u70b9\u7684\u8f68\u8ff9\u3002</p> <p>\u6d41\u7a0b\uff1a 1. \u83b7\u53d6\u8282\u70b9\u4efb\u52a1 2. \u51c6\u5907\u4fdd\u5b58\u64cd\u4f5c 3. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e 4. MessageResponseService \u81ea\u52a8\u5b8c\u6210\u4fdd\u5b58</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>node_index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True: \u51c6\u5907\u6210\u529f, False: \u51c6\u5907\u5931\u8d25\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def save_node_trajectory(self, node_index: int) -&gt; bool:\n    \"\"\"\u4fdd\u5b58\u5355\u4e2a\u8282\u70b9\u7684\u8f68\u8ff9\u3002\n\n    \u6d41\u7a0b\uff1a\n    1. \u83b7\u53d6\u8282\u70b9\u4efb\u52a1\n    2. \u51c6\u5907\u4fdd\u5b58\u64cd\u4f5c\n    3. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e\n    4. MessageResponseService \u81ea\u52a8\u5b8c\u6210\u4fdd\u5b58\n\n    Args:\n        node_index (int): \u8282\u70b9\u7d22\u5f15\u3002\n\n    Returns:\n        bool: True: \u51c6\u5907\u6210\u529f, False: \u51c6\u5907\u5931\u8d25\u3002\n    \"\"\"\n    try:\n        tasks = self._get_node_tasks(node_index)\n        if not tasks:\n            return False\n\n        current_plan = self.domain_service.get_current_plan()\n        if not current_plan:\n            return False\n\n        context = {\n            \"filename\": f\"{current_plan.name}-{node_index}\",\n            \"type\": \"node\"\n        }\n\n        self.motion_constructor.prepare_operation(\n            MotionOperationMode.SAVE,\n            tasks,\n            context\n        )\n\n        self.command_hub.get_current_position()\n        return True\n    except Exception:\n        return False\n</code></pre>"},{"location":"api/application/services/motion_planning/#controller.application.services.motion_planning_application_service.MotionPlanningApplicationService.save_plan_trajectory","title":"save_plan_trajectory","text":"<pre><code>save_plan_trajectory() -&gt; bool\n</code></pre> <p>\u4fdd\u5b58\u6574\u4e2a\u65b9\u6848\u7684\u8f68\u8ff9</p> <p>\u6d41\u7a0b\uff1a 1. \u83b7\u53d6\u65b9\u6848\u6240\u6709\u4efb\u52a1 2. \u51c6\u5907\u4fdd\u5b58\u64cd\u4f5c 3. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e 4. MessageResponseService \u81ea\u52a8\u5b8c\u6210\u4fdd\u5b58</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>True</code> <code>bool</code> <p>\u51c6\u5907\u6210\u529f</p> <code>False</code> <code>bool</code> <p>\u51c6\u5907\u5931\u8d25</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def save_plan_trajectory(self) -&gt; bool:\n    \"\"\"\n    \u4fdd\u5b58\u6574\u4e2a\u65b9\u6848\u7684\u8f68\u8ff9\n\n    \u6d41\u7a0b\uff1a\n    1. \u83b7\u53d6\u65b9\u6848\u6240\u6709\u4efb\u52a1\n    2. \u51c6\u5907\u4fdd\u5b58\u64cd\u4f5c\n    3. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e\n    4. MessageResponseService \u81ea\u52a8\u5b8c\u6210\u4fdd\u5b58\n\n    Returns:\n        True: \u51c6\u5907\u6210\u529f\n        False: \u51c6\u5907\u5931\u8d25\n    \"\"\"\n    try:\n        tasks = self._get_plan_tasks()\n        if not tasks:\n            return False\n\n        current_plan = self.domain_service.get_current_plan()\n        if not current_plan:\n            return False\n\n        context = {\n            \"filename\": current_plan.name,\n            \"type\": \"plan\"\n        }\n\n        self.motion_constructor.prepare_operation(\n            MotionOperationMode.SAVE,\n            tasks,\n            context\n        )\n\n        self.command_hub.get_current_position()\n        return True\n    except Exception:\n        return False\n</code></pre>"},{"location":"api/application/services/motion_planning/#controller.application.services.motion_planning_application_service.MotionPlanningApplicationService.preview_node_trajectory","title":"preview_node_trajectory","text":"<pre><code>preview_node_trajectory(node_index: int) -&gt; bool\n</code></pre> <p>\u9884\u89c8\u5355\u4e2a\u8282\u70b9\u7684\u8f68\u8ff9\u66f2\u7ebf</p> <p>\u6d41\u7a0b\uff1a 1. \u83b7\u53d6\u8282\u70b9\u4efb\u52a1 2. \u51c6\u5907\u9884\u89c8\u64cd\u4f5c 3. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e 4. MessageResponseService \u81ea\u52a8\u53d1\u5c04\u9884\u89c8\u4fe1\u53f7</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>node_index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>True</code> <code>bool</code> <p>\u51c6\u5907\u6210\u529f</p> <code>False</code> <code>bool</code> <p>\u51c6\u5907\u5931\u8d25</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def preview_node_trajectory(self, node_index: int) -&gt; bool:\n    \"\"\"\n    \u9884\u89c8\u5355\u4e2a\u8282\u70b9\u7684\u8f68\u8ff9\u66f2\u7ebf\n\n    \u6d41\u7a0b\uff1a\n    1. \u83b7\u53d6\u8282\u70b9\u4efb\u52a1\n    2. \u51c6\u5907\u9884\u89c8\u64cd\u4f5c\n    3. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e\n    4. MessageResponseService \u81ea\u52a8\u53d1\u5c04\u9884\u89c8\u4fe1\u53f7\n\n    Args:\n        node_index: \u8282\u70b9\u7d22\u5f15\n\n    Returns:\n        True: \u51c6\u5907\u6210\u529f\n        False: \u51c6\u5907\u5931\u8d25\n    \"\"\"\n    try:\n        tasks = self._get_node_tasks(node_index)\n        if not tasks:\n            return False\n\n        context = {\n            \"type\": \"node\",\n            \"node_index\": node_index\n        }\n\n        self.motion_constructor.prepare_operation(\n            MotionOperationMode.PREVIEW,\n            tasks,\n            context\n        )\n\n        self.command_hub.get_current_position()\n        return True\n    except Exception:\n        return False\n</code></pre>"},{"location":"api/application/services/motion_planning/#controller.application.services.motion_planning_application_service.MotionPlanningApplicationService.preview_plan_trajectory","title":"preview_plan_trajectory","text":"<pre><code>preview_plan_trajectory() -&gt; bool\n</code></pre> <p>\u9884\u89c8\u6574\u4e2a\u65b9\u6848\u7684\u8f68\u8ff9\u66f2\u7ebf</p> <p>\u6d41\u7a0b\uff1a 1. \u83b7\u53d6\u65b9\u6848\u6240\u6709\u4efb\u52a1 2. \u51c6\u5907\u9884\u89c8\u64cd\u4f5c 3. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e 4. MessageResponseService \u81ea\u52a8\u53d1\u5c04\u9884\u89c8\u4fe1\u53f7</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>True</code> <code>bool</code> <p>\u51c6\u5907\u6210\u529f</p> <code>False</code> <code>bool</code> <p>\u51c6\u5907\u5931\u8d25</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def preview_plan_trajectory(self) -&gt; bool:\n    \"\"\"\n    \u9884\u89c8\u6574\u4e2a\u65b9\u6848\u7684\u8f68\u8ff9\u66f2\u7ebf\n\n    \u6d41\u7a0b\uff1a\n    1. \u83b7\u53d6\u65b9\u6848\u6240\u6709\u4efb\u52a1\n    2. \u51c6\u5907\u9884\u89c8\u64cd\u4f5c\n    3. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e\n    4. MessageResponseService \u81ea\u52a8\u53d1\u5c04\u9884\u89c8\u4fe1\u53f7\n\n    Returns:\n        True: \u51c6\u5907\u6210\u529f\n        False: \u51c6\u5907\u5931\u8d25\n    \"\"\"\n    try:\n        tasks = self._get_plan_tasks()\n        if not tasks:\n            return False\n\n        context = {\"type\": \"plan\"}\n\n        self.motion_constructor.prepare_operation(\n            MotionOperationMode.PREVIEW,\n            tasks,\n            context\n        )\n\n        self.command_hub.get_current_position()\n        return True\n    except Exception:\n        return False\n</code></pre>"},{"location":"api/application/services/motion_planning/#controller.application.services.motion_planning_application_service.MotionPlanningApplicationService.load_local_trajectory","title":"load_local_trajectory","text":"<pre><code>load_local_trajectory(file_path: str) -&gt; bool\n</code></pre> <p>\u4ece plans \u76ee\u5f55\u52a0\u8f7d\u8f68\u8ff9\u6587\u4ef6\uff0c\u4f5c\u4e3a\u793a\u6559\u8282\u70b9\u6dfb\u52a0</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>str</code> <p>\u8f68\u8ff9\u6587\u4ef6\u7684\u5b8c\u6574\u8def\u5f84\u6216\u6587\u4ef6\u540d</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>True</code> <code>bool</code> <p>\u52a0\u8f7d\u6210\u529f</p> <code>False</code> <code>bool</code> <p>\u52a0\u8f7d\u5931\u8d25</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def load_local_trajectory(self, file_path: str) -&gt; bool:\n    \"\"\"\n    \u4ece plans \u76ee\u5f55\u52a0\u8f7d\u8f68\u8ff9\u6587\u4ef6\uff0c\u4f5c\u4e3a\u793a\u6559\u8282\u70b9\u6dfb\u52a0\n\n    Args:\n        file_path: \u8f68\u8ff9\u6587\u4ef6\u7684\u5b8c\u6574\u8def\u5f84\u6216\u6587\u4ef6\u540d\n\n    Returns:\n        True: \u52a0\u8f7d\u6210\u529f\n        False: \u52a0\u8f7d\u5931\u8d25\n    \"\"\"\n    try:\n        # 1. \u63d0\u53d6\u6587\u4ef6\u540d\uff08\u4e0d\u5e26\u8def\u5f84\u548c\u6269\u5c55\u540d\uff09\n        file_stem = Path(file_path).stem\n\n        # 2. \u4ece TrajectoryRepository \u52a0\u8f7d\n        trajectory_data = self.trajectory_repository.load_trajectory(file_stem)\n\n        # 3. \u9a8c\u8bc1\u6570\u636e\n        if not self._validate_trajectory_data(trajectory_data):\n            return False\n\n        # 4. \u521b\u5efa\u793a\u6559\u8282\u70b9\u6570\u636e\uff08\u590d\u7528\u793a\u6559\u6a21\u5f0f\u7684\u683c\u5f0f\uff09\n        point_data = {\n            \"mode\": f\"\u793a\u6559-{file_stem}\",\n            \"joint1\": 0.0,\n            \"joint2\": 0.0,\n            \"joint3\": 0.0,\n            \"joint4\": 0.0,\n            \"joint5\": 0.0,\n            \"joint6\": 0.0,\n            \"frequency\": 0.01,\n            \"curve_type\": \"S\u66f2\u7ebf\",\n            \"gripper_command\": \"00: \u4e0d\u8fdb\u884c\u4efb\u4f55\u64cd\u4f5c\",\n            \"gripper_param\": 0.0,\n            \"note\": f\"\u672c\u5730\u8f68\u8ff9\uff0c\u5171{len(trajectory_data)}\u4e2a\u70b9\",\n            \"teach_record_name\": file_stem,\n            \"teach_data\": trajectory_data,\n            \"source\": \"local_trajectory\"  # \u6807\u8bb0\u6765\u6e90\n        }\n\n        # 5. \u6dfb\u52a0\u8282\u70b9\n        self.domain_service.add_point(point_data)\n        self._save_data()  # \u6301\u4e45\u5316\u4fdd\u5b58\n        self.point_list_changed.emit()\n        return True\n\n    except Exception:\n        return False\n</code></pre>"},{"location":"api/application/services/motion_planning/#controller.application.services.motion_planning_application_service.MotionPlanningApplicationService.get_local_trajectory_files","title":"get_local_trajectory_files","text":"<pre><code>get_local_trajectory_files() -&gt; List[str]\n</code></pre> <p>\u83b7\u53d6\u6240\u6709\u53ef\u7528\u7684\u672c\u5730\u8f68\u8ff9\u6587\u4ef6</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>\u6587\u4ef6\u540d\u5217\u8868\uff08\u4e0d\u5e26\u6269\u5c55\u540d\uff09</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def get_local_trajectory_files(self) -&gt; List[str]:\n    \"\"\"\n    \u83b7\u53d6\u6240\u6709\u53ef\u7528\u7684\u672c\u5730\u8f68\u8ff9\u6587\u4ef6\n\n    Returns:\n        \u6587\u4ef6\u540d\u5217\u8868\uff08\u4e0d\u5e26\u6269\u5c55\u540d\uff09\n    \"\"\"\n    return self.trajectory_repository.list_trajectory_files()\n</code></pre>"},{"location":"api/application/services/serial/","title":"Serial Application Service","text":""},{"location":"api/application/services/serial/#controller.application.services.serial_application_service","title":"controller.application.services.serial_application_service","text":"<p>\u4e32\u53e3\u5e94\u7528\u670d\u52a1 - Application\u5c42 \u53ea\u8d1f\u8d23\u4e32\u53e3\u8fde\u63a5\u7ba1\u7406\u548c\u72b6\u6001\u534f\u8c03\uff0c\u4e0d\u5904\u7406\u6570\u636e\u6536\u53d1 \u6570\u636e\u6536\u53d1\u7531\u5404\u4e2aDomain\u670d\u52a1\u76f4\u63a5\u4f7f\u7528SerialDomainService</p>"},{"location":"api/application/services/serial/#controller.application.services.serial_application_service.SerialApplicationService","title":"SerialApplicationService","text":"<pre><code>SerialApplicationService(message_display: MessageDisplay, serial_domain_service: SerialDomainService)\n</code></pre> <p>               Bases: <code>BaseService</code></p> <p>\u4e32\u53e3\u5e94\u7528\u670d\u52a1\u3002</p> <p>\u53ea\u8d1f\u8d23\u4e32\u53e3\u8fde\u63a5\u7ba1\u7406\u548c\u72b6\u6001\u534f\u8c03\uff0c\u4e0d\u5904\u7406\u6570\u636e\u6536\u53d1\u3002 \u6570\u636e\u6536\u53d1\u7531\u5404\u4e2aDomain\u670d\u52a1\u76f4\u63a5\u4f7f\u7528SerialDomainService\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>connection_status_changed</code> <code>pyqtSignal</code> <p>\u4e32\u53e3\u8fde\u63a5\u72b6\u6001\u53d8\u5316\u4fe1\u53f7\u3002</p> <code>port_list_updated</code> <code>pyqtSignal</code> <p>\u7aef\u53e3\u5217\u8868\u66f4\u65b0\u4fe1\u53f7\u3002</p> <p>\u521d\u59cb\u5316\u4e32\u53e3\u5e94\u7528\u670d\u52a1\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/serial_application_service.py</code> <pre><code>def __init__(self, message_display: MessageDisplay, serial_domain_service: SerialDomainService):\n    \"\"\"\u521d\u59cb\u5316\u4e32\u53e3\u5e94\u7528\u670d\u52a1\u3002\"\"\"\n    super().__init__(message_display)\n\n    self.serial_domain_service = serial_domain_service\n\n    # \u8fde\u63a5Domain\u5c42\u4fe1\u53f7\u5230Application\u5c42\n    self._connect_domain_signals()\n</code></pre>"},{"location":"api/application/services/serial/#controller.application.services.serial_application_service.SerialApplicationService.refresh_ports","title":"refresh_ports","text":"<pre><code>refresh_ports() -&gt; List[str]\n</code></pre> <p>\u5237\u65b0\u53ef\u7528\u7aef\u53e3\u5217\u8868\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>List[str]: \u53ef\u7528\u7aef\u53e3\u540d\u79f0\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/serial_application_service.py</code> <pre><code>def refresh_ports(self) -&gt; List[str]:\n    \"\"\"\u5237\u65b0\u53ef\u7528\u7aef\u53e3\u5217\u8868\u3002\n\n    Returns:\n        List[str]: \u53ef\u7528\u7aef\u53e3\u540d\u79f0\u5217\u8868\u3002\n    \"\"\"\n    try:\n        ports = self.serial_domain_service.scan_available_ports()\n        self.port_list_updated.emit(ports)\n        self._display_message(f\"\u53d1\u73b0 {len(ports)} \u4e2a\u53ef\u7528\u7aef\u53e3\", \"\u7cfb\u7edf\")\n        return ports\n    except Exception as e:\n        self._display_message(f\"\u5237\u65b0\u7aef\u53e3\u5931\u8d25: {str(e)}\", \"\u9519\u8bef\")\n        return []\n</code></pre>"},{"location":"api/application/services/serial/#controller.application.services.serial_application_service.SerialApplicationService.get_port_info","title":"get_port_info","text":"<pre><code>get_port_info(port_name: str) -&gt; Optional[Dict[str, str]]\n</code></pre> <p>\u83b7\u53d6\u6307\u5b9a\u7aef\u53e3\u4fe1\u606f\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>port_name</code> <code>str</code> <p>\u7aef\u53e3\u540d\u79f0\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[Dict[str, str]]</code> <p>Optional[Dict[str, str]]: \u7aef\u53e3\u4fe1\u606f\u5b57\u5178\uff0c\u5931\u8d25\u65f6\u8fd4\u56deNone\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/serial_application_service.py</code> <pre><code>def get_port_info(self, port_name: str) -&gt; Optional[Dict[str, str]]:\n    \"\"\"\u83b7\u53d6\u6307\u5b9a\u7aef\u53e3\u4fe1\u606f\u3002\n\n    Args:\n        port_name (str): \u7aef\u53e3\u540d\u79f0\u3002\n\n    Returns:\n        Optional[Dict[str, str]]: \u7aef\u53e3\u4fe1\u606f\u5b57\u5178\uff0c\u5931\u8d25\u65f6\u8fd4\u56deNone\u3002\n    \"\"\"\n    try:\n        return self.serial_domain_service.get_port_info(port_name)\n    except Exception as e:\n        self._display_message(f\"\u83b7\u53d6\u7aef\u53e3\u4fe1\u606f\u5931\u8d25: {str(e)}\", \"\u9519\u8bef\")\n        return None\n</code></pre>"},{"location":"api/application/services/serial/#controller.application.services.serial_application_service.SerialApplicationService.get_available_ports","title":"get_available_ports","text":"<pre><code>get_available_ports() -&gt; List[str]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u53ef\u7528\u7aef\u53e3\u5217\u8868\uff08\u4e0d\u5237\u65b0\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>List[str]: \u53ef\u7528\u7aef\u53e3\u540d\u79f0\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/serial_application_service.py</code> <pre><code>def get_available_ports(self) -&gt; List[str]:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u53ef\u7528\u7aef\u53e3\u5217\u8868\uff08\u4e0d\u5237\u65b0\uff09\u3002\n\n    Returns:\n        List[str]: \u53ef\u7528\u7aef\u53e3\u540d\u79f0\u5217\u8868\u3002\n    \"\"\"\n    try:\n        return self.serial_domain_service.scan_available_ports()\n    except Exception as e:\n        self._display_message(f\"\u83b7\u53d6\u7aef\u53e3\u5217\u8868\u5931\u8d25: {str(e)}\", \"\u9519\u8bef\")\n        return []\n</code></pre>"},{"location":"api/application/services/serial/#controller.application.services.serial_application_service.SerialApplicationService.get_current_port","title":"get_current_port","text":"<pre><code>get_current_port() -&gt; Optional[str]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u7684\u7aef\u53e3\u540d\u79f0\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[str]</code> <p>Optional[str]: \u7aef\u53e3\u540d\u79f0\uff0c\u672a\u8fde\u63a5\u65f6\u8fd4\u56deNone\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/serial_application_service.py</code> <pre><code>def get_current_port(self) -&gt; Optional[str]:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u7684\u7aef\u53e3\u540d\u79f0\u3002\n\n    Returns:\n        Optional[str]: \u7aef\u53e3\u540d\u79f0\uff0c\u672a\u8fde\u63a5\u65f6\u8fd4\u56deNone\u3002\n    \"\"\"\n    return self.serial_domain_service.get_current_port()\n</code></pre>"},{"location":"api/application/services/serial/#controller.application.services.serial_application_service.SerialApplicationService.connect_serial","title":"connect_serial","text":"<pre><code>connect_serial(port: str, config: Dict[str, Any]) -&gt; bool\n</code></pre> <p>\u8fde\u63a5\u4e32\u53e3\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>port</code> <code>str</code> <p>\u4e32\u53e3\u540d\u79f0\u3002</p> \u5fc5\u9700 <code>config</code> <code>Dict[str, Any]</code> <p>\u4e32\u53e3\u914d\u7f6e\u53c2\u6570\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u8fde\u63a5\u662f\u5426\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/serial_application_service.py</code> <pre><code>def connect_serial(self, port: str, config: Dict[str, Any]) -&gt; bool:\n    \"\"\"\u8fde\u63a5\u4e32\u53e3\u3002\n\n    Args:\n        port (str): \u4e32\u53e3\u540d\u79f0\u3002\n        config (Dict[str, Any]): \u4e32\u53e3\u914d\u7f6e\u53c2\u6570\u3002\n\n    Returns:\n        bool: \u8fde\u63a5\u662f\u5426\u6210\u529f\u3002\n    \"\"\"\n    self._display_message(f\"\u8fde\u63a5\u4e32\u53e3: {port}, \u914d\u7f6e: {config}\", \"\u7cfb\u7edf\")\n    try:\n        success = self.serial_domain_service.connect_port(port, config)\n        if success:\n            self._display_message(f\"\u6210\u529f\u8fde\u63a5\u5230\u7aef\u53e3 {port}\", \"\u7cfb\u7edf\")\n        return success\n    except Exception as e:\n        self._display_message(f\"\u8fde\u63a5\u5931\u8d25: {str(e)}\", \"\u9519\u8bef\")\n        return False\n</code></pre>"},{"location":"api/application/services/serial/#controller.application.services.serial_application_service.SerialApplicationService.disconnect_serial","title":"disconnect_serial","text":"<pre><code>disconnect_serial() -&gt; bool\n</code></pre> <p>\u65ad\u5f00\u4e32\u53e3\u8fde\u63a5\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u65ad\u5f00\u662f\u5426\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/serial_application_service.py</code> <pre><code>def disconnect_serial(self) -&gt; bool:\n    \"\"\"\u65ad\u5f00\u4e32\u53e3\u8fde\u63a5\u3002\n\n    Returns:\n        bool: \u65ad\u5f00\u662f\u5426\u6210\u529f\u3002\n    \"\"\"\n    try:\n        success = self.serial_domain_service.disconnect_port()\n        if success:\n            self._display_message(\"\u5df2\u65ad\u5f00\u4e32\u53e3\u8fde\u63a5\", \"\u7cfb\u7edf\")\n        return success\n    except Exception as e:\n        self._display_message(f\"\u65ad\u5f00\u8fde\u63a5\u5931\u8d25: {str(e)}\", \"\u9519\u8bef\")\n        return False\n</code></pre>"},{"location":"api/application/services/serial/#controller.application.services.serial_application_service.SerialApplicationService.is_connected","title":"is_connected","text":"<pre><code>is_connected() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u4e32\u53e3\u662f\u5426\u5df2\u8fde\u63a5\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u5df2\u8fde\u63a5\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/serial_application_service.py</code> <pre><code>def is_connected(self) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u4e32\u53e3\u662f\u5426\u5df2\u8fde\u63a5\u3002\n\n    Returns:\n        bool: \u662f\u5426\u5df2\u8fde\u63a5\u3002\n    \"\"\"\n    return self.serial_domain_service.is_connected()\n</code></pre>"},{"location":"api/application/services/serial/#controller.application.services.serial_application_service.SerialApplicationService.cleanup","title":"cleanup","text":"<pre><code>cleanup() -&gt; None\n</code></pre> <p>\u6e05\u7406\u8d44\u6e90\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/serial_application_service.py</code> <pre><code>def cleanup(self) -&gt; None:\n    \"\"\"\u6e05\u7406\u8d44\u6e90\u3002\"\"\"\n    try:\n        self._disconnect_domain_signals()\n        self.serial_domain_service.cleanup()\n    except Exception:\n        pass  # \u5ffd\u7565\u6e05\u7406\u65f6\u7684\u5f02\u5e38 \n</code></pre>"},{"location":"api/application/services/tools/","title":"Tools Application Service","text":""},{"location":"api/application/services/tools/#controller.application.services.tools_application_service","title":"controller.application.services.tools_application_service","text":"<p>\u5de5\u5177\u5e94\u7528\u670d\u52a1</p>"},{"location":"api/application/services/tools/#controller.application.services.tools_application_service.ToolsApplicationService","title":"ToolsApplicationService","text":"<pre><code>ToolsApplicationService(kinematic_service: KinematicDomainService, robot_state_service: RobotStateDomainService)\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u5de5\u5177\u5e94\u7528\u670d\u52a1\u3002</p> <p>\u804c\u8d23\uff1a 1. \u63a5\u6536 6 \u4e2a\u5173\u8282\u89d2\u5ea6 2. \u8c03\u7528 KinematicDomainService \u8ba1\u7b97\u6b63\u8fd0\u52a8\u5b66 3. \u683c\u5f0f\u5316\u7ed3\u679c\u5e76\u53d1\u5c04\u4fe1\u53f7 4. \u83b7\u53d6\u5f53\u524d\u673a\u68b0\u81c2\u5173\u8282\u89d2\u5ea6 5. \u8ba1\u7b97\u9006\u8fd0\u52a8\u5b66</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>calculation_result_signal</code> <code>pyqtSignal</code> <p>\u53d1\u9001\u6b63\u8fd0\u52a8\u5b66\u8ba1\u7b97\u7ed3\u679c\u3002</p> <code>current_angles_signal</code> <code>pyqtSignal</code> <p>\u53d1\u9001\u5f53\u524d\u5173\u8282\u89d2\u5ea6\u3002</p> <code>inverse_result_signal</code> <code>pyqtSignal</code> <p>\u53d1\u9001\u9006\u8fd0\u52a8\u5b66\u8ba1\u7b97\u7ed3\u679c\u3002</p> <p>\u521d\u59cb\u5316\u5de5\u5177\u5e94\u7528\u670d\u52a1\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>kinematic_service</code> <code>KinematicDomainService</code> <p>\u8fd0\u52a8\u5b66\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>robot_state_service</code> <code>RobotStateDomainService</code> <p>\u673a\u68b0\u81c2\u72b6\u6001\u670d\u52a1\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/tools_application_service.py</code> <pre><code>def __init__(self, kinematic_service: KinematicDomainService, robot_state_service: RobotStateDomainService):\n    \"\"\"\u521d\u59cb\u5316\u5de5\u5177\u5e94\u7528\u670d\u52a1\u3002\n\n    Args:\n        kinematic_service (KinematicDomainService): \u8fd0\u52a8\u5b66\u670d\u52a1\u3002\n        robot_state_service (RobotStateDomainService): \u673a\u68b0\u81c2\u72b6\u6001\u670d\u52a1\u3002\n    \"\"\"\n    super().__init__()\n    self.kinematic_service = kinematic_service\n    self.robot_state_service = robot_state_service\n</code></pre>"},{"location":"api/application/services/tools/#controller.application.services.tools_application_service.ToolsApplicationService.calculate_forward_kinematics","title":"calculate_forward_kinematics","text":"<pre><code>calculate_forward_kinematics(joint_angles: List[float])\n</code></pre> <p>\u8ba1\u7b97\u6b63\u8fd0\u52a8\u5b66\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>joint_angles</code> <code>List[float]</code> <p>6\u4e2a\u5173\u8282\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002</p> \u5fc5\u9700 Emits <p>calculation_result_signal \u5305\u542b\uff1a {     \"quaternion\": [x, y, z, w],     \"position\": [x, y, z],     \"rotation_matrix\": [[...], [...], [...]]  # 3x3 } \u6216\u9519\u8bef\u4fe1\u606f\uff1a {     \"error\": \"\u9519\u8bef\u4fe1\u606f\" }</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/tools_application_service.py</code> <pre><code>def calculate_forward_kinematics(self, joint_angles: List[float]):\n    \"\"\"\u8ba1\u7b97\u6b63\u8fd0\u52a8\u5b66\u3002\n\n    Args:\n        joint_angles (List[float]): 6\u4e2a\u5173\u8282\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002\n\n    Emits:\n        calculation_result_signal \u5305\u542b\uff1a\n        {\n            \"quaternion\": [x, y, z, w],\n            \"position\": [x, y, z],\n            \"rotation_matrix\": [[...], [...], [...]]  # 3x3\n        }\n        \u6216\u9519\u8bef\u4fe1\u606f\uff1a\n        {\n            \"error\": \"\u9519\u8bef\u4fe1\u606f\"\n        }\n    \"\"\"\n    try:\n        # \u83b7\u53d6\u56db\u5143\u6570\u548c\u4f4d\u7f6e\n        quat, pos = self.kinematic_service.get_gripper2base(joint_angles)\n\n        # \u83b7\u53d6\u5b8c\u6574\u53d8\u6362\u77e9\u9635\n        transform_matrix = self.kinematic_service.get_gripper2base_rm(joint_angles)\n        rotation_matrix = transform_matrix[:3, :3]  # \u63d0\u53d6\u65cb\u8f6c\u77e9\u9635\u90e8\u5206\n\n        # \u6784\u5efa\u7ed3\u679c\u5b57\u5178\n        result = {\n            \"quaternion\": quat.tolist(),  # [x, y, z, w]\n            \"position\": pos.tolist(),     # [x, y, z]\n            \"rotation_matrix\": rotation_matrix.tolist()  # 3x3 list\n        }\n\n        # \u53d1\u5c04\u4fe1\u53f7\n        self.calculation_result_signal.emit(result)\n\n    except Exception as e:\n        # \u9519\u8bef\u5904\u7406\n        error_result = {\n            \"error\": f\"\u8ba1\u7b97\u5931\u8d25: {str(e)}\"\n        }\n        self.calculation_result_signal.emit(error_result)\n</code></pre>"},{"location":"api/application/services/tools/#controller.application.services.tools_application_service.ToolsApplicationService.get_current_joint_angles","title":"get_current_joint_angles","text":"<pre><code>get_current_joint_angles()\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u673a\u68b0\u81c2\u5173\u8282\u89d2\u5ea6\u3002</p> Emits <p>current_angles_signal: List[float] - 6\u4e2a\u5173\u8282\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/tools_application_service.py</code> <pre><code>def get_current_joint_angles(self):\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u673a\u68b0\u81c2\u5173\u8282\u89d2\u5ea6\u3002\n\n    Emits:\n        current_angles_signal: List[float] - 6\u4e2a\u5173\u8282\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002\n    \"\"\"\n    try:\n        # \u4ece\u673a\u68b0\u81c2\u72b6\u6001\u670d\u52a1\u83b7\u53d6\u5f53\u524d\u89d2\u5ea6\n        current_angles = self.robot_state_service.get_current_angles()\n        # \u53d1\u5c04\u4fe1\u53f7\n        self.current_angles_signal.emit(current_angles)\n    except Exception as e:\n        # \u5982\u679c\u83b7\u53d6\u5931\u8d25\uff0c\u53d1\u9001\u7a7a\u5217\u8868\n        self.current_angles_signal.emit([0.0] * 6)\n</code></pre>"},{"location":"api/application/services/tools/#controller.application.services.tools_application_service.ToolsApplicationService.calculate_inverse_kinematics","title":"calculate_inverse_kinematics","text":"<pre><code>calculate_inverse_kinematics(rotation_matrix: List[List[float]], position: List[float], initial_theta: List[float] = None)\n</code></pre> <p>\u8ba1\u7b97\u9006\u8fd0\u52a8\u5b66\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>rotation_matrix</code> <code>List[List[float]]</code> <p>3x3 \u65cb\u8f6c\u77e9\u9635\u3002</p> \u5fc5\u9700 <code>position</code> <code>List[float]</code> <p>[x, y, z] \u4f4d\u7f6e\uff08\u7c73\uff09\u3002</p> \u5fc5\u9700 <code>initial_theta</code> <code>List[float]</code> <p>\u521d\u59cb\u5173\u8282\u89d2\u5ea6\uff08\u7528\u4e8e\u9009\u62e9\u6700\u63a5\u8fd1\u7684\u89e3\uff09. Defaults to None.</p> <code>None</code> Emits <p>inverse_result_signal \u5305\u542b\uff1a {     \"joint_angles\": [\u03b81, \u03b82, \u03b83, \u03b84, \u03b85, \u03b86],  # \u5f27\u5ea6     \"joint_angles_deg\": [\u03b81, \u03b82, \u03b83, \u03b84, \u03b85, \u03b86]  # \u5ea6 } \u6216\u9519\u8bef\u4fe1\u606f\uff1a {     \"error\": \"\u9519\u8bef\u4fe1\u606f\" }</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/tools_application_service.py</code> <pre><code>def calculate_inverse_kinematics(self, rotation_matrix: List[List[float]], position: List[float], initial_theta: List[float] = None):\n    \"\"\"\u8ba1\u7b97\u9006\u8fd0\u52a8\u5b66\u3002\n\n    Args:\n        rotation_matrix (List[List[float]]): 3x3 \u65cb\u8f6c\u77e9\u9635\u3002\n        position (List[float]): [x, y, z] \u4f4d\u7f6e\uff08\u7c73\uff09\u3002\n        initial_theta (List[float], optional): \u521d\u59cb\u5173\u8282\u89d2\u5ea6\uff08\u7528\u4e8e\u9009\u62e9\u6700\u63a5\u8fd1\u7684\u89e3\uff09. Defaults to None.\n\n    Emits:\n        inverse_result_signal \u5305\u542b\uff1a\n        {\n            \"joint_angles\": [\u03b81, \u03b82, \u03b83, \u03b84, \u03b85, \u03b86],  # \u5f27\u5ea6\n            \"joint_angles_deg\": [\u03b81, \u03b82, \u03b83, \u03b84, \u03b85, \u03b86]  # \u5ea6\n        }\n        \u6216\u9519\u8bef\u4fe1\u606f\uff1a\n        {\n            \"error\": \"\u9519\u8bef\u4fe1\u606f\"\n        }\n    \"\"\"\n    try:\n        # \u8f6c\u6362\u4e3a numpy \u6570\u7ec4\n        rm = np.array(rotation_matrix)\n        pos = np.array(position)\n\n        # \u5982\u679c\u6ca1\u6709\u63d0\u4f9b\u521d\u59cb\u89d2\u5ea6\uff0c\u4f7f\u7528\u5f53\u524d\u89d2\u5ea6\n        if initial_theta is None:\n            initial_theta = self.robot_state_service.get_current_angles()\n\n        # \u8c03\u7528\u9006\u8fd0\u52a8\u5b66\u6c42\u89e3\n        solution = self.kinematic_service.inverse_kinematic(rm, pos, initial_theta)\n\n        # \u6784\u5efa\u7ed3\u679c\u5b57\u5178\n        result = {\n            \"joint_angles\": solution,  # \u5f27\u5ea6\n            \"joint_angles_deg\": [np.rad2deg(angle) for angle in solution]  # \u5ea6\n        }\n\n        # \u53d1\u5c04\u4fe1\u53f7\n        self.inverse_result_signal.emit(result)\n\n    except Exception as e:\n        # \u9519\u8bef\u5904\u7406\n        error_result = {\n            \"error\": f\"\u9006\u89e3\u8ba1\u7b97\u5931\u8d25: {str(e)}\"\n        }\n        self.inverse_result_signal.emit(error_result)\n</code></pre>"},{"location":"api/domain/algorithm/","title":"Algorithm Domain Services","text":""},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.kinematic_domain_service","title":"controller.domain.services.algorithm.kinematic_domain_service","text":""},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.kinematic_domain_service.KinematicDomainService","title":"KinematicDomainService","text":"<pre><code>KinematicDomainService()\n</code></pre> <p>\u8fd0\u52a8\u5b66\u9886\u57df\u670d\u52a1\u3002</p> <p>\u63d0\u4f9b\u673a\u68b0\u81c2\u6b63\u9006\u8fd0\u52a8\u5b66\u89e3\u7b97\u529f\u80fd\uff0c\u5305\u62ecDH\u53c2\u6570\u7ba1\u7406\u3001\u5750\u6807\u53d8\u6362\u77e9\u9635\u8ba1\u7b97\u7b49\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>dh_param</code> <code>DHParam</code> <p>\u673a\u68b0\u81c2 DH \u53c2\u6570\u5bf9\u8c61\u3002</p> <code>kinematic_dh</code> <code>ndarray</code> <p>\u8fd0\u52a8\u5b66 DH \u53c2\u6570\u77e9\u9635\u3002</p> <code>kinematic_utils</code> <code>KinematicUtils</code> <p>\u8fd0\u52a8\u5b66\u5de5\u5177\u7c7b\u5b9e\u4f8b\u3002</p> <code>gripper2base</code> <code>ndarray</code> <p>\u5f53\u524d\u672b\u7aef\u5230\u57fa\u5ea7\u7684\u53d8\u6362\u77e9\u9635\u3002</p> <p>\u521d\u59cb\u5316\u8fd0\u52a8\u5b66\u670d\u52a1\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/kinematic_domain_service.py</code> <pre><code>def __init__(self):\n    \"\"\"\u521d\u59cb\u5316\u8fd0\u52a8\u5b66\u670d\u52a1\u3002\"\"\"\n    self.dh_param = DHParam()\n    self.kinematic_dh = self.dh_param.get_kinematic_dh()\n    self.kinematic_utils = KinematicUtils()\n    self.gripper2base = self.get_gripper2base(self.kinematic_dh[:, 3])\n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.kinematic_domain_service.KinematicDomainService.get_kinematic_dh","title":"get_kinematic_dh","text":"<pre><code>get_kinematic_dh() -&gt; np.ndarray\n</code></pre> <p>\u83b7\u53d6\u8fd0\u52a8\u5b66 DH \u53c2\u6570\u77e9\u9635\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: DH \u53c2\u6570\u77e9\u9635\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/kinematic_domain_service.py</code> <pre><code>def get_kinematic_dh(self) -&gt; np.ndarray:\n    \"\"\"\u83b7\u53d6\u8fd0\u52a8\u5b66 DH \u53c2\u6570\u77e9\u9635\u3002\n\n    Returns:\n        np.ndarray: DH \u53c2\u6570\u77e9\u9635\u3002\n    \"\"\"\n    return self.kinematic_dh\n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.kinematic_domain_service.KinematicDomainService.get_gripper2base","title":"get_gripper2base","text":"<pre><code>get_gripper2base(theta_list: list[float] | ndarray = None) -&gt; tuple[np.ndarray, np.ndarray]\n</code></pre> <p>\u8ba1\u7b97\u672b\u7aef\u6267\u884c\u5668\u76f8\u5bf9\u4e8e\u57fa\u5ea7\u7684\u4f4d\u59ff\uff08\u56db\u5143\u6570 + \u4f4d\u7f6e\uff09\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>theta_list</code> <code>list[float] | ndarray</code> <p>\u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\u3002\u5982\u679c\u4e0d\u4f20\u5219\u4f7f\u7528\u5f53\u524d\u5185\u90e8\u72b6\u6001\u3002</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>tuple</code> <code>tuple[ndarray, ndarray]</code> <p>(quat, pos) - quat (np.ndarray): \u59ff\u6001\u56db\u5143\u6570 [x, y, z, w]\u3002 - pos (np.ndarray): \u4f4d\u7f6e\u5750\u6807 [x, y, z]\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/kinematic_domain_service.py</code> <pre><code>def get_gripper2base(self, theta_list: list[float] | np.ndarray = None) -&gt; tuple[np.ndarray, np.ndarray]:\n    \"\"\"\u8ba1\u7b97\u672b\u7aef\u6267\u884c\u5668\u76f8\u5bf9\u4e8e\u57fa\u5ea7\u7684\u4f4d\u59ff\uff08\u56db\u5143\u6570 + \u4f4d\u7f6e\uff09\u3002\n\n    Args:\n        theta_list (list[float] | np.ndarray, optional): \u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\u3002\u5982\u679c\u4e0d\u4f20\u5219\u4f7f\u7528\u5f53\u524d\u5185\u90e8\u72b6\u6001\u3002\n\n    Returns:\n        tuple: (quat, pos)\n            - quat (np.ndarray): \u59ff\u6001\u56db\u5143\u6570 [x, y, z, w]\u3002\n            - pos (np.ndarray): \u4f4d\u7f6e\u5750\u6807 [x, y, z]\u3002\n    \"\"\"\n    if theta_list is not None:\n        self.kinematic_dh[:, 3] = theta_list\n        rm_list = []\n        for dh in self.kinematic_dh:\n            rm_list.append(self.kinematic_utils.dh2rm(*dh))\n        self.gripper2base = reduce(lambda x, y: x @ y, rm_list, np.eye(4))\n    quat = R.from_matrix(self.gripper2base[:3, :3]).as_quat()\n    return quat, self.gripper2base[:3, 3]\n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.kinematic_domain_service.KinematicDomainService.get_gripper2base_rm","title":"get_gripper2base_rm","text":"<pre><code>get_gripper2base_rm(theta_list: list[float]) -&gt; np.ndarray\n</code></pre> <p>\u83b7\u53d6\u672b\u7aef\u6267\u884c\u5668\u76f8\u5bf9\u4e8e\u57fa\u5ea7\u7684\u53d8\u6362\u77e9\u9635\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>theta_list</code> <code>list[float]</code> <p>\u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: 4x4 \u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/kinematic_domain_service.py</code> <pre><code>def get_gripper2base_rm(self, theta_list: list[float]) -&gt; np.ndarray:\n    \"\"\"\u83b7\u53d6\u672b\u7aef\u6267\u884c\u5668\u76f8\u5bf9\u4e8e\u57fa\u5ea7\u7684\u53d8\u6362\u77e9\u9635\u3002\n\n    Args:\n        theta_list (list[float]): \u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\u3002\n\n    Returns:\n        np.ndarray: 4x4 \u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002\n    \"\"\"\n    self.kinematic_dh[:, 3] = theta_list\n    rm_list = []\n    for dh in self.kinematic_dh:\n        rm_list.append(self.kinematic_utils.dh2rm(*dh))\n    self.gripper2base = reduce(lambda x, y: x @ y, rm_list, np.eye(4))\n    return self.gripper2base\n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.kinematic_domain_service.KinematicDomainService.inverse_kinematic","title":"inverse_kinematic","text":"<pre><code>inverse_kinematic(rm: ndarray, pos: ndarray, initial_theta: list[float] | None = None) -&gt; list[float]\n</code></pre> <p>\u673a\u68b0\u81c2\u9006\u8fd0\u52a8\u5b66\u6c42\u89e3\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>rm</code> <code>ndarray</code> <p>\u76ee\u6807\u59ff\u6001\u65cb\u8f6c\u77e9\u9635 (3x3)\u3002</p> \u5fc5\u9700 <code>pos</code> <code>ndarray</code> <p>\u76ee\u6807\u4f4d\u7f6e\u5750\u6807 [x, y, z]\u3002</p> \u5fc5\u9700 <code>initial_theta</code> <code>list[float] | None</code> <p>\u521d\u59cb\u5173\u8282\u89d2\u5ea6\u731c\u6d4b\u503c\uff0c\u7528\u4e8e\u9009\u62e9\u6700\u4f18\u89e3\u3002</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>list[float]</code> <p>list[float]: \u6700\u4f18\u5173\u8282\u89d2\u5ea6\u89e3\uff08\u5f27\u5ea6\uff09\u3002</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ValueError</code> <p>\u5982\u679c\u672a\u627e\u5230\u6709\u6548\u7684\u9006\u8fd0\u52a8\u5b66\u89e3\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/kinematic_domain_service.py</code> <pre><code>def inverse_kinematic(self, rm: np.ndarray, pos: np.ndarray, initial_theta: list[float] | None = None) -&gt; list[float]:\n    \"\"\"\u673a\u68b0\u81c2\u9006\u8fd0\u52a8\u5b66\u6c42\u89e3\u3002\n\n    Args:\n        rm (np.ndarray): \u76ee\u6807\u59ff\u6001\u65cb\u8f6c\u77e9\u9635 (3x3)\u3002\n        pos (np.ndarray): \u76ee\u6807\u4f4d\u7f6e\u5750\u6807 [x, y, z]\u3002\n        initial_theta (list[float] | None, optional): \u521d\u59cb\u5173\u8282\u89d2\u5ea6\u731c\u6d4b\u503c\uff0c\u7528\u4e8e\u9009\u62e9\u6700\u4f18\u89e3\u3002\n\n    Returns:\n        list[float]: \u6700\u4f18\u5173\u8282\u89d2\u5ea6\u89e3\uff08\u5f27\u5ea6\uff09\u3002\n\n    Raises:\n        ValueError: \u5982\u679c\u672a\u627e\u5230\u6709\u6548\u7684\u9006\u8fd0\u52a8\u5b66\u89e3\u3002\n    \"\"\"\n    if not initial_theta:\n        initial_theta = self.kinematic_dh[:, 3]\n    valid_solutions = []\n    # rotation matrix\n    nx, ny, nz = rm[:, 0]\n    ox, oy, oz = rm[:, 1]\n    ax, ay, az = rm[:, 2]\n    px, py, pz = pos\n\n    # DH\u53c2\u6570\n    a3 = 0.425 \n    a4 = 0.401 \n    d4 = 0.0856 \n    d5 = 0.086 \n    d6 = 0.231\n\n    # \u6dfb\u52a0\u5947\u5f02\u6027\u5224\u65ad\n    if abs(ax**2 + ay**2 - d4**2) &lt; 1e-6:\n        return valid_solutions\n\n    # theta1\u8ba1\u7b97\n    m = ay * d6 - py\n    n = ax * d6 - px\n    try:\n        delta = m**2 + n**2 - d4**2\n\n        if delta &lt; 0:\n            return valid_solutions\n\n        theta1_0 = atan2(m, n) - atan2(-d4, sqrt(m**2 + n**2 - d4**2))\n        theta1_1 = atan2(m, n) - atan2(-d4, -sqrt(m**2 + n**2 - d4**2))\n        theta1_candidate = [theta1_0, theta1_1]\n\n    except Exception as e:\n        return valid_solutions\n\n    # theta5\n    for i, theta1 in enumerate(theta1_candidate):\n        s1 = sin(theta1)\n        c1 = cos(theta1)\n        # \u4fee\u6539theta5\u7684\u8ba1\u7b97\u65b9\u5f0f\n        cos_theta5 = -s1 * ax + c1 * ay\n        if abs(cos_theta5) &gt; 1:\n            cos_theta5 = 1 if cos_theta5 &gt; 0 else -1\n\n        theta5_val = acos(cos_theta5)\n        theta5_candidate = [theta5_val, -theta5_val]\n\n        for j, theta5 in enumerate(theta5_candidate):\n            s5 = sin(theta5)\n            c5 = cos(theta5)\n\n            # theta6\n            if abs(s5) &lt; 1e-6:\n                # \u8155\u90e8\u5947\u5f02\u6027\n                theta6 = initial_theta[5]\n            else:\n                m1 = -s1 * nx + c1 * ny\n                n1 = -s1 * ox + c1 * oy\n                theta6 = atan2(-n1 / s5, m1 / s5)\n\n            # theta3\n            s6 = sin(theta6)\n            c6 = cos(theta6)\n            m2 = d5 * (s6 * (nx * c1 + ny * s1) + c6 * (ox * c1 + oy * s1)) - d6 * (ax * c1 + ay * s1) + px * c1 + py * s1\n            n2 = d5 * (oz * c6 + nz * s6) + pz - az * d6\n\n            # \u8ba1\u7b97\u5230\u5173\u82823\u7684\u8ddd\u79bb\n            r = sqrt(m2**2 + n2**2)\n\n            if r &gt; (a3 + a4) * 1.2 or r &lt; abs(a3 - a4) * 0.8:  # \u8fdb\u4e00\u6b65\u653e\u5bbd\u5de5\u4f5c\u7a7a\u95f4\u9650\u5236\n                continue\n            temp = (m2**2 + n2**2 - a3**2 - a4**2) / (2 * a3 * a4)\n            if abs(temp) &gt; 1:\n                temp = 1 if temp &gt; 0 else -1\n            theta3_candidate = [acos(temp), -acos(temp)]\n\n            for k, theta3 in enumerate(theta3_candidate):\n                # theta2\n                s3 = sin(theta3)\n                c3 = cos(theta3)\n                # \u4fee\u6539theta2\u7684\u8ba1\u7b97\u65b9\u5f0f\n                k1 = a3 + a4 * c3\n                k2 = a4 * s3\n                s2 = (k1 * n2 - k2 * m2) / (k1**2 + k2**2)\n                c2 = (k1 * m2 + k2 * n2) / (k1**2 + k2**2)\n                theta2 = -atan2(s2, c2)\n\n                # theta4\n                if abs(s5) &lt; 1e-6:\n                    # \u5728\u8155\u90e8\u5947\u5f02\u6027\u65f6\uff0c\u4f7f\u7528\u66f4\u7a33\u5b9a\u7684\u8ba1\u7b97\u65b9\u5f0f\n                    if initial_theta is not None:\n                        theta4_candidate = [initial_theta[3]]\n                    else:\n                        theta4_candidate = [initial_theta[3]]\n                else:\n                    T01 = self.kinematic_utils.dh2rm(self.kinematic_dh[0, 0], self.kinematic_dh[0, 1], self.kinematic_dh[0, 2], theta1)\n                    T12 = self.kinematic_utils.dh2rm(self.kinematic_dh[1, 0], self.kinematic_dh[1, 1], self.kinematic_dh[1, 2], theta2)\n                    T23 = self.kinematic_utils.dh2rm(self.kinematic_dh[2, 0], self.kinematic_dh[2, 1], self.kinematic_dh[2, 2], theta3)\n                    R03 = (T01 @ T12 @ T23)[:3, :3]\n                    R36 = R03.T @ rm\n                    theta4 = atan2(R36[1, 2], R36[0, 2])\n                    theta4_candidate = [-theta4, pi - theta4]\n                for theta4 in theta4_candidate:\n                    candidate = [theta1, theta2, theta3, theta4, theta5, theta6]\n                    if self.verify_solution(candidate, (px, py, pz)):\n                        valid_solutions.append(candidate)\n\n    if not valid_solutions:\n        raise ValueError(\"No valid solutions found\")\n    valid_solutions = [\n        [self.kinematic_utils.normalize_angle(a) for a in sol] for sol in valid_solutions\n    ]\n\n    norm_initial_theta = [self.kinematic_utils.normalize_angle(a) for a in initial_theta]\n    final_solution = min(valid_solutions, key=lambda sol: np.linalg.norm(np.array(sol) - np.array(norm_initial_theta)))\n\n    gap = [n - i for n, i in zip(norm_initial_theta, initial_theta)]\n    final_solution = [f - g for f, g in zip(final_solution, gap)]\n\n    return final_solution\n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.kinematic_domain_service.KinematicDomainService.verify_solution","title":"verify_solution","text":"<pre><code>verify_solution(theta_list: list[float], target_pos: ndarray) -&gt; bool\n</code></pre> <p>\u9a8c\u8bc1\u9006\u8fd0\u52a8\u5b66\u89e3\u7684\u51c6\u786e\u6027\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>theta_list</code> <code>list[float]</code> <p>\u5f85\u9a8c\u8bc1\u7684\u5173\u8282\u89d2\u5ea6\u89e3\u3002</p> \u5fc5\u9700 <code>target_pos</code> <code>ndarray</code> <p>\u76ee\u6807\u4f4d\u7f6e\u5750\u6807\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u5982\u679c\u6b63\u89e3\u4f4d\u7f6e\u4e0e\u76ee\u6807\u4f4d\u7f6e\u8bef\u5dee\u5c0f\u4e8e 1e-5 \u5219\u8fd4\u56de True\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/kinematic_domain_service.py</code> <pre><code>def verify_solution(self, theta_list: list[float], target_pos: np.ndarray) -&gt; bool:\n    \"\"\"\u9a8c\u8bc1\u9006\u8fd0\u52a8\u5b66\u89e3\u7684\u51c6\u786e\u6027\u3002\n\n    Args:\n        theta_list (list[float]): \u5f85\u9a8c\u8bc1\u7684\u5173\u8282\u89d2\u5ea6\u89e3\u3002\n        target_pos (np.ndarray): \u76ee\u6807\u4f4d\u7f6e\u5750\u6807\u3002\n\n    Returns:\n        bool: \u5982\u679c\u6b63\u89e3\u4f4d\u7f6e\u4e0e\u76ee\u6807\u4f4d\u7f6e\u8bef\u5dee\u5c0f\u4e8e 1e-5 \u5219\u8fd4\u56de True\u3002\n    \"\"\"\n    self.get_gripper2base(theta_list)\n    current_pos = self.gripper2base[:3, 3]\n    error = np.linalg.norm(current_pos - target_pos)\n\n    return error &lt; 1e-5 \n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.trajectory_domain_service","title":"controller.domain.services.algorithm.trajectory_domain_service","text":""},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.trajectory_domain_service.SCurve","title":"SCurve","text":"<pre><code>SCurve(v_max=[pi / 4] * 6, acc_max=[pi / 8] * 6, t_j=0.5)\n</code></pre> <p>S\u66f2\u7ebf\u901f\u5ea6\u89c4\u5212\u7b97\u6cd5\u3002</p> <p>\u5b9e\u73b0\u57fa\u4e8e\u52a0\u52a0\u901f\u5ea6(Jerk)\u9650\u5236\u7684S\u578b\u901f\u5ea6\u66f2\u7ebf\u89c4\u5212\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>v_max</code> <code>ndarray</code> <p>\u6700\u5927\u901f\u5ea6\u9650\u5236\u3002</p> <code>acc_max</code> <code>ndarray</code> <p>\u6700\u5927\u52a0\u901f\u5ea6\u9650\u5236\u3002</p> <code>t_j</code> <code>float</code> <p>\u52a0\u52a0\u51cf\u901f\u6bb5\u65f6\u95f4\u3002</p> <p>\u521d\u59cb\u5316 S \u66f2\u7ebf\u89c4\u5212\u5668\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>v_max</code> <code>list[float]</code> <p>\u6700\u5927\u901f\u5ea6. Defaults to [pi/4]*6.</p> <code>[pi / 4] * 6</code> <code>acc_max</code> <code>list[float]</code> <p>\u6700\u5927\u52a0\u901f\u5ea6. Defaults to [pi/8]*6.</p> <code>[pi / 8] * 6</code> <code>t_j</code> <code>float</code> <p>Jerk \u65f6\u95f4\u53c2\u6570. Defaults to 0.5.</p> <code>0.5</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/trajectory_domain_service.py</code> <pre><code>def __init__(self, v_max=[pi/4] * 6, acc_max=[pi/8] * 6, t_j=0.5):\n    \"\"\"\u521d\u59cb\u5316 S \u66f2\u7ebf\u89c4\u5212\u5668\u3002\n\n    Args:\n        v_max (list[float], optional): \u6700\u5927\u901f\u5ea6. Defaults to [pi/4]*6.\n        acc_max (list[float], optional): \u6700\u5927\u52a0\u901f\u5ea6. Defaults to [pi/8]*6.\n        t_j (float, optional): Jerk \u65f6\u95f4\u53c2\u6570. Defaults to 0.5.\n    \"\"\"\n    self.v_max = np.array(v_max)\n    self.acc_max = np.array(acc_max)\n    self.t_j = t_j\n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.trajectory_domain_service.SCurve.solve_cubic_numeric","title":"solve_cubic_numeric  <code>staticmethod</code>","text":"<pre><code>solve_cubic_numeric(a, b, c, d, tol=1e-08)\n</code></pre> <p>\u6c42\u89e3\u4e09\u6b21\u65b9\u7a0b\u5b9e\u6839\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/trajectory_domain_service.py</code> <pre><code>@staticmethod\ndef solve_cubic_numeric(a, b, c, d, tol = 1e-8):\n    \"\"\"\u6c42\u89e3\u4e09\u6b21\u65b9\u7a0b\u5b9e\u6839\u3002\"\"\"\n    roots = np.roots([a, b, c, d])\n    real_mask = np.isclose(roots.imag, 0, atol=tol)\n    real_roots = roots[real_mask].real\n\n    return real_roots\n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.trajectory_domain_service.SCurve.solve_quadratic","title":"solve_quadratic  <code>staticmethod</code>","text":"<pre><code>solve_quadratic(a, b, c, tol=1e-08)\n</code></pre> <p>\u6c42\u89e3\u4e8c\u6b21\u65b9\u7a0b\u5b9e\u6839\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/trajectory_domain_service.py</code> <pre><code>@staticmethod\ndef solve_quadratic(a, b, c, tol=1e-8):\n    \"\"\"\u6c42\u89e3\u4e8c\u6b21\u65b9\u7a0b\u5b9e\u6839\u3002\"\"\"\n    coeffs = [a, b, c]\n    roots = np.roots(coeffs)\n    real_mask = np.isclose(roots.imag, 0, atol=tol)\n    real_roots = roots[real_mask].real\n\n    return real_roots\n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.trajectory_domain_service.SCurve.base_method","title":"base_method  <code>staticmethod</code>","text":"<pre><code>base_method(t: float, jerk: float, a_start: float, v_start: float, s_start: float) -&gt; tuple[float, float, float]\n</code></pre> <p>\u57fa\u7840\u8fd0\u52a8\u5b66\u65b9\u7a0b\u8ba1\u7b97\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>tuple</code> <code>tuple[float, float, float]</code> <p>(a, v, s) \u5f53\u524d\u65f6\u523b\u7684\u52a0\u901f\u5ea6\u3001\u901f\u5ea6\u3001\u4f4d\u79fb\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/trajectory_domain_service.py</code> <pre><code>@staticmethod\ndef base_method(t: float, jerk: float, a_start: float, v_start: float, s_start: float) -&gt; tuple[float, float, float]:\n    \"\"\"\u57fa\u7840\u8fd0\u52a8\u5b66\u65b9\u7a0b\u8ba1\u7b97\u3002\n\n    Returns:\n        tuple: (a, v, s) \u5f53\u524d\u65f6\u523b\u7684\u52a0\u901f\u5ea6\u3001\u901f\u5ea6\u3001\u4f4d\u79fb\u3002\n    \"\"\"\n    a = jerk * t + a_start\n    v = jerk * t**2 / 2 + a_start * t + v_start\n    s = jerk * t**3 / 6 + a_start * t**2 / 2 + v_start * t + s_start\n    return a, v, s\n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.trajectory_domain_service.SCurve.planning","title":"planning","text":"<pre><code>planning(start_angles: list[float], target_angles: list[float], v_start: list[float] = [0] * 6, dt: float = 0.01) -&gt; tuple[np.ndarray, np.ndarray, np.ndarray, np.ndarray]\n</code></pre> <p>\u89c4\u5212\u4ece\u8d77\u70b9\u5230\u7ec8\u70b9\u7684S\u66f2\u7ebf\u8f68\u8ff9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>start_angles</code> <code>list[float]</code> <p>\u8d77\u70b9\u89d2\u5ea6\u3002</p> \u5fc5\u9700 <code>target_angles</code> <code>list[float]</code> <p>\u7ec8\u70b9\u89d2\u5ea6\u3002</p> \u5fc5\u9700 <code>v_start</code> <code>list[float]</code> <p>\u8d77\u59cb\u901f\u5ea6. Defaults to [0]*6.</p> <code>[0] * 6</code> <code>dt</code> <code>float</code> <p>\u65f6\u95f4\u6b65\u957f. Defaults to 0.01.</p> <code>0.01</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>tuple</code> <code>tuple[ndarray, ndarray, ndarray, ndarray]</code> <p>(times, accelerations, velocities, positions) \u89c4\u5212\u7ed3\u679c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/trajectory_domain_service.py</code> <pre><code>def planning(self, start_angles: list[float], target_angles: list[float], v_start: list[float] = [0] * 6, dt: float = 0.01) -&gt; tuple[np.ndarray, np.ndarray, np.ndarray, np.ndarray]:\n    \"\"\"\u89c4\u5212\u4ece\u8d77\u70b9\u5230\u7ec8\u70b9\u7684S\u66f2\u7ebf\u8f68\u8ff9\u3002\n\n    Args:\n        start_angles (list[float]): \u8d77\u70b9\u89d2\u5ea6\u3002\n        target_angles (list[float]): \u7ec8\u70b9\u89d2\u5ea6\u3002\n        v_start (list[float], optional): \u8d77\u59cb\u901f\u5ea6. Defaults to [0]*6.\n        dt (float, optional): \u65f6\u95f4\u6b65\u957f. Defaults to 0.01.\n\n    Returns:\n        tuple: (times, accelerations, velocities, positions) \u89c4\u5212\u7ed3\u679c\u3002\n    \"\"\"\n    start_angles = np.array(start_angles)\n    target_angles = np.array(target_angles)\n    displacements = target_angles - start_angles\n    abs_displacements = np.abs(displacements)\n    if np.all(abs_displacements &lt; 1e-6):\n        num_samples = 1\n        times = np.array([0.0])\n        velocities = np.zeros((num_samples, 6))\n        accelerations = np.zeros((num_samples, 6))\n        positions = np.copy(start_angles).reshape((num_samples, 6))\n        # \u4fdd\u6301\u4e0e\u5176\u4ed6\u8fd4\u56de\u8def\u5f84\u4e00\u81f4\u7684\u987a\u5e8f\uff1atimes, accelerations, velocities, positions\n        return times, accelerations, velocities, positions\n    max_displacement_idx = np.argmax(abs_displacements)\n    max_displacement = abs_displacements[max_displacement_idx]\n    a_max = self.acc_max[max_displacement_idx]\n    v_max = self.v_max[max_displacement_idx]\n    max_v_start = v_start[max_displacement_idx]\n    jerk = a_max / self.t_j\n    s_1, list_t_1, list_a_1, list_v_1, list_s_1 = self.get_boundary_1(jerk, 0, max_v_start, 0, v_max, a_max)\n    s_2, t_2 = self.get_boundary_2(jerk, 0, max_v_start, 0)\n    if s_1 &lt; max_displacement:\n        t_acc_1, t_acc_2, t_acc_3, t_dec_1, t_dec_2, t_dec_3 = list_t_1\n        a_acc_1, a_acc_2, a_acc_3, a_dec_1, a_dec_2, a_dec_3 = list_a_1\n        v_acc_1, v_acc_2, v_acc_3, v_dec_1, v_dec_2, v_dec_3 = list_v_1\n        s_acc_1, s_acc_2, s_acc_3, s_dec_1, s_dec_2, s_dec_3 = list_s_1\n        s_const = max_displacement - s_1\n        t_const = s_const / v_max\n        target_time = sum(list_t_1) + t_const\n        param_arr = np.array([\n            [0, 0, 0, 0, 0],\n            [t_acc_1, jerk, 0, max_v_start, 0],\n            [t_acc_1 + t_acc_2, 0, a_acc_1, v_acc_1, s_acc_1],\n            [t_acc_1 + t_acc_2 + t_acc_3, -jerk, a_acc_2, v_acc_2, s_acc_2],\n            [t_acc_1 + t_acc_2 + t_acc_3 + t_const, 0, a_acc_3, v_acc_3, s_acc_3],\n            [t_acc_1 + t_acc_2 + t_acc_3 + t_const + t_dec_1, -jerk, a_acc_3, v_acc_3, s_acc_3 + s_const],\n            [t_acc_1 + t_acc_2 + t_acc_3 + t_const + t_dec_1 + t_dec_2, 0, a_dec_1, v_dec_1, s_dec_1 + s_const],\n            [t_acc_1 + t_acc_2 + t_acc_3 + t_const + t_dec_1 + t_dec_2 + t_dec_3, jerk, a_dec_2, v_dec_2, s_dec_2 + s_const],\n        ])\n        times, accelerations, velocities, positions = self.get_result(param_arr, target_time, dt, max_displacement_idx)\n        accelerations, velocities, positions = self.scale_result(accelerations, \n                                                                 velocities,\n                                                                 positions,\n                                                                 max_displacement_idx, \n                                                                 displacements, \n                                                                 abs_displacements,\n                                                                 start_angles, \n                                                                 target_angles)\n        return times, accelerations, velocities, positions\n\n    elif s_2 &gt; max_displacement:\n        t0 = max_v_start / jerk\n        a = 2 * jerk\n        b = jerk * t0 / 2\n        c = 4 * max_v_start - jerk * t0**2 / 2\n        d = -max_displacement\n        t_j = self.solve_cubic_numeric(a, b, c, d)\n        t_j = t_j[(t_j &gt; 0) &amp; (t_j &lt; self.t_j)][0]\n        s_acc_5, list_t_3, list_a_3, list_v_3, list_s_3 = self.get_stage_3(jerk, 0, max_v_start, 0, t_j, t0)\n        t_acc_1, t_acc_2, t_dec_1, t_dec_2, t_dec_3 = list_t_3\n        a_acc_1, a_acc_2, a_dec_1, a_dec_2, a_dec_3 = list_a_3\n        v_acc_1, v_acc_2, v_dec_1, v_dec_2, v_dec_3 = list_v_3\n        s_acc_1, s_acc_2, s_dec_1, s_dec_2, s_dec_3 = list_s_3\n        target_time = sum(list_t_3)\n        param_arr = np.array([\n            [0, 0, 0, 0, 0],\n            [t_acc_1, jerk, 0, max_v_start, 0],\n            [t_acc_1 + t_acc_2, -jerk, a_acc_1, v_acc_1, s_acc_1],\n            [t_acc_1 + t_acc_2 + t_dec_1, -jerk, a_acc_2, v_acc_2, s_acc_2],\n            [t_acc_1 + t_acc_2 + t_dec_1 + t_dec_2, 0, a_dec_1, v_dec_1, s_dec_1],\n            [t_acc_1 + t_acc_2 + t_dec_1 + t_dec_2 + t_dec_3, jerk, a_dec_2, v_dec_2, s_dec_2],\n        ])\n        times, accelerations, velocities, positions = self.get_result(param_arr, target_time, dt, max_displacement_idx)\n        accelerations, velocities, positions = self.scale_result(accelerations, \n                                                                 velocities,\n                                                                 positions,\n                                                                 max_displacement_idx, \n                                                                 displacements, \n                                                                 abs_displacements,\n                                                                 start_angles, \n                                                                 target_angles)\n        return times, accelerations, velocities, positions\n    else:\n        a_acc_1, v_acc_1, s_acc_1 = self.base_method(self.t_j, jerk, 0, max_v_start, 0)\n        t0 = max_v_start / a_acc_1\n        s_t0 = a_max * t0**2 / 2 + jerk * self.t_j ** 2 * t0 / 2\n        s_dec_3 = jerk * self.t_j ** 3 / 6\n        delta_s = max_displacement - s_t0 - s_dec_3 - s_acc_1\n        a = a_max / 2\n        b = 3 / 2 * a_max * self.t_j + max_v_start\n        c = 5 / 6 * a_max * self.t_j ** 2 + max_v_start * self.t_j - delta_s / 2 \n        t_k = self.solve_quadratic(a, b, c)\n        t_k = t_k[(4 * self.t_j + 2 * t_k + t0 &gt; t_2) &amp; (4 * self.t_j + 2 * t_k + t0 &lt; sum(list_t_1))][0]\n        s_dec_4, list_t_2, list_a_2, list_v_2, list_s_2 = self.get_stage_2(jerk, 0, max_v_start, 0, t_k, t0)\n        t_acc_1, t_acc_2, t_acc_3, t_dec_1, t_dec_2, t_dec_3, t_dec_4 = list_t_2\n        a_acc_1, a_acc_2, a_acc_3, a_dec_1, a_dec_2, a_dec_3, a_dec_4 = list_a_2\n        v_acc_1, v_acc_2, v_acc_3, v_dec_1, v_dec_2, v_dec_3, v_dec_4 = list_v_2\n        s_acc_1, s_acc_2, s_acc_3, s_dec_1, s_dec_2, s_dec_3, s_dec_4 = list_s_2\n\n        target_time = sum(list_t_2)\n        param_arr = np.array([\n            [0, 0, 0, 0, 0],\n            [t_acc_1, jerk, 0, max_v_start, 0],\n            [t_acc_1 + t_acc_2, 0, a_acc_1, v_acc_1, s_acc_1],\n            [t_acc_1 + t_acc_2 + t_acc_3, -jerk, a_acc_2, v_acc_2, s_acc_2],\n            [t_acc_1 + t_acc_2 + t_acc_3 + t_dec_1, -jerk, a_acc_3, v_acc_3, s_acc_3],\n            [t_acc_1 + t_acc_2 + t_acc_3 + t_dec_1 + t_dec_2, 0, a_dec_1, v_dec_1, s_dec_1],\n            [t_acc_1 + t_acc_2 + t_acc_3 + t_dec_1 + t_dec_2 + t_dec_3, 0, a_dec_2, v_dec_2, s_dec_2],\n            [t_acc_1 + t_acc_2 + t_acc_3 + t_dec_1 + t_dec_2 + t_dec_3 + t_dec_4, jerk, a_dec_3, v_dec_3, s_dec_3],\n        ])\n        times, accelerations, velocities, positions = self.get_result(param_arr, target_time, dt, max_displacement_idx)\n        accelerations, velocities, positions = self.scale_result(accelerations, \n                                                        velocities,\n                                                        positions,\n                                                        max_displacement_idx, \n                                                        displacements, \n                                                        abs_displacements,\n                                                        start_angles, \n                                                        target_angles)\n        return times, accelerations, velocities, positions\n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.curve_motion","title":"controller.domain.services.algorithm.curve_motion","text":""},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.curve_motion.CurveMotionDomainService","title":"CurveMotionDomainService","text":"<pre><code>CurveMotionDomainService(kinematic_solver: KinematicDomainService, v_max=[pi / 4] * 6, a_max=[pi / 8] * 6, j_max=[pi / 16] * 6, dt=0.01)\n</code></pre> <p>\u66f2\u7ebf\u8fd0\u52a8\u89c4\u5212\u670d\u52a1\u3002</p> <p>\u63d0\u4f9b\u57fa\u4e8e\u5f27\u957f\u53c2\u6570\u5316\u7684\u7a7a\u95f4\u66f2\u7ebf\u89c4\u5212\u3001\u59ff\u6001\u5e73\u6ed1\u63d2\u503c\u4ee5\u53ca\u57fa\u4e8e TOPPRA \u7684\u65f6\u95f4\u53c2\u6570\u5316\u529f\u80fd\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>v_max</code> <code>ndarray</code> <p>\u5404\u5173\u8282\u6700\u5927\u901f\u5ea6 (rad/s)\u3002</p> <code>a_max</code> <code>ndarray</code> <p>\u5404\u5173\u8282\u6700\u5927\u52a0\u901f\u5ea6 (rad/s\u00b2)\u3002</p> <code>j_max</code> <code>ndarray</code> <p>\u5404\u5173\u8282\u6700\u5927\u52a0\u52a0\u901f\u5ea6 (rad/s\u00b3)\u3002</p> <code>dt</code> <code>float</code> <p>\u65f6\u95f4\u6b65\u957f (s)\u3002</p> <code>kinematic_solver</code> <code>KinematicDomainService</code> <p>\u8fd0\u52a8\u5b66\u6c42\u89e3\u5668\u5b9e\u4f8b\u3002</p> <p>\u521d\u59cb\u5316\u66f2\u7ebf\u8fd0\u52a8\u670d\u52a1\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>kinematic_solver</code> <code>KinematicDomainService</code> <p>\u8fd0\u52a8\u5b66\u6c42\u89e3\u5668\u670d\u52a1\u5b9e\u4f8b\u3002</p> \u5fc5\u9700 <code>v_max</code> <code>list[float]</code> <p>\u6700\u5927\u901f\u5ea6\u5217\u8868. Defaults to [pi/4]*6.</p> <code>[pi / 4] * 6</code> <code>a_max</code> <code>list[float]</code> <p>\u6700\u5927\u52a0\u901f\u5ea6\u5217\u8868. Defaults to [pi/8]*6.</p> <code>[pi / 8] * 6</code> <code>j_max</code> <code>list[float]</code> <p>\u6700\u5927\u52a0\u52a0\u901f\u5ea6\u5217\u8868. Defaults to [pi/16]*6.</p> <code>[pi / 16] * 6</code> <code>dt</code> <code>float</code> <p>\u91c7\u6837\u65f6\u95f4\u6b65\u957f. Defaults to 0.01.</p> <code>0.01</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code> <pre><code>def __init__(\n    self, \n    kinematic_solver: KinematicDomainService,\n    v_max=[pi / 4] * 6, \n    a_max=[pi / 8] * 6, \n    j_max=[pi / 16] * 6, \n    dt=0.01,\n):\n    \"\"\"\u521d\u59cb\u5316\u66f2\u7ebf\u8fd0\u52a8\u670d\u52a1\u3002\n\n    Args:\n        kinematic_solver: \u8fd0\u52a8\u5b66\u6c42\u89e3\u5668\u670d\u52a1\u5b9e\u4f8b\u3002\n        v_max (list[float], optional): \u6700\u5927\u901f\u5ea6\u5217\u8868. Defaults to [pi/4]*6.\n        a_max (list[float], optional): \u6700\u5927\u52a0\u901f\u5ea6\u5217\u8868. Defaults to [pi/8]*6.\n        j_max (list[float], optional): \u6700\u5927\u52a0\u52a0\u901f\u5ea6\u5217\u8868. Defaults to [pi/16]*6.\n        dt (float, optional): \u91c7\u6837\u65f6\u95f4\u6b65\u957f. Defaults to 0.01.\n    \"\"\"\n    self.v_max = np.asarray(v_max, dtype=float)\n    self.a_max = np.asarray(a_max, dtype=float)\n    self.j_max = np.asarray(j_max, dtype=float)\n    self.dt = float(dt)\n    self.kinematic_solver = kinematic_solver\n    self.nearest_position = None\n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.curve_motion.CurveMotionDomainService.clamp","title":"clamp","text":"<pre><code>clamp(x, low, high)\n</code></pre> <p>\u5c06\u503c x \u9650\u5236\u5728 [low, high] \u533a\u95f4\u5185\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code> <pre><code>def clamp(self, x, low, high):\n    \"\"\"\u5c06\u503c x \u9650\u5236\u5728 [low, high] \u533a\u95f4\u5185\u3002\"\"\"\n    return max(low, min(x, high))\n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.curve_motion.CurveMotionDomainService.curve_motion","title":"curve_motion","text":"<pre><code>curve_motion(pos_fun, u0: float, u1: float, start_position: list[float], end_position: list[float] | None, ds: float = 0.002, include_end: bool = True, orientation_mode: str = 'slerp', tool_axis: str = 'z', up_hint: ndarray = np.array([0, 0, 1.0])) -&gt; tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]\n</code></pre> <p>\u6267\u884c\u66f2\u7ebf\u8fd0\u52a8\u89c4\u5212\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>pos_fun</code> <code>callable</code> <p>\u4f4d\u7f6e\u51fd\u6570\uff0c\u63a5\u53d7\u53c2\u6570 u \u8fd4\u56de (3,) \u5750\u6807\u3002</p> \u5fc5\u9700 <code>u0</code> <code>float</code> <p>\u53c2\u6570\u8d77\u59cb\u503c\u3002</p> \u5fc5\u9700 <code>u1</code> <code>float</code> <p>\u53c2\u6570\u7ec8\u6b62\u503c\u3002</p> \u5fc5\u9700 <code>start_position</code> <code>list[float]</code> <p>\u8d77\u70b9\u5173\u8282\u89d2\u5ea6\u3002</p> \u5fc5\u9700 <code>end_position</code> <code>list[float] | None</code> <p>\u7ec8\u70b9\u5173\u8282\u89d2\u5ea6\u3002</p> \u5fc5\u9700 <code>ds</code> <code>float</code> <p>\u91c7\u6837\u5f27\u957f\u6b65\u957f. Defaults to 0.002.</p> <code>0.002</code> <code>include_end</code> <code>bool</code> <p>\u662f\u5426\u5305\u542b\u7ec8\u70b9. Defaults to True.</p> <code>True</code> <code>orientation_mode</code> <code>str</code> <p>\u59ff\u6001\u63d2\u503c\u6a21\u5f0f ('fixed'|'slerp'|'tangent'). Defaults to \"slerp\".</p> <code>'slerp'</code> <code>tool_axis</code> <code>str</code> <p>\u5de5\u5177\u8f74\u65b9\u5411 ('x'|'y'|'z'). Defaults to \"z\".</p> <code>'z'</code> <code>up_hint</code> <code>ndarray</code> <p>\u5411\u4e0a\u5411\u91cf\u63d0\u793a\uff0c\u7528\u4e8e\u5207\u5411\u8ddf\u968f\u6a21\u5f0f. Defaults to [0, 0, 1.0].</p> <code>array([0, 0, 1.0])</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>tuple</code> <code>tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]</code> <p>(t_list, positions, qd, qdd) - t_list: \u65f6\u95f4\u6233\u5217\u8868 - positions: \u5173\u8282\u89d2\u5ea6\u8f68\u8ff9\u5217\u8868 - qd: \u5173\u8282\u901f\u5ea6\u8f68\u8ff9\u5217\u8868 - qdd: \u5173\u8282\u52a0\u901f\u5ea6\u8f68\u8ff9\u5217\u8868</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ValueError</code> <p>\u5982\u679c orientation_mode \u65e0\u6548\u6216 slerp \u6a21\u5f0f\u4e0b\u672a\u63d0\u4f9b end_position\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code> <pre><code>def curve_motion(\n        self,\n        pos_fun,  # callable u -&gt; (3,)\n        u0: float,\n        u1: float,\n        start_position: list[float],\n        end_position: list[float] | None,\n        ds: float = 0.002,\n        include_end: bool = True,\n        orientation_mode: str = \"slerp\",\n        tool_axis: str = \"z\",\n        up_hint: np.ndarray = np.array([0, 0, 1.0])\n) -&gt; tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]:\n    \"\"\"\u6267\u884c\u66f2\u7ebf\u8fd0\u52a8\u89c4\u5212\u3002\n\n    Args:\n        pos_fun (callable): \u4f4d\u7f6e\u51fd\u6570\uff0c\u63a5\u53d7\u53c2\u6570 u \u8fd4\u56de (3,) \u5750\u6807\u3002\n        u0 (float): \u53c2\u6570\u8d77\u59cb\u503c\u3002\n        u1 (float): \u53c2\u6570\u7ec8\u6b62\u503c\u3002\n        start_position (list[float]): \u8d77\u70b9\u5173\u8282\u89d2\u5ea6\u3002\n        end_position (list[float] | None): \u7ec8\u70b9\u5173\u8282\u89d2\u5ea6\u3002\n        ds (float, optional): \u91c7\u6837\u5f27\u957f\u6b65\u957f. Defaults to 0.002.\n        include_end (bool, optional): \u662f\u5426\u5305\u542b\u7ec8\u70b9. Defaults to True.\n        orientation_mode (str, optional): \u59ff\u6001\u63d2\u503c\u6a21\u5f0f ('fixed'|'slerp'|'tangent'). Defaults to \"slerp\".\n        tool_axis (str, optional): \u5de5\u5177\u8f74\u65b9\u5411 ('x'|'y'|'z'). Defaults to \"z\".\n        up_hint (np.ndarray, optional): \u5411\u4e0a\u5411\u91cf\u63d0\u793a\uff0c\u7528\u4e8e\u5207\u5411\u8ddf\u968f\u6a21\u5f0f. Defaults to [0, 0, 1.0].\n\n    Returns:\n        tuple: (t_list, positions, qd, qdd)\n            - t_list: \u65f6\u95f4\u6233\u5217\u8868\n            - positions: \u5173\u8282\u89d2\u5ea6\u8f68\u8ff9\u5217\u8868\n            - qd: \u5173\u8282\u901f\u5ea6\u8f68\u8ff9\u5217\u8868\n            - qdd: \u5173\u8282\u52a0\u901f\u5ea6\u8f68\u8ff9\u5217\u8868\n\n    Raises:\n        ValueError: \u5982\u679c orientation_mode \u65e0\u6548\u6216 slerp \u6a21\u5f0f\u4e0b\u672a\u63d0\u4f9b end_position\u3002\n    \"\"\"\n    # \u8d77\u70b9\u59ff\u6001\u6765\u81ea\u8d77\u70b9\u5173\u8282\u89d2\u7684\u6b63\u89e3\n    start_quat, start_pos_fk = self.kinematic_solver.get_gripper2base(start_position)\n    # 1) \u7b49\u5f27\u957f\u91c7\u6837\n    pos_list, u_eq, n_seg = self.sample_parametric_equal_arclen(pos_fun, u0, u1, ds, include_end)\n\n    # 2) \u59ff\u6001\u751f\u6210\n    if orientation_mode == \"fixed\":\n        quat_list = np.repeat(self._q_normalize(start_quat)[None, :], len(pos_list), axis=0)\n\n    elif orientation_mode == \"slerp\":\n        if end_position is None:\n            raise ValueError(\"slerp \u6a21\u5f0f\u9700\u8981\u63d0\u4f9b end_position \u4ee5\u786e\u5b9a\u7ec8\u6b62\u59ff\u6001\u3002\")\n        end_quat, _ = self.kinematic_solver.get_gripper2base(end_position)\n        q0 = self._q_normalize(start_quat)\n        q1 = self._q_normalize(end_quat)\n        tau = np.linspace(0, 1, len(pos_list))\n        quat_list = np.vstack([self._q_slerp(q0, q1, ti) for ti in tau])\n\n    elif orientation_mode == \"tangent\":\n        quat_list = self._quat_follow_tangent(pos_list, tool_axis=tool_axis, up_hint=up_hint)\n    else:\n        raise ValueError(\"orientation_mode \u5fc5\u987b\u662f {'fixed','slerp','tangent'}\")\n\n    # 3) \u539f\u6709\u5e73\u6ed1/IK/TOPPRA \u7ba1\u7ebf\u590d\u7528\n    t_list, positions, qd, qdd = self.smooth(quat_list, pos_list, n_seg)\n    return t_list, positions, qd, qdd\n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.curve_motion.CurveMotionDomainService.make_pos_fun_spline","title":"make_pos_fun_spline","text":"<pre><code>make_pos_fun_spline(start_position: list[float], end_position: list[float], mid_points: list, bc_type: str = 'natural') -&gt; tuple[callable, np.ndarray]\n</code></pre> <p>\u6784\u9020\u57fa\u4e8e\u4e09\u6b21\u6837\u6761\u7684\u4f4d\u7f6e\u51fd\u6570\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>start_position</code> <code>list[float]</code> <p>\u8d77\u70b9\u5173\u8282\u89d2\u5ea6\u3002</p> \u5fc5\u9700 <code>end_position</code> <code>list[float]</code> <p>\u7ec8\u70b9\u5173\u8282\u89d2\u5ea6\u3002</p> \u5fc5\u9700 <code>mid_points</code> <code>list</code> <p>\u4e2d\u95f4\u70b9\u5750\u6807\u5217\u8868 (N, 3)\u3002</p> \u5fc5\u9700 <code>bc_type</code> <code>str</code> <p>\u8fb9\u754c\u6761\u4ef6\u7c7b\u578b. Defaults to \"natural\".</p> <code>'natural'</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>tuple</code> <code>tuple[callable, ndarray]</code> <p>(pos_fun, s) - pos_fun: \u4f4d\u7f6e\u51fd\u6570 callable - s: \u7d2f\u79ef\u5f26\u957f\u6570\u7ec4</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ValueError</code> <p>\u5982\u679c\u70b9\u96c6\u5f62\u72b6\u4e0d\u6b63\u786e\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code> <pre><code>def make_pos_fun_spline(\n    self, \n    start_position: list[float],\n    end_position: list[float],\n    mid_points: list, \n    bc_type: str = \"natural\") -&gt; tuple[callable, np.ndarray]:\n    \"\"\"\u6784\u9020\u57fa\u4e8e\u4e09\u6b21\u6837\u6761\u7684\u4f4d\u7f6e\u51fd\u6570\u3002\n\n    Args:\n        start_position (list[float]): \u8d77\u70b9\u5173\u8282\u89d2\u5ea6\u3002\n        end_position (list[float]): \u7ec8\u70b9\u5173\u8282\u89d2\u5ea6\u3002\n        mid_points (list): \u4e2d\u95f4\u70b9\u5750\u6807\u5217\u8868 (N, 3)\u3002\n        bc_type (str, optional): \u8fb9\u754c\u6761\u4ef6\u7c7b\u578b. Defaults to \"natural\".\n\n    Returns:\n        tuple: (pos_fun, s)\n            - pos_fun: \u4f4d\u7f6e\u51fd\u6570 callable\n            - s: \u7d2f\u79ef\u5f26\u957f\u6570\u7ec4\n\n    Raises:\n        ValueError: \u5982\u679c\u70b9\u96c6\u5f62\u72b6\u4e0d\u6b63\u786e\u3002\n    \"\"\"\n    _, start_pos = self.kinematic_solver.get_gripper2base(start_position)\n    _, end_pos = self.kinematic_solver.get_gripper2base(end_position)\n    points = np.vstack([start_pos, mid_points, end_pos])\n    P = np.asarray(points, dtype=float)\n    if P.ndim != 2 or P.shape[0] &lt; 2 or P.shape[1] not in (2, 3):\n        raise ValueError(\"points \u5f62\u72b6\u5fc5\u987b\u662f (N,3) \u6216 (N,2)\uff0c\u4e14 N&gt;=2\")\n    if P.shape[1] == 2:\n        P = np.hstack([P, np.zeros((P.shape[0], 1))])  # 2D \u81ea\u52a8\u8865 z=0\n\n    # --- \u5f26\u957f\u53c2\u6570\u5316\uff0c\u907f\u514d\u53c2\u6570\u62e5\u6324 ---\n    d = np.linalg.norm(np.diff(P, axis=0), axis=1)\n    s = np.concatenate([[0.0], np.cumsum(d)])\n    if s[-1] == 0:\n        raise ValueError(\"\u6240\u6709\u70b9\u91cd\u5408\uff0c\u65e0\u6cd5\u6784\u9020\u66f2\u7ebf\")\n    t = s / s[-1]  # \u5f52\u4e00\u5316\u5230 [0,1]\n\n    # \u5206\u522b\u6784\u9020 x,y,z \u7684\u6837\u6761\n    cs_x = CubicSpline(t, P[:, 0], bc_type=bc_type)\n    cs_y = CubicSpline(t, P[:, 1], bc_type=bc_type)\n    cs_z = CubicSpline(t, P[:, 2], bc_type=bc_type)\n\n    def _eval(u):\n        u = np.asarray(u, dtype=float)\n        # \u53ef\u9009\uff1a\u5939\u7d27\u5230 [0,1]\uff0c\u907f\u514d\u6570\u503c\u8d8a\u754c\n        u = np.clip(u, 0.0, 1.0)\n        X = np.stack([cs_x(u), cs_y(u), cs_z(u)], axis=-1)  # (..., 3)\n        if X.ndim == 1:  # \u6807\u91cf u -&gt; (3,)\n            return X\n        return X  # \u6570\u7ec4 u -&gt; (M,3)\n\n    return _eval, s\n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.curve_motion.CurveMotionDomainService.sample_parametric_equal_arclen","title":"sample_parametric_equal_arclen","text":"<pre><code>sample_parametric_equal_arclen(pos_fun, u0: float, u1: float, ds: float = 0.002, include_end: bool = True, dense: int = 4000) -&gt; tuple[np.ndarray, np.ndarray, int]\n</code></pre> <p>\u5bf9\u53c2\u6570\u66f2\u7ebf r(u) \u505a\u7b49\u5f27\u957f\u91c7\u6837\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>pos_fun</code> <code>callable</code> <p>\u53c2\u6570\u66f2\u7ebf\u51fd\u6570 r(u)\u3002</p> \u5fc5\u9700 <code>u0</code> <code>float</code> <p>\u53c2\u6570\u8d77\u59cb\u503c\u3002</p> \u5fc5\u9700 <code>u1</code> <code>float</code> <p>\u53c2\u6570\u7ec8\u6b62\u503c\u3002</p> \u5fc5\u9700 <code>ds</code> <code>float</code> <p>\u76ee\u6807\u5f27\u957f\u91c7\u6837\u95f4\u9694. Defaults to 0.002.</p> <code>0.002</code> <code>include_end</code> <code>bool</code> <p>\u7ed3\u679c\u662f\u5426\u5fc5\u987b\u5305\u542b\u7ec8\u70b9. Defaults to True.</p> <code>True</code> <code>dense</code> <code>int</code> <p>\u521d\u59cb\u5bc6\u91c7\u6837\u7684\u70b9\u6570. Defaults to 4000.</p> <code>4000</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>tuple</code> <code>tuple[ndarray, ndarray, int]</code> <p>(pos_list, u_eq, n_seg) - pos_list: \u7b49\u5f27\u957f\u91c7\u6837\u540e\u7684\u5750\u6807\u5217\u8868 (M, 3) - u_eq: \u5bf9\u5e94\u7684\u53c2\u6570\u503c\u5217\u8868 (M,) - n_seg: \u5206\u6bb5\u6570</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code> <pre><code>def sample_parametric_equal_arclen(\n        self,\n        pos_fun,  # callable: u -&gt; (3,) numpy array\n        u0: float,\n        u1: float,\n        ds: float = 0.002,\n        include_end: bool = True,\n        dense: int = 4000\n) -&gt; tuple[np.ndarray, np.ndarray, int]:\n    \"\"\"\u5bf9\u53c2\u6570\u66f2\u7ebf r(u) \u505a\u7b49\u5f27\u957f\u91c7\u6837\u3002\n\n    Args:\n        pos_fun (callable): \u53c2\u6570\u66f2\u7ebf\u51fd\u6570 r(u)\u3002\n        u0 (float): \u53c2\u6570\u8d77\u59cb\u503c\u3002\n        u1 (float): \u53c2\u6570\u7ec8\u6b62\u503c\u3002\n        ds (float, optional): \u76ee\u6807\u5f27\u957f\u91c7\u6837\u95f4\u9694. Defaults to 0.002.\n        include_end (bool, optional): \u7ed3\u679c\u662f\u5426\u5fc5\u987b\u5305\u542b\u7ec8\u70b9. Defaults to True.\n        dense (int, optional): \u521d\u59cb\u5bc6\u91c7\u6837\u7684\u70b9\u6570. Defaults to 4000.\n\n    Returns:\n        tuple: (pos_list, u_eq, n_seg)\n            - pos_list: \u7b49\u5f27\u957f\u91c7\u6837\u540e\u7684\u5750\u6807\u5217\u8868 (M, 3)\n            - u_eq: \u5bf9\u5e94\u7684\u53c2\u6570\u503c\u5217\u8868 (M,)\n            - n_seg: \u5206\u6bb5\u6570\n    \"\"\"\n    # 1) \u5148\u5728\u53c2\u6570\u4e0a\u505a\u5747\u5300\u5bc6\u91c7\u6837\uff0c\u4f30\u7b97\u5f27\u957f\n    u_dense = np.linspace(u0, u1, max(1000, int(abs(u1 - u0) * dense)))\n    XYZ = np.vstack([np.asarray(pos_fun(ui), dtype=float).reshape(3) for ui in u_dense])\n    seg = np.linalg.norm(np.diff(XYZ, axis=0), axis=1)\n    s_cum = np.concatenate([[0.0], np.cumsum(seg)])\n    L = float(s_cum[-1])\n    if L &lt; 1e-12:\n        # \u9000\u5316\uff1a\u51e0\u4e4e\u96f6\u957f\n        pos_list = XYZ[[0, -1], :] if include_end else XYZ[[0], :]\n        u_eq = np.array([u_dense[0], u_dense[-1]]) if include_end else np.array([u_dense[0]])\n        return pos_list, u_eq, 0.0\n\n    # 2) \u5f27\u957f -&gt; u \u7684\u53cd\u67e5\uff0c\u7528\u63d2\u503c\u8fd1\u4f3c\n    s2u = interp1d(s_cum, u_dense, kind=\"linear\", bounds_error=False, fill_value=(u_dense[0], u_dense[-1]))\n\n    # 3) \u76ee\u6807\u7b49\u5f27\u957f\u5e8f\u5217\n    n_seg = max(1, int(np.ceil(L / ds)))\n    s_target = np.linspace(0.0, L, n_seg + 1 if include_end else n_seg)\n    u_eq = s2u(s_target)\n\n    # 4) \u5f97\u5230\u7b49\u5f27\u957f\u4f4d\u7f6e\n    pos_list = np.vstack([np.asarray(pos_fun(ui), dtype=float).reshape(3) for ui in u_eq])\n    return pos_list, u_eq, n_seg\n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.curve_motion.CurveMotionDomainService.wrap_to_pi","title":"wrap_to_pi","text":"<pre><code>wrap_to_pi(q: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u5c06\u89d2\u5ea6\u5305\u88f9\u5230 (-pi, pi]\uff0c\u907f\u514d 2\u03c0 \u8df3\u53d8\u5f71\u54cd\u8ba1\u7b97\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code> <pre><code>def wrap_to_pi(self, q: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u5c06\u89d2\u5ea6\u5305\u88f9\u5230 (-pi, pi]\uff0c\u907f\u514d 2\u03c0 \u8df3\u53d8\u5f71\u54cd\u8ba1\u7b97\u3002\"\"\"\n    return (q + np.pi) % (2 * np.pi) - np.pi\n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.curve_motion.CurveMotionDomainService.ensure_2d_array","title":"ensure_2d_array","text":"<pre><code>ensure_2d_array(arr: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u5c06\u8f93\u5165\u8f6c\u6362\u4e3a\u4e8c\u7ef4\u6570\u7ec4 (N, dof) \u5e76\u505a\u57fa\u672c\u6821\u9a8c\u3002</p>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.curve_motion.CurveMotionDomainService.ensure_2d_array--raises","title":"Raises","text":"<p>ValueError     \u5f53\u8def\u6807\u6570\u5c11\u4e8e 2\uff08\u7f3a\u5c11\u8d77\u70b9\u6216\u7ec8\u70b9\uff09\u65f6\u629b\u51fa\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code> <pre><code>def ensure_2d_array(self, arr: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\n    \u5c06\u8f93\u5165\u8f6c\u6362\u4e3a\u4e8c\u7ef4\u6570\u7ec4 (N, dof) \u5e76\u505a\u57fa\u672c\u6821\u9a8c\u3002\n\n    Raises\n    ------\n    ValueError\n        \u5f53\u8def\u6807\u6570\u5c11\u4e8e 2\uff08\u7f3a\u5c11\u8d77\u70b9\u6216\u7ec8\u70b9\uff09\u65f6\u629b\u51fa\u3002\n    \"\"\"\n    q = np.asarray(arr, dtype=float)\n    if q.ndim == 1:\n        q = q[None, :]\n    if not (q.ndim == 2 and q.shape[0] &gt;= 2):\n        raise ValueError(\"Q_waypoints \u81f3\u5c11\u9700\u8981\u4e24\u4e2a\u70b9\uff08\u8d77\u70b9\u4e0e\u7ec8\u70b9\uff09\u4e14\u7ef4\u5ea6\u4e3a (N, dof)\u3002\")\n    return q\n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.curve_motion.CurveMotionDomainService.toppra_time_parameterize","title":"toppra_time_parameterize","text":"<pre><code>toppra_time_parameterize(waypoints: ndarray, v_max: ndarray | float, a_max: ndarray | float, dt: float = 0.01, grid_n: int = 400) -&gt; tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]\n</code></pre> <p>\u4f7f\u7528 TOPPRA \u5bf9\u8def\u5f84\u8fdb\u884c\u65f6\u95f4\u53c2\u6570\u5316\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>waypoints</code> <code>ndarray</code> <p>\u8def\u5f84\u70b9\u6570\u7ec4 (N, dof)\u3002</p> \u5fc5\u9700 <code>v_max</code> <code>ndarray | float</code> <p>\u6700\u5927\u901f\u5ea6\u7ea6\u675f\u3002</p> \u5fc5\u9700 <code>a_max</code> <code>ndarray | float</code> <p>\u6700\u5927\u52a0\u901f\u5ea6\u7ea6\u675f\u3002</p> \u5fc5\u9700 <code>dt</code> <code>float</code> <p>\u8f93\u51fa\u8f68\u8ff9\u7684\u65f6\u95f4\u6b65\u957f. Defaults to 0.01.</p> <code>0.01</code> <code>grid_n</code> <code>int</code> <p>TOPPRA \u79bb\u6563\u5316\u7f51\u683c\u70b9\u6570. Defaults to 400.</p> <code>400</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>tuple</code> <code>tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]</code> <p>(t, q, qd, qdd) - t: \u65f6\u95f4\u6233\u5217\u8868 - q: \u5173\u8282\u4f4d\u7f6e\u5217\u8868 - qd: \u5173\u8282\u901f\u5ea6\u5217\u8868 - qdd: \u5173\u8282\u52a0\u901f\u5ea6\u5217\u8868</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ValueError</code> <p>\u5982\u679c waypoints \u7ef4\u5ea6\u4e0d\u6b63\u786e\u6216\u7ea6\u675f\u683c\u5f0f\u9519\u8bef\u3002</p> <code>RuntimeError</code> <p>\u5982\u679c TOPPRA \u6c42\u89e3\u5931\u8d25\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code> <pre><code>def toppra_time_parameterize(self,\n                             waypoints: np.ndarray,\n                             v_max: np.ndarray | float,\n                             a_max: np.ndarray | float,\n                             dt: float = 0.01,\n                             grid_n: int = 400,\n                             ) -&gt; tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]:\n    \"\"\"\u4f7f\u7528 TOPPRA \u5bf9\u8def\u5f84\u8fdb\u884c\u65f6\u95f4\u53c2\u6570\u5316\u3002\n\n    Args:\n        waypoints (np.ndarray): \u8def\u5f84\u70b9\u6570\u7ec4 (N, dof)\u3002\n        v_max (np.ndarray | float): \u6700\u5927\u901f\u5ea6\u7ea6\u675f\u3002\n        a_max (np.ndarray | float): \u6700\u5927\u52a0\u901f\u5ea6\u7ea6\u675f\u3002\n        dt (float, optional): \u8f93\u51fa\u8f68\u8ff9\u7684\u65f6\u95f4\u6b65\u957f. Defaults to 0.01.\n        grid_n (int, optional): TOPPRA \u79bb\u6563\u5316\u7f51\u683c\u70b9\u6570. Defaults to 400.\n\n    Returns:\n        tuple: (t, q, qd, qdd)\n            - t: \u65f6\u95f4\u6233\u5217\u8868\n            - q: \u5173\u8282\u4f4d\u7f6e\u5217\u8868\n            - qd: \u5173\u8282\u901f\u5ea6\u5217\u8868\n            - qdd: \u5173\u8282\u52a0\u901f\u5ea6\u5217\u8868\n\n    Raises:\n        ValueError: \u5982\u679c waypoints \u7ef4\u5ea6\u4e0d\u6b63\u786e\u6216\u7ea6\u675f\u683c\u5f0f\u9519\u8bef\u3002\n        RuntimeError: \u5982\u679c TOPPRA \u6c42\u89e3\u5931\u8d25\u3002\n    \"\"\"\n    waypoints = np.asarray(waypoints, dtype=float)\n    if waypoints.ndim != 2 or waypoints.shape[1] != 6 or waypoints.shape[0] &lt; 2:\n        raise ValueError(\"waypoints \u5fc5\u987b\u662f (N,6) \u4e14 N&gt;=2\")\n\n    dof = waypoints.shape[1]\n\n    # 1) \u51e0\u4f55\u8def\u5f84\uff1a\u7528\u6837\u6761\u5728\u8def\u5f84\u53c2\u6570 s\u2208[0,1] \u4e0a\u63d2\u503c\n    breaks = np.linspace(0.0, 1.0, waypoints.shape[0])\n    path = ta.SplineInterpolator(breaks, waypoints)  # \u5b98\u65b9\u793a\u4f8b\u540c\u6b3e API\n\n    # 2) \u901f\u5ea6/\u52a0\u901f\u5ea6\u7ea6\u675f\uff08\u4e0a\u4e0b\u754c\u683c\u5f0f\uff09\n    v_max = np.full(dof, float(v_max)) if np.isscalar(v_max) else np.asarray(v_max, dtype=float)\n    a_max = np.full(dof, float(a_max)) if np.isscalar(a_max) else np.asarray(a_max, dtype=float)\n    if v_max.shape != (dof,) or a_max.shape != (dof,):\n        raise ValueError(\"v_max/a_max \u9700\u4e3a\u6807\u91cf\u6216 shape=(6,)\")\n\n    v_bounds = np.column_stack((-np.abs(v_max), np.abs(v_max)))  # (2,6) -&gt; [v_min; v_max]\n    a_bounds = np.column_stack((-np.abs(a_max), np.abs(a_max)))  # (2,6) -&gt; [a_min; a_max]\n\n    pc_vel = constraint.JointVelocityConstraint(v_bounds)\n    pc_acc = constraint.JointAccelerationConstraint(a_bounds)\n\n    # 3) TOPPRA \u4e3b\u7b97\u6cd5 + \u5e38\u7528\u53c2\u6570\u5316\u5668\uff08\u5e38\u7528\u4e14\u6ee1\u8db3\u8fb9\u754c/\u7ea6\u675f\uff09\n    gridpoints = np.linspace(0, path.duration, int(grid_n))\n    instance = algo.TOPPRA([pc_vel, pc_acc], path, gridpoints=gridpoints, parametrizer=\"ParametrizeConstAccel\")\n\n    # 4) \u6c42\u89e3\u65f6\u95f4\u53c2\u6570\u5316\uff0c\u5f97\u5230\u53ef\u6309\u65f6\u95f4\u91c7\u6837\u7684 jnt_traj\n    jnt_traj = instance.compute_trajectory(sd_start=0.0, sd_end=0.0)\n    if jnt_traj is None:\n        raise RuntimeError(\"TOPPRA \u6c42\u89e3\u5931\u8d25\uff1a\u7ed9\u5b9a\u7ea6\u675f\u4e0b\u4e0d\u53ef\u884c\uff0c\u6216\u8def\u5f84\u5f02\u5e38\u3002\")\n\n    # 5) \u6309 dt \u91c7\u6837\n    T = float(jnt_traj.duration)\n    M = max(2, int(np.ceil(T / dt)) + 1)\n    t = np.linspace(0.0, T, M)\n\n    q = jnt_traj.eval(t)\n    qd = jnt_traj.evald(t)\n    qdd = jnt_traj.evaldd(t)\n    return t.tolist(), q.tolist(), qd.tolist(), qdd.tolist()\n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.hand_eye_transform_domain_service","title":"controller.domain.services.algorithm.hand_eye_transform_domain_service","text":"<p>\u624b\u773c\u6807\u5b9a\u53d8\u6362\u670d\u52a1 - Domain\u5c42</p>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.hand_eye_transform_domain_service.HandEyeTransformDomainService","title":"HandEyeTransformDomainService","text":"<pre><code>HandEyeTransformDomainService(config: HandEyeCalibrationConfig, kinematic_service: KinematicDomainService)\n</code></pre> <p>\u624b\u773c\u6807\u5b9a\u53d8\u6362\u670d\u52a1\u3002</p> <p>\u804c\u8d23\uff1a 1. \u50cf\u7d20\u5750\u6807 \u2192 \u76f8\u673a\u5750\u6807\u7cfb 2. \u76f8\u673a\u5750\u6807\u7cfb \u2192 \u57fa\u5750\u6807\u7cfb 3. \u8ba1\u7b97\u76ee\u6807\u4f4d\u59ff\uff08\u5305\u542b\u504f\u79fb\u548c\u59ff\u6001\u8c03\u6574\uff09 4. \u63d0\u4f9b\u9006\u8fd0\u52a8\u5b66\u6c42\u89e3</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>config</code> <code>HandEyeCalibrationConfig</code> <p>\u624b\u773c\u6807\u5b9a\u914d\u7f6e\u3002</p> <code>kinematic_service</code> <code>KinematicDomainService</code> <p>\u8fd0\u52a8\u5b66\u670d\u52a1\u5b9e\u4f8b\u3002</p> <p>\u521d\u59cb\u5316\u624b\u773c\u6807\u5b9a\u53d8\u6362\u670d\u52a1\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config</code> <code>HandEyeCalibrationConfig</code> <p>\u624b\u773c\u6807\u5b9a\u914d\u7f6e\uff08\u901a\u8fc7DI\u6ce8\u5165\uff09\u3002</p> \u5fc5\u9700 <code>kinematic_service</code> <code>KinematicDomainService</code> <p>\u8fd0\u52a8\u5b66\u670d\u52a1\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/hand_eye_transform_domain_service.py</code> <pre><code>def __init__(\n    self,\n    config: HandEyeCalibrationConfig,\n    kinematic_service: KinematicDomainService\n):\n    \"\"\"\u521d\u59cb\u5316\u624b\u773c\u6807\u5b9a\u53d8\u6362\u670d\u52a1\u3002\n\n    Args:\n        config: \u624b\u773c\u6807\u5b9a\u914d\u7f6e\uff08\u901a\u8fc7DI\u6ce8\u5165\uff09\u3002\n        kinematic_service: \u8fd0\u52a8\u5b66\u670d\u52a1\u3002\n    \"\"\"\n    self.config = config\n    self.kinematic_service = kinematic_service\n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.hand_eye_transform_domain_service.HandEyeTransformDomainService.calculate_target_joint_angles","title":"calculate_target_joint_angles","text":"<pre><code>calculate_target_joint_angles(central_center: List[float], depth: float, real_center: List[float], real_depth: float, angle: float, current_joint_angles: List[float]) -&gt; Optional[List[float]]\n</code></pre> <p>\u8ba1\u7b97\u8fd0\u52a8\u5230\u96f6\u4ef6\u4f4d\u7f6e\u6240\u9700\u7684\u76ee\u6807\u5173\u8282\u89d2\u5ea6\u3002</p> <p>\u5b8c\u6574\u6d41\u7a0b\uff1a 1. \u50cf\u7d20\u5750\u6807 \u2192 \u76f8\u673a\u5750\u6807\u7cfb 2. \u6b63\u8fd0\u52a8\u5b66\uff1a\u5f53\u524d\u5173\u8282\u89d2\u5ea6 \u2192 \u672b\u7aef\u4f4d\u59ff 3. \u76f8\u673a\u5750\u6807\u7cfb \u2192 \u57fa\u5750\u6807\u7cfb 4. \u8ba1\u7b97\u96f6\u4ef6\u65b9\u5411 + \u504f\u79fb\u91cf 5. \u9006\u8fd0\u52a8\u5b66\uff1a\u76ee\u6807\u4f4d\u59ff \u2192 \u76ee\u6807\u5173\u8282\u89d2\u5ea6</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>central_center</code> <code>List[float]</code> <p>\u4e2d\u5fc3\u70b9\u50cf\u7d20\u5750\u6807 [u, v]\u3002</p> \u5fc5\u9700 <code>depth</code> <code>float</code> <p>\u4e2d\u5fc3\u70b9\u6df1\u5ea6 (mm)\u3002</p> \u5fc5\u9700 <code>real_center</code> <code>List[float]</code> <p>\u5b9e\u9645\u4e2d\u5fc3\u70b9\u50cf\u7d20\u5750\u6807 [u, v]\u3002</p> \u5fc5\u9700 <code>real_depth</code> <code>float</code> <p>\u5b9e\u9645\u4e2d\u5fc3\u70b9\u6df1\u5ea6 (mm)\u3002</p> \u5fc5\u9700 <code>angle</code> <code>float</code> <p>\u96f6\u4ef6\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002</p> \u5fc5\u9700 <code>current_joint_angles</code> <code>List[float]</code> <p>\u5f53\u524d\u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[List[float]]</code> <p>Optional[List[float]]: \u76ee\u6807\u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\uff0c\u5982\u679c\u65e0\u89e3\u5219\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/hand_eye_transform_domain_service.py</code> <pre><code>def calculate_target_joint_angles(\n    self,\n    central_center: List[float],      # [u, v] \u50cf\u7d20\u5750\u6807\n    depth: float,                     # \u6df1\u5ea6 (mm)\n    real_center: List[float],         # \u5b9e\u9645\u4e2d\u5fc3\u70b9 [u, v]\n    real_depth: float,                # \u5b9e\u9645\u6df1\u5ea6 (mm)\n    angle: float,                     # \u96f6\u4ef6\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\n    current_joint_angles: List[float] # \u5f53\u524d\u5173\u8282\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\n) -&gt; Optional[List[float]]:\n    \"\"\"\u8ba1\u7b97\u8fd0\u52a8\u5230\u96f6\u4ef6\u4f4d\u7f6e\u6240\u9700\u7684\u76ee\u6807\u5173\u8282\u89d2\u5ea6\u3002\n\n    \u5b8c\u6574\u6d41\u7a0b\uff1a\n    1. \u50cf\u7d20\u5750\u6807 \u2192 \u76f8\u673a\u5750\u6807\u7cfb\n    2. \u6b63\u8fd0\u52a8\u5b66\uff1a\u5f53\u524d\u5173\u8282\u89d2\u5ea6 \u2192 \u672b\u7aef\u4f4d\u59ff\n    3. \u76f8\u673a\u5750\u6807\u7cfb \u2192 \u57fa\u5750\u6807\u7cfb\n    4. \u8ba1\u7b97\u96f6\u4ef6\u65b9\u5411 + \u504f\u79fb\u91cf\n    5. \u9006\u8fd0\u52a8\u5b66\uff1a\u76ee\u6807\u4f4d\u59ff \u2192 \u76ee\u6807\u5173\u8282\u89d2\u5ea6\n\n    Args:\n        central_center (List[float]): \u4e2d\u5fc3\u70b9\u50cf\u7d20\u5750\u6807 [u, v]\u3002\n        depth (float): \u4e2d\u5fc3\u70b9\u6df1\u5ea6 (mm)\u3002\n        real_center (List[float]): \u5b9e\u9645\u4e2d\u5fc3\u70b9\u50cf\u7d20\u5750\u6807 [u, v]\u3002\n        real_depth (float): \u5b9e\u9645\u4e2d\u5fc3\u70b9\u6df1\u5ea6 (mm)\u3002\n        angle (float): \u96f6\u4ef6\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002\n        current_joint_angles (List[float]): \u5f53\u524d\u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\u3002\n\n    Returns:\n        Optional[List[float]]: \u76ee\u6807\u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\uff0c\u5982\u679c\u65e0\u89e3\u5219\u8fd4\u56de None\u3002\n    \"\"\"\n    # \u83b7\u53d6\u914d\u7f6e\u53c2\u6570\n    intrinsics = self.config.camera_intrinsics\n\n    # 1. \u50cf\u7d20\u5750\u6807 \u2192 \u76f8\u673a\u5750\u6807\u7cfb\uff08\u9f50\u6b21\u5750\u6807\uff09\n    px1, py1, pz1 = central_center[0], central_center[1], depth\n    px2, py2, pz2 = real_center[0], real_center[1], real_depth\n\n    # \u6df1\u5ea6\u5355\u4f4d\u8f6c\u6362\uff1amm \u2192 m\n    pz1 *= 0.001\n    pz2 *= 0.001\n\n    # \u4f7f\u7528\u9488\u5b54\u76f8\u673a\u6a21\u578b\n    px1 = (px1 - intrinsics.cx) * pz1 / intrinsics.fx\n    py1 = (py1 - intrinsics.cy) * pz1 / intrinsics.fy\n    px2 = (px2 - intrinsics.cx) * pz2 / intrinsics.fx\n    py2 = (py2 - intrinsics.cy) * pz2 / intrinsics.fy\n\n    p1_cam = np.array([px1, py1, pz1, 1])\n    p2_cam = np.array([px2, py2, pz2, 1])\n\n    # 2. \u6b63\u8fd0\u52a8\u5b66\uff1a\u83b7\u53d6\u5f53\u524d\u672b\u7aef\u4f4d\u59ff\uff084x4\u53d8\u6362\u77e9\u9635\uff09\n    forward_matrix = self.kinematic_service.get_gripper2base_rm(current_joint_angles)\n\n    # 3. \u76f8\u673a\u5750\u6807\u7cfb \u2192 \u57fa\u5750\u6807\u7cfb\n    T_cam2base = forward_matrix @ self.config.hand_eye_matrix\n\n    p1_base = T_cam2base @ p1_cam\n    p2_base = T_cam2base @ p2_cam\n    v_base = p2_base - p1_base\n\n    # 4. \u8ba1\u7b97\u76ee\u6807\u4f4d\u59ff\n    # 4.1 \u8ba1\u7b97\u96f6\u4ef6\u65b9\u5411\u5411\u91cf\n    theta = np.arctan2(v_base[1], v_base[0])\n\n    # 4.2 \u6784\u5efa\u7ed5 Z \u8f74\u65cb\u8f6c\u7684\u53d8\u6362\u77e9\u9635\n    T_target2base = self.get_z_rotation_matrix(theta)\n    T_target2base[:, 3] = p2_base\n\n    # 4.3 \u6dfb\u52a0\u504f\u79fb\u91cf\n    T_offset2target = np.eye(4)\n    T_offset2target[:3, 3] = self.config.target_offset.to_array()\n    T_target2base = T_target2base @ T_offset2target\n\n    # 4.4 \u8c03\u6574\u672b\u7aef\u59ff\u6001\n    adjustment = self.config.end_effector_adjustment\n    T_target2base = (\n        T_target2base \n        @ self.get_z_rotation_matrix(adjustment.z_rotation) \n        @ self.get_y_rotation_matrix(adjustment.y_rotation)\n    )\n\n    # 5. \u9006\u8fd0\u52a8\u5b66\u6c42\u89e3\n    theta_list = self.kinematic_service.inverse_kinematic(\n        T_target2base[:3, :3], \n        T_target2base[:3, 3],\n        initial_theta=current_joint_angles\n    )\n\n    return theta_list\n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.hand_eye_transform_domain_service.HandEyeTransformDomainService.get_z_rotation_matrix","title":"get_z_rotation_matrix","text":"<pre><code>get_z_rotation_matrix(angle: float) -&gt; np.ndarray\n</code></pre> <p>\u83b7\u53d6\u7ed5 Z \u8f74\u65cb\u8f6c\u7684\u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>angle</code> <code>float</code> <p>\u65cb\u8f6c\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: 4x4 \u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/hand_eye_transform_domain_service.py</code> <pre><code>def get_z_rotation_matrix(self, angle: float) -&gt; np.ndarray:\n    \"\"\"\u83b7\u53d6\u7ed5 Z \u8f74\u65cb\u8f6c\u7684\u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002\n\n    Args:\n        angle (float): \u65cb\u8f6c\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002\n\n    Returns:\n        np.ndarray: 4x4 \u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002\n    \"\"\"\n    c = cos(angle)\n    s = sin(angle)\n    return np.array([\n        [c, -s, 0, 0],\n        [s,  c, 0, 0],\n        [0,  0, 1, 0],\n        [0,  0, 0, 1]\n    ])\n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.hand_eye_transform_domain_service.HandEyeTransformDomainService.get_y_rotation_matrix","title":"get_y_rotation_matrix","text":"<pre><code>get_y_rotation_matrix(angle: float) -&gt; np.ndarray\n</code></pre> <p>\u83b7\u53d6\u7ed5 Y \u8f74\u65cb\u8f6c\u7684\u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>angle</code> <code>float</code> <p>\u65cb\u8f6c\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: 4x4 \u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/hand_eye_transform_domain_service.py</code> <pre><code>def get_y_rotation_matrix(self, angle: float) -&gt; np.ndarray:\n    \"\"\"\u83b7\u53d6\u7ed5 Y \u8f74\u65cb\u8f6c\u7684\u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002\n\n    Args:\n        angle (float): \u65cb\u8f6c\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002\n\n    Returns:\n        np.ndarray: 4x4 \u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002\n    \"\"\"\n    c = cos(angle)\n    s = sin(angle)\n    return np.array([\n        [ c, 0, s, 0],\n        [ 0, 1, 0, 0],\n        [-s, 0, c, 0],\n        [ 0, 0, 0, 1]\n    ])\n</code></pre>"},{"location":"api/domain/algorithm/#controller.domain.services.algorithm.hand_eye_transform_domain_service.HandEyeTransformDomainService.get_x_rotation_matrix","title":"get_x_rotation_matrix","text":"<pre><code>get_x_rotation_matrix(angle: float) -&gt; np.ndarray\n</code></pre> <p>\u83b7\u53d6\u7ed5 X \u8f74\u65cb\u8f6c\u7684\u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>angle</code> <code>float</code> <p>\u65cb\u8f6c\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: 4x4 \u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/hand_eye_transform_domain_service.py</code> <pre><code>def get_x_rotation_matrix(self, angle: float) -&gt; np.ndarray:\n    \"\"\"\u83b7\u53d6\u7ed5 X \u8f74\u65cb\u8f6c\u7684\u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002\n\n    Args:\n        angle (float): \u65cb\u8f6c\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002\n\n    Returns:\n        np.ndarray: 4x4 \u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002\n    \"\"\"\n    c = cos(angle)\n    s = sin(angle)\n    return np.array([\n        [1,  0,  0, 0],\n        [0,  c, -s, 0],\n        [0,  s,  c, 0],\n        [0,  0,  0, 1]\n    ])\n</code></pre>"},{"location":"api/domain/communication/","title":"Domain Layer - Communication Services","text":""},{"location":"api/domain/communication/#controller.domain.services.communication.message_domain_service","title":"controller.domain.services.communication.message_domain_service","text":""},{"location":"api/domain/communication/#controller.domain.services.communication.message_domain_service.MessageDomainService","title":"MessageDomainService","text":"<pre><code>MessageDomainService(message_encoder: MessageEncoder, message_decoder: MessageDecoder)\n</code></pre> <p>\u6d88\u606f\u9886\u57df\u670d\u52a1\u3002</p> <p>\u8d1f\u8d23\u6d88\u606f\u7684\u7f16\u7801\u548c\u89e3\u7801\uff0c\u4f5c\u4e3a MessageEncoder \u548c MessageDecoder \u7684\u95e8\u9762\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>message_encoder</code> <code>MessageEncoder</code> <p>\u6d88\u606f\u7f16\u7801\u5668\u3002</p> <code>message_decoder</code> <code>MessageDecoder</code> <p>\u6d88\u606f\u89e3\u7801\u5668\u3002</p> <p>\u521d\u59cb\u5316\u6d88\u606f\u9886\u57df\u670d\u52a1\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>message_encoder</code> <code>MessageEncoder</code> <p>\u6ce8\u5165\u7684\u6d88\u606f\u7f16\u7801\u5668\u3002</p> \u5fc5\u9700 <code>message_decoder</code> <code>MessageDecoder</code> <p>\u6ce8\u5165\u7684\u6d88\u606f\u89e3\u7801\u5668\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/message_domain_service.py</code> <pre><code>def __init__(self, message_encoder: MessageEncoder, message_decoder: MessageDecoder):\n    \"\"\"\u521d\u59cb\u5316\u6d88\u606f\u9886\u57df\u670d\u52a1\u3002\n\n    Args:\n        message_encoder (MessageEncoder): \u6ce8\u5165\u7684\u6d88\u606f\u7f16\u7801\u5668\u3002\n        message_decoder (MessageDecoder): \u6ce8\u5165\u7684\u6d88\u606f\u89e3\u7801\u5668\u3002\n    \"\"\"\n    self.message_encoder = message_encoder\n    self.message_decoder = message_decoder\n</code></pre>"},{"location":"api/domain/communication/#controller.domain.services.communication.message_domain_service.MessageDomainService.encode_message","title":"encode_message","text":"<pre><code>encode_message(**message: Any) -&gt; str\n</code></pre> <p>\u7f16\u7801\u6d88\u606f\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>**message</code> <code>Any</code> <p>\u6d88\u606f\u5b57\u6bb5\u952e\u503c\u5bf9\u3002</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>str</code> <code>str</code> <p>\u7f16\u7801\u540e\u7684\u5341\u516d\u8fdb\u5236\u6d88\u606f\u5b57\u7b26\u4e32\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/message_domain_service.py</code> <pre><code>def encode_message(self, **message: Any) -&gt; str:\n    \"\"\"\u7f16\u7801\u6d88\u606f\u3002\n\n    Args:\n        **message: \u6d88\u606f\u5b57\u6bb5\u952e\u503c\u5bf9\u3002\n\n    Returns:\n        str: \u7f16\u7801\u540e\u7684\u5341\u516d\u8fdb\u5236\u6d88\u606f\u5b57\u7b26\u4e32\u3002\n    \"\"\"\n    m = self.message_encoder.create_message(**message)\n    return self.message_encoder.interpret_message(m)\n</code></pre>"},{"location":"api/domain/communication/#controller.domain.services.communication.message_domain_service.MessageDomainService.decode_message","title":"decode_message","text":"<pre><code>decode_message(message: str) -&gt; Any\n</code></pre> <p>\u89e3\u7801\u6d88\u606f\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>message</code> <code>str</code> <p>\u5341\u516d\u8fdb\u5236\u6d88\u606f\u5b57\u7b26\u4e32\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Any</code> <code>Any</code> <p>\u89e3\u7801\u540e\u7684\u6d88\u606f\u5bf9\u8c61 (MessageIn)\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/message_domain_service.py</code> <pre><code>def decode_message(self, message: str) -&gt; Any:\n    \"\"\"\u89e3\u7801\u6d88\u606f\u3002\n\n    Args:\n        message (str): \u5341\u516d\u8fdb\u5236\u6d88\u606f\u5b57\u7b26\u4e32\u3002\n\n    Returns:\n        Any: \u89e3\u7801\u540e\u7684\u6d88\u606f\u5bf9\u8c61 (MessageIn)\u3002\n    \"\"\"\n    return self.message_decoder.decode_message(message)\n</code></pre>"},{"location":"api/domain/communication/#controller.domain.services.communication.serial_domain_service","title":"controller.domain.services.communication.serial_domain_service","text":"<p>\u4e32\u53e3\u9886\u57df\u670d\u52a1 - Domain\u5c42 \u63d0\u4f9b\u4e32\u53e3\u8fde\u63a5\u3001\u8bfb\u5199\u64cd\u4f5c\u7684\u6838\u5fc3\u4e1a\u52a1\u903b\u8f91 \u53ef\u88ab\u5176\u4ed6Domain\u670d\u52a1\u590d\u7528</p>"},{"location":"api/domain/communication/#controller.domain.services.communication.serial_domain_service.SerialReaderThread","title":"SerialReaderThread","text":"<pre><code>SerialReaderThread(serial_reader)\n</code></pre> <p>               Bases: <code>QThread</code></p> <p>\u4e32\u53e3\u8bfb\u53d6\u7ebf\u7a0b</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code> <pre><code>def __init__(self, serial_reader):\n    super().__init__()\n    self.serial_reader = serial_reader\n</code></pre>"},{"location":"api/domain/communication/#controller.domain.services.communication.serial_domain_service.SerialReaderThread.run","title":"run","text":"<pre><code>run()\n</code></pre> <p>\u8fd0\u884c\u8bfb\u53d6\u5faa\u73af</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code> <pre><code>def run(self):\n    \"\"\"\u8fd0\u884c\u8bfb\u53d6\u5faa\u73af\"\"\"\n    if self.serial_reader:\n        self.serial_reader.read_data()\n</code></pre>"},{"location":"api/domain/communication/#controller.domain.services.communication.serial_domain_service.SerialWriterThread","title":"SerialWriterThread","text":"<pre><code>SerialWriterThread(serial_writer)\n</code></pre> <p>               Bases: <code>QThread</code></p> <p>\u4e32\u53e3\u5199\u5165\u7ebf\u7a0b</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code> <pre><code>def __init__(self, serial_writer):\n    super().__init__()\n    self.serial_writer = serial_writer\n</code></pre>"},{"location":"api/domain/communication/#controller.domain.services.communication.serial_domain_service.SerialWriterThread.run","title":"run","text":"<pre><code>run()\n</code></pre> <p>\u8fd0\u884c\u5199\u5165\u5faa\u73af</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code> <pre><code>def run(self):\n    \"\"\"\u8fd0\u884c\u5199\u5165\u5faa\u73af\"\"\"\n    if self.serial_writer:\n        self.serial_writer.send_data()\n</code></pre>"},{"location":"api/domain/communication/#controller.domain.services.communication.serial_domain_service.SerialDomainService","title":"SerialDomainService","text":"<pre><code>SerialDomainService()\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u4e32\u53e3\u9886\u57df\u670d\u52a1 - \u7ba1\u7406\u4e32\u53e3\u8fde\u63a5\u7684\u6838\u5fc3\u4e1a\u52a1\u903b\u8f91</p> <p>\u521d\u59cb\u5316\u4e32\u53e3\u9886\u57df\u670d\u52a1</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code> <pre><code>def __init__(self):\n    \"\"\"\u521d\u59cb\u5316\u4e32\u53e3\u9886\u57df\u670d\u52a1\"\"\"\n    super().__init__()\n\n    # \u4e32\u53e3\u76f8\u5173\u5bf9\u8c61\n    self.serial_adapter = SerialAdapter()\n    self.serial_reader: Optional[SerialReader] = None\n    self.serial_writer: Optional[SerialWriter] = None\n\n    # \u7ebf\u7a0b\u7ba1\u7406\n    self.reader_thread: Optional[SerialReaderThread] = None\n    self.writer_thread: Optional[SerialWriterThread] = None\n</code></pre>"},{"location":"api/domain/communication/#controller.domain.services.communication.serial_domain_service.SerialDomainService.scan_available_ports","title":"scan_available_ports","text":"<pre><code>scan_available_ports() -&gt; List[str]\n</code></pre> <p>\u626b\u63cf\u53ef\u7528\u7aef\u53e3\u5217\u8868</p> \u8fd4\u56de <p>List[str]: \u53ef\u7528\u7aef\u53e3\u540d\u79f0\u5217\u8868</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code> <pre><code>def scan_available_ports(self) -&gt; List[str]:\n    \"\"\"\n    \u626b\u63cf\u53ef\u7528\u7aef\u53e3\u5217\u8868\n\n    \u8fd4\u56de:\n        List[str]: \u53ef\u7528\u7aef\u53e3\u540d\u79f0\u5217\u8868\n    \"\"\"\n    try:\n        return PortScanner.scan_ports()\n    except Exception as e:\n        raise Exception(f\"\u626b\u63cf\u7aef\u53e3\u5931\u8d25: {str(e)}\")\n</code></pre>"},{"location":"api/domain/communication/#controller.domain.services.communication.serial_domain_service.SerialDomainService.get_port_info","title":"get_port_info","text":"<pre><code>get_port_info(port_name: str) -&gt; Optional[Dict[str, str]]\n</code></pre> <p>\u83b7\u53d6\u6307\u5b9a\u7aef\u53e3\u4fe1\u606f</p> \u53c2\u6570 <p>port_name: \u7aef\u53e3\u540d\u79f0</p> \u8fd4\u56de <p>Optional[Dict[str, str]]: \u7aef\u53e3\u4fe1\u606f\u5b57\u5178\uff0c\u5931\u8d25\u65f6\u8fd4\u56deNone</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code> <pre><code>def get_port_info(self, port_name: str) -&gt; Optional[Dict[str, str]]:\n    \"\"\"\n    \u83b7\u53d6\u6307\u5b9a\u7aef\u53e3\u4fe1\u606f\n\n    \u53c2\u6570:\n        port_name: \u7aef\u53e3\u540d\u79f0\n\n    \u8fd4\u56de:\n        Optional[Dict[str, str]]: \u7aef\u53e3\u4fe1\u606f\u5b57\u5178\uff0c\u5931\u8d25\u65f6\u8fd4\u56deNone\n    \"\"\"\n    try:\n        return PortScanner.get_port_info(port_name)\n    except Exception as e:\n        raise Exception(f\"\u83b7\u53d6\u7aef\u53e3\u4fe1\u606f\u5931\u8d25: {str(e)}\")\n</code></pre>"},{"location":"api/domain/communication/#controller.domain.services.communication.serial_domain_service.SerialDomainService.get_current_port","title":"get_current_port","text":"<pre><code>get_current_port() -&gt; Optional[str]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u7684\u7aef\u53e3\u540d\u79f0</p> \u8fd4\u56de <p>Optional[str]: \u7aef\u53e3\u540d\u79f0\uff0c\u672a\u8fde\u63a5\u65f6\u8fd4\u56deNone</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code> <pre><code>def get_current_port(self) -&gt; Optional[str]:\n    \"\"\"\n    \u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u7684\u7aef\u53e3\u540d\u79f0\n\n    \u8fd4\u56de:\n        Optional[str]: \u7aef\u53e3\u540d\u79f0\uff0c\u672a\u8fde\u63a5\u65f6\u8fd4\u56deNone\n    \"\"\"\n    return self.serial_adapter.get_port_name()\n</code></pre>"},{"location":"api/domain/communication/#controller.domain.services.communication.serial_domain_service.SerialDomainService.is_connected","title":"is_connected","text":"<pre><code>is_connected() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u4e32\u53e3\u662f\u5426\u5df2\u8fde\u63a5</p> \u8fd4\u56de <p>bool: \u662f\u5426\u5df2\u8fde\u63a5</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code> <pre><code>def is_connected(self) -&gt; bool:\n    \"\"\"\n    \u68c0\u67e5\u4e32\u53e3\u662f\u5426\u5df2\u8fde\u63a5\n\n    \u8fd4\u56de:\n        bool: \u662f\u5426\u5df2\u8fde\u63a5\n    \"\"\"\n    return self.serial_adapter.is_connected()\n</code></pre>"},{"location":"api/domain/communication/#controller.domain.services.communication.serial_domain_service.SerialDomainService.connect_port","title":"connect_port","text":"<pre><code>connect_port(port: str, config: Dict[str, Any]) -&gt; bool\n</code></pre> <p>\u8fde\u63a5\u4e32\u53e3</p> \u53c2\u6570 <p>port: \u4e32\u53e3\u540d\u79f0 config: \u4e32\u53e3\u914d\u7f6e\u53c2\u6570</p> \u8fd4\u56de <p>bool: \u8fde\u63a5\u662f\u5426\u6210\u529f</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code> <pre><code>def connect_port(self, port: str, config: Dict[str, Any]) -&gt; bool:\n    \"\"\"\n    \u8fde\u63a5\u4e32\u53e3\n\n    \u53c2\u6570:\n        port: \u4e32\u53e3\u540d\u79f0\n        config: \u4e32\u53e3\u914d\u7f6e\u53c2\u6570\n\n    \u8fd4\u56de:\n        bool: \u8fde\u63a5\u662f\u5426\u6210\u529f\n    \"\"\"\n    try:\n        # \u5982\u679c\u5df2\u8fde\u63a5\uff0c\u5148\u65ad\u5f00\n        if self.is_connected():\n            self.disconnect_port()\n\n        # \u5c1d\u8bd5\u8fde\u63a5\u4e32\u53e3\n        if not self.serial_adapter.connect(port, config):\n            raise Exception(f\"\u8fde\u63a5\u7aef\u53e3 {port} \u5931\u8d25\")\n\n        # \u83b7\u53d6\u4e32\u53e3\u5bf9\u8c61\n        serial_port = self.serial_adapter.get_serial_port()\n        if not serial_port:\n            raise Exception(\"\u83b7\u53d6\u4e32\u53e3\u5bf9\u8c61\u5931\u8d25\")\n\n        # \u521b\u5efa\u8bfb\u5199\u5668\n        self.serial_reader = SerialReader(serial_port)\n        self.serial_writer = SerialWriter(serial_port)\n\n        # \u8fde\u63a5Infrastructure\u5c42\u4fe1\u53f7\u5230Domain\u5c42\n        self._connect_infrastructure_signals()\n\n        # \u542f\u52a8\u7ebf\u7a0b\n        self._start_threads()\n\n        # \u53d1\u9001\u8fde\u63a5\u6210\u529f\u4fe1\u53f7\n        self.connection_status_changed.emit(True)\n        return True\n\n    except Exception as e:\n        self.disconnect_port()\n        raise Exception(f\"\u8fde\u63a5\u5931\u8d25: {str(e)}\")\n</code></pre>"},{"location":"api/domain/communication/#controller.domain.services.communication.serial_domain_service.SerialDomainService.disconnect_port","title":"disconnect_port","text":"<pre><code>disconnect_port() -&gt; bool\n</code></pre> <p>\u65ad\u5f00\u4e32\u53e3\u8fde\u63a5</p> \u8fd4\u56de <p>bool: \u65ad\u5f00\u662f\u5426\u6210\u529f</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code> <pre><code>def disconnect_port(self) -&gt; bool:\n    \"\"\"\n    \u65ad\u5f00\u4e32\u53e3\u8fde\u63a5\n\n    \u8fd4\u56de:\n        bool: \u65ad\u5f00\u662f\u5426\u6210\u529f\n    \"\"\"\n    try:\n        # \u505c\u6b62\u7ebf\u7a0b\n        self._stop_threads()\n\n        # \u65ad\u5f00\u4fe1\u53f7\u8fde\u63a5\n        self._disconnect_infrastructure_signals()\n\n        # \u505c\u6b62\u8bfb\u5199\u5668\n        if self.serial_reader:\n            self.serial_reader.stop()\n            self.serial_reader = None\n\n        if self.serial_writer:\n            self.serial_writer.stop()\n            self.serial_writer = None\n\n        # \u65ad\u5f00\u9002\u914d\u5668\u8fde\u63a5\n        success = self.serial_adapter.disconnect()\n\n        # \u53d1\u9001\u65ad\u5f00\u8fde\u63a5\u4fe1\u53f7\n        self.connection_status_changed.emit(False)\n        return success\n\n    except Exception as e:\n        raise Exception(f\"\u65ad\u5f00\u8fde\u63a5\u5931\u8d25: {str(e)}\")\n</code></pre>"},{"location":"api/domain/communication/#controller.domain.services.communication.serial_domain_service.SerialDomainService.send_data","title":"send_data","text":"<pre><code>send_data(data: str) -&gt; bool\n</code></pre> <p>\u53d1\u9001\u6570\u636e</p> \u53c2\u6570 <p>data: \u8981\u53d1\u9001\u7684\u6570\u636e</p> \u8fd4\u56de <p>bool: \u662f\u5426\u6210\u529f\u6dfb\u52a0\u5230\u53d1\u9001\u961f\u5217</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code> <pre><code>def send_data(self, data: str) -&gt; bool:\n    \"\"\"\n    \u53d1\u9001\u6570\u636e\n\n    \u53c2\u6570:\n        data: \u8981\u53d1\u9001\u7684\u6570\u636e\n\n    \u8fd4\u56de:\n        bool: \u662f\u5426\u6210\u529f\u6dfb\u52a0\u5230\u53d1\u9001\u961f\u5217\n    \"\"\"\n    if self.serial_writer and self.is_connected():\n        self.serial_writer.add_to_queue(data)\n        return True\n    else:\n        raise Exception(\"\u4e32\u53e3\u672a\u8fde\u63a5\uff0c\u65e0\u6cd5\u53d1\u9001\u6570\u636e\")\n</code></pre>"},{"location":"api/domain/communication/#controller.domain.services.communication.serial_domain_service.SerialDomainService.cleanup","title":"cleanup","text":"<pre><code>cleanup() -&gt; None\n</code></pre> <p>\u6e05\u7406\u8d44\u6e90</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code> <pre><code>def cleanup(self) -&gt; None:\n    \"\"\"\u6e05\u7406\u8d44\u6e90\"\"\"\n    try:\n        self.disconnect_port()\n    except Exception:\n        pass  # \u5ffd\u7565\u6e05\u7406\u65f6\u7684\u5f02\u5e38\n</code></pre>"},{"location":"api/domain/entities/","title":"Domain Layer - Entities","text":""},{"location":"api/domain/entities/#controller.domain.entities.motion_plan","title":"controller.domain.entities.motion_plan","text":"<p>\u8fd0\u52a8\u89c4\u5212\u65b9\u6848\u5b9e\u4f53</p>"},{"location":"api/domain/entities/#controller.domain.entities.motion_plan.MotionPlan","title":"MotionPlan  <code>dataclass</code>","text":"<pre><code>MotionPlan(name: str, points: List[dict] = list())\n</code></pre> <p>\u8fd0\u52a8\u89c4\u5212\u65b9\u6848\u5b9e\u4f53\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>name</code> <code>str</code> <p>\u65b9\u6848\u540d\u79f0\u3002</p> <code>points</code> <code>List[dict]</code> <p>\u8282\u70b9\u5217\u8868\u3002</p>"},{"location":"api/domain/entities/#controller.domain.entities.motion_plan.MotionPlan.add_point","title":"add_point","text":"<pre><code>add_point(point_data: dict)\n</code></pre> <p>\u6dfb\u52a0\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>point_data</code> <code>dict</code> <p>\u8282\u70b9\u6570\u636e\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/entities/motion_plan.py</code> <pre><code>def add_point(self, point_data: dict):\n    \"\"\"\u6dfb\u52a0\u8282\u70b9\u3002\n\n    Args:\n        point_data (dict): \u8282\u70b9\u6570\u636e\u3002\n    \"\"\"\n    self.points.append(point_data)\n</code></pre>"},{"location":"api/domain/entities/#controller.domain.entities.motion_plan.MotionPlan.remove_point","title":"remove_point","text":"<pre><code>remove_point(index: int)\n</code></pre> <p>\u5220\u9664\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/entities/motion_plan.py</code> <pre><code>def remove_point(self, index: int):\n    \"\"\"\u5220\u9664\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n    \"\"\"\n    if 0 &lt;= index &lt; len(self.points):\n        self.points.pop(index)\n</code></pre>"},{"location":"api/domain/entities/#controller.domain.entities.motion_plan.MotionPlan.move_point_up","title":"move_point_up","text":"<pre><code>move_point_up(index: int) -&gt; bool\n</code></pre> <p>\u4e0a\u79fb\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u6210\u529f\u79fb\u52a8\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/entities/motion_plan.py</code> <pre><code>def move_point_up(self, index: int) -&gt; bool:\n    \"\"\"\u4e0a\u79fb\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n\n    Returns:\n        bool: \u662f\u5426\u6210\u529f\u79fb\u52a8\u3002\n    \"\"\"\n    if index &gt; 0:\n        self.points[index], self.points[index-1] = \\\n            self.points[index-1], self.points[index]\n        return True\n    return False\n</code></pre>"},{"location":"api/domain/entities/#controller.domain.entities.motion_plan.MotionPlan.move_point_down","title":"move_point_down","text":"<pre><code>move_point_down(index: int) -&gt; bool\n</code></pre> <p>\u4e0b\u79fb\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u6210\u529f\u79fb\u52a8\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/entities/motion_plan.py</code> <pre><code>def move_point_down(self, index: int) -&gt; bool:\n    \"\"\"\u4e0b\u79fb\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n\n    Returns:\n        bool: \u662f\u5426\u6210\u529f\u79fb\u52a8\u3002\n    \"\"\"\n    if index &lt; len(self.points) - 1:\n        self.points[index], self.points[index+1] = \\\n            self.points[index+1], self.points[index]\n        return True\n    return False\n</code></pre>"},{"location":"api/domain/entities/#controller.domain.entities.motion_plan.MotionPlan.update_point","title":"update_point","text":"<pre><code>update_point(index: int, point_data: dict)\n</code></pre> <p>\u66f4\u65b0\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <code>point_data</code> <code>dict</code> <p>\u65b0\u7684\u8282\u70b9\u6570\u636e\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/entities/motion_plan.py</code> <pre><code>def update_point(self, index: int, point_data: dict):\n    \"\"\"\u66f4\u65b0\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n        point_data (dict): \u65b0\u7684\u8282\u70b9\u6570\u636e\u3002\n    \"\"\"\n    if 0 &lt;= index &lt; len(self.points):\n        self.points[index] = point_data\n</code></pre>"},{"location":"api/domain/motion/","title":"Domain Layer - Motion Services","text":""},{"location":"api/domain/motion/#controller.domain.services.motion.motion_constructor","title":"controller.domain.services.motion.motion_constructor","text":"<p>\u8fd0\u52a8\u6784\u9020\u5668 - Domain\u5c42 \u534f\u8c03\u8f68\u8ff9\u89c4\u5212\u548c\u8fd0\u52a8\u6267\u884c</p>"},{"location":"api/domain/motion/#controller.domain.services.motion.motion_constructor.MotionConstructor","title":"MotionConstructor","text":"<pre><code>MotionConstructor(motion_runner: MotionRunner, trajectory_planner: TrajectoryPlanningService)\n</code></pre> <p>\u8fd0\u52a8\u6784\u9020\u5668 - \u9886\u57df\u670d\u52a1\u3002</p> <p>\u804c\u8d23\uff1a 1. \u7ba1\u7406\u64cd\u4f5c\u72b6\u6001\uff08\u6267\u884c/\u4fdd\u5b58/\u9884\u89c8\uff09 2. \u534f\u8c03 TrajectoryPlanningService\uff08\u89c4\u5212\uff09 3. \u534f\u8c03 MotionRunner\uff08\u6267\u884c\uff09</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>motion_runner</code> <code>MotionRunner</code> <p>\u8fd0\u52a8\u6267\u884c\u5668\u3002</p> <code>trajectory_planner</code> <code>TrajectoryPlanningService</code> <p>\u8f68\u8ff9\u89c4\u5212\u670d\u52a1\u3002</p> <p>\u521d\u59cb\u5316\u8fd0\u52a8\u6784\u9020\u5668\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>motion_runner</code> <code>MotionRunner</code> <p>\u8fd0\u52a8\u6267\u884c\u5668\u3002</p> \u5fc5\u9700 <code>trajectory_planner</code> <code>TrajectoryPlanningService</code> <p>\u8f68\u8ff9\u89c4\u5212\u670d\u52a1\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_constructor.py</code> <pre><code>def __init__(\n    self, \n    motion_runner: MotionRunner,\n    trajectory_planner: TrajectoryPlanningService\n):\n    \"\"\"\u521d\u59cb\u5316\u8fd0\u52a8\u6784\u9020\u5668\u3002\n\n    Args:\n        motion_runner (MotionRunner): \u8fd0\u52a8\u6267\u884c\u5668\u3002\n        trajectory_planner (TrajectoryPlanningService): \u8f68\u8ff9\u89c4\u5212\u670d\u52a1\u3002\n    \"\"\"\n    self.motion_runner = motion_runner\n    self.trajectory_planner = trajectory_planner\n\n    # \u7edf\u4e00\u7684\u64cd\u4f5c\u72b6\u6001\n    self._operation_mode = MotionOperationMode.NONE\n    self._pending_tasks = []\n    self._operation_context = {}\n</code></pre>"},{"location":"api/domain/motion/#controller.domain.services.motion.motion_constructor.MotionConstructor.prepare_operation","title":"prepare_operation","text":"<pre><code>prepare_operation(mode: MotionOperationMode, tasks: List[Dict], context: Dict = None)\n</code></pre> <p>\u51c6\u5907\u64cd\u4f5c\uff08\u7edf\u4e00\u5165\u53e3\uff09\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>mode</code> <code>MotionOperationMode</code> <p>\u64cd\u4f5c\u6a21\u5f0f\u3002 - EXECUTE: \u6267\u884c\u8fd0\u52a8 - SAVE: \u4fdd\u5b58\u8f68\u8ff9 - PREVIEW: \u9884\u89c8\u8f68\u8ff9</p> \u5fc5\u9700 <code>tasks</code> <code>List[Dict]</code> <p>\u4efb\u52a1\u5217\u8868\u3002</p> \u5fc5\u9700 <code>context</code> <code>Dict</code> <p>\u64cd\u4f5c\u4e0a\u4e0b\u6587\u3002 - EXECUTE: {} - SAVE: {\"filename\": \"xxx\", \"type\": \"node|plan\"} - PREVIEW: {\"type\": \"node|plan\", \"node_index\": 0}</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_constructor.py</code> <pre><code>def prepare_operation(\n    self,\n    mode: MotionOperationMode,\n    tasks: List[Dict],\n    context: Dict = None\n):\n    \"\"\"\u51c6\u5907\u64cd\u4f5c\uff08\u7edf\u4e00\u5165\u53e3\uff09\u3002\n\n    Args:\n        mode (MotionOperationMode): \u64cd\u4f5c\u6a21\u5f0f\u3002\n            - EXECUTE: \u6267\u884c\u8fd0\u52a8\n            - SAVE: \u4fdd\u5b58\u8f68\u8ff9\n            - PREVIEW: \u9884\u89c8\u8f68\u8ff9\n        tasks (List[Dict]): \u4efb\u52a1\u5217\u8868\u3002\n        context (Dict, optional): \u64cd\u4f5c\u4e0a\u4e0b\u6587\u3002\n            - EXECUTE: {}\n            - SAVE: {\"filename\": \"xxx\", \"type\": \"node|plan\"}\n            - PREVIEW: {\"type\": \"node|plan\", \"node_index\": 0}\n    \"\"\"\n    self._operation_mode = mode\n    self._pending_tasks = tasks.copy()\n    self._operation_context = context or {}\n</code></pre>"},{"location":"api/domain/motion/#controller.domain.services.motion.motion_constructor.MotionConstructor.has_pending_operation","title":"has_pending_operation","text":"<pre><code>has_pending_operation() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u662f\u5426\u6709\u5f85\u5904\u7406\u7684\u64cd\u4f5c\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u6709\u5f85\u5904\u7406\u7684\u64cd\u4f5c, False=\u65e0\u64cd\u4f5c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_constructor.py</code> <pre><code>def has_pending_operation(self) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u662f\u5426\u6709\u5f85\u5904\u7406\u7684\u64cd\u4f5c\u3002\n\n    Returns:\n        bool: True=\u6709\u5f85\u5904\u7406\u7684\u64cd\u4f5c, False=\u65e0\u64cd\u4f5c\u3002\n    \"\"\"\n    return self._operation_mode != MotionOperationMode.NONE\n</code></pre>"},{"location":"api/domain/motion/#controller.domain.services.motion.motion_constructor.MotionConstructor.get_operation_mode","title":"get_operation_mode","text":"<pre><code>get_operation_mode() -&gt; MotionOperationMode\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u64cd\u4f5c\u6a21\u5f0f\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>MotionOperationMode</code> <code>MotionOperationMode</code> <p>\u5f53\u524d\u64cd\u4f5c\u6a21\u5f0f\u679a\u4e3e\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_constructor.py</code> <pre><code>def get_operation_mode(self) -&gt; MotionOperationMode:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u64cd\u4f5c\u6a21\u5f0f\u3002\n\n    Returns:\n        MotionOperationMode: \u5f53\u524d\u64cd\u4f5c\u6a21\u5f0f\u679a\u4e3e\u3002\n    \"\"\"\n    return self._operation_mode\n</code></pre>"},{"location":"api/domain/motion/#controller.domain.services.motion.motion_constructor.MotionConstructor.get_pending_tasks","title":"get_pending_tasks","text":"<pre><code>get_pending_tasks() -&gt; List[Dict]\n</code></pre> <p>\u83b7\u53d6\u5f85\u5904\u7406\u7684\u4efb\u52a1\u5217\u8868\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[Dict]</code> <p>List[Dict]: \u4efb\u52a1\u5217\u8868\u7684\u526f\u672c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_constructor.py</code> <pre><code>def get_pending_tasks(self) -&gt; List[Dict]:\n    \"\"\"\u83b7\u53d6\u5f85\u5904\u7406\u7684\u4efb\u52a1\u5217\u8868\u3002\n\n    Returns:\n        List[Dict]: \u4efb\u52a1\u5217\u8868\u7684\u526f\u672c\u3002\n    \"\"\"\n    return self._pending_tasks.copy()\n</code></pre>"},{"location":"api/domain/motion/#controller.domain.services.motion.motion_constructor.MotionConstructor.get_operation_context","title":"get_operation_context","text":"<pre><code>get_operation_context() -&gt; Dict\n</code></pre> <p>\u83b7\u53d6\u64cd\u4f5c\u4e0a\u4e0b\u6587\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Dict</code> <code>Dict</code> <p>\u4e0a\u4e0b\u6587\u5b57\u5178\u7684\u526f\u672c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_constructor.py</code> <pre><code>def get_operation_context(self) -&gt; Dict:\n    \"\"\"\u83b7\u53d6\u64cd\u4f5c\u4e0a\u4e0b\u6587\u3002\n\n    Returns:\n        Dict: \u4e0a\u4e0b\u6587\u5b57\u5178\u7684\u526f\u672c\u3002\n    \"\"\"\n    return self._operation_context.copy()\n</code></pre>"},{"location":"api/domain/motion/#controller.domain.services.motion.motion_constructor.MotionConstructor.clear_operation","title":"clear_operation","text":"<pre><code>clear_operation()\n</code></pre> <p>\u6e05\u9664\u64cd\u4f5c\u72b6\u6001\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_constructor.py</code> <pre><code>def clear_operation(self):\n    \"\"\"\u6e05\u9664\u64cd\u4f5c\u72b6\u6001\u3002\"\"\"\n    self._operation_mode = MotionOperationMode.NONE\n    self._pending_tasks.clear()\n    self._operation_context.clear()\n</code></pre>"},{"location":"api/domain/motion/#controller.domain.services.motion.motion_constructor.MotionConstructor.execute_motion","title":"execute_motion","text":"<pre><code>execute_motion(start_position: List[float])\n</code></pre> <p>\u6267\u884c\u8fd0\u52a8\uff08\u4ec5\u7528\u4e8eEXECUTE\u6a21\u5f0f\uff09\u3002</p> <p>\u6d41\u7a0b\uff1a 1. \u6309\u4efb\u52a1\u987a\u5e8f\u89c4\u5212\u6bcf\u4e2a\u4efb\u52a1 2. \u6309\u987a\u5e8f\u6dfb\u52a0\u8fd0\u52a8\u6570\u636e\u548c\u5939\u722a\u547d\u4ee4 3. \u6e05\u9664\u72b6\u6001</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>start_position</code> <code>List[float]</code> <p>\u8d77\u59cb\u4f4d\u7f6e\uff08\u5f53\u524d\u5173\u8282\u89d2\u5ea6\uff09\u3002</p> \u5fc5\u9700 <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>RuntimeError</code> <p>\u5982\u679c\u5f53\u524d\u6a21\u5f0f\u4e0d\u662fEXECUTE\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_constructor.py</code> <pre><code>def execute_motion(self, start_position: List[float]):\n    \"\"\"\u6267\u884c\u8fd0\u52a8\uff08\u4ec5\u7528\u4e8eEXECUTE\u6a21\u5f0f\uff09\u3002\n\n    \u6d41\u7a0b\uff1a\n    1. \u6309\u4efb\u52a1\u987a\u5e8f\u89c4\u5212\u6bcf\u4e2a\u4efb\u52a1\n    2. \u6309\u987a\u5e8f\u6dfb\u52a0\u8fd0\u52a8\u6570\u636e\u548c\u5939\u722a\u547d\u4ee4\n    3. \u6e05\u9664\u72b6\u6001\n\n    Args:\n        start_position (List[float]): \u8d77\u59cb\u4f4d\u7f6e\uff08\u5f53\u524d\u5173\u8282\u89d2\u5ea6\uff09\u3002\n\n    Raises:\n        RuntimeError: \u5982\u679c\u5f53\u524d\u6a21\u5f0f\u4e0d\u662fEXECUTE\u3002\n    \"\"\"\n    if self._operation_mode != MotionOperationMode.EXECUTE:\n        raise RuntimeError(f\"\u5f53\u524d\u6a21\u5f0f\u4e0d\u662fEXECUTE: {self._operation_mode}\")\n\n    if not self._pending_tasks:\n        return\n\n    # \u6267\u884c\n    self.motion_runner.clear_data()\n\n    # \u6309\u987a\u5e8f\u5904\u7406\u6bcf\u4e2a\u4efb\u52a1\uff0c\u4fdd\u6301\u539f\u6709\u987a\u5e8f\n    current_position = start_position\n\n    for task in self._pending_tasks:\n        if task[\"type\"] == \"gripper\":\n            # \u5939\u722a\u4efb\u52a1\uff1a\u76f4\u63a5\u6dfb\u52a0\u5939\u722a\u547d\u4ee4\uff08\u5e26\u5ef6\u8fdf\uff09\n            effector_mode = task[\"effector_mode\"]\n            effector_data = task[\"effector_data\"]\n            pre_delay = task.get(\"pre_delay\", 0.0)\n            post_delay = task.get(\"post_delay\", 1.0)\n            self.motion_runner.add_gripper_data(\n                effector_mode, \n                effector_data,\n                pre_delay=pre_delay,\n                post_delay=post_delay\n            )\n        else:\n            # \u8fd0\u52a8\u4efb\u52a1\uff1a\u89c4\u5212\u8f68\u8ff9\u5e76\u6dfb\u52a0\n            positions, end_position = self.trajectory_planner._plan_single_task(\n                task, \n                current_position\n            )\n            # \u6ce8\u610f\uff1apositions \u53ef\u80fd\u662f numpy \u6570\u7ec4\uff0c\u4e0d\u80fd\u76f4\u63a5\u7528 if positions\n            if len(positions) &gt; 0:\n                self.motion_runner.add_motion_data(positions)\n                current_position = end_position\n\n    self.motion_runner.start_motion()\n\n    # \u6e05\u7406\n    self.clear_operation()\n</code></pre>"},{"location":"api/domain/motion/#controller.domain.services.motion.motion_runner","title":"controller.domain.services.motion.motion_runner","text":""},{"location":"api/domain/motion/#controller.domain.services.motion.motion_runner.MotionRunner","title":"MotionRunner","text":"<pre><code>MotionRunner(serial_domain_service: SerialDomainService, message_domain_service: MessageDomainService)\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u8fd0\u52a8\u6267\u884c\u5668\u3002</p> <p>\u8d1f\u8d23\u6309\u65f6\u95f4\u6b65\u957f\u5b9a\u65f6\u53d1\u9001\u8fd0\u52a8\u548c\u5939\u722a\u6307\u4ee4\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>motion_msg_signal</code> <code>pyqtSignal</code> <p>\u8fd0\u52a8\u6d88\u606f\u53d1\u9001\u4fe1\u53f7\uff0c\u643a\u5e26 (\u6d88\u606f\u5185\u5bb9, \u7c7b\u578b)\u3002</p> <code>serial_domain_service</code> <p>\u4e32\u53e3\u9886\u57df\u670d\u52a1\u3002</p> <code>message_domain_service</code> <p>\u6d88\u606f\u9886\u57df\u670d\u52a1\u3002</p> <code>data_list</code> <code>list</code> <p>\u5f85\u53d1\u9001\u7684\u6570\u636e\u5217\u8868\u3002</p> <code>data_index</code> <code>int</code> <p>\u5f53\u524d\u53d1\u9001\u7d22\u5f15\u3002</p> <code>timer</code> <code>QTimer</code> <p>\u5b9a\u65f6\u5668\u3002</p> <p>\u521d\u59cb\u5316\u8fd0\u52a8\u6267\u884c\u5668\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_runner.py</code> <pre><code>def __init__(\n    self, \n    serial_domain_service: SerialDomainService, \n    message_domain_service: MessageDomainService):\n    \"\"\"\u521d\u59cb\u5316\u8fd0\u52a8\u6267\u884c\u5668\u3002\"\"\"\n    super().__init__()\n    self.serial_domain_service = serial_domain_service\n    self.message_domain_service = message_domain_service\n    self.data_list = []\n    self.data_index = 0\n    self.timer = QTimer()\n    self.timer.setInterval(10)\n    self.timer.timeout.connect(self.motion_timeout)\n</code></pre>"},{"location":"api/domain/motion/#controller.domain.services.motion.motion_runner.MotionRunner.add_motion_data","title":"add_motion_data","text":"<pre><code>add_motion_data(positions)\n</code></pre> <p>\u6dfb\u52a0\u8fd0\u52a8\u6570\u636e\u70b9\u5e8f\u5217\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>positions</code> <code>list | ndarray</code> <p>\u5173\u8282\u89d2\u5ea6\u5217\u8868\u5e8f\u5217\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_runner.py</code> <pre><code>def add_motion_data(self, positions):\n    \"\"\"\u6dfb\u52a0\u8fd0\u52a8\u6570\u636e\u70b9\u5e8f\u5217\u3002\n\n    Args:\n        positions (list | np.ndarray): \u5173\u8282\u89d2\u5ea6\u5217\u8868\u5e8f\u5217\u3002\n    \"\"\"\n    for position in positions:\n        msg_dict = {\n            'control': 0x06,\n            'mode': 0x08,\n            'joint_angles': list(position)\n        }\n        message = self.message_domain_service.encode_message(**msg_dict)\n        self.data_list.append(message)\n</code></pre>"},{"location":"api/domain/motion/#controller.domain.services.motion.motion_runner.MotionRunner.add_gripper_data","title":"add_gripper_data","text":"<pre><code>add_gripper_data(effector_mode, effector_data, pre_delay=0.0, post_delay=1.0)\n</code></pre> <p>\u6dfb\u52a0\u5939\u722a\u547d\u4ee4\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>effector_mode</code> <code>int</code> <p>\u5939\u722a\u6a21\u5f0f\u3002</p> \u5fc5\u9700 <code>effector_data</code> <code>float</code> <p>\u5939\u722a\u53c2\u6570\u3002</p> \u5fc5\u9700 <code>pre_delay</code> <code>float</code> <p>\u524d\u7f6e\u7b49\u5f85\u65f6\u95f4\uff08\u79d2\uff09. Defaults to 0.0.</p> <code>0.0</code> <code>post_delay</code> <code>float</code> <p>\u540e\u7f6e\u7b49\u5f85\u65f6\u95f4\uff08\u79d2\uff09. Defaults to 1.0.</p> <code>1.0</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_runner.py</code> <pre><code>def add_gripper_data(self, effector_mode, effector_data, pre_delay=0.0, post_delay=1.0):\n    \"\"\"\u6dfb\u52a0\u5939\u722a\u547d\u4ee4\u3002\n\n    Args:\n        effector_mode (int): \u5939\u722a\u6a21\u5f0f\u3002\n        effector_data (float): \u5939\u722a\u53c2\u6570\u3002\n        pre_delay (float, optional): \u524d\u7f6e\u7b49\u5f85\u65f6\u95f4\uff08\u79d2\uff09. Defaults to 0.0.\n        post_delay (float, optional): \u540e\u7f6e\u7b49\u5f85\u65f6\u95f4\uff08\u79d2\uff09. Defaults to 1.0.\n    \"\"\"\n    # \u6dfb\u52a0\u524d\u7f6e\u5ef6\u8fdf\uff08\u5982\u679c&gt;0\uff09\n    if pre_delay &gt; 0:\n        self.data_list.append(DelayCommand(delay_s=pre_delay))\n\n    # \u6dfb\u52a0\u5939\u722a\u547d\u4ee4\n    msg_dict = {\n        'control': 0x00,\n        'mode': 0x08,\n        'effector_mode': effector_mode,\n        'effector_data': effector_data\n    }\n    message = self.message_domain_service.encode_message(**msg_dict)\n    self.data_list.append(message)\n\n    # \u6dfb\u52a0\u540e\u7f6e\u5ef6\u8fdf\uff08\u5982\u679c&gt;0\uff09\n    if post_delay &gt; 0:\n        self.data_list.append(DelayCommand(delay_s=post_delay))\n</code></pre>"},{"location":"api/domain/motion/#controller.domain.services.motion.motion_runner.MotionRunner.start_motion","title":"start_motion","text":"<pre><code>start_motion()\n</code></pre> <p>\u5f00\u59cb\u6267\u884c\u8fd0\u52a8\u5e8f\u5217\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_runner.py</code> <pre><code>def start_motion(self):\n    \"\"\"\u5f00\u59cb\u6267\u884c\u8fd0\u52a8\u5e8f\u5217\u3002\"\"\"\n    self.data_index = 0\n    self.timer.start()\n</code></pre>"},{"location":"api/domain/motion/#controller.domain.services.motion.motion_runner.MotionRunner.stop_motion","title":"stop_motion","text":"<pre><code>stop_motion()\n</code></pre> <p>\u505c\u6b62\u6267\u884c\u8fd0\u52a8\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_runner.py</code> <pre><code>def stop_motion(self):\n    \"\"\"\u505c\u6b62\u6267\u884c\u8fd0\u52a8\u3002\"\"\"\n    self.data_index = 0\n    self.timer.stop()\n</code></pre>"},{"location":"api/domain/motion/#controller.domain.services.motion.motion_runner.MotionRunner.clear_data","title":"clear_data","text":"<pre><code>clear_data()\n</code></pre> <p>\u6e05\u7a7a\u6240\u6709\u5f85\u53d1\u9001\u6570\u636e\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_runner.py</code> <pre><code>def clear_data(self):\n    \"\"\"\u6e05\u7a7a\u6240\u6709\u5f85\u53d1\u9001\u6570\u636e\u3002\"\"\"\n    self.data_index = 0\n    self.data_list = []\n</code></pre>"},{"location":"api/domain/motion/#controller.domain.services.motion.motion_runner.MotionRunner.motion_timeout","title":"motion_timeout","text":"<pre><code>motion_timeout()\n</code></pre> <p>\u5b9a\u65f6\u5668\u56de\u8c03\u51fd\u6570\uff0c\u8d1f\u8d23\u5355\u6b65\u53d1\u9001\u6216\u5ef6\u8fdf\u7b49\u5f85\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_runner.py</code> <pre><code>def motion_timeout(self):\n    \"\"\"\u5b9a\u65f6\u5668\u56de\u8c03\u51fd\u6570\uff0c\u8d1f\u8d23\u5355\u6b65\u53d1\u9001\u6216\u5ef6\u8fdf\u7b49\u5f85\u3002\"\"\"\n    if self.data_index &gt;= len(self.data_list):\n        self.timer.stop()\n        return\n    current_item = self.data_list[self.data_index]\n    if hasattr(current_item, 'is_delay'):\n        time.sleep(current_item.delay_s)\n    else:\n        self.serial_domain_service.send_data(current_item)\n        self.motion_msg_signal.emit(current_item, \"\u53d1\u9001\")\n    self.data_index += 1\n</code></pre>"},{"location":"api/domain/motion/#controller.domain.services.motion.trajectory_planning_service","title":"controller.domain.services.motion.trajectory_planning_service","text":"<p>\u8f68\u8ff9\u89c4\u5212\u670d\u52a1 - Domain\u5c42 \u7eaf\u7cb9\u7684\u8f68\u8ff9\u89c4\u5212\u903b\u8f91\uff0c\u4e0d\u6d89\u53ca\u6267\u884c\u6216\u6301\u4e45\u5316</p>"},{"location":"api/domain/motion/#controller.domain.services.motion.trajectory_planning_service.TrajectoryPlanningService","title":"TrajectoryPlanningService","text":"<pre><code>TrajectoryPlanningService(s_curve: SCurve, smooth_service: SmoothDomainService, linear_motion_service: LinearMotionDomainService, curve_motion_service: CurveMotionDomainService)\n</code></pre> <p>\u8f68\u8ff9\u89c4\u5212\u670d\u52a1 - \u9886\u57df\u670d\u52a1\u3002</p> <p>\u804c\u8d23\uff1a 1. \u6839\u636e\u4efb\u52a1\u7c7b\u578b\u89c4\u5212\u8f68\u8ff9\u70b9\u5e8f\u5217 2. \u7ef4\u62a4\u4f4d\u7f6e\u72b6\u6001\uff08\u8d77\u70b9-&gt;\u7ec8\u70b9\uff09 3. \u8fd4\u56de\u7eaf\u6570\u636e\uff0c\u4e0d\u6267\u884c\u4efb\u4f55\u526f\u4f5c\u7528</p> <p>\u6838\u5fc3\u539f\u5219\uff1a\u7eaf\u51fd\u6570\uff0c\u53ef\u6d4b\u8bd5\uff0c\u53ef\u590d\u7528</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>s_curve</code> <code>SCurve</code> <p>S\u66f2\u7ebf\u7b97\u6cd5\u670d\u52a1\u3002</p> <code>smooth_service</code> <code>SmoothDomainService</code> <p>\u5e73\u6ed1\u7b97\u6cd5\u670d\u52a1\u3002</p> <code>linear_motion_service</code> <code>LinearMotionDomainService</code> <p>\u76f4\u7ebf\u8fd0\u52a8\u670d\u52a1\u3002</p> <code>curve_motion_service</code> <code>CurveMotionDomainService</code> <p>\u66f2\u7ebf\u8fd0\u52a8\u670d\u52a1\u3002</p> <p>\u521d\u59cb\u5316\u8f68\u8ff9\u89c4\u5212\u670d\u52a1\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>s_curve</code> <code>SCurve</code> <p>S\u66f2\u7ebf\u7b97\u6cd5\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>smooth_service</code> <code>SmoothDomainService</code> <p>\u5e73\u6ed1\u7b97\u6cd5\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>linear_motion_service</code> <code>LinearMotionDomainService</code> <p>\u76f4\u7ebf\u8fd0\u52a8\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>curve_motion_service</code> <code>CurveMotionDomainService</code> <p>\u66f2\u7ebf\u8fd0\u52a8\u670d\u52a1\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/trajectory_planning_service.py</code> <pre><code>def __init__(\n    self,\n    s_curve: SCurve,\n    smooth_service: SmoothDomainService,\n    linear_motion_service: LinearMotionDomainService,\n    curve_motion_service: CurveMotionDomainService\n):\n    \"\"\"\u521d\u59cb\u5316\u8f68\u8ff9\u89c4\u5212\u670d\u52a1\u3002\n\n    Args:\n        s_curve (SCurve): S\u66f2\u7ebf\u7b97\u6cd5\u670d\u52a1\u3002\n        smooth_service (SmoothDomainService): \u5e73\u6ed1\u7b97\u6cd5\u670d\u52a1\u3002\n        linear_motion_service (LinearMotionDomainService): \u76f4\u7ebf\u8fd0\u52a8\u670d\u52a1\u3002\n        curve_motion_service (CurveMotionDomainService): \u66f2\u7ebf\u8fd0\u52a8\u670d\u52a1\u3002\n    \"\"\"\n    self.s_curve = s_curve\n    self.smooth_service = smooth_service\n    self.linear_motion_service = linear_motion_service\n    self.curve_motion_service = curve_motion_service\n</code></pre>"},{"location":"api/domain/motion/#controller.domain.services.motion.trajectory_planning_service.TrajectoryPlanningService.plan_task_sequence","title":"plan_task_sequence","text":"<pre><code>plan_task_sequence(tasks: List[Dict], start_position: List[float]) -&gt; List[List[float]]\n</code></pre> <p>\u89c4\u5212\u4efb\u52a1\u5e8f\u5217\uff08\u4ec5\u8fd4\u56de\u4f4d\u7f6e\uff09\u3002</p> <p>\u7528\u4e8e\uff1a\u6267\u884c\u8fd0\u52a8\u3001\u4fdd\u5b58\u8f68\u8ff9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>tasks</code> <code>List[Dict]</code> <p>\u4efb\u52a1\u5217\u8868\u3002</p> \u5fc5\u9700 <code>start_position</code> <code>List[float]</code> <p>\u8d77\u59cb\u4f4d\u7f6e\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[List[float]]</code> <p>List[List[float]]: \u8f68\u8ff9\u70b9\u5e8f\u5217 [[q1,...,q6], ...]\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/trajectory_planning_service.py</code> <pre><code>def plan_task_sequence(\n    self,\n    tasks: List[Dict],\n    start_position: List[float]\n) -&gt; List[List[float]]:\n    \"\"\"\u89c4\u5212\u4efb\u52a1\u5e8f\u5217\uff08\u4ec5\u8fd4\u56de\u4f4d\u7f6e\uff09\u3002\n\n    \u7528\u4e8e\uff1a\u6267\u884c\u8fd0\u52a8\u3001\u4fdd\u5b58\u8f68\u8ff9\u3002\n\n    Args:\n        tasks (List[Dict]): \u4efb\u52a1\u5217\u8868\u3002\n        start_position (List[float]): \u8d77\u59cb\u4f4d\u7f6e\u3002\n\n    Returns:\n        List[List[float]]: \u8f68\u8ff9\u70b9\u5e8f\u5217 [[q1,...,q6], ...]\u3002\n    \"\"\"\n    all_positions = []\n    current_position = start_position\n\n    for task in tasks:\n        positions, end_position = self._plan_single_task(task, current_position)\n        all_positions.extend(positions)\n        current_position = end_position\n\n    return all_positions\n</code></pre>"},{"location":"api/domain/motion/#controller.domain.services.motion.trajectory_planning_service.TrajectoryPlanningService.plan_task_sequence_with_derivatives","title":"plan_task_sequence_with_derivatives","text":"<pre><code>plan_task_sequence_with_derivatives(tasks: List[Dict], start_position: List[float]) -&gt; Dict\n</code></pre> <p>\u89c4\u5212\u4efb\u52a1\u5e8f\u5217\uff08\u8fd4\u56de\u4f4d\u7f6e\u3001\u901f\u5ea6\u3001\u52a0\u901f\u5ea6\u3001\u65f6\u95f4\uff09\u3002</p> <p>\u7528\u4e8e\uff1a\u9884\u89c8\u8f68\u8ff9\u66f2\u7ebf\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>tasks</code> <code>List[Dict]</code> <p>\u4efb\u52a1\u5217\u8868\u3002</p> \u5fc5\u9700 <code>start_position</code> <code>List[float]</code> <p>\u8d77\u59cb\u4f4d\u7f6e\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Dict</code> <code>Dict</code> <p>\u5305\u542b\u4ee5\u4e0b\u952e\u7684\u5b57\u5178: - time: [t0, t1, ...] - positions: [[q1,...,q6], ...] - velocities: [[qd1,...,qd6], ...] - accelerations: [[qdd1,...,qdd6], ...]</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/trajectory_planning_service.py</code> <pre><code>def plan_task_sequence_with_derivatives(\n    self,\n    tasks: List[Dict],\n    start_position: List[float]\n) -&gt; Dict:\n    \"\"\"\u89c4\u5212\u4efb\u52a1\u5e8f\u5217\uff08\u8fd4\u56de\u4f4d\u7f6e\u3001\u901f\u5ea6\u3001\u52a0\u901f\u5ea6\u3001\u65f6\u95f4\uff09\u3002\n\n    \u7528\u4e8e\uff1a\u9884\u89c8\u8f68\u8ff9\u66f2\u7ebf\u3002\n\n    Args:\n        tasks (List[Dict]): \u4efb\u52a1\u5217\u8868\u3002\n        start_position (List[float]): \u8d77\u59cb\u4f4d\u7f6e\u3002\n\n    Returns:\n        Dict: \u5305\u542b\u4ee5\u4e0b\u952e\u7684\u5b57\u5178:\n            - time: [t0, t1, ...]\n            - positions: [[q1,...,q6], ...]\n            - velocities: [[qd1,...,qd6], ...]\n            - accelerations: [[qdd1,...,qdd6], ...]\n    \"\"\"\n    all_time = []\n    all_positions = []\n    all_velocities = []\n    all_accelerations = []\n\n    current_position = start_position\n    current_time = 0.0\n\n    for task in tasks:\n        result = self._plan_single_task_full(task, current_position)\n\n        # \u5408\u5e76\u6570\u636e\uff08\u65f6\u95f4\u7d2f\u52a0\uff09\n        all_time.extend([t + current_time for t in result[\"time\"]])\n        all_positions.extend(result[\"positions\"])\n        all_velocities.extend(result[\"velocities\"])\n        all_accelerations.extend(result[\"accelerations\"])\n\n        # \u66f4\u65b0\u72b6\u6001\n        if len(result[\"positions\"]) &gt; 0:\n            current_position = result[\"positions\"][-1]\n            if len(result[\"time\"]) &gt; 0:\n                current_time = all_time[-1]\n\n    return {\n        \"time\": all_time,\n        \"positions\": all_positions,\n        \"velocities\": all_velocities,\n        \"accelerations\": all_accelerations\n    }\n</code></pre>"},{"location":"api/domain/planning/","title":"Domain Layer - Planning Services","text":""},{"location":"api/domain/planning/#controller.domain.services.planning.motion_planning_domain_service","title":"controller.domain.services.planning.motion_planning_domain_service","text":"<p>\u8fd0\u52a8\u89c4\u5212Domain\u670d\u52a1</p>"},{"location":"api/domain/planning/#controller.domain.services.planning.motion_planning_domain_service.MotionPlanningDomainService","title":"MotionPlanningDomainService","text":"<pre><code>MotionPlanningDomainService()\n</code></pre> <p>\u8fd0\u52a8\u89c4\u5212Domain\u670d\u52a1\u3002</p> <p>\u804c\u8d23\uff1a 1. \u7ba1\u7406\u591a\u4e2a\u65b9\u6848\uff08\u5185\u5b58\uff09 2. \u7ef4\u62a4\u5f53\u524d\u6fc0\u6d3b\u7684\u65b9\u6848 3. \u63d0\u4f9b\u65b9\u6848\u548c\u8282\u70b9\u7684\u589e\u5220\u6539\u67e5 4. \u5b9e\u65bd\u4e1a\u52a1\u89c4\u5219</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>_plans</code> <code>List[MotionPlan]</code> <p>\u65b9\u6848\u5217\u8868\u3002</p> <code>_current_index</code> <code>int</code> <p>\u5f53\u524d\u6fc0\u6d3b\u65b9\u6848\u7684\u7d22\u5f15\u3002</p> <p>\u521d\u59cb\u5316\u670d\u52a1\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def __init__(self):\n    \"\"\"\u521d\u59cb\u5316\u670d\u52a1\u3002\"\"\"\n    self._plans: List[MotionPlan] = []\n    self._current_index: int = -1\n</code></pre>"},{"location":"api/domain/planning/#controller.domain.services.planning.motion_planning_domain_service.MotionPlanningDomainService.initialize","title":"initialize","text":"<pre><code>initialize(plans: List[MotionPlan], current_index: int)\n</code></pre> <p>\u521d\u59cb\u5316\u6570\u636e\uff08\u4eceRepository\u52a0\u8f7d\u540e\u8c03\u7528\uff09\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>plans</code> <code>List[MotionPlan]</code> <p>\u65b9\u6848\u5217\u8868\u3002</p> \u5fc5\u9700 <code>current_index</code> <code>int</code> <p>\u5f53\u524d\u65b9\u6848\u7d22\u5f15\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def initialize(self, plans: List[MotionPlan], current_index: int):\n    \"\"\"\u521d\u59cb\u5316\u6570\u636e\uff08\u4eceRepository\u52a0\u8f7d\u540e\u8c03\u7528\uff09\u3002\n\n    Args:\n        plans (List[MotionPlan]): \u65b9\u6848\u5217\u8868\u3002\n        current_index (int): \u5f53\u524d\u65b9\u6848\u7d22\u5f15\u3002\n    \"\"\"\n    self._plans = plans\n    self._current_index = current_index if plans else -1\n</code></pre>"},{"location":"api/domain/planning/#controller.domain.services.planning.motion_planning_domain_service.MotionPlanningDomainService.get_all_plans","title":"get_all_plans","text":"<pre><code>get_all_plans() -&gt; List[MotionPlan]\n</code></pre> <p>\u83b7\u53d6\u6240\u6709\u65b9\u6848\uff08\u7528\u4e8e\u6301\u4e45\u5316\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[MotionPlan]</code> <p>List[MotionPlan]: \u65b9\u6848\u5217\u8868\u7684\u526f\u672c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def get_all_plans(self) -&gt; List[MotionPlan]:\n    \"\"\"\u83b7\u53d6\u6240\u6709\u65b9\u6848\uff08\u7528\u4e8e\u6301\u4e45\u5316\uff09\u3002\n\n    Returns:\n        List[MotionPlan]: \u65b9\u6848\u5217\u8868\u7684\u526f\u672c\u3002\n    \"\"\"\n    return self._plans.copy()\n</code></pre>"},{"location":"api/domain/planning/#controller.domain.services.planning.motion_planning_domain_service.MotionPlanningDomainService.create_plan","title":"create_plan","text":"<pre><code>create_plan(name: str) -&gt; int\n</code></pre> <p>\u521b\u5efa\u65b9\u6848\uff0c\u8fd4\u56de\u7d22\u5f15\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>name</code> <code>str</code> <p>\u65b9\u6848\u540d\u79f0\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>int</code> <code>int</code> <p>\u65b0\u521b\u5efa\u65b9\u6848\u7684\u7d22\u5f15\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def create_plan(self, name: str) -&gt; int:\n    \"\"\"\u521b\u5efa\u65b9\u6848\uff0c\u8fd4\u56de\u7d22\u5f15\u3002\n\n    Args:\n        name (str): \u65b9\u6848\u540d\u79f0\u3002\n\n    Returns:\n        int: \u65b0\u521b\u5efa\u65b9\u6848\u7684\u7d22\u5f15\u3002\n    \"\"\"\n    plan = MotionPlan(name=name)\n    self._plans.append(plan)\n    self._current_index = len(self._plans) - 1\n    return self._current_index\n</code></pre>"},{"location":"api/domain/planning/#controller.domain.services.planning.motion_planning_domain_service.MotionPlanningDomainService.get_plan_names","title":"get_plan_names","text":"<pre><code>get_plan_names() -&gt; List[str]\n</code></pre> <p>\u83b7\u53d6\u6240\u6709\u65b9\u6848\u540d\u79f0\uff08\u7528\u4e8e\u4e0b\u62c9\u6846\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>List[str]: \u65b9\u6848\u540d\u79f0\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def get_plan_names(self) -&gt; List[str]:\n    \"\"\"\u83b7\u53d6\u6240\u6709\u65b9\u6848\u540d\u79f0\uff08\u7528\u4e8e\u4e0b\u62c9\u6846\uff09\u3002\n\n    Returns:\n        List[str]: \u65b9\u6848\u540d\u79f0\u5217\u8868\u3002\n    \"\"\"\n    return [plan.name for plan in self._plans]\n</code></pre>"},{"location":"api/domain/planning/#controller.domain.services.planning.motion_planning_domain_service.MotionPlanningDomainService.get_current_index","title":"get_current_index","text":"<pre><code>get_current_index() -&gt; int\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u65b9\u6848\u7d22\u5f15\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>int</code> <code>int</code> <p>\u5f53\u524d\u7d22\u5f15\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def get_current_index(self) -&gt; int:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u65b9\u6848\u7d22\u5f15\u3002\n\n    Returns:\n        int: \u5f53\u524d\u7d22\u5f15\u3002\n    \"\"\"\n    return self._current_index\n</code></pre>"},{"location":"api/domain/planning/#controller.domain.services.planning.motion_planning_domain_service.MotionPlanningDomainService.set_current_index","title":"set_current_index","text":"<pre><code>set_current_index(index: int) -&gt; bool\n</code></pre> <p>\u5207\u6362\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u76ee\u6807\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u5207\u6362\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def set_current_index(self, index: int) -&gt; bool:\n    \"\"\"\u5207\u6362\u65b9\u6848\u3002\n\n    Args:\n        index (int): \u76ee\u6807\u7d22\u5f15\u3002\n\n    Returns:\n        bool: \u662f\u5426\u5207\u6362\u6210\u529f\u3002\n    \"\"\"\n    if 0 &lt;= index &lt; len(self._plans):\n        self._current_index = index\n        return True\n    return False\n</code></pre>"},{"location":"api/domain/planning/#controller.domain.services.planning.motion_planning_domain_service.MotionPlanningDomainService.delete_plan","title":"delete_plan","text":"<pre><code>delete_plan(index: int) -&gt; bool\n</code></pre> <p>\u5220\u9664\u65b9\u6848\u3002</p> <p>\u4e1a\u52a1\u89c4\u5219\uff1a\u81f3\u5c11\u4fdd\u7559\u4e00\u4e2a\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u65b9\u6848\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u5220\u9664\u6210\u529f, False=\u5220\u9664\u5931\u8d25\uff08\u8fdd\u53cd\u4e1a\u52a1\u89c4\u5219\u6216\u7d22\u5f15\u65e0\u6548\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def delete_plan(self, index: int) -&gt; bool:\n    \"\"\"\u5220\u9664\u65b9\u6848\u3002\n\n    \u4e1a\u52a1\u89c4\u5219\uff1a\u81f3\u5c11\u4fdd\u7559\u4e00\u4e2a\u65b9\u6848\u3002\n\n    Args:\n        index (int): \u65b9\u6848\u7d22\u5f15\u3002\n\n    Returns:\n        bool: True=\u5220\u9664\u6210\u529f, False=\u5220\u9664\u5931\u8d25\uff08\u8fdd\u53cd\u4e1a\u52a1\u89c4\u5219\u6216\u7d22\u5f15\u65e0\u6548\uff09\u3002\n    \"\"\"\n    # \u4e1a\u52a1\u89c4\u5219\uff1a\u81f3\u5c11\u4fdd\u7559\u4e00\u4e2a\u65b9\u6848\n    if len(self._plans) &lt;= 1:\n        return False\n\n    if 0 &lt;= index &lt; len(self._plans):\n        self._plans.pop(index)\n        # \u8c03\u6574\u5f53\u524d\u7d22\u5f15\n        if self._current_index &gt;= len(self._plans):\n            self._current_index = max(0, len(self._plans) - 1)\n        if len(self._plans) == 0:\n            self._current_index = -1\n        return True\n    return False\n</code></pre>"},{"location":"api/domain/planning/#controller.domain.services.planning.motion_planning_domain_service.MotionPlanningDomainService.can_delete_plan","title":"can_delete_plan","text":"<pre><code>can_delete_plan() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u662f\u5426\u53ef\u4ee5\u5220\u9664\u65b9\u6848\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u53ef\u4ee5\u5220\u9664, False=\u4e0d\u80fd\u5220\u9664\uff08\u53ea\u6709\u4e00\u4e2a\u65b9\u6848\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def can_delete_plan(self) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u662f\u5426\u53ef\u4ee5\u5220\u9664\u65b9\u6848\u3002\n\n    Returns:\n        bool: True=\u53ef\u4ee5\u5220\u9664, False=\u4e0d\u80fd\u5220\u9664\uff08\u53ea\u6709\u4e00\u4e2a\u65b9\u6848\uff09\u3002\n    \"\"\"\n    return len(self._plans) &gt; 1\n</code></pre>"},{"location":"api/domain/planning/#controller.domain.services.planning.motion_planning_domain_service.MotionPlanningDomainService.rename_plan","title":"rename_plan","text":"<pre><code>rename_plan(index: int, new_name: str) -&gt; bool\n</code></pre> <p>\u91cd\u547d\u540d\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u65b9\u6848\u7d22\u5f15\u3002</p> \u5fc5\u9700 <code>new_name</code> <code>str</code> <p>\u65b0\u540d\u79f0\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def rename_plan(self, index: int, new_name: str) -&gt; bool:\n    \"\"\"\u91cd\u547d\u540d\u65b9\u6848\u3002\n\n    Args:\n        index (int): \u65b9\u6848\u7d22\u5f15\u3002\n        new_name (str): \u65b0\u540d\u79f0\u3002\n\n    Returns:\n        bool: \u662f\u5426\u6210\u529f\u3002\n    \"\"\"\n    if 0 &lt;= index &lt; len(self._plans):\n        self._plans[index].name = new_name\n        return True\n    return False\n</code></pre>"},{"location":"api/domain/planning/#controller.domain.services.planning.motion_planning_domain_service.MotionPlanningDomainService.get_current_plan","title":"get_current_plan","text":"<pre><code>get_current_plan() -&gt; Optional[MotionPlan]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u65b9\u6848\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[MotionPlan]</code> <p>Optional[MotionPlan]: \u5f53\u524d\u65b9\u6848\u5bf9\u8c61\uff0c\u65e0\u65b9\u6848\u65f6\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def get_current_plan(self) -&gt; Optional[MotionPlan]:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u65b9\u6848\u3002\n\n    Returns:\n        Optional[MotionPlan]: \u5f53\u524d\u65b9\u6848\u5bf9\u8c61\uff0c\u65e0\u65b9\u6848\u65f6\u8fd4\u56de None\u3002\n    \"\"\"\n    if 0 &lt;= self._current_index &lt; len(self._plans):\n        return self._plans[self._current_index]\n    return None\n</code></pre>"},{"location":"api/domain/planning/#controller.domain.services.planning.motion_planning_domain_service.MotionPlanningDomainService.get_plan_count","title":"get_plan_count","text":"<pre><code>get_plan_count() -&gt; int\n</code></pre> <p>\u83b7\u53d6\u65b9\u6848\u6570\u91cf\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>int</code> <code>int</code> <p>\u65b9\u6848\u6570\u91cf\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def get_plan_count(self) -&gt; int:\n    \"\"\"\u83b7\u53d6\u65b9\u6848\u6570\u91cf\u3002\n\n    Returns:\n        int: \u65b9\u6848\u6570\u91cf\u3002\n    \"\"\"\n    return len(self._plans)\n</code></pre>"},{"location":"api/domain/planning/#controller.domain.services.planning.motion_planning_domain_service.MotionPlanningDomainService.add_point","title":"add_point","text":"<pre><code>add_point(point_data: dict)\n</code></pre> <p>\u6dfb\u52a0\u8282\u70b9\u5230\u5f53\u524d\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>point_data</code> <code>dict</code> <p>\u8282\u70b9\u6570\u636e\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def add_point(self, point_data: dict):\n    \"\"\"\u6dfb\u52a0\u8282\u70b9\u5230\u5f53\u524d\u65b9\u6848\u3002\n\n    Args:\n        point_data (dict): \u8282\u70b9\u6570\u636e\u3002\n    \"\"\"\n    plan = self.get_current_plan()\n    if plan:\n        plan.add_point(point_data)\n</code></pre>"},{"location":"api/domain/planning/#controller.domain.services.planning.motion_planning_domain_service.MotionPlanningDomainService.remove_point","title":"remove_point","text":"<pre><code>remove_point(index: int)\n</code></pre> <p>\u5220\u9664\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def remove_point(self, index: int):\n    \"\"\"\u5220\u9664\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n    \"\"\"\n    plan = self.get_current_plan()\n    if plan:\n        plan.remove_point(index)\n</code></pre>"},{"location":"api/domain/planning/#controller.domain.services.planning.motion_planning_domain_service.MotionPlanningDomainService.move_point_up","title":"move_point_up","text":"<pre><code>move_point_up(index: int) -&gt; bool\n</code></pre> <p>\u4e0a\u79fb\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def move_point_up(self, index: int) -&gt; bool:\n    \"\"\"\u4e0a\u79fb\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n\n    Returns:\n        bool: \u662f\u5426\u6210\u529f\u3002\n    \"\"\"\n    plan = self.get_current_plan()\n    return plan.move_point_up(index) if plan else False\n</code></pre>"},{"location":"api/domain/planning/#controller.domain.services.planning.motion_planning_domain_service.MotionPlanningDomainService.move_point_down","title":"move_point_down","text":"<pre><code>move_point_down(index: int) -&gt; bool\n</code></pre> <p>\u4e0b\u79fb\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def move_point_down(self, index: int) -&gt; bool:\n    \"\"\"\u4e0b\u79fb\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n\n    Returns:\n        bool: \u662f\u5426\u6210\u529f\u3002\n    \"\"\"\n    plan = self.get_current_plan()\n    return plan.move_point_down(index) if plan else False\n</code></pre>"},{"location":"api/domain/planning/#controller.domain.services.planning.motion_planning_domain_service.MotionPlanningDomainService.update_point","title":"update_point","text":"<pre><code>update_point(index: int, point_data: dict)\n</code></pre> <p>\u66f4\u65b0\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <code>point_data</code> <code>dict</code> <p>\u65b0\u6570\u636e\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def update_point(self, index: int, point_data: dict):\n    \"\"\"\u66f4\u65b0\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n        point_data (dict): \u65b0\u6570\u636e\u3002\n    \"\"\"\n    plan = self.get_current_plan()\n    if plan:\n        plan.update_point(index, point_data)\n</code></pre>"},{"location":"api/domain/planning/#controller.domain.services.planning.motion_planning_domain_service.MotionPlanningDomainService.get_all_points","title":"get_all_points","text":"<pre><code>get_all_points() -&gt; List[dict]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u65b9\u6848\u7684\u6240\u6709\u8282\u70b9\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[dict]</code> <p>List[dict]: \u8282\u70b9\u5217\u8868\u7684\u526f\u672c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def get_all_points(self) -&gt; List[dict]:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u65b9\u6848\u7684\u6240\u6709\u8282\u70b9\u3002\n\n    Returns:\n        List[dict]: \u8282\u70b9\u5217\u8868\u7684\u526f\u672c\u3002\n    \"\"\"\n    plan = self.get_current_plan()\n    return plan.points.copy() if plan else []\n</code></pre>"},{"location":"api/domain/state/","title":"State Domain Services","text":""},{"location":"api/domain/state/#controller.domain.services.state.robot_state_domain_service","title":"controller.domain.services.state.robot_state_domain_service","text":"<p>\u673a\u68b0\u81c2\u72b6\u6001\u9886\u57df\u670d\u52a1 - Domain\u5c42 \u7edf\u4e00\u7ba1\u7406\u673a\u68b0\u81c2\u8fd0\u884c\u65f6\u72b6\u6001</p>"},{"location":"api/domain/state/#controller.domain.services.state.robot_state_domain_service.RobotStateDomainService","title":"RobotStateDomainService","text":"<pre><code>RobotStateDomainService()\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u673a\u68b0\u81c2\u72b6\u6001\u9886\u57df\u670d\u52a1 - \u5355\u4e00\u6570\u636e\u6e90\u3002</p> <p>\u804c\u8d23\uff1a 1. \u7ef4\u62a4\u5f53\u524d\u673a\u68b0\u81c2\u72b6\u6001\uff08\u6700\u65b0\u5feb\u7167\uff09 2. \u7ef4\u62a4\u5386\u53f2\u72b6\u6001\u7f13\u51b2\uff08\u6ed1\u52a8\u7a97\u53e3\uff09 3. \u8ba1\u7b97\u9759\u6469\u64e6\u8865\u507f\uff08\u57fa\u4e8e\u5386\u53f2\u6570\u636e\uff09 4. \u53d1\u5c04\u4fe1\u53f7\u901a\u77e5\u8ba2\u9605\u8005</p> <p>\u8bbe\u8ba1\u539f\u5219\uff1a - Single Source of Truth: \u6240\u6709\u72b6\u6001\u53ea\u5728\u8fd9\u91cc\u7ef4\u62a4 - Pub-Sub Pattern: \u652f\u6301\u591a\u4e2a\u8ba2\u9605\u8005 - Thread Safe: \u4f7f\u7528\u9501\u4fdd\u62a4\u53ef\u53d8\u6570\u636e</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>state_updated</code> <code>pyqtSignal</code> <p>\u72b6\u6001\u66f4\u65b0\u4fe1\u53f7\uff0c\u643a\u5e26 RobotStateSnapshot\u3002</p> <code>angles_changed</code> <code>pyqtSignal</code> <p>\u89d2\u5ea6\u663e\u8457\u53d8\u5316\u4fe1\u53f7\uff0c\u643a\u5e26 [\u03b81, \u03b82, ..., \u03b86] \u5217\u8868\u3002</p> <code>torque_compensation_requested</code> <code>pyqtSignal</code> <p>\u529b\u77e9\u8865\u507f\u8bf7\u6c42\u4fe1\u53f7\uff0c\u643a\u5e26\u5f53\u524d\u89d2\u5ea6\u5217\u8868\u3002</p>"},{"location":"api/domain/state/#controller.domain.services.state.robot_state_domain_service.RobotStateDomainService.update_state","title":"update_state","text":"<pre><code>update_state(decoded_message)\n</code></pre> <p>\u66f4\u65b0\u673a\u68b0\u81c2\u72b6\u6001\uff08\u6838\u5fc3\u65b9\u6cd5\uff09\u3002</p> <p>\u7531 MessageResponseService \u8c03\u7528\uff0c\u6bcf\u6b21\u63a5\u6536\u5230\u4e32\u53e3\u6570\u636e\u5e76\u89e3\u7801\u540e\u8c03\u7528\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>decoded_message</code> <code>Any</code> <p>\u89e3\u7801\u540e\u7684\u6d88\u606f\u5bf9\u8c61\u3002</p> \u5fc5\u9700"},{"location":"api/domain/state/#controller.domain.services.state.robot_state_domain_service.RobotStateDomainService.get_current_state","title":"get_current_state","text":"<pre><code>get_current_state() -&gt; Optional[RobotStateSnapshot]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u72b6\u6001\u5feb\u7167\uff08\u4e0d\u53ef\u53d8\uff0c\u7ebf\u7a0b\u5b89\u5168\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[RobotStateSnapshot]</code> <p>Optional[RobotStateSnapshot]: \u5f53\u524d\u72b6\u6001\u5feb\u7167\u3002</p>"},{"location":"api/domain/state/#controller.domain.services.state.robot_state_domain_service.RobotStateDomainService.get_current_angles","title":"get_current_angles","text":"<pre><code>get_current_angles() -&gt; List[float]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u5173\u8282\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[float]</code> <p>List[float]: 6\u4e2a\u5173\u8282\u7684\u89d2\u5ea6\u5217\u8868\u3002</p>"},{"location":"api/domain/state/#controller.domain.services.state.robot_state_domain_service.RobotStateDomainService.get_current_positions","title":"get_current_positions","text":"<pre><code>get_current_positions() -&gt; List[int]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u5173\u8282\u4f4d\u7f6e\uff08\u7f16\u7801\u5668\u503c\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[int]</code> <p>List[int]: 6\u4e2a\u5173\u8282\u7684\u7f16\u7801\u5668\u4f4d\u7f6e\u5217\u8868\u3002</p>"},{"location":"api/domain/state/#controller.domain.services.state.robot_state_domain_service.RobotStateDomainService.get_position_history","title":"get_position_history","text":"<pre><code>get_position_history(count: int = 20) -&gt; List[Dict]\n</code></pre> <p>\u83b7\u53d6\u5386\u53f2\u4f4d\u7f6e\u6570\u636e\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>count</code> <code>int</code> <p>\u83b7\u53d6\u7684\u8bb0\u5f55\u6570\u91cf. Defaults to 20.</p> <code>20</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[Dict]</code> <p>List[Dict]: \u5386\u53f2\u4f4d\u7f6e\u6570\u636e\u5217\u8868\uff0c\u6bcf\u4e2a\u5143\u7d20\u5305\u542b timestamp, angles, positions\u3002</p>"},{"location":"api/domain/state/#controller.domain.services.state.robot_state_domain_service.RobotStateDomainService.get_friction_compensation","title":"get_friction_compensation","text":"<pre><code>get_friction_compensation() -&gt; List[float]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u9759\u6469\u64e6\u8865\u507f\u503c\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[float]</code> <p>List[float]: 6\u4e2a\u5173\u8282\u7684\u9759\u6469\u64e6\u8865\u507f\u503c\u5217\u8868\u3002</p>"},{"location":"api/domain/state/#controller.domain.services.state.robot_state_domain_service.RobotStateDomainService.set_teaching_mode","title":"set_teaching_mode","text":"<pre><code>set_teaching_mode(enabled: bool)\n</code></pre> <p>\u8bbe\u7f6e\u793a\u6559\u6a21\u5f0f\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>enabled</code> <code>bool</code> <p>True=\u5f00\u542f, False=\u5173\u95ed\u3002</p> \u5fc5\u9700"},{"location":"api/domain/state/#controller.domain.services.state.robot_state_domain_service.RobotStateDomainService.set_friction_config","title":"set_friction_config","text":"<pre><code>set_friction_config(config: List[float])\n</code></pre> <p>\u8bbe\u7f6e\u9759\u6469\u64e6\u914d\u7f6e\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config</code> <code>List[float]</code> <p>6\u4e2a\u5173\u8282\u7684\u9759\u6469\u64e6\u9608\u503c\u5217\u8868\u3002</p> \u5fc5\u9700"},{"location":"api/domain/state/#controller.domain.services.state.robot_state_domain_service.RobotStateDomainService.clear_history","title":"clear_history","text":"<pre><code>clear_history()\n</code></pre> <p>\u6e05\u7a7a\u5386\u53f2\u6570\u636e\u3002</p>"},{"location":"api/domain/state/#controller.domain.services.state.teach_record_domain_service","title":"controller.domain.services.state.teach_record_domain_service","text":"<p>\u793a\u6559\u8bb0\u5f55\u9886\u57df\u670d\u52a1</p>"},{"location":"api/domain/state/#controller.domain.services.state.teach_record_domain_service.TeachRecordDomainService","title":"TeachRecordDomainService","text":"<pre><code>TeachRecordDomainService()\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u793a\u6559\u8bb0\u5f55\u9886\u57df\u670d\u52a1 - Domain\u5c42\u3002</p> <p>\u804c\u8d23\uff1a 1. \u7ba1\u7406\u793a\u6559\u8bb0\u5f55\u6570\u636e\uff08\u5185\u5b58\u4e2d\uff09 2. \u63a7\u5236\u8bb0\u5f55\u7684\u5f00\u59cb/\u505c\u6b62 3. \u63d0\u4f9b\u8bb0\u5f55\u7684\u589e\u5220\u6539\u67e5\u64cd\u4f5c 4. \u751f\u6210\u8bb0\u5f55\u540d\u79f0</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>recording_state_changed</code> <code>pyqtSignal</code> <p>\u8bb0\u5f55\u72b6\u6001\u53d8\u5316\u4fe1\u53f7\uff0c\u643a\u5e26\u662f\u5426\u6b63\u5728\u8bb0\u5f55\u3002</p> <code>record_added</code> <code>pyqtSignal</code> <p>\u8bb0\u5f55\u6dfb\u52a0\u4fe1\u53f7\uff0c\u643a\u5e26\u65b0\u589e\u7684\u8bb0\u5f55\u540d\u79f0\u3002</p> <code>record_deleted</code> <code>pyqtSignal</code> <p>\u8bb0\u5f55\u5220\u9664\u4fe1\u53f7\uff0c\u643a\u5e26\u5220\u9664\u7684\u8bb0\u5f55\u540d\u79f0\u3002</p> <p>\u521d\u59cb\u5316\u793a\u6559\u8bb0\u5f55\u670d\u52a1\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def __init__(self):\n    \"\"\"\u521d\u59cb\u5316\u793a\u6559\u8bb0\u5f55\u670d\u52a1\u3002\"\"\"\n    super().__init__()\n\n    # \u8bb0\u5f55\u6570\u636e {\u8bb0\u5f55\u540d: \u89d2\u5ea6\u5217\u8868}\n    self._records: Dict[str, List[List[float]]] = {}\n\n    # \u5f53\u524d\u8bb0\u5f55\u72b6\u6001\n    self._is_recording = False\n    self._current_record_angles: List[List[float]] = []\n    self._record_counter = 0\n\n    # \u8bb0\u5f55\u5b9a\u65f6\u5668\uff0810ms\u95f4\u9694\uff0c100Hz\u91c7\u6837\u7387\uff09\n    self._record_timer = QTimer()\n    self._record_timer.setInterval(10)\n    self._record_timer.timeout.connect(self._on_record_timer_timeout)\n</code></pre>"},{"location":"api/domain/state/#controller.domain.services.state.teach_record_domain_service.TeachRecordDomainService.start_recording","title":"start_recording","text":"<pre><code>start_recording()\n</code></pre> <p>\u5f00\u59cb\u8bb0\u5f55\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def start_recording(self):\n    \"\"\"\u5f00\u59cb\u8bb0\u5f55\u3002\"\"\"\n    if not self._is_recording:\n        self._is_recording = True\n        self._current_record_angles = []\n        self._record_counter = 0\n        self._record_timer.start()\n        self.recording_state_changed.emit(True)\n</code></pre>"},{"location":"api/domain/state/#controller.domain.services.state.teach_record_domain_service.TeachRecordDomainService.stop_recording","title":"stop_recording","text":"<pre><code>stop_recording() -&gt; Optional[str]\n</code></pre> <p>\u505c\u6b62\u8bb0\u5f55\u5e76\u4fdd\u5b58\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[str]</code> <p>Optional[str]: \u65b0\u751f\u6210\u7684\u8bb0\u5f55\u540d\u79f0\uff0c\u5982\u679c\u6ca1\u6709\u6570\u636e\u5219\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def stop_recording(self) -&gt; Optional[str]:\n    \"\"\"\u505c\u6b62\u8bb0\u5f55\u5e76\u4fdd\u5b58\u3002\n\n    Returns:\n        Optional[str]: \u65b0\u751f\u6210\u7684\u8bb0\u5f55\u540d\u79f0\uff0c\u5982\u679c\u6ca1\u6709\u6570\u636e\u5219\u8fd4\u56de None\u3002\n    \"\"\"\n    if self._is_recording:\n        self._is_recording = False\n        self._record_timer.stop()\n        self.recording_state_changed.emit(False)\n\n        # \u4fdd\u5b58\u5f53\u524d\u8bb0\u5f55\n        if self._current_record_angles:\n            record_name = self._generate_record_name()\n            self._records[record_name] = self._current_record_angles.copy()\n            self.record_added.emit(record_name)\n            return record_name\n        else:\n            return None\n    return None\n</code></pre>"},{"location":"api/domain/state/#controller.domain.services.state.teach_record_domain_service.TeachRecordDomainService.is_recording","title":"is_recording","text":"<pre><code>is_recording() -&gt; bool\n</code></pre> <p>\u67e5\u8be2\u662f\u5426\u6b63\u5728\u8bb0\u5f55\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u6b63\u5728\u8bb0\u5f55\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def is_recording(self) -&gt; bool:\n    \"\"\"\u67e5\u8be2\u662f\u5426\u6b63\u5728\u8bb0\u5f55\u3002\n\n    Returns:\n        bool: \u662f\u5426\u6b63\u5728\u8bb0\u5f55\u3002\n    \"\"\"\n    return self._is_recording\n</code></pre>"},{"location":"api/domain/state/#controller.domain.services.state.teach_record_domain_service.TeachRecordDomainService.add_angle_to_current_record","title":"add_angle_to_current_record","text":"<pre><code>add_angle_to_current_record(angles: List[float])\n</code></pre> <p>\u6dfb\u52a0\u89d2\u5ea6\u5230\u5f53\u524d\u8bb0\u5f55\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>angles</code> <code>List[float]</code> <p>6\u7ef4\u5173\u8282\u89d2\u5ea6\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def add_angle_to_current_record(self, angles: List[float]):\n    \"\"\"\u6dfb\u52a0\u89d2\u5ea6\u5230\u5f53\u524d\u8bb0\u5f55\u3002\n\n    Args:\n        angles (List[float]): 6\u7ef4\u5173\u8282\u89d2\u5ea6\u3002\n    \"\"\"\n    if self._is_recording and len(angles) == 6:\n        self._current_record_angles.append(angles.copy())\n        self._record_counter += 1\n</code></pre>"},{"location":"api/domain/state/#controller.domain.services.state.teach_record_domain_service.TeachRecordDomainService.get_record_timer","title":"get_record_timer","text":"<pre><code>get_record_timer() -&gt; QTimer\n</code></pre> <p>\u83b7\u53d6\u8bb0\u5f55\u5b9a\u65f6\u5668\uff08\u7528\u4e8e\u5916\u90e8\u8fde\u63a5\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>QTimer</code> <code>QTimer</code> <p>\u8bb0\u5f55\u5b9a\u65f6\u5668\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def get_record_timer(self) -&gt; QTimer:\n    \"\"\"\u83b7\u53d6\u8bb0\u5f55\u5b9a\u65f6\u5668\uff08\u7528\u4e8e\u5916\u90e8\u8fde\u63a5\uff09\u3002\n\n    Returns:\n        QTimer: \u8bb0\u5f55\u5b9a\u65f6\u5668\u3002\n    \"\"\"\n    return self._record_timer\n</code></pre>"},{"location":"api/domain/state/#controller.domain.services.state.teach_record_domain_service.TeachRecordDomainService.get_all_records","title":"get_all_records","text":"<pre><code>get_all_records() -&gt; Dict[str, List[List[float]]]\n</code></pre> <p>\u83b7\u53d6\u6240\u6709\u8bb0\u5f55\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Dict[str, List[List[float]]]</code> <p>Dict[str, List[List[float]]]: \u6240\u6709\u8bb0\u5f55\u5b57\u5178\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def get_all_records(self) -&gt; Dict[str, List[List[float]]]:\n    \"\"\"\u83b7\u53d6\u6240\u6709\u8bb0\u5f55\u3002\n\n    Returns:\n        Dict[str, List[List[float]]]: \u6240\u6709\u8bb0\u5f55\u5b57\u5178\u3002\n    \"\"\"\n    return self._records.copy()\n</code></pre>"},{"location":"api/domain/state/#controller.domain.services.state.teach_record_domain_service.TeachRecordDomainService.get_record_names","title":"get_record_names","text":"<pre><code>get_record_names() -&gt; List[str]\n</code></pre> <p>\u83b7\u53d6\u6240\u6709\u8bb0\u5f55\u540d\u79f0\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>List[str]: \u8bb0\u5f55\u540d\u79f0\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def get_record_names(self) -&gt; List[str]:\n    \"\"\"\u83b7\u53d6\u6240\u6709\u8bb0\u5f55\u540d\u79f0\u3002\n\n    Returns:\n        List[str]: \u8bb0\u5f55\u540d\u79f0\u5217\u8868\u3002\n    \"\"\"\n    return list(self._records.keys())\n</code></pre>"},{"location":"api/domain/state/#controller.domain.services.state.teach_record_domain_service.TeachRecordDomainService.get_record","title":"get_record","text":"<pre><code>get_record(name: str) -&gt; Optional[List[List[float]]]\n</code></pre> <p>\u83b7\u53d6\u6307\u5b9a\u8bb0\u5f55\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>name</code> <code>str</code> <p>\u8bb0\u5f55\u540d\u79f0\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[List[List[float]]]</code> <p>Optional[List[List[float]]]: \u89d2\u5ea6\u5217\u8868\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def get_record(self, name: str) -&gt; Optional[List[List[float]]]:\n    \"\"\"\u83b7\u53d6\u6307\u5b9a\u8bb0\u5f55\u3002\n\n    Args:\n        name (str): \u8bb0\u5f55\u540d\u79f0\u3002\n\n    Returns:\n        Optional[List[List[float]]]: \u89d2\u5ea6\u5217\u8868\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u8fd4\u56de None\u3002\n    \"\"\"\n    return self._records.get(name)\n</code></pre>"},{"location":"api/domain/state/#controller.domain.services.state.teach_record_domain_service.TeachRecordDomainService.delete_record","title":"delete_record","text":"<pre><code>delete_record(name: str) -&gt; bool\n</code></pre> <p>\u5220\u9664\u6307\u5b9a\u8bb0\u5f55\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>name</code> <code>str</code> <p>\u8bb0\u5f55\u540d\u79f0\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u5220\u9664\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def delete_record(self, name: str) -&gt; bool:\n    \"\"\"\u5220\u9664\u6307\u5b9a\u8bb0\u5f55\u3002\n\n    Args:\n        name (str): \u8bb0\u5f55\u540d\u79f0\u3002\n\n    Returns:\n        bool: \u662f\u5426\u5220\u9664\u6210\u529f\u3002\n    \"\"\"\n    if name in self._records:\n        del self._records[name]\n        self.record_deleted.emit(name)\n        return True\n    return False\n</code></pre>"},{"location":"api/domain/state/#controller.domain.services.state.teach_record_domain_service.TeachRecordDomainService.reverse_record","title":"reverse_record","text":"<pre><code>reverse_record(name: str) -&gt; Optional[str]\n</code></pre> <p>\u53cd\u8f6c\u6307\u5b9a\u8bb0\u5f55\u5e76\u53e6\u5b58\u4e3a\u65b0\u8bb0\u5f55\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>name</code> <code>str</code> <p>\u539f\u8bb0\u5f55\u540d\u79f0\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[str]</code> <p>Optional[str]: \u65b0\u8bb0\u5f55\u540d\u79f0\uff0c\u5982\u679c\u5931\u8d25\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def reverse_record(self, name: str) -&gt; Optional[str]:\n    \"\"\"\u53cd\u8f6c\u6307\u5b9a\u8bb0\u5f55\u5e76\u53e6\u5b58\u4e3a\u65b0\u8bb0\u5f55\u3002\n\n    Args:\n        name (str): \u539f\u8bb0\u5f55\u540d\u79f0\u3002\n\n    Returns:\n        Optional[str]: \u65b0\u8bb0\u5f55\u540d\u79f0\uff0c\u5982\u679c\u5931\u8d25\u8fd4\u56de None\u3002\n    \"\"\"\n    if name not in self._records:\n        return None\n\n    try:\n        # \u53cd\u8f6c\u89d2\u5ea6\u5e8f\u5217\n        original_list = self._records[name]\n        reversed_list = list(reversed(original_list))\n\n        # \u751f\u6210\u65b0\u540d\u79f0\uff1a\u539f\u540d-\u53cd\u8f6c\uff08\u5982\u5df2\u5b58\u5728\u5219\u8ffd\u52a0\u5e8f\u53f7\uff09\n        base_name = f\"{name}-\u53cd\u8f6c\"\n        new_name = base_name\n        suffix = 2\n        while new_name in self._records:\n            new_name = f\"{base_name}-{suffix}\"\n            suffix += 1\n\n        # \u4fdd\u5b58\u65b0\u8bb0\u5f55\n        self._records[new_name] = reversed_list\n        self.record_added.emit(new_name)\n        return new_name\n    except Exception as e:\n        return None\n</code></pre>"},{"location":"api/domain/state/#controller.domain.services.state.teach_record_domain_service.TeachRecordDomainService.load_records","title":"load_records","text":"<pre><code>load_records(records: Dict[str, List[List[float]]])\n</code></pre> <p>\u52a0\u8f7d\u8bb0\u5f55\u6570\u636e\uff08\u4eceRepository\uff09\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>records</code> <code>Dict[str, List[List[float]]]</code> <p>\u8bb0\u5f55\u6570\u636e\u5b57\u5178\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def load_records(self, records: Dict[str, List[List[float]]]):\n    \"\"\"\u52a0\u8f7d\u8bb0\u5f55\u6570\u636e\uff08\u4eceRepository\uff09\u3002\n\n    Args:\n        records (Dict[str, List[List[float]]]): \u8bb0\u5f55\u6570\u636e\u5b57\u5178\u3002\n    \"\"\"\n    self._records = records.copy()\n</code></pre>"},{"location":"api/domain/state/#controller.domain.services.state.teach_record_domain_service.TeachRecordDomainService.clear_all_records","title":"clear_all_records","text":"<pre><code>clear_all_records()\n</code></pre> <p>\u6e05\u7a7a\u6240\u6709\u8bb0\u5f55\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def clear_all_records(self):\n    \"\"\"\u6e05\u7a7a\u6240\u6709\u8bb0\u5f55\u3002\"\"\"\n    self._records.clear()\n</code></pre>"},{"location":"api/domain/utils/","title":"Domain Layer - Utilities","text":""},{"location":"api/domain/utils/#controller.domain.utils.message_decoder","title":"controller.domain.utils.message_decoder","text":""},{"location":"api/domain/utils/#controller.domain.utils.message_decoder.MessageDecoder","title":"MessageDecoder","text":"<pre><code>MessageDecoder(config_path='controller/config/message_decoder_config.yaml')\n</code></pre> <p>\u6d88\u606f\u89e3\u7801\u5668\u3002</p> <p>\u57fa\u4e8e YAML \u914d\u7f6e\u6587\u4ef6\u52a8\u6001\u89e3\u6790\u5341\u516d\u8fdb\u5236\u6d88\u606f\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>config</code> <code>dict</code> <p>\u52a0\u8f7d\u7684\u914d\u7f6e\u5b57\u5178\u3002</p> <code>robot_utils</code> <code>RobotUtils</code> <p>\u5de5\u5177\u7c7b\u5b9e\u4f8b\u3002</p> <code>parsers</code> <code>Dict[str, BaseParser]</code> <p>\u5df2\u6ce8\u518c\u7684\u89e3\u6790\u5668\u5b57\u5178\u3002</p> <code>MessageIn</code> <code>type</code> <p>\u52a8\u6001\u521b\u5efa\u7684\u6d88\u606f\u6570\u636e\u7c7b\u3002</p> <p>\u521d\u59cb\u5316\u6d88\u606f\u89e3\u7801\u5668\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config_path</code> <code>str</code> <p>\u914d\u7f6e\u6587\u4ef6\u8def\u5f84. Defaults to \"controller/config/message_decoder_config.yaml\".</p> <code>'controller/config/message_decoder_config.yaml'</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/message_decoder.py</code> <pre><code>def __init__(self, config_path = \"controller/config/message_decoder_config.yaml\"):\n    \"\"\"\u521d\u59cb\u5316\u6d88\u606f\u89e3\u7801\u5668\u3002\n\n    Args:\n        config_path (str, optional): \u914d\u7f6e\u6587\u4ef6\u8def\u5f84. Defaults to \"controller/config/message_decoder_config.yaml\".\n    \"\"\"\n    # \u4f7f\u7528 ROS2 \u5305\u8d44\u6e90\u7ba1\u7406\u65b9\u5f0f\u67e5\u627e\u914d\u7f6e\u6587\u4ef6\n    if _HAS_AMENT_INDEX:\n        try:\n            # ROS2 \u65b9\u5f0f\uff1a\u4ece share \u76ee\u5f55\u52a0\u8f7d\n            package_share_dir = get_package_share_directory('controller')\n            config_path = os.path.join(package_share_dir, 'config', 'message_decoder_config.yaml')\n        except Exception:\n            # \u5982\u679c\u5305\u672a\u5b89\u88c5\uff0c\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\uff08\u5f00\u53d1\u6a21\u5f0f\uff09\n            pass\n\n    with open(config_path, 'r', encoding='utf-8') as f:\n        self.config = yaml.safe_load(f)\n\n    self.robot_utils = RobotUtils()\n    self.parsers = self._register_parsers()\n    self.MessageIn = self._create_message_class()\n</code></pre>"},{"location":"api/domain/utils/#controller.domain.utils.message_decoder.MessageDecoder.decode_message","title":"decode_message","text":"<pre><code>decode_message(hex_message: str) -&gt; Any\n</code></pre> <p>\u89e3\u7801\u5341\u516d\u8fdb\u5236\u6d88\u606f\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>hex_message</code> <code>str</code> <p>\u539f\u59cb\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Any</code> <code>Any</code> <p>\u89e3\u7801\u540e\u7684\u6d88\u606f\u5bf9\u8c61 (MessageIn)\u3002</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ValueError</code> <p>\u5982\u679c\u6d88\u606f\u683c\u5f0f\u9519\u8bef\u6216\u6821\u9a8c\u5931\u8d25\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/message_decoder.py</code> <pre><code>def decode_message(self, hex_message: str) -&gt; Any:\n    \"\"\"\u89e3\u7801\u5341\u516d\u8fdb\u5236\u6d88\u606f\u3002\n\n    Args:\n        hex_message (str): \u539f\u59cb\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u3002\n\n    Returns:\n        Any: \u89e3\u7801\u540e\u7684\u6d88\u606f\u5bf9\u8c61 (MessageIn)\u3002\n\n    Raises:\n        ValueError: \u5982\u679c\u6d88\u606f\u683c\u5f0f\u9519\u8bef\u6216\u6821\u9a8c\u5931\u8d25\u3002\n    \"\"\"\n    # \u79fb\u9664\u7a7a\u683c\u548c\u6362\u884c\u7b26\n    hex_message = hex_message.replace(' ', '').replace('\\n', '').replace('\\r', '')\n\n    # \u9a8c\u8bc1\u534f\u8bae\u5934\u548c\u5c3e\n    protocol_config = self.config['protocol']\n    header = protocol_config['header']\n    footer = protocol_config['footer']\n\n    if not hex_message.startswith(header):\n        raise ValueError(f\"Invalid header. Expected {header}, got {hex_message[:4]}\")\n\n    if not hex_message.endswith(footer):\n        raise ValueError(f\"Invalid footer. Expected {footer}, got {hex_message[-4:]}\")\n\n\n    # \u9a8c\u8bc1CRC\uff08\u5982\u679c\u542f\u7528\uff09\n    if protocol_config.get('crc_enabled', False):\n        crc_bytes = protocol_config.get('crc_bytes', 2) * 2  # \u8f6c\u6362\u4e3a\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u6570\n        message_without_crc = hex_message[:-len(footer)-crc_bytes]\n        received_crc = hex_message[-len(footer)-crc_bytes:-len(footer)]\n\n        calculated_crc = self.robot_utils.calculate_crc16(message_without_crc)\n        calculated_crc_hex = f\"{calculated_crc:04X}\"\n\n        if calculated_crc_hex != received_crc:\n            raise ValueError(f\"CRC\u6821\u9a8c\u5931\u8d25: \u63a5\u6536={received_crc}, \u8ba1\u7b97={calculated_crc_hex}\")\n\n    # \u89e3\u6790\u5404\u4e2a\u5b57\u6bb5\n    fields_config = self.config['message_formats']['message_in']['fields']\n    parsed_data = {}\n    current_pos = 0\n\n    for field_name, field_config in fields_config.items():\n        field_bytes = field_config['bytes']\n        hex_chars = field_bytes * 2  # \u6bcf\u4e2a\u5b57\u8282\u5bf9\u5e942\u4e2a\u5341\u516d\u8fdb\u5236\u5b57\u7b26\n\n        # \u7279\u6b8a\u5904\u7406CRC\u5b57\u6bb5\n        if field_name == 'crc':\n            if protocol_config.get('crc_enabled', False):\n                field_hex = hex_message[current_pos:current_pos + hex_chars]\n            else:\n                field_hex = \"\"\n        else:\n            field_hex = hex_message[current_pos:current_pos + hex_chars]\n\n        # \u89e3\u6790\u5b57\u6bb5\n        parsed_value = self._parse_field(field_hex, field_config)\n        parsed_data[field_name] = parsed_value\n\n        current_pos += hex_chars\n\n    return self.MessageIn(**parsed_data)\n</code></pre>"},{"location":"api/domain/utils/#controller.domain.utils.message_decoder.MessageDecoder.decode_message_detailed","title":"decode_message_detailed","text":"<pre><code>decode_message_detailed(hex_message: str) -&gt; Dict[str, Any]\n</code></pre> <p>\u89e3\u7801\u6d88\u606f\u5e76\u8fd4\u56de\u8be6\u7ec6\u4fe1\u606f\uff08\u5305\u62ec\u539f\u59cb\u5341\u516d\u8fdb\u5236\u503c\uff09\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>hex_message</code> <code>str</code> <p>\u539f\u59cb\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Dict[str, Any]</code> <p>Dict[str, Any]: \u5305\u542b\u8be6\u7ec6\u4fe1\u606f\u7684\u5b57\u5178\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/message_decoder.py</code> <pre><code>def decode_message_detailed(self, hex_message: str) -&gt; Dict[str, Any]:\n    \"\"\"\u89e3\u7801\u6d88\u606f\u5e76\u8fd4\u56de\u8be6\u7ec6\u4fe1\u606f\uff08\u5305\u62ec\u539f\u59cb\u5341\u516d\u8fdb\u5236\u503c\uff09\u3002\n\n    Args:\n        hex_message (str): \u539f\u59cb\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u3002\n\n    Returns:\n        Dict[str, Any]: \u5305\u542b\u8be6\u7ec6\u4fe1\u606f\u7684\u5b57\u5178\u3002\n    \"\"\"\n    message_in = self.decode_message(hex_message)\n\n    # \u521b\u5efa\u8be6\u7ec6\u4fe1\u606f\u5b57\u5178\n    detailed_info = {}\n    fields_config = self.config['message_formats']['message_in']['fields']\n\n    for field_name, _ in fields_config.items():\n        value = getattr(message_in, field_name)\n        detailed_info[field_name] = {\n            'value': value,\n            'description': fields_config[field_name].get('description', field_name)\n        }\n\n    return detailed_info\n</code></pre>"},{"location":"api/domain/utils/#controller.domain.utils.message_encoder","title":"controller.domain.utils.message_encoder","text":""},{"location":"api/domain/utils/#controller.domain.utils.message_encoder.MessageEncoder","title":"MessageEncoder","text":"<pre><code>MessageEncoder(config_path='controller/config/message_encoder_config.yaml')\n</code></pre> <p>\u6d88\u606f\u7f16\u7801\u5668\u3002</p> <p>\u57fa\u4e8e YAML \u914d\u7f6e\u6587\u4ef6\u52a8\u6001\u751f\u6210\u5341\u516d\u8fdb\u5236\u6d88\u606f\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>config</code> <code>dict</code> <p>\u52a0\u8f7d\u7684\u914d\u7f6e\u5b57\u5178\u3002</p> <code>robot_utils</code> <code>RobotUtils</code> <p>\u5de5\u5177\u7c7b\u5b9e\u4f8b\u3002</p> <code>formatters</code> <code>Dict[str, BaseFormatter]</code> <p>\u5df2\u6ce8\u518c\u7684\u683c\u5f0f\u5316\u5668\u5b57\u5178\u3002</p> <code>Message</code> <code>type</code> <p>\u52a8\u6001\u521b\u5efa\u7684\u6d88\u606f\u6570\u636e\u7c7b\u3002</p> <p>\u521d\u59cb\u5316\u6d88\u606f\u7f16\u7801\u5668\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config_path</code> <code>str</code> <p>\u914d\u7f6e\u6587\u4ef6\u8def\u5f84. Defaults to \"controller/config/message_encoder_config.yaml\".</p> <code>'controller/config/message_encoder_config.yaml'</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/message_encoder.py</code> <pre><code>def __init__(self, config_path = \"controller/config/message_encoder_config.yaml\"):\n    \"\"\"\u521d\u59cb\u5316\u6d88\u606f\u7f16\u7801\u5668\u3002\n\n    Args:\n        config_path (str, optional): \u914d\u7f6e\u6587\u4ef6\u8def\u5f84. Defaults to \"controller/config/message_encoder_config.yaml\".\n    \"\"\"\n    # \u4f7f\u7528 ROS2 \u5305\u8d44\u6e90\u7ba1\u7406\u65b9\u5f0f\u67e5\u627e\u914d\u7f6e\u6587\u4ef6\n    if _HAS_AMENT_INDEX:\n        try:\n            # ROS2 \u65b9\u5f0f\uff1a\u4ece share \u76ee\u5f55\u52a0\u8f7d\n            package_share_dir = get_package_share_directory('controller')\n            config_path = os.path.join(package_share_dir, 'config', 'message_encoder_config.yaml')\n        except Exception:\n            # \u5982\u679c\u5305\u672a\u5b89\u88c5\uff0c\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\uff08\u5f00\u53d1\u6a21\u5f0f\uff09\n            pass\n\n    with open(config_path, 'r', encoding='utf-8') as f:\n        self.config = yaml.safe_load(f)\n\n    self.robot_utils = RobotUtils()\n    self.formatters = self._register_formatters()\n    self.Message = self._create_message_class()\n</code></pre>"},{"location":"api/domain/utils/#controller.domain.utils.message_encoder.MessageEncoder.create_message","title":"create_message","text":"<pre><code>create_message(**kwargs: Any) -&gt; Any\n</code></pre> <p>\u521b\u5efa MessageOut \u5b9e\u4f8b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>**kwargs</code> <code>Any</code> <p>\u6d88\u606f\u5b57\u6bb5\u503c\u3002</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Any</code> <code>Any</code> <p>\u6d88\u606f\u5bf9\u8c61 (MessageOut)\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/message_encoder.py</code> <pre><code>def create_message(self, **kwargs: Any) -&gt; Any:\n    \"\"\"\u521b\u5efa MessageOut \u5b9e\u4f8b\u3002\n\n    Args:\n        **kwargs: \u6d88\u606f\u5b57\u6bb5\u503c\u3002\n\n    Returns:\n        Any: \u6d88\u606f\u5bf9\u8c61 (MessageOut)\u3002\n    \"\"\"\n    return self.Message(**kwargs)\n</code></pre>"},{"location":"api/domain/utils/#controller.domain.utils.message_encoder.MessageEncoder.interpret_message","title":"interpret_message","text":"<pre><code>interpret_message(message: Any) -&gt; str\n</code></pre> <p>\u6839\u636e\u914d\u7f6e\u52a8\u6001\u5c06\u6d88\u606f\u5bf9\u8c61\u7f16\u7801\u4e3a\u5b57\u7b26\u4e32\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>message</code> <code>Any</code> <p>MessageOut \u5bf9\u8c61\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>str</code> <code>str</code> <p>\u7f16\u7801\u540e\u7684\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/message_encoder.py</code> <pre><code>def interpret_message(self, message: Any) -&gt; str:\n    \"\"\"\u6839\u636e\u914d\u7f6e\u52a8\u6001\u5c06\u6d88\u606f\u5bf9\u8c61\u7f16\u7801\u4e3a\u5b57\u7b26\u4e32\u3002\n\n    Args:\n        message (Any): MessageOut \u5bf9\u8c61\u3002\n\n    Returns:\n        str: \u7f16\u7801\u540e\u7684\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u3002\n    \"\"\"\n    protocol_config = self.config['protocol']\n    fields_config = self.config['message_formats']['message_out']['fields']\n\n    # 1. \u6dfb\u52a0\u534f\u8bae\u5934\n    command = protocol_config['header']\n\n    # 2. \u6309\u914d\u7f6e\u987a\u5e8f\u5904\u7406\u6bcf\u4e2a\u5b57\u6bb5\n    for field_name, field_config in fields_config.items():\n        field_value = getattr(message, field_name)\n        command += self._format_field(field_value, field_config)\n\n    # 3. \u8ba1\u7b97CRC\uff08\u5982\u679c\u542f\u7528\uff09\n    if protocol_config.get('crc_enabled', False):\n        crc = self.robot_utils.calculate_crc16(bytes.fromhex(command))\n        command += f\"{(crc &gt;&gt; 8) &amp; 0xFF:02X}{crc &amp; 0xFF:02X}\"\n\n    # 4. \u6dfb\u52a0\u534f\u8bae\u5c3e\n    command += protocol_config['footer']\n\n    return command\n</code></pre>"},{"location":"api/domain/utils/#controller.domain.utils.image_drawing_utils","title":"controller.domain.utils.image_drawing_utils","text":"<p>\u56fe\u50cf\u7ed8\u5236\u5de5\u5177\u7c7b - Domain\u5c42 \u7528\u4e8e\u5728\u56fe\u50cf\u4e0a\u7ed8\u5236\u68c0\u6d4b\u7ed3\u679c</p>"},{"location":"api/domain/utils/#controller.domain.utils.image_drawing_utils.ImageDrawingUtils","title":"ImageDrawingUtils","text":"<p>\u56fe\u50cf\u7ed8\u5236\u5de5\u5177\u7c7b\u3002</p> <p>\u63d0\u4f9b\u9759\u6001\u65b9\u6cd5\u7528\u4e8e\u5728 OpenCV \u56fe\u50cf\u4e0a\u7ed8\u5236\u68c0\u6d4b\u7ed3\u679c\u548c\u8f85\u52a9\u56fe\u5f62\u3002</p>"},{"location":"api/domain/utils/#controller.domain.utils.image_drawing_utils.ImageDrawingUtils.draw_detection_result","title":"draw_detection_result  <code>staticmethod</code>","text":"<pre><code>draw_detection_result(image: ndarray, detection: Dict) -&gt; np.ndarray\n</code></pre> <p>\u5728\u56fe\u50cf\u4e0a\u7ed8\u5236\u68c0\u6d4b\u7ed3\u679c\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>image</code> <code>ndarray</code> <p>\u539f\u59cb\u56fe\u50cf\uff08BGR\uff09\u3002</p> \u5fc5\u9700 <code>detection</code> <code>Dict</code> <p>\u68c0\u6d4b\u7ed3\u679c\u5b57\u5178\uff0c\u5305\u542b\uff1a - head_center (Tuple[float, float]): \u5934\u90e8\u4e2d\u5fc3\u70b9 (x, y)\u3002 - central_center (Tuple[float, float]): \u4e2d\u592e\u4e2d\u5fc3\u70b9 (x, y)\u3002 - real_center (Tuple[float, float]): \u5b9e\u9645\u4e2d\u5fc3\u70b9 (x, y)\u3002 - angle (float): \u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002 - depth (float): central_center \u7684\u6df1\u5ea6\uff08\u7c73\uff09\u3002 - real_depth (float): real_center \u7684\u6df1\u5ea6\uff08\u7c73\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u7ed8\u5236\u540e\u7684\u56fe\u50cf\uff08\u65b0\u56fe\u50cf\uff0c\u4e0d\u4fee\u6539\u539f\u56fe\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/image_drawing_utils.py</code> <pre><code>@staticmethod\ndef draw_detection_result(image: np.ndarray, detection: Dict) -&gt; np.ndarray:\n    \"\"\"\u5728\u56fe\u50cf\u4e0a\u7ed8\u5236\u68c0\u6d4b\u7ed3\u679c\u3002\n\n    Args:\n        image (np.ndarray): \u539f\u59cb\u56fe\u50cf\uff08BGR\uff09\u3002\n        detection (Dict): \u68c0\u6d4b\u7ed3\u679c\u5b57\u5178\uff0c\u5305\u542b\uff1a\n            - head_center (Tuple[float, float]): \u5934\u90e8\u4e2d\u5fc3\u70b9 (x, y)\u3002\n            - central_center (Tuple[float, float]): \u4e2d\u592e\u4e2d\u5fc3\u70b9 (x, y)\u3002\n            - real_center (Tuple[float, float]): \u5b9e\u9645\u4e2d\u5fc3\u70b9 (x, y)\u3002\n            - angle (float): \u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002\n            - depth (float): central_center \u7684\u6df1\u5ea6\uff08\u7c73\uff09\u3002\n            - real_depth (float): real_center \u7684\u6df1\u5ea6\uff08\u7c73\uff09\u3002\n\n    Returns:\n        np.ndarray: \u7ed8\u5236\u540e\u7684\u56fe\u50cf\uff08\u65b0\u56fe\u50cf\uff0c\u4e0d\u4fee\u6539\u539f\u56fe\uff09\u3002\n    \"\"\"\n    if not detection:\n        return image\n\n    # \u590d\u5236\u56fe\u50cf\uff0c\u907f\u514d\u4fee\u6539\u539f\u56fe\n    result_image = image.copy()\n\n    try:\n        # \u63d0\u53d6\u68c0\u6d4b\u6570\u636e\n        head_center = detection.get('head_center')\n        central_center = detection.get('central_center')\n        real_center = detection.get('real_center')\n        angle = detection.get('angle', 0.0)\n        depth = detection.get('depth', 0.0)\n        real_depth = detection.get('real_depth', 0.0)\n\n        # \u8f6c\u6362\u4e3a\u6574\u6570\u5750\u6807\n        if head_center:\n            head_center = (int(head_center[0]), int(head_center[1]))\n            # \u7ed8\u5236head_center\uff08\u7ea2\u8272\u5706\u70b9\uff09\n            cv2.circle(result_image, head_center, 5, (0, 0, 255), -1)\n            # \u7ed8\u5236angle\u6587\u672c\n            cv2.putText(\n                result_image, \n                f\"angle: {angle:.2f}\", \n                (head_center[0], head_center[1] - 10), \n                cv2.FONT_HERSHEY_SIMPLEX, \n                0.5, \n                (0, 0, 255), \n                2\n            )\n\n        if central_center:\n            central_center = (int(central_center[0]), int(central_center[1]))\n            # \u7ed8\u5236central_center\uff08\u7eff\u8272\u5706\u70b9\uff09\n            cv2.circle(result_image, central_center, 5, (0, 255, 0), -1)\n            # \u7ed8\u5236depth\u6587\u672c\n            cv2.putText(\n                result_image, \n                f\"depth: {depth:.2f}\", \n                (central_center[0], central_center[1] - 10), \n                cv2.FONT_HERSHEY_SIMPLEX, \n                0.5, \n                (0, 255, 0), \n                2\n            )\n            # \u7ed8\u5236\u65b9\u5411\u7bad\u5934\n            ImageDrawingUtils.draw_direction_arrow(result_image, central_center, angle)\n\n        if real_center:\n            real_center = (int(real_center[0]), int(real_center[1]))\n            # \u7ed8\u5236real_center\uff08\u7ea2\u8272\u5706\u70b9\uff09\n            cv2.circle(result_image, real_center, 5, (0, 0, 255), -1)\n            # \u7ed8\u5236real_depth\u6587\u672c\n            cv2.putText(\n                result_image, \n                f\"real_depth: {real_depth:.2f}\", \n                (real_center[0], real_center[1] - 10), \n                cv2.FONT_HERSHEY_SIMPLEX, \n                0.5, \n                (0, 0, 255), \n                2\n            )\n\n    except Exception as e:\n        # \u5982\u679c\u7ed8\u5236\u5931\u8d25\uff0c\u8fd4\u56de\u539f\u56fe\n        return image\n\n    return result_image\n</code></pre>"},{"location":"api/domain/utils/#controller.domain.utils.image_drawing_utils.ImageDrawingUtils.draw_direction_arrow","title":"draw_direction_arrow  <code>staticmethod</code>","text":"<pre><code>draw_direction_arrow(image: ndarray, center: Tuple[int, int], angle: float)\n</code></pre> <p>\u7ed8\u5236\u65b9\u5411\u7bad\u5934\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>image</code> <code>ndarray</code> <p>\u56fe\u50cf\uff08\u539f\u5730\u4fee\u6539\uff09\u3002</p> \u5fc5\u9700 <code>center</code> <code>Tuple[int, int]</code> <p>\u4e2d\u5fc3\u70b9\u5750\u6807 (x, y)\u3002</p> \u5fc5\u9700 <code>angle</code> <code>float</code> <p>\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09- \u76f4\u7740\u5411\u4e0a\u4e3a 0\uff0c\u987a\u65f6\u9488\u4e3a\u6b63\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/image_drawing_utils.py</code> <pre><code>@staticmethod\ndef draw_direction_arrow(image: np.ndarray, center: Tuple[int, int], angle: float):\n    \"\"\"\u7ed8\u5236\u65b9\u5411\u7bad\u5934\u3002\n\n    Args:\n        image (np.ndarray): \u56fe\u50cf\uff08\u539f\u5730\u4fee\u6539\uff09\u3002\n        center (Tuple[int, int]): \u4e2d\u5fc3\u70b9\u5750\u6807 (x, y)\u3002\n        angle (float): \u89d2\u5ea6\uff08\u5f27\u5ea6\uff09- \u76f4\u7740\u5411\u4e0a\u4e3a 0\uff0c\u987a\u65f6\u9488\u4e3a\u6b63\u3002\n    \"\"\"\n    try:\n        # \u7bad\u5934\u53c2\u6570\n        arrow_length = 50  # \u7bad\u5934\u957f\u5ea6\uff08\u50cf\u7d20\uff09\n        arrow_color = (255, 0, 0)  # \u84dd\u8272\uff08BGR\u683c\u5f0f\uff09\n        arrow_thickness = 3\n\n        # \u8ba1\u7b97\u7bad\u5934\u7ec8\u70b9\n        # \u89d2\u5ea6\u7cfb\u7edf\uff1a\u76f4\u7740\u5411\u4e0a\u4e3a0\uff0c\u987a\u65f6\u9488\u4e3a\u6b63\n        # \u5411\u4e0a\u65b9\u5411\u4e3a (0, -1)\uff0c\u56e0\u4e3a\u56fe\u50cf\u5750\u6807\u7cfbY\u8f74\u5411\u4e0b\n        end_x = center[0] + arrow_length * math.sin(angle)\n        end_y = center[1] - arrow_length * math.cos(angle)\n        end_point = (int(end_x), int(end_y))\n\n        # \u7ed8\u5236\u7bad\u5934\n        cv2.arrowedLine(\n            image, \n            center, \n            end_point, \n            arrow_color, \n            arrow_thickness, \n            tipLength=0.3\n        )\n\n    except Exception as e:\n        pass\n</code></pre>"},{"location":"api/domain/utils/#controller.domain.utils.kinematic_utils","title":"controller.domain.utils.kinematic_utils","text":""},{"location":"api/domain/utils/#controller.domain.utils.kinematic_utils.KinematicUtils","title":"KinematicUtils","text":"<p>\u8fd0\u52a8\u5b66\u5de5\u5177\u7c7b\u3002</p> <p>\u63d0\u4f9b\u57fa\u672c\u7684\u8fd0\u52a8\u5b66\u53d8\u6362\u548c\u89d2\u5ea6\u5904\u7406\u51fd\u6570\u3002</p>"},{"location":"api/domain/utils/#controller.domain.utils.kinematic_utils.KinematicUtils.dh2rm","title":"dh2rm  <code>staticmethod</code>","text":"<pre><code>dh2rm(a: float, alpha: float, d: float, theta: float) -&gt; np.ndarray\n</code></pre> <p>\u6839\u636e DH \u53c2\u6570\u8ba1\u7b97\u53d8\u6362\u77e9\u9635\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>a</code> <code>float</code> <p>\u8fde\u6746\u957f\u5ea6\u3002</p> \u5fc5\u9700 <code>alpha</code> <code>float</code> <p>\u8fde\u6746\u626d\u8f6c\u89d2\u3002</p> \u5fc5\u9700 <code>d</code> <code>float</code> <p>\u8fde\u6746\u504f\u79fb\u3002</p> \u5fc5\u9700 <code>theta</code> <code>float</code> <p>\u5173\u8282\u89d2\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: 4x4 \u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/kinematic_utils.py</code> <pre><code>@staticmethod\ndef dh2rm(a: float, alpha: float, d: float, theta: float) -&gt; np.ndarray:\n    \"\"\"\u6839\u636e DH \u53c2\u6570\u8ba1\u7b97\u53d8\u6362\u77e9\u9635\u3002\n\n    Args:\n        a (float): \u8fde\u6746\u957f\u5ea6\u3002\n        alpha (float): \u8fde\u6746\u626d\u8f6c\u89d2\u3002\n        d (float): \u8fde\u6746\u504f\u79fb\u3002\n        theta (float): \u5173\u8282\u89d2\u3002\n\n    Returns:\n        np.ndarray: 4x4 \u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002\n    \"\"\"\n    c_theta = cos(theta)\n    s_theta = sin(theta)\n    c_alpha = cos(alpha)\n    s_alpha = sin(alpha)\n\n    return np.array([\n        [c_theta, -s_theta, 0, a],\n        [s_theta * c_alpha, c_theta * c_alpha, -s_alpha, -s_alpha * d],\n        [s_theta * s_alpha, c_theta * s_alpha, c_alpha, c_alpha * d],\n        [0, 0, 0, 1]\n    ], dtype=np.float64)\n</code></pre>"},{"location":"api/domain/utils/#controller.domain.utils.kinematic_utils.KinematicUtils.rm2quat","title":"rm2quat  <code>staticmethod</code>","text":"<pre><code>rm2quat(rm: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u65cb\u8f6c\u77e9\u9635\u8f6c\u56db\u5143\u6570\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>rm</code> <code>ndarray</code> <p>3x3 \u65cb\u8f6c\u77e9\u9635\u6216 4x4 \u53d8\u6362\u77e9\u9635\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u56db\u5143\u6570 [x, y, z, w]\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/kinematic_utils.py</code> <pre><code>@staticmethod\ndef rm2quat(rm: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u65cb\u8f6c\u77e9\u9635\u8f6c\u56db\u5143\u6570\u3002\n\n    Args:\n        rm (np.ndarray): 3x3 \u65cb\u8f6c\u77e9\u9635\u6216 4x4 \u53d8\u6362\u77e9\u9635\u3002\n\n    Returns:\n        np.ndarray: \u56db\u5143\u6570 [x, y, z, w]\u3002\n    \"\"\"\n    # \u5982\u679c\u662f 4x4 \u77e9\u9635\uff0c\u63d0\u53d6 3x3 \u90e8\u5206\n    if rm.shape == (4, 4):\n        rm = rm[:3, :3]\n    return R.from_matrix(rm).as_quat()\n</code></pre>"},{"location":"api/domain/utils/#controller.domain.utils.kinematic_utils.KinematicUtils.quat2rm","title":"quat2rm  <code>staticmethod</code>","text":"<pre><code>quat2rm(quat: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u56db\u5143\u6570\u8f6c\u65cb\u8f6c\u77e9\u9635\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>quat</code> <code>ndarray</code> <p>\u56db\u5143\u6570 [x, y, z, w]\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: 3x3 \u65cb\u8f6c\u77e9\u9635\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/kinematic_utils.py</code> <pre><code>@staticmethod\ndef quat2rm(quat: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u56db\u5143\u6570\u8f6c\u65cb\u8f6c\u77e9\u9635\u3002\n\n    Args:\n        quat (np.ndarray): \u56db\u5143\u6570 [x, y, z, w]\u3002\n\n    Returns:\n        np.ndarray: 3x3 \u65cb\u8f6c\u77e9\u9635\u3002\n    \"\"\"\n    return R.from_quat(quat).as_matrix()\n</code></pre>"},{"location":"api/domain/utils/#controller.domain.utils.kinematic_utils.KinematicUtils.quat2euler","title":"quat2euler  <code>staticmethod</code>","text":"<pre><code>quat2euler(quat: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u56db\u5143\u6570\u8f6c\u6b27\u62c9\u89d2 (XYZ \u987a\u5e8f)\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>quat</code> <code>ndarray</code> <p>\u56db\u5143\u6570 [x, y, z, w]\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u6b27\u62c9\u89d2 [roll, pitch, yaw] (\u5f27\u5ea6)\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/kinematic_utils.py</code> <pre><code>@staticmethod\ndef quat2euler(quat: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u56db\u5143\u6570\u8f6c\u6b27\u62c9\u89d2 (XYZ \u987a\u5e8f)\u3002\n\n    Args:\n        quat (np.ndarray): \u56db\u5143\u6570 [x, y, z, w]\u3002\n\n    Returns:\n        np.ndarray: \u6b27\u62c9\u89d2 [roll, pitch, yaw] (\u5f27\u5ea6)\u3002\n    \"\"\"\n    return R.from_quat(quat).as_euler('xyz', degrees=False)\n</code></pre>"},{"location":"api/domain/utils/#controller.domain.utils.kinematic_utils.KinematicUtils.euler2quat","title":"euler2quat  <code>staticmethod</code>","text":"<pre><code>euler2quat(euler: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u6b27\u62c9\u89d2\u8f6c\u56db\u5143\u6570 (XYZ \u987a\u5e8f)\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>euler</code> <code>ndarray</code> <p>\u6b27\u62c9\u89d2 [roll, pitch, yaw] (\u5f27\u5ea6)\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u56db\u5143\u6570 [x, y, z, w]\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/kinematic_utils.py</code> <pre><code>@staticmethod\ndef euler2quat(euler: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u6b27\u62c9\u89d2\u8f6c\u56db\u5143\u6570 (XYZ \u987a\u5e8f)\u3002\n\n    Args:\n        euler (np.ndarray): \u6b27\u62c9\u89d2 [roll, pitch, yaw] (\u5f27\u5ea6)\u3002\n\n    Returns:\n        np.ndarray: \u56db\u5143\u6570 [x, y, z, w]\u3002\n    \"\"\"\n    return R.from_euler('xyz', euler, degrees=False).as_quat()\n</code></pre>"},{"location":"api/domain/utils/#controller.domain.utils.kinematic_utils.KinematicUtils.euler2rm","title":"euler2rm  <code>staticmethod</code>","text":"<pre><code>euler2rm(euler: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u6b27\u62c9\u89d2\u8f6c\u65cb\u8f6c\u77e9\u9635 (XYZ \u987a\u5e8f)\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>euler</code> <code>ndarray</code> <p>\u6b27\u62c9\u89d2 [roll, pitch, yaw] (\u5f27\u5ea6)\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: 3x3 \u65cb\u8f6c\u77e9\u9635\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/kinematic_utils.py</code> <pre><code>@staticmethod\ndef euler2rm(euler: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u6b27\u62c9\u89d2\u8f6c\u65cb\u8f6c\u77e9\u9635 (XYZ \u987a\u5e8f)\u3002\n\n    Args:\n        euler (np.ndarray): \u6b27\u62c9\u89d2 [roll, pitch, yaw] (\u5f27\u5ea6)\u3002\n\n    Returns:\n        np.ndarray: 3x3 \u65cb\u8f6c\u77e9\u9635\u3002\n    \"\"\"\n    return R.from_euler('xyz', euler, degrees=False).as_matrix()\n</code></pre>"},{"location":"api/domain/utils/#controller.domain.utils.kinematic_utils.KinematicUtils.rm2euler","title":"rm2euler  <code>staticmethod</code>","text":"<pre><code>rm2euler(rm: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u65cb\u8f6c\u77e9\u9635\u8f6c\u6b27\u62c9\u89d2 (XYZ \u987a\u5e8f)\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>rm</code> <code>ndarray</code> <p>3x3 \u65cb\u8f6c\u77e9\u9635\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u6b27\u62c9\u89d2 [roll, pitch, yaw] (\u5f27\u5ea6)\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/kinematic_utils.py</code> <pre><code>@staticmethod\ndef rm2euler(rm: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u65cb\u8f6c\u77e9\u9635\u8f6c\u6b27\u62c9\u89d2 (XYZ \u987a\u5e8f)\u3002\n\n    Args:\n        rm (np.ndarray): 3x3 \u65cb\u8f6c\u77e9\u9635\u3002\n\n    Returns:\n        np.ndarray: \u6b27\u62c9\u89d2 [roll, pitch, yaw] (\u5f27\u5ea6)\u3002\n    \"\"\"\n    # \u5982\u679c\u662f 4x4 \u77e9\u9635\uff0c\u63d0\u53d6 3x3 \u90e8\u5206\n    if rm.shape == (4, 4):\n        rm = rm[:3, :3]\n    return R.from_matrix(rm).as_euler('xyz', degrees=False)\n</code></pre>"},{"location":"api/domain/utils/#controller.domain.utils.kinematic_utils.KinematicUtils.normalize_angle","title":"normalize_angle  <code>staticmethod</code>","text":"<pre><code>normalize_angle(angle: float) -&gt; float\n</code></pre> <p>\u5c06\u89d2\u5ea6\u5f52\u4e00\u5316\u5230 [-pi, pi] \u8303\u56f4\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>angle</code> <code>float</code> <p>\u8f93\u5165\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>float</code> <code>float</code> <p>\u5f52\u4e00\u5316\u540e\u7684\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/kinematic_utils.py</code> <pre><code>@staticmethod\ndef normalize_angle(angle: float) -&gt; float:\n    \"\"\"\u5c06\u89d2\u5ea6\u5f52\u4e00\u5316\u5230 [-pi, pi] \u8303\u56f4\u3002\n\n    Args:\n        angle (float): \u8f93\u5165\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002\n\n    Returns:\n        float: \u5f52\u4e00\u5316\u540e\u7684\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002\n    \"\"\"\n    return (angle + pi) % (2 * pi) - pi\n</code></pre>"},{"location":"api/domain/utils/#controller.domain.utils.robot_utils","title":"controller.domain.utils.robot_utils","text":""},{"location":"api/domain/utils/#controller.domain.utils.robot_utils.RobotUtils","title":"RobotUtils","text":"<pre><code>RobotUtils()\n</code></pre> <p>\u673a\u5668\u4eba\u5de5\u5177\u7c7b\u3002</p> <p>\u63d0\u4f9b\u673a\u5668\u4eba\u76f8\u5173\u7684\u6570\u503c\u8f6c\u6362\u3001\u6821\u9a8c\u548c\u8ba1\u7b97\u7b49\u5de5\u5177\u65b9\u6cd5\u3002</p> <p>\u521d\u59cb\u5316\u673a\u5668\u4eba\u53c2\u6570\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/robot_utils.py</code> <pre><code>def __init__(self):\n    \"\"\"\u521d\u59cb\u5316\u673a\u5668\u4eba\u53c2\u6570\u3002\"\"\"\n    self.JOINT_OFFSETS = [79119, 369835, 83627, 392414, 507293, 456372]\n    self.RADIAN_TO_POS_SCALE_FACTOR = (2**19) / (2 * pi)  # \u5f27\u5ea6\u8f6c\u4f4d\u7f6e\u503c\u7684\u7cfb\u6570\n    self.POS_TO_RADIAN_SCALE_FACTOR = (2 * pi) / (2**19)  # \u4f4d\u7f6e\u503c\u8f6c\u5f27\u5ea6\u7684\u7cfb\u6570\n    self.init_radians = [0, -pi/2, 0, pi/2, 0, 0]\n</code></pre>"},{"location":"api/domain/utils/#controller.domain.utils.robot_utils.RobotUtils.position2radian","title":"position2radian","text":"<pre><code>position2radian(position: list) -&gt; list\n</code></pre> <p>\u7f16\u7801\u5668\u4f4d\u7f6e\u503c\u8f6c\u6362\u4e3a\u5f27\u5ea6\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>position</code> <code>list</code> <p>\u7f16\u7801\u5668\u4f4d\u7f6e\u503c\u5217\u8868\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>list</code> <code>list</code> <p>\u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/robot_utils.py</code> <pre><code>def position2radian(self, position: list) -&gt; list:\n    \"\"\"\u7f16\u7801\u5668\u4f4d\u7f6e\u503c\u8f6c\u6362\u4e3a\u5f27\u5ea6\u3002\n\n    Args:\n        position (list): \u7f16\u7801\u5668\u4f4d\u7f6e\u503c\u5217\u8868\u3002\n\n    Returns:\n        list: \u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\u3002\n    \"\"\"\n    radians = self.init_radians.copy()\n    for i, pos in enumerate(position):\n        if isinstance(pos, str):\n            pos = int(pos)\n        radians[i] += (pos - self.JOINT_OFFSETS[i]) * self.POS_TO_RADIAN_SCALE_FACTOR\n    return radians\n</code></pre>"},{"location":"api/domain/utils/#controller.domain.utils.robot_utils.RobotUtils.radian2position","title":"radian2position","text":"<pre><code>radian2position(radian: list) -&gt; list\n</code></pre> <p>\u5f27\u5ea6\u8f6c\u6362\u4e3a\u7f16\u7801\u5668\u4f4d\u7f6e\u503c\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>radian</code> <code>list</code> <p>\u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>list</code> <code>list</code> <p>\u7f16\u7801\u5668\u4f4d\u7f6e\u503c\u5217\u8868\uff0832\u4f4d\u6574\u6570\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/robot_utils.py</code> <pre><code>def radian2position(self, radian: list) -&gt; list:\n    \"\"\"\u5f27\u5ea6\u8f6c\u6362\u4e3a\u7f16\u7801\u5668\u4f4d\u7f6e\u503c\u3002\n\n    Args:\n        radian (list): \u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\u3002\n\n    Returns:\n        list: \u7f16\u7801\u5668\u4f4d\u7f6e\u503c\u5217\u8868\uff0832\u4f4d\u6574\u6570\uff09\u3002\n    \"\"\"\n    positions = []\n    for i, rad in enumerate(radian):\n        position = int((rad - self.init_radians[i]) * self.RADIAN_TO_POS_SCALE_FACTOR + self.JOINT_OFFSETS[i]) &amp; 0xFFFFFFFF\n        positions.append(position)\n    return positions\n</code></pre>"},{"location":"api/domain/utils/#controller.domain.utils.robot_utils.RobotUtils.speed2position","title":"speed2position","text":"<pre><code>speed2position(speed: list) -&gt; list\n</code></pre> <p>\u901f\u5ea6\u503c\u8f6c\u6362\u4e3a\u4f4d\u7f6e\u589e\u91cf\u503c\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>speed</code> <code>list</code> <p>\u901f\u5ea6\u5217\u8868\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>list</code> <code>list</code> <p>\u5bf9\u5e94\u7684\u65f6\u95f4\u6b65\u957f\u5185\u7684\u4f4d\u7f6e\u589e\u91cf\u503c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/robot_utils.py</code> <pre><code>def speed2position(self, speed: list) -&gt; list:\n    \"\"\"\u901f\u5ea6\u503c\u8f6c\u6362\u4e3a\u4f4d\u7f6e\u589e\u91cf\u503c\u3002\n\n    Args:\n        speed (list): \u901f\u5ea6\u5217\u8868\u3002\n\n    Returns:\n        list: \u5bf9\u5e94\u7684\u65f6\u95f4\u6b65\u957f\u5185\u7684\u4f4d\u7f6e\u589e\u91cf\u503c\u3002\n    \"\"\"\n    return [int(position * self.RADIAN_TO_POS_SCALE_FACTOR) &amp; 0xFFFFFF for position in speed]\n</code></pre>"},{"location":"api/domain/utils/#controller.domain.utils.robot_utils.RobotUtils.torque_transfer","title":"torque_transfer  <code>staticmethod</code>","text":"<pre><code>torque_transfer(torque: list) -&gt; list\n</code></pre> <p>\u529b\u77e9\u503c\u8f6c\u6362\u4e0e\u5f52\u4e00\u5316\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>torque</code> <code>list</code> <p>\u529b\u77e9\u503c\u5217\u8868\uff0c\u957f\u5ea6\u4e0d\u8d85\u8fc76\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>list</code> <code>list</code> <p>\u8f6c\u6362\u540e\u7684\u529b\u77e9\u503c\u5217\u8868\uff0816\u4f4d\u6574\u6570\uff09\u3002</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ValueError</code> <p>\u5982\u679c\u529b\u77e9\u5217\u8868\u957f\u5ea6\u8d85\u8fc76\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/robot_utils.py</code> <pre><code>@staticmethod\ndef torque_transfer(torque: list) -&gt; list:\n    \"\"\"\u529b\u77e9\u503c\u8f6c\u6362\u4e0e\u5f52\u4e00\u5316\u3002\n\n    Args:\n        torque (list): \u529b\u77e9\u503c\u5217\u8868\uff0c\u957f\u5ea6\u4e0d\u8d85\u8fc76\u3002\n\n    Returns:\n        list: \u8f6c\u6362\u540e\u7684\u529b\u77e9\u503c\u5217\u8868\uff0816\u4f4d\u6574\u6570\uff09\u3002\n\n    Raises:\n        ValueError: \u5982\u679c\u529b\u77e9\u5217\u8868\u957f\u5ea6\u8d85\u8fc76\u3002\n    \"\"\"\n    if len(torque) &gt; 6:\n        raise ValueError(\"\u529b\u77e9\u503c\u5217\u8868\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc76\")\n    transfer_torque = []\n    for t in torque[:3]:\n        t = min(max(t, -50), 50)\n        transfer_torque.append(int(t / 87 * 1000))\n    for t in torque[3:]:\n        t = min(max(t, -10), 10)\n        transfer_torque.append(int(t * 100))\n    return [int(t) &amp; 0xFFFF for t in transfer_torque]\n</code></pre>"},{"location":"api/domain/utils/#controller.domain.utils.robot_utils.RobotUtils.effector2hex","title":"effector2hex  <code>staticmethod</code>","text":"<pre><code>effector2hex(effector_data: float) -&gt; list\n</code></pre> <p>\u672b\u7aef\u6267\u884c\u5668\u6570\u636e\u8f6c\u6362\u4e3a\u5341\u516d\u8fdb\u5236\u5b57\u8282\u5217\u8868\u3002</p> <p>\u5c06\u6d6e\u70b9\u6570\u62c6\u5206\u4e3a\u6574\u6570\u90e8\u5206\u548c\u5c0f\u6570\u90e8\u5206\uff0c\u5206\u522b\u8f6c\u6362\u4e3a 2 \u5b57\u8282\u7684\u5927\u7aef\u5e8f\u5341\u516d\u8fdb\u5236\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>effector_data</code> <code>float</code> <p>\u672b\u7aef\u6267\u884c\u5668\u6570\u636e\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>list</code> <code>list</code> <p>\u5305\u542b\u4e24\u4e2a\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u7684\u5217\u8868 [\u6574\u6570\u90e8\u5206hex, \u5c0f\u6570\u90e8\u5206hex]\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/robot_utils.py</code> <pre><code>@staticmethod\ndef effector2hex(effector_data: float) -&gt; list:\n    \"\"\"\u672b\u7aef\u6267\u884c\u5668\u6570\u636e\u8f6c\u6362\u4e3a\u5341\u516d\u8fdb\u5236\u5b57\u8282\u5217\u8868\u3002\n\n    \u5c06\u6d6e\u70b9\u6570\u62c6\u5206\u4e3a\u6574\u6570\u90e8\u5206\u548c\u5c0f\u6570\u90e8\u5206\uff0c\u5206\u522b\u8f6c\u6362\u4e3a 2 \u5b57\u8282\u7684\u5927\u7aef\u5e8f\u5341\u516d\u8fdb\u5236\u3002\n\n    Args:\n        effector_data (float): \u672b\u7aef\u6267\u884c\u5668\u6570\u636e\u3002\n\n    Returns:\n        list: \u5305\u542b\u4e24\u4e2a\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u7684\u5217\u8868 [\u6574\u6570\u90e8\u5206hex, \u5c0f\u6570\u90e8\u5206hex]\u3002\n    \"\"\"\n    effector_data = str(float(effector_data))\n    arr = effector_data.split('.')\n    return [int(arr[0]).to_bytes(2, 'big').hex(), int(arr[1]).to_bytes(2, 'big').hex()]\n</code></pre>"},{"location":"api/domain/utils/#controller.domain.utils.robot_utils.RobotUtils.calculate_crc16","title":"calculate_crc16  <code>staticmethod</code>","text":"<pre><code>calculate_crc16(data) -&gt; int\n</code></pre> <p>\u8ba1\u7b97 CRC16 \u6821\u9a8c\u548c (CCITT)\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>Union[bytes, str]</code> <p>\u5b57\u8282\u6570\u7ec4\u6216\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>int</code> <code>int</code> <p>16\u4f4d\u6821\u9a8c\u548c\u3002\u5982\u679c\u8f93\u5165\u683c\u5f0f\u9519\u8bef\u8fd4\u56de False\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/robot_utils.py</code> <pre><code>@staticmethod\ndef calculate_crc16(data) -&gt; int:\n    \"\"\"\u8ba1\u7b97 CRC16 \u6821\u9a8c\u548c (CCITT)\u3002\n\n    Args:\n        data (Union[bytes, str]): \u5b57\u8282\u6570\u7ec4\u6216\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u3002\n\n    Returns:\n        int: 16\u4f4d\u6821\u9a8c\u548c\u3002\u5982\u679c\u8f93\u5165\u683c\u5f0f\u9519\u8bef\u8fd4\u56de False\u3002\n    \"\"\"\n    if isinstance(data, str):\n        try:\n            data = bytes.fromhex(data.strip())\n        except Exception as e:\n            return False\n\n    # \u8ba1\u7b97CRC16-CCITT\n    crc = 0xFFFF\n    for byte in data:\n        crc ^= (int(byte) &lt;&lt; 8)\n        for _ in range(8):\n            if crc &amp; 0x8000:\n                crc = (crc &lt;&lt; 1) ^ 0x1021\n            else:\n                crc = crc &lt;&lt; 1\n            crc &amp;= 0xFFFF\n\n    return crc\n</code></pre>"},{"location":"api/domain/value_objects/","title":"Domain Layer - Value Objects","text":""},{"location":"api/domain/value_objects/#controller.domain.value_objects.dh_param","title":"controller.domain.value_objects.dh_param","text":""},{"location":"api/domain/value_objects/#controller.domain.value_objects.dh_param.DHParam","title":"DHParam  <code>dataclass</code>","text":"<pre><code>DHParam()\n</code></pre> <p>\u673a\u68b0\u81c2 DH \u53c2\u6570\u914d\u7f6e\u3002</p> <p>\u5b58\u50a8\u8fd0\u52a8\u5b66\u548c\u52a8\u529b\u5b66\u6240\u9700\u7684 DH \u53c2\u6570\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>kinematic_dh</code> <code>array</code> <p>\u8fd0\u52a8\u5b66 DH \u53c2\u6570\u8868\u3002</p> <code>dynamic_dh</code> <code>array</code> <p>\u52a8\u529b\u5b66 DH \u53c2\u6570\u8868\u3002</p> <p>\u521d\u59cb\u5316\u9ed8\u8ba4 DH \u53c2\u6570\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/value_objects/dh_param.py</code> <pre><code>def __init__(self):\n    \"\"\"\u521d\u59cb\u5316\u9ed8\u8ba4 DH \u53c2\u6570\u3002\"\"\"\n    self.kinematic_dh = np.array([\n        [0.0, 0.0, 0.0,  0.0],\n        [0.0, -pi/2, 0.0, -pi/2],\n        [0.425, pi, 0.0, 0.0],\n        [0.401, pi, 0.0856, pi/2],\n        [0.0, pi/2, 0.086, 0.0],\n        [0.0, -pi/2, 0.231, 0.0]  \n    ], dtype=float)\n\n    self.dynamic_dh = np.array([\n        [0.0, 0.0, 0.0, 0.0],\n        [0.0, -pi/2, 0.0, -pi/2],\n        [0.425, pi, 0.0, 0.0],\n        [0.401, pi, 0.0856, pi/2],\n        [0.0, pi/2, 0.086, 0.0],\n        [0.0, -pi/2, 0.0725, 0.0]\n    ])\n</code></pre>"},{"location":"api/domain/value_objects/#controller.domain.value_objects.dh_param.DHParam.get_kinematic_dh","title":"get_kinematic_dh","text":"<pre><code>get_kinematic_dh() -&gt; np.ndarray\n</code></pre> <p>\u83b7\u53d6\u8fd0\u52a8\u5b66 DH \u53c2\u6570\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u8fd0\u52a8\u5b66 DH \u53c2\u6570\u77e9\u9635\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/value_objects/dh_param.py</code> <pre><code>def get_kinematic_dh(self) -&gt; np.ndarray:\n    \"\"\"\u83b7\u53d6\u8fd0\u52a8\u5b66 DH \u53c2\u6570\u3002\n\n    Returns:\n        np.ndarray: \u8fd0\u52a8\u5b66 DH \u53c2\u6570\u77e9\u9635\u3002\n    \"\"\"\n    return self.kinematic_dh\n</code></pre>"},{"location":"api/domain/value_objects/#controller.domain.value_objects.dh_param.DHParam.get_dynamic_dh","title":"get_dynamic_dh","text":"<pre><code>get_dynamic_dh() -&gt; np.ndarray\n</code></pre> <p>\u83b7\u53d6\u52a8\u529b\u5b66 DH \u53c2\u6570\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u52a8\u529b\u5b66 DH \u53c2\u6570\u77e9\u9635\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/value_objects/dh_param.py</code> <pre><code>def get_dynamic_dh(self) -&gt; np.ndarray:\n    \"\"\"\u83b7\u53d6\u52a8\u529b\u5b66 DH \u53c2\u6570\u3002\n\n    Returns:\n        np.ndarray: \u52a8\u529b\u5b66 DH \u53c2\u6570\u77e9\u9635\u3002\n    \"\"\"\n    return self.dynamic_dh\n</code></pre>"},{"location":"api/domain/value_objects/#controller.domain.value_objects.hand_eye_calibration_config","title":"controller.domain.value_objects.hand_eye_calibration_config","text":"<p>\u624b\u773c\u6807\u5b9a\u914d\u7f6e\u503c\u5bf9\u8c61</p>"},{"location":"api/domain/value_objects/#controller.domain.value_objects.hand_eye_calibration_config.CameraIntrinsics","title":"CameraIntrinsics  <code>dataclass</code>","text":"<pre><code>CameraIntrinsics(fx: float, fy: float, cx: float, cy: float)\n</code></pre> <p>\u76f8\u673a\u5185\u53c2\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>fx</code> <code>float</code> <p>x \u65b9\u5411\u7126\u8ddd\u3002</p> <code>fy</code> <code>float</code> <p>y \u65b9\u5411\u7126\u8ddd\u3002</p> <code>cx</code> <code>float</code> <p>\u5149\u5fc3 x \u5750\u6807\u3002</p> <code>cy</code> <code>float</code> <p>\u5149\u5fc3 y \u5750\u6807\u3002</p>"},{"location":"api/domain/value_objects/#controller.domain.value_objects.hand_eye_calibration_config.TargetOffset","title":"TargetOffset  <code>dataclass</code>","text":"<pre><code>TargetOffset(x: float, y: float, z: float)\n</code></pre> <p>\u76ee\u6807\u504f\u79fb\u91cf\uff08\u7c73\uff09\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>x</code> <code>float</code> <p>x \u65b9\u5411\u504f\u79fb\u3002</p> <code>y</code> <code>float</code> <p>y \u65b9\u5411\u504f\u79fb\u3002</p> <code>z</code> <code>float</code> <p>z \u65b9\u5411\u504f\u79fb\u3002</p>"},{"location":"api/domain/value_objects/#controller.domain.value_objects.hand_eye_calibration_config.TargetOffset.to_array","title":"to_array","text":"<pre><code>to_array() -&gt; np.ndarray\n</code></pre> <p>\u8f6c\u6362\u4e3a numpy \u6570\u7ec4\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: [x, y, z] \u6570\u7ec4\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/value_objects/hand_eye_calibration_config.py</code> <pre><code>def to_array(self) -&gt; np.ndarray:\n    \"\"\"\u8f6c\u6362\u4e3a numpy \u6570\u7ec4\u3002\n\n    Returns:\n        np.ndarray: [x, y, z] \u6570\u7ec4\u3002\n    \"\"\"\n    return np.array([self.x, self.y, self.z])\n</code></pre>"},{"location":"api/domain/value_objects/#controller.domain.value_objects.hand_eye_calibration_config.EndEffectorAdjustment","title":"EndEffectorAdjustment  <code>dataclass</code>","text":"<pre><code>EndEffectorAdjustment(z_rotation: float, y_rotation: float, x_rotation: float)\n</code></pre> <p>\u672b\u7aef\u59ff\u6001\u8c03\u6574\uff08\u5f27\u5ea6\uff09\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>z_rotation</code> <code>float</code> <p>\u7ed5 Z \u8f74\u65cb\u8f6c\u89d2\u5ea6\u3002</p> <code>y_rotation</code> <code>float</code> <p>\u7ed5 Y \u8f74\u65cb\u8f6c\u89d2\u5ea6\u3002</p> <code>x_rotation</code> <code>float</code> <p>\u7ed5 X \u8f74\u65cb\u8f6c\u89d2\u5ea6\u3002</p>"},{"location":"api/domain/value_objects/#controller.domain.value_objects.hand_eye_calibration_config.HandEyeCalibrationConfig","title":"HandEyeCalibrationConfig  <code>dataclass</code>","text":"<pre><code>HandEyeCalibrationConfig(hand_eye_matrix: ndarray, camera_intrinsics: CameraIntrinsics, target_offset: TargetOffset, end_effector_adjustment: EndEffectorAdjustment)\n</code></pre> <p>\u624b\u773c\u6807\u5b9a\u5b8c\u6574\u914d\u7f6e\u3002</p> <p>\u8fd9\u662f\u4e00\u4e2a\u503c\u5bf9\u8c61\uff08Value Object\uff09\uff0c\u4e0d\u53ef\u53d8\u4e14\u65e0\u526f\u4f5c\u7528\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>hand_eye_matrix</code> <code>ndarray</code> <p>4x4 \u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002</p> <code>camera_intrinsics</code> <code>CameraIntrinsics</code> <p>\u76f8\u673a\u5185\u53c2\u3002</p> <code>target_offset</code> <code>TargetOffset</code> <p>\u76ee\u6807\u504f\u79fb\u91cf\u3002</p> <code>end_effector_adjustment</code> <code>EndEffectorAdjustment</code> <p>\u672b\u7aef\u59ff\u6001\u8c03\u6574\u3002</p>"},{"location":"api/domain/value_objects/#controller.domain.value_objects.hand_eye_calibration_config.HandEyeCalibrationConfig.__post_init__","title":"__post_init__","text":"<pre><code>__post_init__()\n</code></pre> <p>\u9a8c\u8bc1\u6570\u636e\u5b8c\u6574\u6027\u3002</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ValueError</code> <p>\u5982\u679c\u624b\u773c\u6807\u5b9a\u77e9\u9635\u5f62\u72b6\u4e0d\u662f 4x4\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/value_objects/hand_eye_calibration_config.py</code> <pre><code>def __post_init__(self):\n    \"\"\"\u9a8c\u8bc1\u6570\u636e\u5b8c\u6574\u6027\u3002\n\n    Raises:\n        ValueError: \u5982\u679c\u624b\u773c\u6807\u5b9a\u77e9\u9635\u5f62\u72b6\u4e0d\u662f 4x4\u3002\n    \"\"\"\n    if self.hand_eye_matrix.shape != (4, 4):\n        raise ValueError(\"\u624b\u773c\u6807\u5b9a\u77e9\u9635\u5fc5\u987b\u662f 4x4 \u77e9\u9635\")\n</code></pre>"},{"location":"api/domain/value_objects/#controller.domain.value_objects.motion_operation_mode","title":"controller.domain.value_objects.motion_operation_mode","text":"<p>\u8fd0\u52a8\u64cd\u4f5c\u6a21\u5f0f - Domain Value Object</p>"},{"location":"api/domain/value_objects/#controller.domain.value_objects.motion_operation_mode.MotionOperationMode","title":"MotionOperationMode","text":"<p>               Bases: <code>Enum</code></p> <p>\u8fd0\u52a8\u64cd\u4f5c\u6a21\u5f0f\u679a\u4e3e\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>NONE</code> <p>\u65e0\u64cd\u4f5c\uff08\u4ec5\u83b7\u53d6\u4f4d\u7f6e\uff09\u3002</p> <code>EXECUTE</code> <p>\u6267\u884c\u8fd0\u52a8\u3002</p> <code>SAVE</code> <p>\u4fdd\u5b58\u8f68\u8ff9\u3002</p> <code>PREVIEW</code> <p>\u9884\u89c8\u8f68\u8ff9\uff08\u663e\u793a\u66f2\u7ebf\uff09\u3002</p>"},{"location":"api/domain/value_objects/#controller.domain.value_objects.robot_state_snapshot","title":"controller.domain.value_objects.robot_state_snapshot","text":"<p>\u673a\u68b0\u81c2\u72b6\u6001\u5feb\u7167 - Domain\u5c42\u503c\u5bf9\u8c61 \u4e0d\u53ef\u53d8\u7684\u72b6\u6001\u6570\u636e\u8f7d\u4f53</p>"},{"location":"api/domain/value_objects/#controller.domain.value_objects.robot_state_snapshot.RobotStateSnapshot","title":"RobotStateSnapshot  <code>dataclass</code>","text":"<pre><code>RobotStateSnapshot(init_status: int, control: int, mode: int, joint_positions: Tuple[int, ...], joint_angles: Tuple[float, ...], joint_speeds: Tuple[int, ...], joint_torques: Tuple[int, ...], joint_status: Tuple[int, ...], double_encoder_interpolations: Tuple[int, ...], errors: Tuple[int, ...], effector_data: Any, timestamp: float)\n</code></pre> <p>\u673a\u68b0\u81c2\u72b6\u6001\u5feb\u7167 - \u4e0d\u53ef\u53d8\u6570\u636e\u8f7d\u4f53\u3002</p> <p>\u7279\u70b9\uff1a - frozen=True: \u4e0d\u53ef\u53d8\uff0c\u7ebf\u7a0b\u5b89\u5168 - \u5305\u542b\u5b8c\u6574\u7684\u673a\u68b0\u81c2\u72b6\u6001 - \u53ef\u4ee5\u4fdd\u5b58\u5386\u53f2\u5feb\u7167\u5e8f\u5217</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>init_status</code> <code>int</code> <p>\u521d\u59cb\u5316\u72b6\u6001\u3002</p> <code>control</code> <code>int</code> <p>\u5f53\u524d\u547d\u4ee4 0x06/0x07...\u3002</p> <code>mode</code> <code>int</code> <p>\u8fd0\u884c\u6a21\u5f0f 0x08/0x0A...\u3002</p> <code>joint_positions</code> <code>Tuple[int, ...]</code> <p>\u7f16\u7801\u5668\u4f4d\u7f6e\uff08\u539f\u59cb\u503c\uff0c6\u4e2a\u5173\u8282\uff09\u3002</p> <code>joint_angles</code> <code>Tuple[float, ...]</code> <p>\u5173\u8282\u89d2\u5ea6\uff08\u5f27\u5ea6\uff0c6\u4e2a\u5173\u8282\uff09\u3002</p> <code>joint_speeds</code> <code>Tuple[int, ...]</code> <p>\u5173\u8282\u901f\u5ea6\u3002</p> <code>joint_torques</code> <code>Tuple[int, ...]</code> <p>\u5173\u8282\u529b\u77e9\u3002</p> <code>joint_status</code> <code>Tuple[int, ...]</code> <p>\u5173\u8282\u72b6\u6001\u7801\u3002</p> <code>double_encoder_interpolations</code> <code>Tuple[int, ...]</code> <p>\u53cc\u7f16\u7801\u5668\u63d2\u503c\u3002</p> <code>errors</code> <code>Tuple[int, ...]</code> <p>\u9519\u8bef\u7801\u3002</p> <code>effector_data</code> <code>Any</code> <p>\u5939\u722a\u6570\u636e\u3002</p> <code>timestamp</code> <code>float</code> <p>\u63a5\u6536\u65f6\u95f4\u6233\u3002</p>"},{"location":"api/domain/value_objects/#controller.domain.value_objects.robot_state_snapshot.RobotStateSnapshot.from_decoded_message","title":"from_decoded_message  <code>classmethod</code>","text":"<pre><code>from_decoded_message(decoded_msg: Any) -&gt; RobotStateSnapshot\n</code></pre> <p>\u4ece\u89e3\u7801\u6d88\u606f\u521b\u5efa\u5feb\u7167\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>decoded_msg</code> <code>Any</code> <p>\u89e3\u7801\u540e\u7684\u6d88\u606f\u5bf9\u8c61\uff0c\u5e94\u5305\u542b positions(\u5f27\u5ea6), speeds, torques \u7b49\u5b57\u6bb5\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>RobotStateSnapshot</code> <code>RobotStateSnapshot</code> <p>\u521b\u5efa\u7684\u72b6\u6001\u5feb\u7167\u5b9e\u4f8b\u3002</p> Note <p>decoded_msg.positions \u5df2\u7ecf\u901a\u8fc7 position2radian \u8f6c\u6362\u4e3a\u5f27\u5ea6\u503c\uff0c \u6240\u4ee5 joint_angles \u76f4\u63a5\u4f7f\u7528\u8be5\u503c\u3002 joint_positions \u4f1a\u901a\u8fc7\u53cd\u5411\u8ba1\u7b97\u8fd8\u539f\u4e3a\u539f\u59cb\u7f16\u7801\u5668\u503c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/value_objects/robot_state_snapshot.py</code> <pre><code>@classmethod\ndef from_decoded_message(cls, decoded_msg: Any) -&gt; 'RobotStateSnapshot':\n    \"\"\"\u4ece\u89e3\u7801\u6d88\u606f\u521b\u5efa\u5feb\u7167\u3002\n\n    Args:\n        decoded_msg (Any): \u89e3\u7801\u540e\u7684\u6d88\u606f\u5bf9\u8c61\uff0c\u5e94\u5305\u542b positions(\u5f27\u5ea6), speeds, torques \u7b49\u5b57\u6bb5\u3002\n\n    Returns:\n        RobotStateSnapshot: \u521b\u5efa\u7684\u72b6\u6001\u5feb\u7167\u5b9e\u4f8b\u3002\n\n    Note:\n        decoded_msg.positions \u5df2\u7ecf\u901a\u8fc7 position2radian \u8f6c\u6362\u4e3a\u5f27\u5ea6\u503c\uff0c\n        \u6240\u4ee5 joint_angles \u76f4\u63a5\u4f7f\u7528\u8be5\u503c\u3002\n        joint_positions \u4f1a\u901a\u8fc7\u53cd\u5411\u8ba1\u7b97\u8fd8\u539f\u4e3a\u539f\u59cb\u7f16\u7801\u5668\u503c\u3002\n    \"\"\"        \n    robot_utils = RobotUtils()\n\n    # decoded_msg.positions \u5df2\u7ecf\u662f\u5f27\u5ea6\u503c\uff08\u7531MessageDecoder\u7684transform\u5b8c\u6210\uff09\n    # \u6240\u4ee5\u76f4\u63a5\u4f7f\u7528\uff0c\u4e0d\u9700\u8981\u518d\u6b21\u8f6c\u6362\n    angles = decoded_msg.positions  # \u5df2\u7ecf\u662f\u5f27\u5ea6\u503c\n\n    # \u53cd\u5411\u8ba1\u7b97\u539f\u59cb\u7f16\u7801\u5668\u4f4d\u7f6e\u503c\uff08\u7528\u4e8e\u4fdd\u5b58\u5b8c\u6574\u72b6\u6001\uff09\n    positions = robot_utils.radian2position(angles)\n\n    return cls(\n        init_status=decoded_msg.init_status,\n        control=decoded_msg.control,\n        mode=decoded_msg.mode,\n        joint_positions=tuple(positions),  # \u53cd\u5411\u8ba1\u7b97\u7684\u7f16\u7801\u5668\u503c\n        joint_angles=tuple(angles),        # \u76f4\u63a5\u4f7f\u7528\u89e3\u7801\u540e\u7684\u5f27\u5ea6\u503c\n        joint_speeds=tuple(decoded_msg.speeds),\n        joint_torques=tuple(decoded_msg.torques),\n        joint_status=tuple(decoded_msg.status),\n        double_encoder_interpolations=tuple(decoded_msg.double_encoder_interpolations),\n        errors=tuple(decoded_msg.errors),\n        effector_data=decoded_msg.effector_data,\n        timestamp=time.time()\n    )\n</code></pre>"},{"location":"api/domain/vision/","title":"Domain Layer - Vision Services","text":""},{"location":"api/domain/vision/#controller.domain.services.vision.camera_domain_service","title":"controller.domain.services.vision.camera_domain_service","text":"<p>\u6444\u50cf\u5934\u9886\u57df\u670d\u52a1 - Domain\u5c42 \u7ba1\u7406ROS2\u6444\u50cf\u5934\u8ba2\u9605\u8282\u70b9</p>"},{"location":"api/domain/vision/#controller.domain.services.vision.camera_domain_service.ColorImageSubscriber","title":"ColorImageSubscriber","text":"<pre><code>ColorImageSubscriber(callback)\n</code></pre> <p>               Bases: <code>Node</code></p> <p>\u5f69\u8272\u56fe\u50cf\u8ba2\u9605\u8282\u70b9\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>callback</code> <code>callable</code> <p>\u56fe\u50cf\u63a5\u6536\u56de\u8c03\u51fd\u6570\u3002</p> <code>bridge</code> <code>CvBridge</code> <p>CV \u6865\u63a5\u5668\u3002</p> <code>subscription</code> <code>Subscription</code> <p>ROS \u8ba2\u9605\u5bf9\u8c61\u3002</p> <p>\u521d\u59cb\u5316\u5f69\u8272\u56fe\u50cf\u8ba2\u9605\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>callback</code> <code>callable</code> <p>\u56fe\u50cf\u63a5\u6536\u56de\u8c03\u51fd\u6570\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code> <pre><code>def __init__(self, callback):\n    \"\"\"\u521d\u59cb\u5316\u5f69\u8272\u56fe\u50cf\u8ba2\u9605\u8282\u70b9\u3002\n\n    Args:\n        callback (callable): \u56fe\u50cf\u63a5\u6536\u56de\u8c03\u51fd\u6570\u3002\n    \"\"\"\n    super().__init__('color_image_subscriber')\n    self.callback = callback\n    self.bridge = CvBridge()\n\n    # \u8ba2\u9605\u5f69\u8272\u56fe\u50cf\u8bdd\u9898\n    self.subscription = self.create_subscription(\n        Image,\n        '/camera/color/image_raw',\n        self.image_callback,\n        10\n    )\n</code></pre>"},{"location":"api/domain/vision/#controller.domain.services.vision.camera_domain_service.ColorImageSubscriber.image_callback","title":"image_callback","text":"<pre><code>image_callback(msg)\n</code></pre> <p>\u56fe\u50cf\u56de\u8c03\u51fd\u6570\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>msg</code> <code>Image</code> <p>ROS \u56fe\u50cf\u6d88\u606f\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code> <pre><code>def image_callback(self, msg):\n    \"\"\"\u56fe\u50cf\u56de\u8c03\u51fd\u6570\u3002\n\n    Args:\n        msg (Image): ROS \u56fe\u50cf\u6d88\u606f\u3002\n    \"\"\"\n    try:\n        # \u8f6c\u6362\u4e3aOpenCV\u683c\u5f0f\uff08BGR\uff09\n        cv_image = self.bridge.imgmsg_to_cv2(msg, desired_encoding='bgr8')\n\n        # \u8c03\u7528\u56de\u8c03\u51fd\u6570\n        if self.callback:\n            self.callback(cv_image)\n\n    except CvBridgeError as e:\n        self.get_logger().error(f'\u5f69\u8272\u56fe\u50cf\u8f6c\u6362\u5931\u8d25: {e}')\n</code></pre>"},{"location":"api/domain/vision/#controller.domain.services.vision.camera_domain_service.DepthImageSubscriber","title":"DepthImageSubscriber","text":"<pre><code>DepthImageSubscriber(callback)\n</code></pre> <p>               Bases: <code>Node</code></p> <p>\u6df1\u5ea6\u56fe\u50cf\u8ba2\u9605\u8282\u70b9\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>callback</code> <code>callable</code> <p>\u56fe\u50cf\u63a5\u6536\u56de\u8c03\u51fd\u6570\u3002</p> <code>bridge</code> <code>CvBridge</code> <p>CV \u6865\u63a5\u5668\u3002</p> <code>subscription</code> <code>Subscription</code> <p>ROS \u8ba2\u9605\u5bf9\u8c61\u3002</p> <p>\u521d\u59cb\u5316\u6df1\u5ea6\u56fe\u50cf\u8ba2\u9605\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>callback</code> <code>callable</code> <p>\u56fe\u50cf\u63a5\u6536\u56de\u8c03\u51fd\u6570\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code> <pre><code>def __init__(self, callback):\n    \"\"\"\u521d\u59cb\u5316\u6df1\u5ea6\u56fe\u50cf\u8ba2\u9605\u8282\u70b9\u3002\n\n    Args:\n        callback (callable): \u56fe\u50cf\u63a5\u6536\u56de\u8c03\u51fd\u6570\u3002\n    \"\"\"\n    super().__init__('depth_image_subscriber')\n    self.callback = callback\n    self.bridge = CvBridge()\n\n    # \u8ba2\u9605\u6df1\u5ea6\u56fe\u50cf\u8bdd\u9898\n    self.subscription = self.create_subscription(\n        Image,\n        '/camera/depth/image_raw',\n        self.image_callback,\n        10\n    )\n</code></pre>"},{"location":"api/domain/vision/#controller.domain.services.vision.camera_domain_service.DepthImageSubscriber.image_callback","title":"image_callback","text":"<pre><code>image_callback(msg)\n</code></pre> <p>\u56fe\u50cf\u56de\u8c03\u51fd\u6570\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>msg</code> <code>Image</code> <p>ROS \u56fe\u50cf\u6d88\u606f\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code> <pre><code>def image_callback(self, msg):\n    \"\"\"\u56fe\u50cf\u56de\u8c03\u51fd\u6570\u3002\n\n    Args:\n        msg (Image): ROS \u56fe\u50cf\u6d88\u606f\u3002\n    \"\"\"\n    try:\n        # \u5904\u7406\u4e0d\u540c\u7684\u6df1\u5ea6\u56fe\u7f16\u7801\u683c\u5f0f\n        if msg.encoding == 'mono16' or msg.encoding == '16UC1':\n            cv_image = self.bridge.imgmsg_to_cv2(msg, desired_encoding='16UC1')\n        elif msg.encoding == '32FC1':\n            cv_image = self.bridge.imgmsg_to_cv2(msg, desired_encoding='32FC1')\n        else:\n            # \u5c1d\u8bd5\u76f4\u63a5\u8f6c\u6362\n            cv_image = self.bridge.imgmsg_to_cv2(msg, desired_encoding='passthrough')\n\n        # \u8c03\u7528\u56de\u8c03\u51fd\u6570\n        if self.callback:\n            self.callback(cv_image)\n\n    except CvBridgeError as e:\n        self.get_logger().error(f'\u6df1\u5ea6\u56fe\u50cf\u8f6c\u6362\u5931\u8d25: {e}')\n    except Exception as e:\n        self.get_logger().error(f'\u6df1\u5ea6\u56fe\u50cf\u5904\u7406\u5931\u8d25: {e}')\n</code></pre>"},{"location":"api/domain/vision/#controller.domain.services.vision.camera_domain_service.CameraDomainService","title":"CameraDomainService","text":"<pre><code>CameraDomainService()\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u6444\u50cf\u5934\u9886\u57df\u670d\u52a1\u3002</p> <p>\u804c\u8d23\uff1a - \u7ba1\u7406 ROS2 \u6444\u50cf\u5934\u8ba2\u9605\u8282\u70b9\u7684\u751f\u547d\u5468\u671f - \u7ef4\u62a4\u6700\u65b0\u7684\u5f69\u8272/\u6df1\u5ea6\u56fe\u50cf\u6570\u636e\uff08\u7ebf\u7a0b\u5b89\u5168\uff09 - \u53d1\u5c04\u56fe\u50cf\u63a5\u6536\u4fe1\u53f7 - \u6df1\u5ea6\u56fe\u53ef\u89c6\u5316\u5904\u7406</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>color_image_received</code> <code>pyqtSignal</code> <p>\u5f69\u8272\u56fe\u50cf\u63a5\u6536\u4fe1\u53f7\uff0c\u643a\u5e26\u56fe\u50cf\u6570\u636e (np.ndarray)\u3002</p> <code>depth_image_received</code> <code>pyqtSignal</code> <p>\u6df1\u5ea6\u56fe\u50cf\u63a5\u6536\u4fe1\u53f7\uff0c\u643a\u5e26\u56fe\u50cf\u6570\u636e (np.ndarray)\u3002</p> <code>connection_status_changed</code> <code>pyqtSignal</code> <p>\u8fde\u63a5\u72b6\u6001\u53d8\u66f4\u4fe1\u53f7\uff0c\u643a\u5e26 (connected, message)\u3002</p> <code>error_occurred</code> <code>pyqtSignal</code> <p>\u9519\u8bef\u4fe1\u53f7\uff0c\u643a\u5e26\u9519\u8bef\u4fe1\u606f\u3002</p> <p>\u521d\u59cb\u5316\u6444\u50cf\u5934\u9886\u57df\u670d\u52a1\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code> <pre><code>def __init__(self):\n    \"\"\"\u521d\u59cb\u5316\u6444\u50cf\u5934\u9886\u57df\u670d\u52a1\u3002\"\"\"\n    super().__init__()\n\n    # ROS\u8282\u70b9\u548c\u6267\u884c\u5668\n    self.color_subscriber = None\n    self.depth_subscriber = None\n    self.ros_executor = None\n    self.ros_thread = None\n\n    # cv_bridge\n    self.bridge = CvBridge()\n\n    # \u56fe\u50cf\u6570\u636e\u5b58\u50a8\uff08\u7ebf\u7a0b\u5b89\u5168\uff09\n    self.latest_color_image = None\n    self.latest_depth_image = None\n    self.color_image_lock = threading.Lock()\n    self.depth_image_lock = threading.Lock()\n\n    # \u8fde\u63a5\u72b6\u6001\n    self.is_connected = False\n    self.color_connected = False  # \u5f69\u8272\u6d41\u662f\u5426\u6709\u6570\u636e\n    self.depth_connected = False  # \u6df1\u5ea6\u6d41\u662f\u5426\u6709\u6570\u636e\n</code></pre>"},{"location":"api/domain/vision/#controller.domain.services.vision.camera_domain_service.CameraDomainService.connect","title":"connect","text":"<pre><code>connect() -&gt; bool\n</code></pre> <p>\u8fde\u63a5\u6444\u50cf\u5934\uff08\u542f\u52a8 ROS \u8ba2\u9605\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u8fde\u63a5\u6210\u529f\u8fd4\u56de True\uff0c\u5931\u8d25\u8fd4\u56de False\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code> <pre><code>def connect(self) -&gt; bool:\n    \"\"\"\u8fde\u63a5\u6444\u50cf\u5934\uff08\u542f\u52a8 ROS \u8ba2\u9605\uff09\u3002\n\n    Returns:\n        bool: \u8fde\u63a5\u6210\u529f\u8fd4\u56de True\uff0c\u5931\u8d25\u8fd4\u56de False\u3002\n    \"\"\"\n    try:\n        if self.is_connected:\n            return True\n\n        # \u68c0\u67e5\u5e76\u521d\u59cb\u5316ROS\uff08\u7075\u6d3b\u7b56\u7565\uff0c\u53c2\u8003\u65e7\u7248\uff09\n        if not rclpy.ok():\n            try:\n                rclpy.init()\n            except RuntimeError as e:\n                # ROS\u5df2\u7ecf\u521d\u59cb\u5316\u4f46\u72b6\u6001\u5f02\u5e38\n                self.error_occurred.emit(f\"ROS\u72b6\u6001\u5f02\u5e38: {str(e)}\")\n                return False\n\n        # \u521b\u5efa\u8ba2\u9605\u8282\u70b9\n        self.color_subscriber = ColorImageSubscriber(self._on_color_image_received)\n        self.depth_subscriber = DepthImageSubscriber(self._on_depth_image_received)\n\n        # \u521b\u5efaexecutor\n        self.ros_executor = MultiThreadedExecutor()\n        self.ros_executor.add_node(self.color_subscriber)\n        self.ros_executor.add_node(self.depth_subscriber)\n\n        # \u5728\u72ec\u7acb\u7ebf\u7a0b\u8fd0\u884cexecutor\n        self.ros_thread = threading.Thread(target=self._ros_spin_worker, daemon=True)\n        self.ros_thread.start()\n\n        self.is_connected = True\n        self.connection_status_changed.emit(True, \"\u6444\u50cf\u5934\u8fde\u63a5\u6210\u529f\")\n        return True\n\n    except Exception as e:\n        self.error_occurred.emit(f\"\u8fde\u63a5\u6444\u50cf\u5934\u5931\u8d25: {str(e)}\")\n        return False\n</code></pre>"},{"location":"api/domain/vision/#controller.domain.services.vision.camera_domain_service.CameraDomainService.disconnect","title":"disconnect","text":"<pre><code>disconnect() -&gt; bool\n</code></pre> <p>\u65ad\u5f00\u6444\u50cf\u5934\uff08\u5173\u95ed ROS \u8ba2\u9605\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u65ad\u5f00\u6210\u529f\u8fd4\u56de True\uff0c\u5931\u8d25\u8fd4\u56de False\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code> <pre><code>def disconnect(self) -&gt; bool:\n    \"\"\"\u65ad\u5f00\u6444\u50cf\u5934\uff08\u5173\u95ed ROS \u8ba2\u9605\uff09\u3002\n\n    Returns:\n        bool: \u65ad\u5f00\u6210\u529f\u8fd4\u56de True\uff0c\u5931\u8d25\u8fd4\u56de False\u3002\n    \"\"\"\n    try:\n        if not self.is_connected:\n            return True\n\n        self.is_connected = False\n        self.color_connected = False\n        self.depth_connected = False\n\n        # \u505c\u6b62executor\uff08\u53ea\u5f71\u54cd\u6444\u50cf\u5934\u8282\u70b9\uff09\n        if self.ros_executor:\n            self.ros_executor.shutdown()\n\n        # \u9500\u6bc1\u8282\u70b9\n        if self.color_subscriber:\n            self.color_subscriber.destroy_node()\n            self.color_subscriber = None\n        if self.depth_subscriber:\n            self.depth_subscriber.destroy_node()\n            self.depth_subscriber = None\n\n        # \u7b49\u5f85\u7ebf\u7a0b\u7ed3\u675f\n        if self.ros_thread and self.ros_thread.is_alive():\n            self.ros_thread.join(timeout=1.0)\n\n        self.ros_executor = None\n        self.ros_thread = None\n\n        # \u6e05\u7a7a\u56fe\u50cf\u6570\u636e\n        with self.color_image_lock:\n            self.latest_color_image = None\n        with self.depth_image_lock:\n            self.latest_depth_image = None\n\n        self.connection_status_changed.emit(False, \"\u6444\u50cf\u5934\u5df2\u65ad\u5f00\")\n        return True\n\n    except Exception as e:\n        self.error_occurred.emit(f\"\u65ad\u5f00\u6444\u50cf\u5934\u5931\u8d25: {str(e)}\")\n        return False\n</code></pre>"},{"location":"api/domain/vision/#controller.domain.services.vision.camera_domain_service.CameraDomainService.get_latest_color_image","title":"get_latest_color_image","text":"<pre><code>get_latest_color_image() -&gt; Optional[np.ndarray]\n</code></pre> <p>\u83b7\u53d6\u6700\u65b0\u5f69\u8272\u56fe\u50cf\uff08\u7ebf\u7a0b\u5b89\u5168\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[ndarray]</code> <p>Optional[np.ndarray]: \u56fe\u50cf\u6570\u636e\uff0c\u65e0\u6570\u636e\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code> <pre><code>def get_latest_color_image(self) -&gt; Optional[np.ndarray]:\n    \"\"\"\u83b7\u53d6\u6700\u65b0\u5f69\u8272\u56fe\u50cf\uff08\u7ebf\u7a0b\u5b89\u5168\uff09\u3002\n\n    Returns:\n        Optional[np.ndarray]: \u56fe\u50cf\u6570\u636e\uff0c\u65e0\u6570\u636e\u8fd4\u56de None\u3002\n    \"\"\"\n    with self.color_image_lock:\n        return self.latest_color_image.copy() if self.latest_color_image is not None else None\n</code></pre>"},{"location":"api/domain/vision/#controller.domain.services.vision.camera_domain_service.CameraDomainService.get_latest_depth_image","title":"get_latest_depth_image","text":"<pre><code>get_latest_depth_image() -&gt; Optional[np.ndarray]\n</code></pre> <p>\u83b7\u53d6\u6700\u65b0\u6df1\u5ea6\u56fe\u50cf\uff08\u7ebf\u7a0b\u5b89\u5168\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[ndarray]</code> <p>Optional[np.ndarray]: \u56fe\u50cf\u6570\u636e\uff0c\u65e0\u6570\u636e\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code> <pre><code>def get_latest_depth_image(self) -&gt; Optional[np.ndarray]:\n    \"\"\"\u83b7\u53d6\u6700\u65b0\u6df1\u5ea6\u56fe\u50cf\uff08\u7ebf\u7a0b\u5b89\u5168\uff09\u3002\n\n    Returns:\n        Optional[np.ndarray]: \u56fe\u50cf\u6570\u636e\uff0c\u65e0\u6570\u636e\u8fd4\u56de None\u3002\n    \"\"\"\n    with self.depth_image_lock:\n        return self.latest_depth_image.copy() if self.latest_depth_image is not None else None\n</code></pre>"},{"location":"api/domain/vision/#controller.domain.services.vision.camera_domain_service.CameraDomainService.is_color_available","title":"is_color_available","text":"<pre><code>is_color_available() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u5f69\u8272\u56fe\u50cf\u662f\u5426\u53ef\u7528\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u53ef\u7528\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code> <pre><code>def is_color_available(self) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u5f69\u8272\u56fe\u50cf\u662f\u5426\u53ef\u7528\u3002\n\n    Returns:\n        bool: \u662f\u5426\u53ef\u7528\u3002\n    \"\"\"\n    return self.color_connected and self.latest_color_image is not None\n</code></pre>"},{"location":"api/domain/vision/#controller.domain.services.vision.camera_domain_service.CameraDomainService.is_depth_available","title":"is_depth_available","text":"<pre><code>is_depth_available() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u6df1\u5ea6\u56fe\u50cf\u662f\u5426\u53ef\u7528\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u53ef\u7528\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code> <pre><code>def is_depth_available(self) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u6df1\u5ea6\u56fe\u50cf\u662f\u5426\u53ef\u7528\u3002\n\n    Returns:\n        bool: \u662f\u5426\u53ef\u7528\u3002\n    \"\"\"\n    return self.depth_connected and self.latest_depth_image is not None\n</code></pre>"},{"location":"api/domain/vision/#controller.domain.services.vision.camera_domain_service.CameraDomainService.visualize_depth_image","title":"visualize_depth_image","text":"<pre><code>visualize_depth_image(depth_image: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u6df1\u5ea6\u56fe\u53ef\u89c6\u5316\u4e3a\u4f2a\u5f69\u8272\u56fe\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>depth_image</code> <code>ndarray</code> <p>\u539f\u59cb\u6df1\u5ea6\u56fe\uff0816\u4f4d\u621632\u4f4d\u6d6e\u70b9\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u4f2a\u5f69\u8272\u6df1\u5ea6\u56fe\uff08BGR, uint8\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code> <pre><code>def visualize_depth_image(self, depth_image: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u6df1\u5ea6\u56fe\u53ef\u89c6\u5316\u4e3a\u4f2a\u5f69\u8272\u56fe\u3002\n\n    Args:\n        depth_image (np.ndarray): \u539f\u59cb\u6df1\u5ea6\u56fe\uff0816\u4f4d\u621632\u4f4d\u6d6e\u70b9\uff09\u3002\n\n    Returns:\n        np.ndarray: \u4f2a\u5f69\u8272\u6df1\u5ea6\u56fe\uff08BGR, uint8\uff09\u3002\n    \"\"\"\n    try:\n        # \u8fc7\u6ee4\u65e0\u6548\u503c\uff08depth &lt;= 0 \u6216 nan\uff09\n        valid_mask = (depth_image &gt; 0) &amp; np.isfinite(depth_image)\n\n        if not np.any(valid_mask):\n            # \u5982\u679c\u6ca1\u6709\u6709\u6548\u6570\u636e\uff0c\u8fd4\u56de\u9ed1\u8272\u56fe\u50cf\n            depth_display = np.zeros_like(depth_image, dtype=np.uint8)\n        else:\n            # \u5f52\u4e00\u5316\u5230 0-255\n            min_val = np.min(depth_image[valid_mask])\n            max_val = np.max(depth_image[valid_mask])\n\n            if max_val - min_val &lt; 1e-6:\n                depth_display = np.zeros_like(depth_image, dtype=np.uint8)\n            else:\n                norm = (depth_image - min_val) / (max_val - min_val)\n                norm[~valid_mask] = 0\n                depth_display = (norm * 255).astype(np.uint8)\n\n        # \u5e94\u7528\u4f2a\u5f69\u8272\u6620\u5c04\n        depth_colormap = cv2.applyColorMap(depth_display, cv2.COLORMAP_JET)\n        return depth_colormap\n\n    except Exception as e:\n        # \u5982\u679c\u53ef\u89c6\u5316\u5931\u8d25\uff0c\u8fd4\u56de\u9ed1\u8272\u56fe\u50cf\n        height, width = depth_image.shape[:2]\n        return np.zeros((height, width, 3), dtype=np.uint8)\n</code></pre>"},{"location":"api/domain/vision/#controller.domain.services.vision.recognition_domain_service","title":"controller.domain.services.vision.recognition_domain_service","text":"<p>\u96f6\u4ef6\u8bc6\u522b\u9886\u57df\u670d\u52a1 - Domain\u5c42 \u7ba1\u7406ROS2\u68c0\u6d4b\u7ed3\u679c\u8ba2\u9605\u8282\u70b9</p>"},{"location":"api/domain/vision/#controller.domain.services.vision.recognition_domain_service.DetectionSubscriberNode","title":"DetectionSubscriberNode","text":"<pre><code>DetectionSubscriberNode(callback)\n</code></pre> <p>               Bases: <code>Node</code></p> <p>\u68c0\u6d4b\u7ed3\u679c\u8ba2\u9605\u8282\u70b9\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>callback</code> <code>callable</code> <p>\u68c0\u6d4b\u7ed3\u679c\u56de\u8c03\u51fd\u6570\u3002</p> <code>subscription</code> <code>Subscription</code> <p>ROS \u8ba2\u9605\u5bf9\u8c61\u3002</p> <p>\u521d\u59cb\u5316\u68c0\u6d4b\u7ed3\u679c\u8ba2\u9605\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>callback</code> <code>callable</code> <p>\u68c0\u6d4b\u7ed3\u679c\u56de\u8c03\u51fd\u6570\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/recognition_domain_service.py</code> <pre><code>def __init__(self, callback):\n    \"\"\"\u521d\u59cb\u5316\u68c0\u6d4b\u7ed3\u679c\u8ba2\u9605\u8282\u70b9\u3002\n\n    Args:\n        callback (callable): \u68c0\u6d4b\u7ed3\u679c\u56de\u8c03\u51fd\u6570\u3002\n    \"\"\"\n    super().__init__('detection_subscriber')\n    self.callback = callback\n\n    # \u8ba2\u9605\u68c0\u6d4b\u7ed3\u679c\u8bdd\u9898\n    self.subscription = self.create_subscription(\n        DetectionResult,\n        'recognition_result',\n        self.detection_callback,\n        10\n    )\n</code></pre>"},{"location":"api/domain/vision/#controller.domain.services.vision.recognition_domain_service.DetectionSubscriberNode.detection_callback","title":"detection_callback","text":"<pre><code>detection_callback(msg)\n</code></pre> <p>\u68c0\u6d4b\u7ed3\u679c\u56de\u8c03\u51fd\u6570\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>msg</code> <code>DetectionResult</code> <p>ROS \u68c0\u6d4b\u7ed3\u679c\u6d88\u606f\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/recognition_domain_service.py</code> <pre><code>def detection_callback(self, msg):\n    \"\"\"\u68c0\u6d4b\u7ed3\u679c\u56de\u8c03\u51fd\u6570\u3002\n\n    Args:\n        msg (DetectionResult): ROS \u68c0\u6d4b\u7ed3\u679c\u6d88\u606f\u3002\n    \"\"\"\n    try:\n        # \u5c06ROS\u6d88\u606f\u8f6c\u6362\u4e3a\u5b57\u5178\u683c\u5f0f\n        detection_result = {\n            'head_center': tuple(msg.head_center),\n            'central_center': tuple(msg.central_center),\n            'real_center': tuple(msg.real_center),\n            'angle': msg.angle,\n            'depth': msg.depth,\n            'real_depth': msg.real_depth\n        }\n\n        # \u8c03\u7528\u56de\u8c03\u51fd\u6570\n        if self.callback:\n            self.callback(detection_result)\n\n    except Exception as e:\n        self.get_logger().error(f'\u5904\u7406\u68c0\u6d4b\u7ed3\u679c\u5931\u8d25: {e}')\n</code></pre>"},{"location":"api/domain/vision/#controller.domain.services.vision.recognition_domain_service.RecognitionDomainService","title":"RecognitionDomainService","text":"<pre><code>RecognitionDomainService()\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u96f6\u4ef6\u8bc6\u522b\u9886\u57df\u670d\u52a1\u3002</p> <p>\u804c\u8d23\uff1a - \u8ba2\u9605 recognition_result ROS \u8bdd\u9898 - \u7ef4\u62a4\u6700\u65b0\u68c0\u6d4b\u7ed3\u679c\uff08\u7ebf\u7a0b\u5b89\u5168\uff09 - \u72ec\u7acb\u4e8e\u6444\u50cf\u5934\u670d\u52a1\u8fd0\u884c - \u53d1\u5c04\u68c0\u6d4b\u7ed3\u679c\u4fe1\u53f7</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>detection_result_received</code> <code>pyqtSignal</code> <p>\u68c0\u6d4b\u7ed3\u679c\u63a5\u6536\u4fe1\u53f7\uff0c\u643a\u5e26\u7ed3\u679c\u5b57\u5178\u3002</p> <code>detection_status_changed</code> <code>pyqtSignal</code> <p>\u68c0\u6d4b\u72b6\u6001\u53d8\u66f4\u4fe1\u53f7\uff0c\u643a\u5e26 (is_running, message)\u3002</p> <code>error_occurred</code> <code>pyqtSignal</code> <p>\u9519\u8bef\u4fe1\u53f7\uff0c\u643a\u5e26\u9519\u8bef\u4fe1\u606f\u3002</p> <p>\u521d\u59cb\u5316\u96f6\u4ef6\u8bc6\u522b\u9886\u57df\u670d\u52a1\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/recognition_domain_service.py</code> <pre><code>def __init__(self):\n    \"\"\"\u521d\u59cb\u5316\u96f6\u4ef6\u8bc6\u522b\u9886\u57df\u670d\u52a1\u3002\"\"\"\n    super().__init__()\n\n    # ROS\u8282\u70b9\u548c\u6267\u884c\u5668\n    self.detection_subscriber = None\n    self.ros_executor = None\n    self.ros_thread = None\n\n    # \u68c0\u6d4b\u7ed3\u679c\u5b58\u50a8\uff08\u7ebf\u7a0b\u5b89\u5168\uff09\n    self.latest_detection_result = {}\n    self.detection_lock = threading.Lock()\n\n    # \u8fd0\u884c\u72b6\u6001\n    self.is_running = False\n</code></pre>"},{"location":"api/domain/vision/#controller.domain.services.vision.recognition_domain_service.RecognitionDomainService.start_detection","title":"start_detection","text":"<pre><code>start_detection() -&gt; bool\n</code></pre> <p>\u5f00\u59cb\u68c0\u6d4b\uff08\u542f\u52a8 ROS \u8ba2\u9605\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u542f\u52a8\u6210\u529f\u8fd4\u56de True\uff0c\u5931\u8d25\u8fd4\u56de False\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/recognition_domain_service.py</code> <pre><code>def start_detection(self) -&gt; bool:\n    \"\"\"\u5f00\u59cb\u68c0\u6d4b\uff08\u542f\u52a8 ROS \u8ba2\u9605\uff09\u3002\n\n    Returns:\n        bool: \u542f\u52a8\u6210\u529f\u8fd4\u56de True\uff0c\u5931\u8d25\u8fd4\u56de False\u3002\n    \"\"\"\n    try:\n        if self.is_running:\n            return True\n\n        # \u68c0\u67e5\u5e76\u521d\u59cb\u5316ROS\uff08\u7075\u6d3b\u7b56\u7565\uff0c\u53c2\u8003\u65e7\u7248\uff09\n        if not rclpy.ok():\n            try:\n                rclpy.init()\n            except RuntimeError as e:\n                # ROS\u5df2\u7ecf\u521d\u59cb\u5316\u4f46\u72b6\u6001\u5f02\u5e38\n                self.error_occurred.emit(f\"ROS\u72b6\u6001\u5f02\u5e38: {str(e)}\")\n                return False\n            except Exception as e:\n                self.error_occurred.emit(f\"ROS\u521d\u59cb\u5316\u5931\u8d25: {str(e)}\")\n                return False\n\n        # \u521b\u5efa\u8ba2\u9605\u8282\u70b9\n        self.detection_subscriber = DetectionSubscriberNode(self._on_detection_received)\n\n        # \u521b\u5efaexecutor\n        self.ros_executor = SingleThreadedExecutor()\n        self.ros_executor.add_node(self.detection_subscriber)\n\n        # \u5728\u72ec\u7acb\u7ebf\u7a0b\u8fd0\u884cexecutor\n        self.ros_thread = threading.Thread(target=self._ros_spin_worker, daemon=True)\n        self.ros_thread.start()\n\n        self.is_running = True\n        self.detection_status_changed.emit(True, \"\u5f00\u59cb\u96f6\u4ef6\u8bc6\u522b\")\n        return True\n\n    except Exception as e:\n        self.error_occurred.emit(f\"\u542f\u52a8\u68c0\u6d4b\u5931\u8d25: {str(e)}\")\n        return False\n</code></pre>"},{"location":"api/domain/vision/#controller.domain.services.vision.recognition_domain_service.RecognitionDomainService.stop_detection","title":"stop_detection","text":"<pre><code>stop_detection() -&gt; bool\n</code></pre> <p>\u505c\u6b62\u68c0\u6d4b\uff08\u5173\u95ed ROS \u8ba2\u9605\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u505c\u6b62\u6210\u529f\u8fd4\u56de True\uff0c\u5931\u8d25\u8fd4\u56de False\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/recognition_domain_service.py</code> <pre><code>def stop_detection(self) -&gt; bool:\n    \"\"\"\u505c\u6b62\u68c0\u6d4b\uff08\u5173\u95ed ROS \u8ba2\u9605\uff09\u3002\n\n    Returns:\n        bool: \u505c\u6b62\u6210\u529f\u8fd4\u56de True\uff0c\u5931\u8d25\u8fd4\u56de False\u3002\n    \"\"\"\n    try:\n        if not self.is_running:\n            return True\n\n        self.is_running = False\n\n        # \u505c\u6b62executor\uff08\u53ea\u5f71\u54cd\u68c0\u6d4b\u8282\u70b9\uff09\n        if self.ros_executor:\n            self.ros_executor.shutdown()\n\n        # \u9500\u6bc1\u8282\u70b9\n        if self.detection_subscriber:\n            self.detection_subscriber.destroy_node()\n            self.detection_subscriber = None\n\n        # \u7b49\u5f85\u7ebf\u7a0b\u7ed3\u675f\n        if self.ros_thread and self.ros_thread.is_alive():\n            self.ros_thread.join(timeout=1.0)\n\n        self.ros_executor = None\n        self.ros_thread = None\n\n        # \u6e05\u7a7a\u68c0\u6d4b\u7ed3\u679c\n        with self.detection_lock:\n            self.latest_detection_result = {}\n\n        self.detection_status_changed.emit(False, \"\u505c\u6b62\u96f6\u4ef6\u8bc6\u522b\")\n        return True\n\n    except Exception as e:\n        self.error_occurred.emit(f\"\u505c\u6b62\u68c0\u6d4b\u5931\u8d25: {str(e)}\")\n        return False\n</code></pre>"},{"location":"api/domain/vision/#controller.domain.services.vision.recognition_domain_service.RecognitionDomainService.get_latest_result","title":"get_latest_result","text":"<pre><code>get_latest_result() -&gt; Optional[Dict]\n</code></pre> <p>\u83b7\u53d6\u6700\u65b0\u68c0\u6d4b\u7ed3\u679c\uff08\u7ebf\u7a0b\u5b89\u5168\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[Dict]</code> <p>Optional[Dict]: \u68c0\u6d4b\u7ed3\u679c\u5b57\u5178\uff0c\u65e0\u7ed3\u679c\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/recognition_domain_service.py</code> <pre><code>def get_latest_result(self) -&gt; Optional[Dict]:\n    \"\"\"\u83b7\u53d6\u6700\u65b0\u68c0\u6d4b\u7ed3\u679c\uff08\u7ebf\u7a0b\u5b89\u5168\uff09\u3002\n\n    Returns:\n        Optional[Dict]: \u68c0\u6d4b\u7ed3\u679c\u5b57\u5178\uff0c\u65e0\u7ed3\u679c\u8fd4\u56de None\u3002\n    \"\"\"\n    with self.detection_lock:\n        if self.latest_detection_result:\n            return copy.deepcopy(self.latest_detection_result)\n        return None\n</code></pre>"},{"location":"api/domain/vision/#controller.domain.services.vision.recognition_domain_service.RecognitionDomainService.is_detection_running","title":"is_detection_running","text":"<pre><code>is_detection_running() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u68c0\u6d4b\u662f\u5426\u6b63\u5728\u8fd0\u884c\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u6b63\u5728\u8fd0\u884c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/recognition_domain_service.py</code> <pre><code>def is_detection_running(self) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u68c0\u6d4b\u662f\u5426\u6b63\u5728\u8fd0\u884c\u3002\n\n    Returns:\n        bool: \u662f\u5426\u6b63\u5728\u8fd0\u884c\u3002\n    \"\"\"\n    return self.is_running\n</code></pre>"},{"location":"api/domain/vision/#controller.domain.services.vision.recognition_domain_service.RecognitionDomainService.clear_result","title":"clear_result","text":"<pre><code>clear_result()\n</code></pre> <p>\u6e05\u9664\u68c0\u6d4b\u7ed3\u679c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/recognition_domain_service.py</code> <pre><code>def clear_result(self):\n    \"\"\"\u6e05\u9664\u68c0\u6d4b\u7ed3\u679c\u3002\"\"\"\n    with self.detection_lock:\n        self.latest_detection_result = {}\n</code></pre>"},{"location":"api/infrastructure/communication/adapter/","title":"Serial Adapter","text":""},{"location":"api/infrastructure/communication/adapter/#controller.infrastructure.communication.serial_adapter","title":"controller.infrastructure.communication.serial_adapter","text":"<p>\u4e32\u53e3\u9002\u914d\u5668 - Infrastructure\u5c42 \u8d1f\u8d23\u7ba1\u7406\u4e32\u53e3\u8fde\u63a5\u548c\u65ad\u5f00</p>"},{"location":"api/infrastructure/communication/adapter/#controller.infrastructure.communication.serial_adapter.SerialAdapter","title":"SerialAdapter","text":"<pre><code>SerialAdapter()\n</code></pre> <p>\u4e32\u53e3\u8fde\u63a5\u9002\u914d\u5668\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>serial_port</code> <code>Optional[Serial]</code> <p>PySerial \u5b9e\u4f8b\u3002</p> <code>current_config</code> <code>Optional[Dict[str, Any]]</code> <p>\u5f53\u524d\u914d\u7f6e\u5b57\u5178\u3002</p> <p>\u521d\u59cb\u5316\u4e32\u53e3\u9002\u914d\u5668\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_adapter.py</code> <pre><code>def __init__(self):\n    \"\"\"\u521d\u59cb\u5316\u4e32\u53e3\u9002\u914d\u5668\u3002\"\"\"\n    self.serial_port: Optional[serial.Serial] = None\n    self.current_config: Optional[Dict[str, Any]] = None\n</code></pre>"},{"location":"api/infrastructure/communication/adapter/#controller.infrastructure.communication.serial_adapter.SerialAdapter.connect","title":"connect","text":"<pre><code>connect(port: str, config: Dict[str, Any]) -&gt; bool\n</code></pre> <p>\u8fde\u63a5\u4e32\u53e3\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>port</code> <code>str</code> <p>\u4e32\u53e3\u540d\u79f0\u3002</p> \u5fc5\u9700 <code>config</code> <code>Dict[str, Any]</code> <p>\u4e32\u53e3\u914d\u7f6e\u53c2\u6570\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u8fde\u63a5\u662f\u5426\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_adapter.py</code> <pre><code>def connect(self, port: str, config: Dict[str, Any]) -&gt; bool:\n    \"\"\"\u8fde\u63a5\u4e32\u53e3\u3002\n\n    Args:\n        port (str): \u4e32\u53e3\u540d\u79f0\u3002\n        config (Dict[str, Any]): \u4e32\u53e3\u914d\u7f6e\u53c2\u6570\u3002\n\n    Returns:\n        bool: \u8fde\u63a5\u662f\u5426\u6210\u529f\u3002\n    \"\"\"\n    try:\n        # \u5982\u679c\u5df2\u7ecf\u8fde\u63a5\uff0c\u5148\u65ad\u5f00\n        if self.is_connected():\n            self.disconnect()\n\n        # \u521b\u5efa\u4e32\u53e3\u8fde\u63a5\n        self.serial_port = serial.Serial(\n            port=port,\n            baudrate=config.get('baudrate', 115200),\n            bytesize=config.get('bytesize', 8),\n            parity=config.get('parity', 'N'),\n            stopbits=config.get('stopbits', 1),\n            timeout=config.get('timeout', 1),\n            xonxoff=config.get('xonxoff', False),\n            rtscts=config.get('rtscts', False),\n            dsrdtr=config.get('dsrdtr', False)\n        )\n\n        # \u4fdd\u5b58\u914d\u7f6e\n        self.current_config = config.copy()\n        self.current_config['port'] = port\n\n        return True\n\n    except Exception:\n        self.serial_port = None\n        self.current_config = None\n        return False\n</code></pre>"},{"location":"api/infrastructure/communication/adapter/#controller.infrastructure.communication.serial_adapter.SerialAdapter.disconnect","title":"disconnect","text":"<pre><code>disconnect() -&gt; bool\n</code></pre> <p>\u65ad\u5f00\u4e32\u53e3\u8fde\u63a5\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u65ad\u5f00\u662f\u5426\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_adapter.py</code> <pre><code>def disconnect(self) -&gt; bool:\n    \"\"\"\u65ad\u5f00\u4e32\u53e3\u8fde\u63a5\u3002\n\n    Returns:\n        bool: \u65ad\u5f00\u662f\u5426\u6210\u529f\u3002\n    \"\"\"\n    try:\n        if self.serial_port and self.serial_port.is_open:\n            self.serial_port.close()\n        return True\n    except Exception:\n        return False\n    finally:\n        self.serial_port = None\n        self.current_config = None\n</code></pre>"},{"location":"api/infrastructure/communication/adapter/#controller.infrastructure.communication.serial_adapter.SerialAdapter.is_connected","title":"is_connected","text":"<pre><code>is_connected() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u4e32\u53e3\u662f\u5426\u5df2\u8fde\u63a5\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u5df2\u8fde\u63a5\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_adapter.py</code> <pre><code>def is_connected(self) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u4e32\u53e3\u662f\u5426\u5df2\u8fde\u63a5\u3002\n\n    Returns:\n        bool: \u662f\u5426\u5df2\u8fde\u63a5\u3002\n    \"\"\"\n    return (self.serial_port is not None and \n            self.serial_port.is_open)\n</code></pre>"},{"location":"api/infrastructure/communication/adapter/#controller.infrastructure.communication.serial_adapter.SerialAdapter.get_serial_port","title":"get_serial_port","text":"<pre><code>get_serial_port() -&gt; Optional[serial.Serial]\n</code></pre> <p>\u83b7\u53d6\u4e32\u53e3\u5bf9\u8c61\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[Serial]</code> <p>Optional[serial.Serial]: \u4e32\u53e3\u5bf9\u8c61\uff0c\u672a\u8fde\u63a5\u65f6\u8fd4\u56deNone\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_adapter.py</code> <pre><code>def get_serial_port(self) -&gt; Optional[serial.Serial]:\n    \"\"\"\u83b7\u53d6\u4e32\u53e3\u5bf9\u8c61\u3002\n\n    Returns:\n        Optional[serial.Serial]: \u4e32\u53e3\u5bf9\u8c61\uff0c\u672a\u8fde\u63a5\u65f6\u8fd4\u56deNone\u3002\n    \"\"\"\n    if self.is_connected():\n        return self.serial_port\n    return None\n</code></pre>"},{"location":"api/infrastructure/communication/adapter/#controller.infrastructure.communication.serial_adapter.SerialAdapter.get_current_config","title":"get_current_config","text":"<pre><code>get_current_config() -&gt; Optional[Dict[str, Any]]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u914d\u7f6e\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[Dict[str, Any]]</code> <p>Optional[Dict[str, Any]]: \u5f53\u524d\u914d\u7f6e\uff0c\u672a\u8fde\u63a5\u65f6\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_adapter.py</code> <pre><code>def get_current_config(self) -&gt; Optional[Dict[str, Any]]:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u914d\u7f6e\u3002\n\n    Returns:\n        Optional[Dict[str, Any]]: \u5f53\u524d\u914d\u7f6e\uff0c\u672a\u8fde\u63a5\u65f6\u8fd4\u56de None\u3002\n    \"\"\"\n    return self.current_config.copy() if self.current_config else None\n</code></pre>"},{"location":"api/infrastructure/communication/adapter/#controller.infrastructure.communication.serial_adapter.SerialAdapter.get_port_name","title":"get_port_name","text":"<pre><code>get_port_name() -&gt; Optional[str]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u7684\u7aef\u53e3\u540d\u79f0\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[str]</code> <p>Optional[str]: \u7aef\u53e3\u540d\u79f0\uff0c\u672a\u8fde\u63a5\u65f6\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_adapter.py</code> <pre><code>def get_port_name(self) -&gt; Optional[str]:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u7684\u7aef\u53e3\u540d\u79f0\u3002\n\n    Returns:\n        Optional[str]: \u7aef\u53e3\u540d\u79f0\uff0c\u672a\u8fde\u63a5\u65f6\u8fd4\u56de None\u3002\n    \"\"\"\n    if self.current_config:\n        return self.current_config.get('port')\n    return None\n</code></pre>"},{"location":"api/infrastructure/communication/reader/","title":"Serial Reader","text":""},{"location":"api/infrastructure/communication/reader/#controller.infrastructure.communication.serial_reader","title":"controller.infrastructure.communication.serial_reader","text":"<p>\u4e32\u53e3\u8bfb\u53d6\u5668 - Infrastructure\u5c42 \u8d1f\u8d23\u591a\u7ebf\u7a0b\u8bfb\u53d6\u4e32\u53e3\u6570\u636e</p>"},{"location":"api/infrastructure/communication/reader/#controller.infrastructure.communication.serial_reader.SerialReader","title":"SerialReader","text":"<pre><code>SerialReader(serial_port: Optional[Serial] = None)\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u4e32\u53e3\u8bfb\u53d6\u5904\u7406\u7c7b\u3002</p> <p>\u8d1f\u8d23\u5728\u72ec\u7acb\u7ebf\u7a0b\u4e2d\u8bfb\u53d6\u4e32\u53e3\u6570\u636e\uff0c\u652f\u6301\u591a\u79cd\u7f16\u7801\u683c\u5f0f\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>data_received</code> <code>pyqtSignal</code> <p>\u63a5\u6536\u5230\u6570\u636e\u65f6\u53d1\u9001\u4fe1\u53f7\uff0c\u643a\u5e26\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u3002</p> <p>\u521d\u59cb\u5316\u4e32\u53e3\u8bfb\u53d6\u5668\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>serial_port</code> <code>Serial</code> <p>\u4e32\u53e3\u5bf9\u8c61\u3002</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_reader.py</code> <pre><code>def __init__(self, serial_port: Optional[serial.Serial] = None):\n    \"\"\"\u521d\u59cb\u5316\u4e32\u53e3\u8bfb\u53d6\u5668\u3002\n\n    Args:\n        serial_port (serial.Serial, optional): \u4e32\u53e3\u5bf9\u8c61\u3002\n    \"\"\"\n    super().__init__()\n    self.serial_port = serial_port\n    self.stop_flag = False\n</code></pre>"},{"location":"api/infrastructure/communication/reader/#controller.infrastructure.communication.serial_reader.SerialReader.stop","title":"stop","text":"<pre><code>stop() -&gt; None\n</code></pre> <p>\u505c\u6b62\u8bfb\u53d6\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_reader.py</code> <pre><code>def stop(self) -&gt; None:\n    \"\"\"\u505c\u6b62\u8bfb\u53d6\u3002\"\"\"\n    self.stop_flag = True\n</code></pre>"},{"location":"api/infrastructure/communication/reader/#controller.infrastructure.communication.serial_reader.SerialReader.read_data","title":"read_data","text":"<pre><code>read_data() -&gt; None\n</code></pre> <p>\u8bfb\u53d6\u4e32\u53e3\u6570\u636e - \u5728\u72ec\u7acb\u7ebf\u7a0b\u4e2d\u8fd0\u884c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_reader.py</code> <pre><code>def read_data(self) -&gt; None:\n    \"\"\"\u8bfb\u53d6\u4e32\u53e3\u6570\u636e - \u5728\u72ec\u7acb\u7ebf\u7a0b\u4e2d\u8fd0\u884c\u3002\"\"\"\n    self.stop_flag = False\n\n    while not self.stop_flag:\n        if not self.serial_port or not self.serial_port.is_open:\n            time.sleep(0.1)\n            continue\n\n        try:\n            waiting_bytes = self.serial_port.in_waiting\n        except OSError:\n            time.sleep(0.1)\n            continue\n\n        if waiting_bytes &gt; 0:\n            try:\n                data = self.serial_port.read(waiting_bytes)\n\n                # \u56fa\u5b9a\u4f7f\u7528\u5341\u516d\u8fdb\u5236\u683c\u5f0f\n                hex_data = data.hex().upper()\n                self.data_received.emit(hex_data)\n\n            except serial.SerialException:\n                time.sleep(0.1)\n                continue\n        else:\n            time.sleep(0.01)\n\n        time.sleep(0.01) \n</code></pre>"},{"location":"api/infrastructure/communication/scanner/","title":"Port Scanner","text":""},{"location":"api/infrastructure/communication/scanner/#controller.infrastructure.communication.port_scanner","title":"controller.infrastructure.communication.port_scanner","text":"<p>\u4e32\u53e3\u626b\u63cf\u5668 - Infrastructure\u5c42 \u8d1f\u8d23\u626b\u63cf\u53ef\u7528\u7684\u4e32\u53e3\u7aef\u53e3</p>"},{"location":"api/infrastructure/communication/scanner/#controller.infrastructure.communication.port_scanner.PortScanner","title":"PortScanner","text":"<p>\u4e32\u53e3\u7aef\u53e3\u626b\u63cf\u5668\u3002</p> <p>\u8d1f\u8d23\u626b\u63cf\u53ef\u7528\u7684\u4e32\u53e3\u7aef\u53e3\uff0c\u5305\u542b\u771f\u5b9e\u4e32\u53e3\u548c\u865a\u62df\u4e32\u53e3\u3002</p>"},{"location":"api/infrastructure/communication/scanner/#controller.infrastructure.communication.port_scanner.PortScanner.scan_ports","title":"scan_ports  <code>staticmethod</code>","text":"<pre><code>scan_ports() -&gt; List[str]\n</code></pre> <p>\u626b\u63cf\u53ef\u7528\u7684\u4e32\u53e3\u7aef\u53e3\uff08\u5305\u542b\u771f\u5b9e\u4e32\u53e3\u548c\u865a\u62df\u4e32\u53e3\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>List[str]: \u53ef\u7528\u7aef\u53e3\u540d\u79f0\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/port_scanner.py</code> <pre><code>@staticmethod\ndef scan_ports() -&gt; List[str]:\n    \"\"\"\u626b\u63cf\u53ef\u7528\u7684\u4e32\u53e3\u7aef\u53e3\uff08\u5305\u542b\u771f\u5b9e\u4e32\u53e3\u548c\u865a\u62df\u4e32\u53e3\uff09\u3002\n\n    Returns:\n        List[str]: \u53ef\u7528\u7aef\u53e3\u540d\u79f0\u5217\u8868\u3002\n    \"\"\"\n    all_ports = []\n\n    try:\n        # 1. \u626b\u63cf\u771f\u5b9e\u786c\u4ef6\u4e32\u53e3\n        ports = serial.tools.list_ports.comports()\n        all_ports.extend([port.device for port in ports])\n\n        # 2. \u626b\u63cf\u865a\u62df\u4e32\u53e3\uff08\u4f2a\u7ec8\u7aef\uff09\n        virtual_port_patterns = [\n            '/dev/pts/*',      # \u4f2a\u7ec8\u7aef\n            '/tmp/tty*',       # \u4e34\u65f6\u865a\u62df\u4e32\u53e3\uff08socat\u521b\u5efa\u7684\uff09\n            '/dev/ttyV*',      # \u865a\u62df\u4e32\u53e3\u8bbe\u5907\n        ]\n\n        for pattern in virtual_port_patterns:\n            for device in glob.glob(pattern):\n                # \u68c0\u67e5\u662f\u5426\u662f\u5b57\u7b26\u8bbe\u5907\u4e14\u53ef\u8bbf\u95ee\n                if os.path.exists(device) and PortScanner._is_accessible(device):\n                    if device not in all_ports:\n                        all_ports.append(device)\n\n        # \u6392\u5e8f\uff1a\u771f\u5b9e\u4e32\u53e3\u5728\u524d\uff0c\u865a\u62df\u4e32\u53e3\u5728\u540e\n        all_ports.sort(key=lambda x: (not x.startswith('/dev/ttyUSB'), \n                                     not x.startswith('/dev/ttyACM'), \n                                     x))\n\n        return all_ports\n\n    except Exception:\n        return all_ports\n</code></pre>"},{"location":"api/infrastructure/communication/scanner/#controller.infrastructure.communication.port_scanner.PortScanner.get_port_info","title":"get_port_info  <code>staticmethod</code>","text":"<pre><code>get_port_info(port_name: str) -&gt; Optional[Dict[str, str]]\n</code></pre> <p>\u83b7\u53d6\u6307\u5b9a\u7aef\u53e3\u7684\u8be6\u7ec6\u4fe1\u606f\uff08\u652f\u6301\u771f\u5b9e\u4e32\u53e3\u548c\u865a\u62df\u4e32\u53e3\uff09\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>port_name</code> <code>str</code> <p>\u7aef\u53e3\u540d\u79f0\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[Dict[str, str]]</code> <p>Optional[Dict[str, str]]: \u7aef\u53e3\u4fe1\u606f\u5b57\u5178\uff0c\u5305\u542b description \u548c hwid\u3002\u5982\u679c\u7aef\u53e3\u4e0d\u53ef\u7528\u5219\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/port_scanner.py</code> <pre><code>@staticmethod\ndef get_port_info(port_name: str) -&gt; Optional[Dict[str, str]]:\n    \"\"\"\u83b7\u53d6\u6307\u5b9a\u7aef\u53e3\u7684\u8be6\u7ec6\u4fe1\u606f\uff08\u652f\u6301\u771f\u5b9e\u4e32\u53e3\u548c\u865a\u62df\u4e32\u53e3\uff09\u3002\n\n    Args:\n        port_name (str): \u7aef\u53e3\u540d\u79f0\u3002\n\n    Returns:\n        Optional[Dict[str, str]]: \u7aef\u53e3\u4fe1\u606f\u5b57\u5178\uff0c\u5305\u542b description \u548c hwid\u3002\u5982\u679c\u7aef\u53e3\u4e0d\u53ef\u7528\u5219\u8fd4\u56de None\u3002\n    \"\"\"\n    try:\n        # 1. \u5148\u5c1d\u8bd5\u4ece\u771f\u5b9e\u786c\u4ef6\u4e32\u53e3\u83b7\u53d6\u4fe1\u606f\n        ports = serial.tools.list_ports.comports()\n        for port in ports:\n            if port.device == port_name:\n                return {\n                    'device': port.device,\n                    'description': port.description or '',\n                    'hwid': port.hwid or ''\n                }\n\n        # 2. \u5982\u679c\u662f\u865a\u62df\u4e32\u53e3\uff0c\u8fd4\u56de\u81ea\u5b9a\u4e49\u4fe1\u606f\n        if os.path.exists(port_name):\n            description = \"\u865a\u62df\u4e32\u53e3\"\n\n            # \u6839\u636e\u8def\u5f84\u5224\u65ad\u7c7b\u578b\n            if port_name.startswith('/tmp/'):\n                description = \"\u4e34\u65f6\u865a\u62df\u4e32\u53e3 (socat)\"\n            elif port_name.startswith('/dev/pts/'):\n                description = \"\u4f2a\u7ec8\u7aef (pty)\"\n            elif port_name.startswith('/dev/ttyV'):\n                description = \"\u865a\u62df\u4e32\u53e3\u8bbe\u5907\"\n\n            return {\n                'device': port_name,\n                'description': description,\n                'hwid': 'VIRTUAL'\n            }\n\n        return None\n    except Exception:\n        return None\n</code></pre>"},{"location":"api/infrastructure/communication/scanner/#controller.infrastructure.communication.port_scanner.PortScanner.get_all_port_info","title":"get_all_port_info  <code>staticmethod</code>","text":"<pre><code>get_all_port_info() -&gt; List[Dict[str, str]]\n</code></pre> <p>\u83b7\u53d6\u6240\u6709\u53ef\u7528\u7aef\u53e3\u7684\u8be6\u7ec6\u4fe1\u606f\uff08\u5305\u542b\u771f\u5b9e\u4e32\u53e3\u548c\u865a\u62df\u4e32\u53e3\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[Dict[str, str]]</code> <p>List[Dict[str, str]]: \u6240\u6709\u7aef\u53e3\u4fe1\u606f\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/port_scanner.py</code> <pre><code>@staticmethod\ndef get_all_port_info() -&gt; List[Dict[str, str]]:\n    \"\"\"\u83b7\u53d6\u6240\u6709\u53ef\u7528\u7aef\u53e3\u7684\u8be6\u7ec6\u4fe1\u606f\uff08\u5305\u542b\u771f\u5b9e\u4e32\u53e3\u548c\u865a\u62df\u4e32\u53e3\uff09\u3002\n\n    Returns:\n        List[Dict[str, str]]: \u6240\u6709\u7aef\u53e3\u4fe1\u606f\u5217\u8868\u3002\n    \"\"\"\n    try:\n        all_port_info = []\n\n        # \u83b7\u53d6\u6240\u6709\u7aef\u53e3\n        all_ports = PortScanner.scan_ports()\n\n        # \u4e3a\u6bcf\u4e2a\u7aef\u53e3\u83b7\u53d6\u4fe1\u606f\n        for port_name in all_ports:\n            port_info = PortScanner.get_port_info(port_name)\n            if port_info:\n                all_port_info.append(port_info)\n\n        return all_port_info\n    except Exception:\n        return [] \n</code></pre>"},{"location":"api/infrastructure/communication/writer/","title":"Serial Writer","text":""},{"location":"api/infrastructure/communication/writer/#controller.infrastructure.communication.serial_writer","title":"controller.infrastructure.communication.serial_writer","text":"<p>\u4e32\u53e3\u5199\u5165\u5668 - Infrastructure\u5c42 \u8d1f\u8d23\u591a\u7ebf\u7a0b\u53d1\u9001\u4e32\u53e3\u6570\u636e</p>"},{"location":"api/infrastructure/communication/writer/#controller.infrastructure.communication.serial_writer.SerialWriter","title":"SerialWriter","text":"<pre><code>SerialWriter(serial_port: Optional[Serial] = None)\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u4e32\u53e3\u53d1\u9001\u5904\u7406\u7c7b\u3002</p> <p>\u8d1f\u8d23\u5728\u72ec\u7acb\u7ebf\u7a0b\u4e2d\u53d1\u9001\u4e32\u53e3\u6570\u636e\uff0c\u4f7f\u7528\u961f\u5217\u7ba1\u7406\u53d1\u9001\u4efb\u52a1\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>serial_port</code> <code>Optional[Serial]</code> <p>\u4e32\u53e3\u5bf9\u8c61\u3002</p> <code>send_queue</code> <code>Queue</code> <p>\u53d1\u9001\u4efb\u52a1\u961f\u5217\u3002</p> <p>\u521d\u59cb\u5316\u4e32\u53e3\u5199\u5165\u5668\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>serial_port</code> <code>Serial</code> <p>\u4e32\u53e3\u5bf9\u8c61\u3002</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_writer.py</code> <pre><code>def __init__(self, serial_port: Optional[serial.Serial] = None):\n    \"\"\"\u521d\u59cb\u5316\u4e32\u53e3\u5199\u5165\u5668\u3002\n\n    Args:\n        serial_port (serial.Serial, optional): \u4e32\u53e3\u5bf9\u8c61\u3002\n    \"\"\"\n    super().__init__()\n    self.serial_port = serial_port\n    self.send_queue = Queue()\n    self.stop_flag = False\n</code></pre>"},{"location":"api/infrastructure/communication/writer/#controller.infrastructure.communication.serial_writer.SerialWriter.stop","title":"stop","text":"<pre><code>stop() -&gt; None\n</code></pre> <p>\u505c\u6b62\u53d1\u9001\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_writer.py</code> <pre><code>def stop(self) -&gt; None:\n    \"\"\"\u505c\u6b62\u53d1\u9001\u3002\"\"\"\n    self.stop_flag = True\n</code></pre>"},{"location":"api/infrastructure/communication/writer/#controller.infrastructure.communication.serial_writer.SerialWriter.add_to_queue","title":"add_to_queue","text":"<pre><code>add_to_queue(cmd: Union[str, bytes]) -&gt; None\n</code></pre> <p>\u6dfb\u52a0\u547d\u4ee4\u5230\u53d1\u9001\u961f\u5217\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>cmd</code> <code>Union[str, bytes]</code> <p>\u5f85\u53d1\u9001\u7684\u547d\u4ee4\uff08\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u6216\u5b57\u8282\uff09\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_writer.py</code> <pre><code>def add_to_queue(self, cmd: Union[str, bytes]) -&gt; None:\n    \"\"\"\u6dfb\u52a0\u547d\u4ee4\u5230\u53d1\u9001\u961f\u5217\u3002\n\n    Args:\n        cmd (Union[str, bytes]): \u5f85\u53d1\u9001\u7684\u547d\u4ee4\uff08\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u6216\u5b57\u8282\uff09\u3002\n    \"\"\"\n    self.send_queue.put(cmd)\n</code></pre>"},{"location":"api/infrastructure/communication/writer/#controller.infrastructure.communication.serial_writer.SerialWriter.send_data","title":"send_data","text":"<pre><code>send_data() -&gt; None\n</code></pre> <p>\u53d1\u9001\u4e32\u53e3\u6570\u636e - \u5728\u72ec\u7acb\u7ebf\u7a0b\u4e2d\u8fd0\u884c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_writer.py</code> <pre><code>def send_data(self) -&gt; None:\n    \"\"\"\u53d1\u9001\u4e32\u53e3\u6570\u636e - \u5728\u72ec\u7acb\u7ebf\u7a0b\u4e2d\u8fd0\u884c\u3002\"\"\"\n    self.stop_flag = False\n\n    while not self.stop_flag:\n        try:\n            if not self.serial_port or not self.serial_port.is_open:\n                time.sleep(0.1)\n                continue\n\n            if not self.send_queue.empty():\n                try:\n                    cmd = self.send_queue.get()\n                    if isinstance(cmd, str):\n                        cmd = bytes.fromhex(cmd.replace(' ', ''))\n                    self.serial_port.write(cmd)\n                    self.serial_port.flush()\n                    self.send_queue.task_done()\n                except Exception:\n                    # \u9759\u9ed8\u5904\u7406\u9519\u8bef\uff0c\u4e0d\u53d1\u9001\u4fe1\u53f7\n                    pass\n            else:\n                # \u961f\u5217\u4e3a\u7a7a\u65f6\u77ed\u6682\u4f11\u7720\uff0c\u907f\u514dCPU\u7a7a\u8f6c\n                time.sleep(0.01)\n        except Exception:\n            # \u9759\u9ed8\u5904\u7406\u9519\u8bef\uff0c\u4e0d\u53d1\u9001\u4fe1\u53f7\n            time.sleep(0.1) \n</code></pre>"},{"location":"api/infrastructure/persistence/calibration/","title":"Hand-Eye Calibration Repository","text":""},{"location":"api/infrastructure/persistence/calibration/#controller.infrastructure.persistence.hand_eye_calibration_repository","title":"controller.infrastructure.persistence.hand_eye_calibration_repository","text":"<p>\u624b\u773c\u6807\u5b9a\u914d\u7f6e\u4ed3\u50a8 - Infrastructure\u5c42 \u8d1f\u8d23\u4ece\u6587\u4ef6\u7cfb\u7edf\u8bfb\u53d6\u914d\u7f6e</p>"},{"location":"api/infrastructure/persistence/calibration/#controller.infrastructure.persistence.hand_eye_calibration_repository.HandEyeCalibrationRepository","title":"HandEyeCalibrationRepository","text":"<pre><code>HandEyeCalibrationRepository(config_path: str = None)\n</code></pre> <p>\u624b\u773c\u6807\u5b9a\u914d\u7f6e\u4ed3\u50a8 - Infrastructure\u5c42\u3002</p> <p>\u8d1f\u8d23\u4ece\u6587\u4ef6\u7cfb\u7edf\u8bfb\u53d6\u914d\u7f6e\u3002</p> <p>\u804c\u8d23\uff1a - \u4ece JSON \u6587\u4ef6\u52a0\u8f7d\u914d\u7f6e - \u8f6c\u6362\u4e3a Domain \u5c42\u7684\u503c\u5bf9\u8c61 - \u5904\u7406\u6587\u4ef6\u4e0d\u5b58\u5728\u7b49\u5f02\u5e38</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>config_path</code> <code>Path</code> <p>\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\u3002</p> <p>\u521d\u59cb\u5316\u914d\u7f6e\u4ed3\u50a8\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config_path</code> <code>str</code> <p>\u914d\u7f6e\u6587\u4ef6\u8def\u5f84. Defaults to None. \u5982\u679c\u4e3a None\uff0c\u5219\u6309\u4ee5\u4e0b\u4f18\u5148\u7ea7\u67e5\u627e\uff1a 1. ROS2 share \u76ee\u5f55 (controller/config/hand_eye_calibration.json) 2. \u5f00\u53d1\u73af\u5883\u76f8\u5bf9\u8def\u5f84 (../../config/hand_eye_calibration.json)</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/hand_eye_calibration_repository.py</code> <pre><code>def __init__(self, config_path: str = None):\n    \"\"\"\u521d\u59cb\u5316\u914d\u7f6e\u4ed3\u50a8\u3002\n\n    Args:\n        config_path (str, optional): \u914d\u7f6e\u6587\u4ef6\u8def\u5f84. Defaults to None.\n            \u5982\u679c\u4e3a None\uff0c\u5219\u6309\u4ee5\u4e0b\u4f18\u5148\u7ea7\u67e5\u627e\uff1a\n            1. ROS2 share \u76ee\u5f55 (controller/config/hand_eye_calibration.json)\n            2. \u5f00\u53d1\u73af\u5883\u76f8\u5bf9\u8def\u5f84 (../../config/hand_eye_calibration.json)\n    \"\"\"\n    if config_path is None:\n        # \u4f7f\u7528 ROS2 \u5305\u8d44\u6e90\u7ba1\u7406\u65b9\u5f0f\u67e5\u627e\u914d\u7f6e\u6587\u4ef6\n        try:\n            # ROS2 \u65b9\u5f0f\uff1a\u4ece share \u76ee\u5f55\u52a0\u8f7d\n            package_share_dir = get_package_share_directory('controller')\n            config_path = Path(package_share_dir) / 'config' / 'hand_eye_calibration.json'\n        except Exception:\n            # \u5982\u679c\u5305\u672a\u5b89\u88c5\uff0c\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\uff08\u5f00\u53d1\u6a21\u5f0f\uff09\n            current_file = Path(__file__)\n            controller_root = current_file.parent.parent.parent\n            config_path = controller_root / \"config\" / \"hand_eye_calibration.json\"\n\n    self.config_path = Path(config_path)\n</code></pre>"},{"location":"api/infrastructure/persistence/calibration/#controller.infrastructure.persistence.hand_eye_calibration_repository.HandEyeCalibrationRepository.load","title":"load","text":"<pre><code>load() -&gt; HandEyeCalibrationConfig\n</code></pre> <p>\u52a0\u8f7d\u624b\u773c\u6807\u5b9a\u914d\u7f6e\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>HandEyeCalibrationConfig</code> <code>HandEyeCalibrationConfig</code> <p>\u914d\u7f6e\u503c\u5bf9\u8c61\u3002</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>FileNotFoundError</code> <p>\u914d\u7f6e\u6587\u4ef6\u4e0d\u5b58\u5728\u3002</p> <code>ValueError</code> <p>\u914d\u7f6e\u683c\u5f0f\u9519\u8bef\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/hand_eye_calibration_repository.py</code> <pre><code>def load(self) -&gt; HandEyeCalibrationConfig:\n    \"\"\"\u52a0\u8f7d\u624b\u773c\u6807\u5b9a\u914d\u7f6e\u3002\n\n    Returns:\n        HandEyeCalibrationConfig: \u914d\u7f6e\u503c\u5bf9\u8c61\u3002\n\n    Raises:\n        FileNotFoundError: \u914d\u7f6e\u6587\u4ef6\u4e0d\u5b58\u5728\u3002\n        ValueError: \u914d\u7f6e\u683c\u5f0f\u9519\u8bef\u3002\n    \"\"\"\n    if not self.config_path.exists():\n        raise FileNotFoundError(\n            f\"\u914d\u7f6e\u6587\u4ef6\u4e0d\u5b58\u5728: {self.config_path}\\n\"\n            f\"\u8bf7\u5728 controller/config/ \u76ee\u5f55\u4e0b\u521b\u5efa hand_eye_calibration.json\"\n        )\n\n    try:\n        with open(self.config_path, 'r', encoding='utf-8') as f:\n            data = json.load(f)\n    except json.JSONDecodeError as e:\n        raise ValueError(f\"\u914d\u7f6e\u6587\u4ef6\u683c\u5f0f\u9519\u8bef: {e}\")\n\n    # \u89e3\u6790\u624b\u773c\u6807\u5b9a\u77e9\u9635\n    hand_eye_matrix = np.array(data['hand_eye_matrix'], dtype=float)\n\n    # \u89e3\u6790\u76f8\u673a\u5185\u53c2\n    intrinsics_data = data['camera_intrinsics']\n    camera_intrinsics = CameraIntrinsics(\n        fx=intrinsics_data['fx'],\n        fy=intrinsics_data['fy'],\n        cx=intrinsics_data['cx'],\n        cy=intrinsics_data['cy']\n    )\n\n    # \u89e3\u6790\u76ee\u6807\u504f\u79fb\u91cf\n    offset_data = data['target_offset']\n    target_offset = TargetOffset(\n        x=offset_data['x'],\n        y=offset_data['y'],\n        z=offset_data['z']\n    )\n\n    # \u89e3\u6790\u672b\u7aef\u59ff\u6001\u8c03\u6574\uff08\u89d2\u5ea6\u8f6c\u5f27\u5ea6\uff09\n    adjustment_data = data['end_effector_adjustment']\n    end_effector_adjustment = EndEffectorAdjustment(\n        z_rotation=radians(adjustment_data['z_rotation_deg']),\n        y_rotation=radians(adjustment_data['y_rotation_deg']),\n        x_rotation=radians(adjustment_data['x_rotation_deg'])\n    )\n\n    return HandEyeCalibrationConfig(\n        hand_eye_matrix=hand_eye_matrix,\n        camera_intrinsics=camera_intrinsics,\n        target_offset=target_offset,\n        end_effector_adjustment=end_effector_adjustment\n    )\n</code></pre>"},{"location":"api/infrastructure/persistence/calibration/#controller.infrastructure.persistence.hand_eye_calibration_repository.HandEyeCalibrationRepository.save","title":"save","text":"<pre><code>save(config: HandEyeCalibrationConfig)\n</code></pre> <p>\u4fdd\u5b58\u914d\u7f6e\u5230\u6587\u4ef6\uff08\u53ef\u9009\u529f\u80fd\uff0c\u7528\u4e8e\u6807\u5b9a\u5de5\u5177\uff09\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config</code> <code>HandEyeCalibrationConfig</code> <p>\u624b\u773c\u6807\u5b9a\u914d\u7f6e\u5bf9\u8c61\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/hand_eye_calibration_repository.py</code> <pre><code>def save(self, config: HandEyeCalibrationConfig):\n    \"\"\"\u4fdd\u5b58\u914d\u7f6e\u5230\u6587\u4ef6\uff08\u53ef\u9009\u529f\u80fd\uff0c\u7528\u4e8e\u6807\u5b9a\u5de5\u5177\uff09\u3002\n\n    Args:\n        config (HandEyeCalibrationConfig): \u624b\u773c\u6807\u5b9a\u914d\u7f6e\u5bf9\u8c61\u3002\n    \"\"\"\n    # \u786e\u4fdd\u76ee\u5f55\u5b58\u5728\n    self.config_path.parent.mkdir(parents=True, exist_ok=True)\n\n    data = {\n        \"hand_eye_matrix\": config.hand_eye_matrix.tolist(),\n        \"camera_intrinsics\": {\n            \"fx\": config.camera_intrinsics.fx,\n            \"fy\": config.camera_intrinsics.fy,\n            \"cx\": config.camera_intrinsics.cx,\n            \"cy\": config.camera_intrinsics.cy\n        },\n        \"target_offset\": {\n            \"x\": config.target_offset.x,\n            \"y\": config.target_offset.y,\n            \"z\": config.target_offset.z,\n            \"comment\": \"\u76f8\u5bf9\u4e8e\u96f6\u4ef6\u4f4d\u7f6e\u7684\u504f\u79fb\u91cf\uff08\u7c73\uff09\"\n        },\n        \"end_effector_adjustment\": {\n            \"z_rotation_deg\": np.degrees(config.end_effector_adjustment.z_rotation),\n            \"y_rotation_deg\": np.degrees(config.end_effector_adjustment.y_rotation),\n            \"x_rotation_deg\": np.degrees(config.end_effector_adjustment.x_rotation),\n            \"comment\": \"\u672b\u7aef\u59ff\u6001\u8c03\u6574\uff08\u89d2\u5ea6\uff09\"\n        }\n    }\n\n    with open(self.config_path, 'w', encoding='utf-8') as f:\n        json.dump(data, f, indent=2, ensure_ascii=False)\n</code></pre>"},{"location":"api/infrastructure/persistence/motion_plan/","title":"Motion Plan Repository","text":""},{"location":"api/infrastructure/persistence/motion_plan/#controller.infrastructure.persistence.motion_plan_repository","title":"controller.infrastructure.persistence.motion_plan_repository","text":"<p>\u8fd0\u52a8\u65b9\u6848\u6301\u4e45\u5316\u4ed3\u5e93</p>"},{"location":"api/infrastructure/persistence/motion_plan/#controller.infrastructure.persistence.motion_plan_repository.MotionPlanRepository","title":"MotionPlanRepository","text":"<pre><code>MotionPlanRepository(file_path: str = './motion_planning_plans.json')\n</code></pre> <p>\u8fd0\u52a8\u65b9\u6848\u6301\u4e45\u5316\u4ed3\u5e93\u3002</p> <p>\u804c\u8d23\uff1a 1. \u4fdd\u5b58/\u52a0\u8f7d\u65b9\u6848\u5230JSON\u6587\u4ef6 2. \u7ba1\u7406\u6587\u4ef6\u7cfb\u7edf\u64cd\u4f5c</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>file_path</code> <code>Path</code> <p>\u65b9\u6848\u6587\u4ef6\u8def\u5f84\u3002</p> <p>\u521d\u59cb\u5316\u4ed3\u5e93\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>str</code> <p>\u6587\u4ef6\u8def\u5f84. Defaults to \"./motion_planning_plans.json\".</p> <code>'./motion_planning_plans.json'</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/motion_plan_repository.py</code> <pre><code>def __init__(self, file_path: str = \"./motion_planning_plans.json\"):\n    \"\"\"\u521d\u59cb\u5316\u4ed3\u5e93\u3002\n\n    Args:\n        file_path (str, optional): \u6587\u4ef6\u8def\u5f84. Defaults to \"./motion_planning_plans.json\".\n    \"\"\"\n    self.file_path = Path(file_path)\n</code></pre>"},{"location":"api/infrastructure/persistence/motion_plan/#controller.infrastructure.persistence.motion_plan_repository.MotionPlanRepository.save","title":"save","text":"<pre><code>save(plans_data: List[Dict], current_index: int)\n</code></pre> <p>\u4fdd\u5b58\u65b9\u6848\u6570\u636e\u5230\u6587\u4ef6\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>plans_data</code> <code>List[Dict]</code> <p>\u65b9\u6848\u6570\u636e\u5217\u8868\u3002</p> \u5fc5\u9700 <code>current_index</code> <code>int</code> <p>\u5f53\u524d\u9009\u4e2d\u65b9\u6848\u7d22\u5f15\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/motion_plan_repository.py</code> <pre><code>def save(self, plans_data: List[Dict], current_index: int):\n    \"\"\"\u4fdd\u5b58\u65b9\u6848\u6570\u636e\u5230\u6587\u4ef6\u3002\n\n    Args:\n        plans_data (List[Dict]): \u65b9\u6848\u6570\u636e\u5217\u8868\u3002\n        current_index (int): \u5f53\u524d\u9009\u4e2d\u65b9\u6848\u7d22\u5f15\u3002\n    \"\"\"\n    data = {\n        \"current_index\": current_index,\n        \"plans\": plans_data\n    }\n    try:\n        with open(self.file_path, 'w', encoding='utf-8') as f:\n            json.dump(data, f, indent=2, ensure_ascii=False)\n    except Exception as e:\n        pass\n</code></pre>"},{"location":"api/infrastructure/persistence/motion_plan/#controller.infrastructure.persistence.motion_plan_repository.MotionPlanRepository.load","title":"load","text":"<pre><code>load() -&gt; tuple[List[Dict], int]\n</code></pre> <p>\u4ece\u6587\u4ef6\u52a0\u8f7d\u65b9\u6848\u6570\u636e\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>tuple[List[Dict], int]</code> <p>tuple[List[Dict], int]: (plans_data, current_index)\u3002 \u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\u6216\u52a0\u8f7d\u5931\u8d25\uff0c\u8fd4\u56de\u9ed8\u8ba4\u65b9\u6848\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/motion_plan_repository.py</code> <pre><code>def load(self) -&gt; tuple[List[Dict], int]:\n    \"\"\"\u4ece\u6587\u4ef6\u52a0\u8f7d\u65b9\u6848\u6570\u636e\u3002\n\n    Returns:\n        tuple[List[Dict], int]: (plans_data, current_index)\u3002\n            \u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\u6216\u52a0\u8f7d\u5931\u8d25\uff0c\u8fd4\u56de\u9ed8\u8ba4\u65b9\u6848\u3002\n    \"\"\"\n    if not self.file_path.exists():\n        # \u8fd4\u56de\u9ed8\u8ba4\u65b9\u6848\n        return [{\"name\": \"\u9ed8\u8ba4\u65b9\u6848\", \"points\": []}], 0\n\n    try:\n        with open(self.file_path, 'r', encoding='utf-8') as f:\n            data = json.load(f)\n\n        plans = data.get(\"plans\", [])\n        current_index = data.get(\"current_index\", 0)\n\n        # \u5982\u679c\u6ca1\u6709\u65b9\u6848\uff0c\u521b\u5efa\u9ed8\u8ba4\u65b9\u6848\n        if not plans:\n            plans = [{\"name\": \"\u9ed8\u8ba4\u65b9\u6848\", \"points\": []}]\n            current_index = 0\n\n        return plans, current_index\n\n    except Exception as e:\n        return [{\"name\": \"\u9ed8\u8ba4\u65b9\u6848\", \"points\": []}], 0\n</code></pre>"},{"location":"api/infrastructure/persistence/record/","title":"Record Repository","text":""},{"location":"api/infrastructure/persistence/record/#controller.infrastructure.persistence.record_repository","title":"controller.infrastructure.persistence.record_repository","text":"<p>\u8bb0\u5f55\u6570\u636e\u6301\u4e45\u5316\u4ed3\u5e93</p>"},{"location":"api/infrastructure/persistence/record/#controller.infrastructure.persistence.record_repository.RecordRepository","title":"RecordRepository","text":"<pre><code>RecordRepository(file_path: str = 'teach_record.json')\n</code></pre> <p>\u793a\u6559\u8bb0\u5f55\u6301\u4e45\u5316\u4ed3\u5e93 - Infrastructure\u5c42\u3002</p> <p>\u804c\u8d23\uff1a - \u4eceJSON\u6587\u4ef6\u52a0\u8f7d\u8bb0\u5f55\u6570\u636e - \u4fdd\u5b58\u8bb0\u5f55\u6570\u636e\u5230JSON\u6587\u4ef6 - \u7ba1\u7406\u8bb0\u5f55\u6587\u4ef6\u7684\u8bfb\u5199</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>file_path</code> <code>str</code> <p>\u8bb0\u5f55\u6587\u4ef6\u8def\u5f84\u3002</p> <p>\u521d\u59cb\u5316\u8bb0\u5f55\u4ed3\u5e93\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>str</code> <p>\u8bb0\u5f55\u6587\u4ef6\u8def\u5f84. Defaults to \"teach_record.json\".</p> <code>'teach_record.json'</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/record_repository.py</code> <pre><code>def __init__(self, file_path: str = \"teach_record.json\"):\n    \"\"\"\u521d\u59cb\u5316\u8bb0\u5f55\u4ed3\u5e93\u3002\n\n    Args:\n        file_path (str, optional): \u8bb0\u5f55\u6587\u4ef6\u8def\u5f84. Defaults to \"teach_record.json\".\n    \"\"\"\n    self.file_path = file_path\n</code></pre>"},{"location":"api/infrastructure/persistence/record/#controller.infrastructure.persistence.record_repository.RecordRepository.load_records","title":"load_records","text":"<pre><code>load_records() -&gt; Dict[str, List[List[float]]]\n</code></pre> <p>\u4ece\u6587\u4ef6\u52a0\u8f7d\u8bb0\u5f55\u6570\u636e\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Dict[str, List[List[float]]]</code> <p>Dict[str, List[List[float]]]: \u8bb0\u5f55\u6570\u636e\u5b57\u5178 {\u8bb0\u5f55\u540d: \u89d2\u5ea6\u5217\u8868}\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/record_repository.py</code> <pre><code>def load_records(self) -&gt; Dict[str, List[List[float]]]:\n    \"\"\"\u4ece\u6587\u4ef6\u52a0\u8f7d\u8bb0\u5f55\u6570\u636e\u3002\n\n    Returns:\n        Dict[str, List[List[float]]]: \u8bb0\u5f55\u6570\u636e\u5b57\u5178 {\u8bb0\u5f55\u540d: \u89d2\u5ea6\u5217\u8868}\u3002\n    \"\"\"\n    try:\n        if os.path.exists(self.file_path):\n            with open(self.file_path, 'r', encoding='utf-8') as f:\n                data = json.load(f)\n            return data\n        else:\n            return {}\n    except Exception as e:\n        return {}\n</code></pre>"},{"location":"api/infrastructure/persistence/record/#controller.infrastructure.persistence.record_repository.RecordRepository.save_records","title":"save_records","text":"<pre><code>save_records(records: Dict[str, List[List[float]]]) -&gt; bool\n</code></pre> <p>\u4fdd\u5b58\u8bb0\u5f55\u6570\u636e\u5230\u6587\u4ef6\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>records</code> <code>Dict[str, List[List[float]]]</code> <p>\u8bb0\u5f55\u6570\u636e\u5b57\u5178\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u4fdd\u5b58\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/record_repository.py</code> <pre><code>def save_records(self, records: Dict[str, List[List[float]]]) -&gt; bool:\n    \"\"\"\u4fdd\u5b58\u8bb0\u5f55\u6570\u636e\u5230\u6587\u4ef6\u3002\n\n    Args:\n        records (Dict[str, List[List[float]]]): \u8bb0\u5f55\u6570\u636e\u5b57\u5178\u3002\n\n    Returns:\n        bool: \u662f\u5426\u4fdd\u5b58\u6210\u529f\u3002\n    \"\"\"\n    try:\n        with open(self.file_path, 'w', encoding='utf-8') as f:\n            json.dump(records, f, ensure_ascii=False, indent=2)\n        return True\n    except Exception as e:\n        return False\n</code></pre>"},{"location":"api/infrastructure/persistence/record/#controller.infrastructure.persistence.record_repository.RecordRepository.delete_file","title":"delete_file","text":"<pre><code>delete_file() -&gt; bool\n</code></pre> <p>\u5220\u9664\u8bb0\u5f55\u6587\u4ef6\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u5220\u9664\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/record_repository.py</code> <pre><code>def delete_file(self) -&gt; bool:\n    \"\"\"\u5220\u9664\u8bb0\u5f55\u6587\u4ef6\u3002\n\n    Returns:\n        bool: \u662f\u5426\u5220\u9664\u6210\u529f\u3002\n    \"\"\"\n    try:\n        if os.path.exists(self.file_path):\n            os.remove(self.file_path)\n            return True\n        return False\n    except Exception as e:\n        return False\n</code></pre>"},{"location":"api/infrastructure/persistence/trajectory/","title":"Trajectory Repository","text":""},{"location":"api/infrastructure/persistence/trajectory/#controller.infrastructure.persistence.trajectory_repository","title":"controller.infrastructure.persistence.trajectory_repository","text":"<p>\u8f68\u8ff9\u6570\u636e\u4ed3\u5e93 - Infrastructure\u5c42</p>"},{"location":"api/infrastructure/persistence/trajectory/#controller.infrastructure.persistence.trajectory_repository.TrajectoryRepository","title":"TrajectoryRepository","text":"<pre><code>TrajectoryRepository(plans_dir: str = './plans')\n</code></pre> <p>\u8f68\u8ff9\u6570\u636e\u4ed3\u5e93 - Infrastructure\u5c42\u3002</p> <p>\u804c\u8d23\uff1a 1. \u4fdd\u5b58\u8f68\u8ff9\u6570\u636e\u5230\u6587\u4ef6\u7cfb\u7edf 2. \u52a0\u8f7d\u8f68\u8ff9\u6570\u636e 3. \u7ba1\u7406\u5b58\u50a8\u76ee\u5f55</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>plans_dir</code> <code>Path</code> <p>\u8f68\u8ff9\u5b58\u50a8\u76ee\u5f55\u3002</p> <p>\u521d\u59cb\u5316\u8f68\u8ff9\u4ed3\u5e93\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>plans_dir</code> <code>str</code> <p>\u5b58\u50a8\u76ee\u5f55. Defaults to \"./plans\".</p> <code>'./plans'</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/trajectory_repository.py</code> <pre><code>def __init__(self, plans_dir: str = \"./plans\"):\n    \"\"\"\u521d\u59cb\u5316\u8f68\u8ff9\u4ed3\u5e93\u3002\n\n    Args:\n        plans_dir (str, optional): \u5b58\u50a8\u76ee\u5f55. Defaults to \"./plans\".\n    \"\"\"\n    self.plans_dir = Path(plans_dir)\n    self.plans_dir.mkdir(exist_ok=True)\n</code></pre>"},{"location":"api/infrastructure/persistence/trajectory/#controller.infrastructure.persistence.trajectory_repository.TrajectoryRepository.save_trajectory","title":"save_trajectory","text":"<pre><code>save_trajectory(filename: str, positions: List[List[float]]) -&gt; None\n</code></pre> <p>\u4fdd\u5b58\u8f68\u8ff9\u6570\u636e\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>filename</code> <code>str</code> <p>\u6587\u4ef6\u540d\uff08\u4e0d\u542b\u6269\u5c55\u540d\uff09\u3002</p> \u5fc5\u9700 <code>positions</code> <code>List[List[float]]</code> <p>\u8f68\u8ff9\u70b9\u5e8f\u5217 [[q1,...,q6], ...]\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/trajectory_repository.py</code> <pre><code>def save_trajectory(\n    self, \n    filename: str, \n    positions: List[List[float]]\n) -&gt; None:\n    \"\"\"\u4fdd\u5b58\u8f68\u8ff9\u6570\u636e\u3002\n\n    Args:\n        filename (str): \u6587\u4ef6\u540d\uff08\u4e0d\u542b\u6269\u5c55\u540d\uff09\u3002\n        positions (List[List[float]]): \u8f68\u8ff9\u70b9\u5e8f\u5217 [[q1,...,q6], ...]\u3002\n    \"\"\"\n    clean_name = self._sanitize_filename(filename)\n    filepath = self.plans_dir / f\"{clean_name}.json\"\n\n    # \u5c06numpy\u6570\u7ec4\u8f6c\u6362\u4e3aPython\u5217\u8868\n    positions_serializable = self._convert_to_serializable(positions)\n\n    with open(filepath, 'w', encoding='utf-8') as f:\n        json.dump(positions_serializable, f, indent=2, ensure_ascii=False)\n</code></pre>"},{"location":"api/infrastructure/persistence/trajectory/#controller.infrastructure.persistence.trajectory_repository.TrajectoryRepository.load_trajectory","title":"load_trajectory","text":"<pre><code>load_trajectory(filename: str) -&gt; List[List[float]]\n</code></pre> <p>\u52a0\u8f7d\u8f68\u8ff9\u6570\u636e\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>filename</code> <code>str</code> <p>\u6587\u4ef6\u540d\uff08\u4e0d\u542b\u6269\u5c55\u540d\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[List[float]]</code> <p>List[List[float]]: \u8f68\u8ff9\u70b9\u5e8f\u5217\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/trajectory_repository.py</code> <pre><code>def load_trajectory(self, filename: str) -&gt; List[List[float]]:\n    \"\"\"\u52a0\u8f7d\u8f68\u8ff9\u6570\u636e\u3002\n\n    Args:\n        filename (str): \u6587\u4ef6\u540d\uff08\u4e0d\u542b\u6269\u5c55\u540d\uff09\u3002\n\n    Returns:\n        List[List[float]]: \u8f68\u8ff9\u70b9\u5e8f\u5217\u3002\n    \"\"\"\n    filepath = self.plans_dir / f\"{filename}.json\"\n    with open(filepath, 'r', encoding='utf-8') as f:\n        return json.load(f)\n</code></pre>"},{"location":"api/infrastructure/persistence/trajectory/#controller.infrastructure.persistence.trajectory_repository.TrajectoryRepository.list_trajectory_files","title":"list_trajectory_files","text":"<pre><code>list_trajectory_files() -&gt; List[str]\n</code></pre> <p>\u5217\u51fa\u6240\u6709\u53ef\u7528\u7684\u8f68\u8ff9\u6587\u4ef6\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>List[str]: \u6587\u4ef6\u540d\u5217\u8868\uff08\u4e0d\u5e26\u6269\u5c55\u540d\uff09\u3002</p> <code>\u4f8b\u5982</code> <code>List[str]</code> <p>[\"\u9ed8\u8ba4\u65b9\u6848-0\", \"\u9ed8\u8ba4\u65b9\u6848-1\", \"test_trajectory\"]</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/trajectory_repository.py</code> <pre><code>def list_trajectory_files(self) -&gt; List[str]:\n    \"\"\"\u5217\u51fa\u6240\u6709\u53ef\u7528\u7684\u8f68\u8ff9\u6587\u4ef6\u3002\n\n    Returns:\n        List[str]: \u6587\u4ef6\u540d\u5217\u8868\uff08\u4e0d\u5e26\u6269\u5c55\u540d\uff09\u3002\n        \u4f8b\u5982: [\"\u9ed8\u8ba4\u65b9\u6848-0\", \"\u9ed8\u8ba4\u65b9\u6848-1\", \"test_trajectory\"]\n    \"\"\"\n    if not self.plans_dir.exists():\n        return []\n\n    files = []\n    for file in self.plans_dir.glob(\"*.json\"):\n        files.append(file.stem)  # \u6587\u4ef6\u540d\u4e0d\u5e26\u6269\u5c55\u540d\n\n    return sorted(files)\n</code></pre>"},{"location":"api/infrastructure/persistence/trajectory/#controller.infrastructure.persistence.trajectory_repository.TrajectoryRepository.trajectory_exists","title":"trajectory_exists","text":"<pre><code>trajectory_exists(filename: str) -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u8f68\u8ff9\u6587\u4ef6\u662f\u5426\u5b58\u5728\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>filename</code> <code>str</code> <p>\u6587\u4ef6\u540d\uff08\u4e0d\u542b\u6269\u5c55\u540d\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u6587\u4ef6\u5b58\u5728, False=\u6587\u4ef6\u4e0d\u5b58\u5728\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/trajectory_repository.py</code> <pre><code>def trajectory_exists(self, filename: str) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u8f68\u8ff9\u6587\u4ef6\u662f\u5426\u5b58\u5728\u3002\n\n    Args:\n        filename (str): \u6587\u4ef6\u540d\uff08\u4e0d\u542b\u6269\u5c55\u540d\uff09\u3002\n\n    Returns:\n        bool: True=\u6587\u4ef6\u5b58\u5728, False=\u6587\u4ef6\u4e0d\u5b58\u5728\u3002\n    \"\"\"\n    filepath = self.plans_dir / f\"{filename}.json\"\n    return filepath.exists()\n</code></pre>"},{"location":"api/presentation/core/base/","title":"Base ViewModel","text":""},{"location":"api/presentation/core/base/#controller.presentation.view_models.base_view_model","title":"controller.presentation.view_models.base_view_model","text":"<p>\u57fa\u7840\u89c6\u56fe\u6a21\u578b - \u63d0\u4f9b\u901a\u7528\u7684\u89c6\u56fe\u6a21\u578b\u529f\u80fd</p>"},{"location":"api/presentation/core/base/#controller.presentation.view_models.base_view_model.BaseViewModel","title":"BaseViewModel","text":"<pre><code>BaseViewModel(parent=None)\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u57fa\u7840\u89c6\u56fe\u6a21\u578b\u7c7b\u3002</p> <p>\u6240\u6709\u89c6\u56fe\u6a21\u578b\u7684\u57fa\u7c7b\uff0c\u63d0\u4f9b\u901a\u7528\u7684\u4fe1\u53f7\u548c\u6e05\u7406\u63a5\u53e3\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>connection_status_changed</code> <code>pyqtSignal</code> <p>\u8fde\u63a5\u72b6\u6001\u53d8\u66f4\u4fe1\u53f7\uff0c\u643a\u5e26 bool \u72b6\u6001\u3002</p> <p>\u521d\u59cb\u5316\u57fa\u7840\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>parent</code> <code>QObject</code> <p>\u7236\u5bf9\u8c61. Defaults to None.</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/base_view_model.py</code> <pre><code>def __init__(self, parent=None):\n    \"\"\"\u521d\u59cb\u5316\u57fa\u7840\u89c6\u56fe\u6a21\u578b\u3002\n\n    Args:\n        parent (QObject, optional): \u7236\u5bf9\u8c61. Defaults to None.\n    \"\"\"\n    super().__init__(parent)\n</code></pre>"},{"location":"api/presentation/core/base/#controller.presentation.view_models.base_view_model.BaseViewModel.cleanup","title":"cleanup","text":"<pre><code>cleanup()\n</code></pre> <p>\u6e05\u7406\u8d44\u6e90\u3002</p> <p>\u5b50\u7c7b\u5e94\u91cd\u5199\u6b64\u65b9\u6cd5\u4ee5\u91ca\u653e\u8d44\u6e90\uff08\u5982\u5173\u95ed\u8fde\u63a5\u3001\u505c\u6b62\u5b9a\u65f6\u5668\u7b49\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/base_view_model.py</code> <pre><code>def cleanup(self):\n    \"\"\"\u6e05\u7406\u8d44\u6e90\u3002\n\n    \u5b50\u7c7b\u5e94\u91cd\u5199\u6b64\u65b9\u6cd5\u4ee5\u91ca\u653e\u8d44\u6e90\uff08\u5982\u5173\u95ed\u8fde\u63a5\u3001\u505c\u6b62\u5b9a\u65f6\u5668\u7b49\uff09\u3002\n    \"\"\"\n    pass \n</code></pre>"},{"location":"api/presentation/core/display/","title":"Display ViewModel","text":""},{"location":"api/presentation/core/display/#controller.presentation.view_models.display_view_model","title":"controller.presentation.view_models.display_view_model","text":"<p>\u663e\u793a\u89c6\u56fe\u6a21\u578b - Presentation\u5c42 \u4f5c\u4e3a\u6d88\u606f\u663e\u793a\u7684\u4e2d\u5fc3\u5206\u53d1\u5668\uff0c\u5176\u4ed6\u670d\u52a1\u8c03\u7528\u5b83\u7684\u65b9\u6cd5\u6765\u663e\u793a\u6d88\u606f</p>"},{"location":"api/presentation/core/display/#controller.presentation.view_models.display_view_model.DisplayViewModel","title":"DisplayViewModel","text":"<pre><code>DisplayViewModel(message_display: MessageDisplay, parent=None)\n</code></pre> <p>               Bases: <code>BaseViewModel</code></p> <p>\u663e\u793a\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u4f5c\u4e3a\u6d88\u606f\u663e\u793a\u7684\u4e2d\u5fc3\u5206\u53d1\u5668\uff0c\u5176\u4ed6\u670d\u52a1\u8c03\u7528\u5b83\u7684\u65b9\u6cd5\u6765\u663e\u793a\u6d88\u606f\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>message_display_signal</code> <code>pyqtSignal</code> <p>\u6d88\u606f\u663e\u793a\u4fe1\u53f7\uff0c\u643a\u5e26 (\u6d88\u606f\u5185\u5bb9, \u6d88\u606f\u7c7b\u578b)\u3002</p> <code>clear_requested</code> <code>pyqtSignal</code> <p>\u6e05\u9664\u6d88\u606f\u8bf7\u6c42\u4fe1\u53f7\u3002</p> <code>message_display</code> <code>MessageDisplay</code> <p>\u6d88\u606f\u663e\u793a\u670d\u52a1\u3002</p> <p>\u521d\u59cb\u5316\u663e\u793a\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>message_display</code> <code>MessageDisplay</code> <p>\u6d88\u606f\u663e\u793a\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>parent</code> <code>QObject</code> <p>\u7236\u5bf9\u8c61. Defaults to None.</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/display_view_model.py</code> <pre><code>def __init__(self, message_display: MessageDisplay, parent=None):\n    \"\"\"\u521d\u59cb\u5316\u663e\u793a\u89c6\u56fe\u6a21\u578b\u3002\n\n    Args:\n        message_display (MessageDisplay): \u6d88\u606f\u663e\u793a\u670d\u52a1\u3002\n        parent (QObject, optional): \u7236\u5bf9\u8c61. Defaults to None.\n    \"\"\"\n    super().__init__(parent)\n    self.message_display = message_display\n    self.message_display.message_display_signal.connect(self.message_display_signal.emit)\n    self.message_display.clear_requested.connect(self.clear_requested.emit)\n</code></pre>"},{"location":"api/presentation/core/display/#controller.presentation.view_models.display_view_model.DisplayViewModel.clear_messages","title":"clear_messages","text":"<pre><code>clear_messages() -&gt; None\n</code></pre> <p>\u6e05\u9664\u6240\u6709\u6d88\u606f\u3002</p> <p>\u53d1\u9001\u6e05\u9664\u6d88\u606f\u4fe1\u53f7\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/display_view_model.py</code> <pre><code>def clear_messages(self) -&gt; None:\n    \"\"\"\u6e05\u9664\u6240\u6709\u6d88\u606f\u3002\n\n    \u53d1\u9001\u6e05\u9664\u6d88\u606f\u4fe1\u53f7\u3002\n    \"\"\"\n    # \u53d1\u9001\u6e05\u9664\u6d88\u606f\u4fe1\u53f7\n    self.clear_requested.emit()\n</code></pre>"},{"location":"api/presentation/core/display/#controller.presentation.view_models.display_view_model.DisplayViewModel.cleanup","title":"cleanup","text":"<pre><code>cleanup() -&gt; None\n</code></pre> <p>\u6e05\u7406\u8d44\u6e90\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/display_view_model.py</code> <pre><code>def cleanup(self) -&gt; None:\n    \"\"\"\u6e05\u7406\u8d44\u6e90\u3002\"\"\"\n    super().cleanup() \n</code></pre>"},{"location":"api/presentation/core/main/","title":"Main ViewModel","text":""},{"location":"api/presentation/core/main/#controller.presentation.view_models.main_view_model","title":"controller.presentation.view_models.main_view_model","text":"<p>\u4e3b\u89c6\u56fe\u6a21\u578b - \u6574\u5408\u6240\u6709\u5b50\u89c6\u56fe\u6a21\u578b</p>"},{"location":"api/presentation/core/main/#controller.presentation.view_models.main_view_model.MainViewModel","title":"MainViewModel","text":"<pre><code>MainViewModel(serial_vm: SerialViewModel, display_vm: DisplayViewModel, control_vm: ControlViewModel, status_vm: StatusViewModel, effector_vm: EffectorViewModel, trajectory_vm: TrajectoryViewModel, dynamics_vm: DynamicsViewModel, camera_vm: CameraViewModel, motion_planning_vm: MotionPlanningViewModel, tools_vm: ToolsViewModel, parent=None)\n</code></pre> <p>               Bases: <code>BaseViewModel</code></p> <p>\u4e3b\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u6574\u5408\u6240\u6709\u5b50\u89c6\u56fe\u6a21\u578b\uff0c\u5e76\u7ba1\u7406\u5b83\u4eec\u4e4b\u95f4\u7684\u4fe1\u53f7\u4ea4\u4e92\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>connection_status_changed</code> <code>pyqtSignal</code> <p>\u4e32\u53e3\u8fde\u63a5\u72b6\u6001\u4fe1\u53f7\u3002</p> <code>status_message_changed</code> <code>pyqtSignal</code> <p>\u72b6\u6001\u6d88\u606f\u53d8\u66f4\u4fe1\u53f7\u3002</p> <code>progress_changed</code> <code>pyqtSignal</code> <p>\u8fdb\u5ea6\u53d8\u66f4\u4fe1\u53f7\u3002</p> <code>serial_vm</code> <code>SerialViewModel</code> <p>\u4e32\u53e3\u89c6\u56fe\u6a21\u578b\u3002</p> <code>display_vm</code> <code>DisplayViewModel</code> <p>\u663e\u793a\u89c6\u56fe\u6a21\u578b\u3002</p> <code>control_vm</code> <code>ControlViewModel</code> <p>\u63a7\u5236\u89c6\u56fe\u6a21\u578b\u3002</p> <code>status_vm</code> <code>StatusViewModel</code> <p>\u72b6\u6001\u89c6\u56fe\u6a21\u578b\u3002</p> <code>effector_vm</code> <code>EffectorViewModel</code> <p>\u672b\u7aef\u6267\u884c\u5668\u89c6\u56fe\u6a21\u578b\u3002</p> <code>trajectory_vm</code> <code>TrajectoryViewModel</code> <p>\u8f68\u8ff9\u89c6\u56fe\u6a21\u578b\u3002</p> <code>dynamics_vm</code> <code>DynamicsViewModel</code> <p>\u52a8\u529b\u5b66\u89c6\u56fe\u6a21\u578b\u3002</p> <code>camera_vm</code> <code>CameraViewModel</code> <p>\u76f8\u673a\u89c6\u56fe\u6a21\u578b\u3002</p> <code>motion_planning_vm</code> <code>MotionPlanningViewModel</code> <p>\u8fd0\u52a8\u89c4\u5212\u89c6\u56fe\u6a21\u578b\u3002</p> <code>tools_vm</code> <code>ToolsViewModel</code> <p>\u5de5\u5177\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u521d\u59cb\u5316\u4e3b\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>serial_vm</code> <code>SerialViewModel</code> <p>\u6ce8\u5165\u7684\u4e32\u53e3 VM\u3002</p> \u5fc5\u9700 <code>display_vm</code> <code>DisplayViewModel</code> <p>\u6ce8\u5165\u7684\u663e\u793a VM\u3002</p> \u5fc5\u9700 <code>control_vm</code> <code>ControlViewModel</code> <p>\u6ce8\u5165\u7684\u63a7\u5236 VM\u3002</p> \u5fc5\u9700 <code>status_vm</code> <code>StatusViewModel</code> <p>\u6ce8\u5165\u7684\u72b6\u6001 VM\u3002</p> \u5fc5\u9700 <code>effector_vm</code> <code>EffectorViewModel</code> <p>\u6ce8\u5165\u7684\u672b\u7aef VM\u3002</p> \u5fc5\u9700 <code>trajectory_vm</code> <code>TrajectoryViewModel</code> <p>\u6ce8\u5165\u7684\u8f68\u8ff9 VM\u3002</p> \u5fc5\u9700 <code>dynamics_vm</code> <code>DynamicsViewModel</code> <p>\u6ce8\u5165\u7684\u52a8\u529b\u5b66 VM\u3002</p> \u5fc5\u9700 <code>camera_vm</code> <code>CameraViewModel</code> <p>\u6ce8\u5165\u7684\u76f8\u673a VM\u3002</p> \u5fc5\u9700 <code>motion_planning_vm</code> <code>MotionPlanningViewModel</code> <p>\u6ce8\u5165\u7684\u89c4\u5212 VM\u3002</p> \u5fc5\u9700 <code>tools_vm</code> <code>ToolsViewModel</code> <p>\u6ce8\u5165\u7684\u5de5\u5177 VM\u3002</p> \u5fc5\u9700 <code>parent</code> <code>QObject</code> <p>\u7236\u5bf9\u8c61. Defaults to None.</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/main_view_model.py</code> <pre><code>def __init__(\n    self, \n    serial_vm: SerialViewModel, \n    display_vm: DisplayViewModel, \n    control_vm: ControlViewModel, \n    status_vm: StatusViewModel,\n    effector_vm: EffectorViewModel,\n    trajectory_vm: TrajectoryViewModel,\n    dynamics_vm: DynamicsViewModel,\n    camera_vm: CameraViewModel,\n    motion_planning_vm: MotionPlanningViewModel,\n    tools_vm: ToolsViewModel,\n    parent=None\n):\n    \"\"\"\u521d\u59cb\u5316\u4e3b\u89c6\u56fe\u6a21\u578b\u3002\n\n    Args:\n        serial_vm (SerialViewModel): \u6ce8\u5165\u7684\u4e32\u53e3 VM\u3002\n        display_vm (DisplayViewModel): \u6ce8\u5165\u7684\u663e\u793a VM\u3002\n        control_vm (ControlViewModel): \u6ce8\u5165\u7684\u63a7\u5236 VM\u3002\n        status_vm (StatusViewModel): \u6ce8\u5165\u7684\u72b6\u6001 VM\u3002\n        effector_vm (EffectorViewModel): \u6ce8\u5165\u7684\u672b\u7aef VM\u3002\n        trajectory_vm (TrajectoryViewModel): \u6ce8\u5165\u7684\u8f68\u8ff9 VM\u3002\n        dynamics_vm (DynamicsViewModel): \u6ce8\u5165\u7684\u52a8\u529b\u5b66 VM\u3002\n        camera_vm (CameraViewModel): \u6ce8\u5165\u7684\u76f8\u673a VM\u3002\n        motion_planning_vm (MotionPlanningViewModel): \u6ce8\u5165\u7684\u89c4\u5212 VM\u3002\n        tools_vm (ToolsViewModel): \u6ce8\u5165\u7684\u5de5\u5177 VM\u3002\n        parent (QObject, optional): \u7236\u5bf9\u8c61. Defaults to None.\n    \"\"\"\n    super().__init__(parent)\n    self.serial_vm = serial_vm\n    self.display_vm = display_vm\n    self.control_vm = control_vm\n    self.status_vm = status_vm\n    self.effector_vm = effector_vm\n    self.trajectory_vm = trajectory_vm\n    self.dynamics_vm = dynamics_vm\n    self.camera_vm = camera_vm\n    self.motion_planning_vm = motion_planning_vm\n    self.tools_vm = tools_vm\n\n    # \u8fde\u63a5\u8fde\u63a5\u72b6\u6001\u4fe1\u53f7\n    self._connect_status_update_signals()\n</code></pre>"},{"location":"api/presentation/core/main/#controller.presentation.view_models.main_view_model.MainViewModel.cleanup","title":"cleanup","text":"<pre><code>cleanup()\n</code></pre> <p>\u6e05\u7406\u8d44\u6e90\u3002</p> <p>\u8c03\u7528\u6240\u6709\u5b50 ViewModel \u7684 cleanup \u65b9\u6cd5\uff0c\u786e\u4fdd\u8d44\u6e90\u91ca\u653e\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/main_view_model.py</code> <pre><code>def cleanup(self):\n    \"\"\"\u6e05\u7406\u8d44\u6e90\u3002\n\n    \u8c03\u7528\u6240\u6709\u5b50 ViewModel \u7684 cleanup \u65b9\u6cd5\uff0c\u786e\u4fdd\u8d44\u6e90\u91ca\u653e\u3002\n    \"\"\"\n    # \u6e05\u7406\u6240\u6709\u5b50ViewModels\n    for vm_attr in ['serial_vm', 'display_vm', 'control_vm', 'status_vm',\n                   'effector_vm', 'trajectory_vm', 'dynamics_vm', 'camera_vm',\n                   'motion_planning_vm', 'tools_vm']:\n        vm = getattr(self, vm_attr, None)\n        if vm and hasattr(vm, 'cleanup'):\n            try:\n                vm.cleanup()\n            except Exception as e:\n                pass\n\n    super().cleanup() \n</code></pre>"},{"location":"api/presentation/device/control/","title":"Control ViewModel","text":""},{"location":"api/presentation/device/control/#controller.presentation.view_models.control_view_model","title":"controller.presentation.view_models.control_view_model","text":""},{"location":"api/presentation/device/control/#controller.presentation.view_models.control_view_model.ControlViewModel","title":"ControlViewModel","text":"<pre><code>ControlViewModel(command_hub_service: CommandHubService, parent=None)\n</code></pre> <p>               Bases: <code>BaseViewModel</code></p> <p>\u63a7\u5236\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u8d1f\u8d23\u5904\u7406\u7528\u6237\u8f93\u5165\u7684\u63a7\u5236\u547d\u4ee4\uff0c\u5e76\u5206\u53d1\u5230\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>command_hub_service</code> <code>CommandHubService</code> <p>\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002</p> <p>\u521d\u59cb\u5316\u63a7\u5236\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>command_hub_service</code> <code>CommandHubService</code> <p>\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>parent</code> <code>QObject</code> <p>\u7236\u5bf9\u8c61. Defaults to None.</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/control_view_model.py</code> <pre><code>def __init__(self, command_hub_service: CommandHubService, parent=None):\n    \"\"\"\u521d\u59cb\u5316\u63a7\u5236\u89c6\u56fe\u6a21\u578b\u3002\n\n    Args:\n        command_hub_service (CommandHubService): \u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002\n        parent (QObject, optional): \u7236\u5bf9\u8c61. Defaults to None.\n    \"\"\"\n    super().__init__(parent)\n    self.command_hub_service = command_hub_service\n</code></pre>"},{"location":"api/presentation/device/control/#controller.presentation.view_models.control_view_model.ControlViewModel.send_command","title":"send_command","text":"<pre><code>send_command(config_dict: dict)\n</code></pre> <p>\u53d1\u9001\u63a7\u5236\u547d\u4ee4\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config_dict</code> <code>dict</code> <p>\u547d\u4ee4\u914d\u7f6e\u5b57\u5178\uff0c\u5305\u542b\u63a7\u5236\u53c2\u6570\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/control_view_model.py</code> <pre><code>def send_command(self, config_dict: dict):\n    \"\"\"\u53d1\u9001\u63a7\u5236\u547d\u4ee4\u3002\n\n    Args:\n        config_dict (dict): \u547d\u4ee4\u914d\u7f6e\u5b57\u5178\uff0c\u5305\u542b\u63a7\u5236\u53c2\u6570\u3002\n    \"\"\"\n    self.command_hub_service.command_distribution(config_dict)\n</code></pre>"},{"location":"api/presentation/device/effector/","title":"Effector ViewModel","text":""},{"location":"api/presentation/device/effector/#controller.presentation.view_models.effector_view_model","title":"controller.presentation.view_models.effector_view_model","text":"<p>\u672b\u7aef\u6267\u884c\u5668\u89c6\u56fe\u6a21\u578b - Presentation\u5c42</p>"},{"location":"api/presentation/device/effector/#controller.presentation.view_models.effector_view_model.EffectorViewModel","title":"EffectorViewModel","text":"<pre><code>EffectorViewModel(command_hub_service: CommandHubService, parent=None)\n</code></pre> <p>               Bases: <code>BaseViewModel</code></p> <p>\u672b\u7aef\u6267\u884c\u5668\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u8d1f\u8d23\u5904\u7406\u672b\u7aef\u6267\u884c\u5668\uff08\u5982\u5939\u722a\u3001\u5438\u76d8\uff09\u7684\u63a7\u5236\u547d\u4ee4\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>command_hub_service</code> <code>CommandHubService</code> <p>\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002</p> <p>\u521d\u59cb\u5316\u672b\u7aef\u6267\u884c\u5668\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>command_hub_service</code> <code>CommandHubService</code> <p>\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>parent</code> <code>QObject</code> <p>\u7236\u5bf9\u8c61. Defaults to None.</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/effector_view_model.py</code> <pre><code>def __init__(self, command_hub_service: CommandHubService, parent=None):\n    \"\"\"\u521d\u59cb\u5316\u672b\u7aef\u6267\u884c\u5668\u89c6\u56fe\u6a21\u578b\u3002\n\n    Args:\n        command_hub_service (CommandHubService): \u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002\n        parent (QObject, optional): \u7236\u5bf9\u8c61. Defaults to None.\n    \"\"\"\n    super().__init__(parent)\n    self.command_hub_service = command_hub_service\n</code></pre>"},{"location":"api/presentation/device/effector/#controller.presentation.view_models.effector_view_model.EffectorViewModel.send_effector_command","title":"send_effector_command","text":"<pre><code>send_effector_command(config_dict: dict)\n</code></pre> <p>\u53d1\u9001\u672b\u7aef\u6267\u884c\u5668\u547d\u4ee4\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config_dict</code> <code>dict</code> <p>\u547d\u4ee4\u914d\u7f6e\u5b57\u5178\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/effector_view_model.py</code> <pre><code>def send_effector_command(self, config_dict: dict):\n    \"\"\"\u53d1\u9001\u672b\u7aef\u6267\u884c\u5668\u547d\u4ee4\u3002\n\n    Args:\n        config_dict (dict): \u547d\u4ee4\u914d\u7f6e\u5b57\u5178\u3002\n    \"\"\"\n    self.command_hub_service.command_distribution(config_dict)\n</code></pre>"},{"location":"api/presentation/device/serial/","title":"Serial ViewModel","text":""},{"location":"api/presentation/device/serial/#controller.presentation.view_models.serial_view_model","title":"controller.presentation.view_models.serial_view_model","text":"<p>\u4e32\u53e3\u89c6\u56fe\u6a21\u578b - Presentation\u5c42 \u7eaf\u4fe1\u53f7\u8f6c\u53d1\u5c42\uff0c\u4e0d\u5305\u542b\u4e1a\u52a1\u903b\u8f91</p>"},{"location":"api/presentation/device/serial/#controller.presentation.view_models.serial_view_model.SerialViewModel","title":"SerialViewModel","text":"<pre><code>SerialViewModel(serial_service: SerialApplicationService, command_hub_service: CommandHubService, parent=None)\n</code></pre> <p>               Bases: <code>BaseViewModel</code></p> <p>\u4e32\u53e3\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u7eaf\u4fe1\u53f7\u8f6c\u53d1\u5c42\uff0c\u4e0d\u5305\u542b\u4e1a\u52a1\u903b\u8f91\uff0c\u8d1f\u8d23 UI \u4e0e\u4e32\u53e3\u670d\u52a1\u7684\u4ea4\u4e92\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>port_list_updated</code> <code>pyqtSignal</code> <p>\u7aef\u53e3\u5217\u8868\u66f4\u65b0\u4fe1\u53f7\uff0c\u643a\u5e26\u7aef\u53e3\u5217\u8868\u3002</p> <code>serial_service</code> <code>SerialApplicationService</code> <p>\u4e32\u53e3\u5e94\u7528\u670d\u52a1\u3002</p> <code>command_hub_service</code> <code>CommandHubService</code> <p>\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002</p> <p>\u521d\u59cb\u5316\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>serial_service</code> <code>SerialApplicationService</code> <p>\u4e32\u53e3\u5e94\u7528\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>command_hub_service</code> <code>CommandHubService</code> <p>\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>parent</code> <code>QObject</code> <p>\u7236\u5bf9\u8c61. Defaults to None.</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/serial_view_model.py</code> <pre><code>def __init__(self, serial_service: SerialApplicationService, command_hub_service: CommandHubService, parent=None):\n    \"\"\"\u521d\u59cb\u5316\u89c6\u56fe\u6a21\u578b\u3002\n\n    Args:\n        serial_service (SerialApplicationService): \u4e32\u53e3\u5e94\u7528\u670d\u52a1\u3002\n        command_hub_service (CommandHubService): \u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002\n        parent (QObject, optional): \u7236\u5bf9\u8c61. Defaults to None.\n    \"\"\"\n    super().__init__(parent)\n\n    self.serial_service = serial_service\n    self.command_hub_service = command_hub_service\n    self._connect_service_signals()\n</code></pre>"},{"location":"api/presentation/device/serial/#controller.presentation.view_models.serial_view_model.SerialViewModel.refresh_ports","title":"refresh_ports","text":"<pre><code>refresh_ports() -&gt; None\n</code></pre> <p>\u5237\u65b0\u7aef\u53e3\u5217\u8868\u547d\u4ee4 - \u76f4\u63a5\u8f6c\u53d1\u5230Service\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/serial_view_model.py</code> <pre><code>def refresh_ports(self) -&gt; None:\n    \"\"\"\u5237\u65b0\u7aef\u53e3\u5217\u8868\u547d\u4ee4 - \u76f4\u63a5\u8f6c\u53d1\u5230Service\u3002\"\"\"\n    self.serial_service.refresh_ports()\n</code></pre>"},{"location":"api/presentation/device/serial/#controller.presentation.view_models.serial_view_model.SerialViewModel.connect_serial","title":"connect_serial","text":"<pre><code>connect_serial(port: str, config: Dict[str, Any]) -&gt; None\n</code></pre> <p>\u8fde\u63a5\u4e32\u53e3\u547d\u4ee4 - \u76f4\u63a5\u8f6c\u53d1\u5230Service\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>port</code> <code>str</code> <p>\u7aef\u53e3\u540d\u79f0\u3002</p> \u5fc5\u9700 <code>config</code> <code>Dict[str, Any]</code> <p>\u914d\u7f6e\u53c2\u6570\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/serial_view_model.py</code> <pre><code>def connect_serial(self, port: str, config: Dict[str, Any]) -&gt; None:\n    \"\"\"\u8fde\u63a5\u4e32\u53e3\u547d\u4ee4 - \u76f4\u63a5\u8f6c\u53d1\u5230Service\u3002\n\n    Args:\n        port (str): \u7aef\u53e3\u540d\u79f0\u3002\n        config (Dict[str, Any]): \u914d\u7f6e\u53c2\u6570\u3002\n    \"\"\"\n    self.serial_service.connect_serial(port, config)\n</code></pre>"},{"location":"api/presentation/device/serial/#controller.presentation.view_models.serial_view_model.SerialViewModel.disconnect_serial","title":"disconnect_serial","text":"<pre><code>disconnect_serial() -&gt; None\n</code></pre> <p>\u65ad\u5f00\u8fde\u63a5\u547d\u4ee4 - \u76f4\u63a5\u8f6c\u53d1\u5230Service\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/serial_view_model.py</code> <pre><code>def disconnect_serial(self) -&gt; None:\n    \"\"\"\u65ad\u5f00\u8fde\u63a5\u547d\u4ee4 - \u76f4\u63a5\u8f6c\u53d1\u5230Service\u3002\"\"\"\n    self.serial_service.disconnect_serial()\n</code></pre>"},{"location":"api/presentation/device/serial/#controller.presentation.view_models.serial_view_model.SerialViewModel.get_available_ports","title":"get_available_ports","text":"<pre><code>get_available_ports() -&gt; List[str]\n</code></pre> <p>\u83b7\u53d6\u53ef\u7528\u7aef\u53e3\u5217\u8868 - \u59d4\u6258\u7ed9Service\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>List[str]: \u7aef\u53e3\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/serial_view_model.py</code> <pre><code>def get_available_ports(self) -&gt; List[str]:\n    \"\"\"\u83b7\u53d6\u53ef\u7528\u7aef\u53e3\u5217\u8868 - \u59d4\u6258\u7ed9Service\u3002\n\n    Returns:\n        List[str]: \u7aef\u53e3\u5217\u8868\u3002\n    \"\"\"\n    return self.serial_service.get_available_ports()\n</code></pre>"},{"location":"api/presentation/device/serial/#controller.presentation.view_models.serial_view_model.SerialViewModel.get_current_port","title":"get_current_port","text":"<pre><code>get_current_port() -&gt; Optional[str]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u7684\u7aef\u53e3 - \u59d4\u6258\u7ed9Service\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[str]</code> <p>Optional[str]: \u7aef\u53e3\u540d\u79f0\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/serial_view_model.py</code> <pre><code>def get_current_port(self) -&gt; Optional[str]:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u7684\u7aef\u53e3 - \u59d4\u6258\u7ed9Service\u3002\n\n    Returns:\n        Optional[str]: \u7aef\u53e3\u540d\u79f0\u3002\n    \"\"\"\n    return self.serial_service.get_current_port()\n</code></pre>"},{"location":"api/presentation/device/serial/#controller.presentation.view_models.serial_view_model.SerialViewModel.get_connection_status","title":"get_connection_status","text":"<pre><code>get_connection_status() -&gt; bool\n</code></pre> <p>\u83b7\u53d6\u8fde\u63a5\u72b6\u6001 - \u59d4\u6258\u7ed9Service\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u5df2\u8fde\u63a5\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/serial_view_model.py</code> <pre><code>def get_connection_status(self) -&gt; bool:\n    \"\"\"\u83b7\u53d6\u8fde\u63a5\u72b6\u6001 - \u59d4\u6258\u7ed9Service\u3002\n\n    Returns:\n        bool: \u662f\u5426\u5df2\u8fde\u63a5\u3002\n    \"\"\"\n    return self.serial_service.is_connected()\n</code></pre>"},{"location":"api/presentation/device/serial/#controller.presentation.view_models.serial_view_model.SerialViewModel.get_port_info","title":"get_port_info","text":"<pre><code>get_port_info(port_name: str) -&gt; Optional[Dict[str, str]]\n</code></pre> <p>\u83b7\u53d6\u7aef\u53e3\u4fe1\u606f - \u59d4\u6258\u7ed9Service\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>port_name</code> <code>str</code> <p>\u7aef\u53e3\u540d\u79f0\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[Dict[str, str]]</code> <p>Optional[Dict[str, str]]: \u7aef\u53e3\u4fe1\u606f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/serial_view_model.py</code> <pre><code>def get_port_info(self, port_name: str) -&gt; Optional[Dict[str, str]]:\n    \"\"\"\u83b7\u53d6\u7aef\u53e3\u4fe1\u606f - \u59d4\u6258\u7ed9Service\u3002\n\n    Args:\n        port_name (str): \u7aef\u53e3\u540d\u79f0\u3002\n\n    Returns:\n        Optional[Dict[str, str]]: \u7aef\u53e3\u4fe1\u606f\u3002\n    \"\"\"\n    return self.serial_service.get_port_info(port_name)\n</code></pre>"},{"location":"api/presentation/device/serial/#controller.presentation.view_models.serial_view_model.SerialViewModel.cleanup","title":"cleanup","text":"<pre><code>cleanup() -&gt; None\n</code></pre> <p>\u6e05\u7406\u89c6\u56fe\u6a21\u578b - \u65ad\u5f00\u4fe1\u53f7\u8fde\u63a5\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/serial_view_model.py</code> <pre><code>def cleanup(self) -&gt; None:\n    \"\"\"\u6e05\u7406\u89c6\u56fe\u6a21\u578b - \u65ad\u5f00\u4fe1\u53f7\u8fde\u63a5\u3002\"\"\"\n    self._disconnect_service_signals()\n    super().cleanup() \n</code></pre>"},{"location":"api/presentation/device/status/","title":"Status ViewModel","text":""},{"location":"api/presentation/device/status/#controller.presentation.view_models.status_view_model","title":"controller.presentation.view_models.status_view_model","text":"<p>\u72b6\u6001\u89c6\u56fe\u6a21\u578b - \u7ba1\u7406\u673a\u5668\u4eba\u72b6\u6001\u663e\u793a \u8ba2\u9605 RobotStateDomainService\uff0c\u4e0d\u518d\u81ea\u5df1\u7ef4\u62a4\u72b6\u6001</p>"},{"location":"api/presentation/device/status/#controller.presentation.view_models.status_view_model.StatusViewModel","title":"StatusViewModel","text":"<pre><code>StatusViewModel(robot_state_service: RobotStateDomainService, parent=None)\n</code></pre> <p>               Bases: <code>BaseViewModel</code></p> <p>\u72b6\u6001\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u7ba1\u7406\u673a\u5668\u4eba\u72b6\u6001\u663e\u793a\uff0c\u8ba2\u9605 RobotStateDomainService \u7684\u72b6\u6001\u66f4\u65b0\uff0c\u4e0d\u518d\u81ea\u5df1\u7ef4\u62a4\u72b6\u6001\u3002</p> <p>\u804c\u8d23\uff1a 1. \u8ba2\u9605 RobotStateDomainService \u7684\u72b6\u6001\u66f4\u65b0 2. \u8f6c\u6362\u6570\u636e\u683c\u5f0f\uff08\u8f6c\u6362\u4e3a dict \u4f9b UI \u7ec4\u4ef6\u4f7f\u7528\uff09 3. \u53d1\u5c04\u4fe1\u53f7\u7ed9 UI \u7ec4\u4ef6</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>status_updated</code> <code>pyqtSignal</code> <p>\u72b6\u6001\u66f4\u65b0\u4fe1\u53f7\uff0c\u643a\u5e26\u72b6\u6001\u6570\u636e\u5b57\u5178\u3002</p> <code>robot_state_service</code> <code>RobotStateDomainService</code> <p>\u673a\u68b0\u81c2\u72b6\u6001\u670d\u52a1\u3002</p> <p>\u521d\u59cb\u5316\u72b6\u6001\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>robot_state_service</code> <code>RobotStateDomainService</code> <p>\u673a\u68b0\u81c2\u72b6\u6001\u670d\u52a1\uff08\u4f9d\u8d56\u6ce8\u5165\uff09\u3002</p> \u5fc5\u9700 <code>parent</code> <code>QObject</code> <p>\u7236\u5bf9\u8c61. Defaults to None.</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/status_view_model.py</code> <pre><code>def __init__(self, robot_state_service: RobotStateDomainService, parent=None):\n    \"\"\"\u521d\u59cb\u5316\u72b6\u6001\u89c6\u56fe\u6a21\u578b\u3002\n\n    Args:\n        robot_state_service (RobotStateDomainService): \u673a\u68b0\u81c2\u72b6\u6001\u670d\u52a1\uff08\u4f9d\u8d56\u6ce8\u5165\uff09\u3002\n        parent (QObject, optional): \u7236\u5bf9\u8c61. Defaults to None.\n    \"\"\"\n    super().__init__(parent)\n    self.robot_state_service = robot_state_service\n\n    # \u8ba2\u9605\u72b6\u6001\u670d\u52a1\u7684\u4fe1\u53f7\n    self.robot_state_service.state_updated.connect(self._on_state_updated)\n</code></pre>"},{"location":"api/presentation/device/status/#controller.presentation.view_models.status_view_model.StatusViewModel.get_position_string","title":"get_position_string","text":"<pre><code>get_position_string() -&gt; str\n</code></pre> <p>\u83b7\u53d6\u4f4d\u7f6e\u4fe1\u606f\u7684\u5b57\u7b26\u4e32\u8868\u793a\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>str</code> <code>str</code> <p>\u4f4d\u7f6e\u5b57\u7b26\u4e32\uff0c\u5982 \"[0.50, -1.20, 0.30, 0.00, 0.00, 0.00]\"\u3002\u5982\u679c\u65e0\u6570\u636e\u8fd4\u56de \"--\"\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/status_view_model.py</code> <pre><code>def get_position_string(self) -&gt; str:\n    \"\"\"\u83b7\u53d6\u4f4d\u7f6e\u4fe1\u606f\u7684\u5b57\u7b26\u4e32\u8868\u793a\u3002\n\n    Returns:\n        str: \u4f4d\u7f6e\u5b57\u7b26\u4e32\uff0c\u5982 \"[0.50, -1.20, 0.30, 0.00, 0.00, 0.00]\"\u3002\u5982\u679c\u65e0\u6570\u636e\u8fd4\u56de \"--\"\u3002\n    \"\"\"\n    snapshot = self.robot_state_service.get_current_state()\n    if snapshot:\n        positions = snapshot.joint_angles\n        return f\"[{', '.join(f'{pos:.3f}' for pos in positions[:6])}]\"\n    return \"--\"\n</code></pre>"},{"location":"api/presentation/device/status/#controller.presentation.view_models.status_view_model.StatusViewModel.get_status_summary","title":"get_status_summary","text":"<pre><code>get_status_summary() -&gt; str\n</code></pre> <p>\u83b7\u53d6\u72b6\u6001\u6458\u8981\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>str</code> <code>str</code> <p>\u72b6\u6001\u6458\u8981\u5b57\u7b26\u4e32\uff0c\u5982 \"CMD:0x06 | MODE:0x08 | STA:0x01\"\u3002\u5982\u679c\u65e0\u6570\u636e\u8fd4\u56de \"\u65e0\u72b6\u6001\u6570\u636e\"\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/status_view_model.py</code> <pre><code>def get_status_summary(self) -&gt; str:\n    \"\"\"\u83b7\u53d6\u72b6\u6001\u6458\u8981\u3002\n\n    Returns:\n        str: \u72b6\u6001\u6458\u8981\u5b57\u7b26\u4e32\uff0c\u5982 \"CMD:0x06 | MODE:0x08 | STA:0x01\"\u3002\u5982\u679c\u65e0\u6570\u636e\u8fd4\u56de \"\u65e0\u72b6\u6001\u6570\u636e\"\u3002\n    \"\"\"\n    snapshot = self.robot_state_service.get_current_state()\n    if not snapshot:\n        return \"\u65e0\u72b6\u6001\u6570\u636e\"\n\n    summary = []\n    summary.append(f\"CMD:0x{snapshot.control:02X}\")\n    summary.append(f\"MODE:0x{snapshot.mode:02X}\")\n    summary.append(f\"STA:0x{snapshot.init_status:02X}\")\n\n    # \u68c0\u67e5\u9519\u8bef\n    if any(err != 0 for err in snapshot.errors):\n        summary.append(f\"ERR:\u6709\u9519\u8bef\")\n\n    return \" | \".join(summary)\n</code></pre>"},{"location":"api/presentation/features/camera/","title":"Camera ViewModel","text":""},{"location":"api/presentation/features/camera/#controller.presentation.view_models.camera_view_model","title":"controller.presentation.view_models.camera_view_model","text":"<p>\u6444\u50cf\u5934\u89c6\u56fe\u6a21\u578b - Presentation\u5c42 \u53ea\u4f9d\u8d56Application\u5c42\uff0c\u4e0d\u76f4\u63a5\u8bbf\u95eeDomain\u5c42</p>"},{"location":"api/presentation/features/camera/#controller.presentation.view_models.camera_view_model.CameraViewModel","title":"CameraViewModel","text":"<pre><code>CameraViewModel(app_service: CameraApplicationService, parent=None)\n</code></pre> <p>               Bases: <code>BaseViewModel</code></p> <p>\u6444\u50cf\u5934\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u804c\u8d23\uff1a - \u8fde\u63a5 UI \u548c Application Service - \u7ba1\u7406\u56fe\u50cf\u663e\u793a\u72b6\u6001\uff08\u5b9a\u65f6\u5237\u65b0\uff09 - \u7ba1\u7406\u68c0\u6d4b\u72b6\u6001 - \u901a\u8fc7 Application Service \u83b7\u53d6\u56fe\u50cf\u548c\u68c0\u6d4b\u7ed3\u679c</p> <p>\u67b6\u6784\u539f\u5219\uff1a - \u53ea\u4f9d\u8d56 Application \u5c42\uff0c\u4e0d\u76f4\u63a5\u8bbf\u95ee Domain \u5c42 - \u6240\u6709 Domain \u5c42\u8c03\u7528\u901a\u8fc7 Application Service \u8f6c\u53d1</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>image_display_requested</code> <code>pyqtSignal</code> <p>\u56fe\u50cf\u663e\u793a\u8bf7\u6c42\u4fe1\u53f7\uff0c\u643a\u5e26 (image, image_type)\u3002</p> <code>status_updated</code> <code>pyqtSignal</code> <p>\u72b6\u6001\u6587\u672c\u66f4\u65b0\u4fe1\u53f7\u3002</p> <code>image_info_updated</code> <code>pyqtSignal</code> <p>\u56fe\u50cf\u4fe1\u606f\u66f4\u65b0\u4fe1\u53f7\u3002</p> <code>connection_status_changed</code> <code>pyqtSignal</code> <p>\u6444\u50cf\u5934\u8fde\u63a5\u72b6\u6001\u4fe1\u53f7\u3002</p> <code>button_states_changed</code> <code>pyqtSignal</code> <p>\u6309\u94ae\u72b6\u6001\u53d8\u66f4\u4fe1\u53f7\uff0c\u643a\u5e26 (color_active, depth_active)\u3002</p> <code>clear_display_requested</code> <code>pyqtSignal</code> <p>\u6e05\u9664\u663e\u793a\u8bf7\u6c42\u4fe1\u53f7\u3002</p> <code>detection_status_changed</code> <code>pyqtSignal</code> <p>\u68c0\u6d4b\u72b6\u6001\u53d8\u66f4\u4fe1\u53f7\u3002</p> <code>detection_result_updated</code> <code>pyqtSignal</code> <p>\u68c0\u6d4b\u7ed3\u679c\u66f4\u65b0\u4fe1\u53f7\u3002</p> <code>app_service</code> <code>CameraApplicationService</code> <p>\u6444\u50cf\u5934\u5e94\u7528\u670d\u52a1\u3002</p> <code>display_timer</code> <code>QTimer</code> <p>\u56fe\u50cf\u5237\u65b0\u5b9a\u65f6\u5668\u3002</p> <p>\u521d\u59cb\u5316\u6444\u50cf\u5934\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>app_service</code> <code>CameraApplicationService</code> <p>\u6444\u50cf\u5934\u5e94\u7528\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>parent</code> <code>QObject</code> <p>\u7236\u5bf9\u8c61. Defaults to None.</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/camera_view_model.py</code> <pre><code>def __init__(\n    self,\n    app_service: CameraApplicationService,\n    parent=None\n):\n    \"\"\"\u521d\u59cb\u5316\u6444\u50cf\u5934\u89c6\u56fe\u6a21\u578b\u3002\n\n    Args:\n        app_service (CameraApplicationService): \u6444\u50cf\u5934\u5e94\u7528\u670d\u52a1\u3002\n        parent (QObject, optional): \u7236\u5bf9\u8c61. Defaults to None.\n    \"\"\"\n    super().__init__(parent)\n    self.app_service = app_service\n\n    # \u663e\u793a\u72b6\u6001\n    self.current_display_mode = None  # None, 'color', 'depth'\n\n    # \u5b9a\u65f6\u5668\uff0830FPS\u5237\u65b0\u56fe\u50cf\uff09\n    self.display_timer = QTimer()\n    self.display_timer.timeout.connect(self._update_display)\n\n    # \u8fde\u63a5\u4fe1\u53f7\n    self._connect_signals()\n</code></pre>"},{"location":"api/presentation/features/camera/#controller.presentation.view_models.camera_view_model.CameraViewModel.connect_camera","title":"connect_camera","text":"<pre><code>connect_camera()\n</code></pre> <p>\u8fde\u63a5\u6444\u50cf\u5934\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/camera_view_model.py</code> <pre><code>def connect_camera(self):\n    \"\"\"\u8fde\u63a5\u6444\u50cf\u5934\u3002\"\"\"\n    self.app_service.connect_camera()\n</code></pre>"},{"location":"api/presentation/features/camera/#controller.presentation.view_models.camera_view_model.CameraViewModel.disconnect_camera","title":"disconnect_camera","text":"<pre><code>disconnect_camera()\n</code></pre> <p>\u65ad\u5f00\u6444\u50cf\u5934\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/camera_view_model.py</code> <pre><code>def disconnect_camera(self):\n    \"\"\"\u65ad\u5f00\u6444\u50cf\u5934\u3002\"\"\"\n    # \u5148\u505c\u6b62\u663e\u793a\n    if self.current_display_mode is not None:\n        self.stop_display()\n\n    # \u65ad\u5f00\u6444\u50cf\u5934\n    self.app_service.disconnect_camera()\n</code></pre>"},{"location":"api/presentation/features/camera/#controller.presentation.view_models.camera_view_model.CameraViewModel.start_color_display","title":"start_color_display","text":"<pre><code>start_color_display()\n</code></pre> <p>\u5f00\u59cb\u663e\u793a\u5f69\u8272\u56fe\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/camera_view_model.py</code> <pre><code>def start_color_display(self):\n    \"\"\"\u5f00\u59cb\u663e\u793a\u5f69\u8272\u56fe\u3002\"\"\"\n    # \u2705 \u901a\u8fc7Application\u5c42\u68c0\u67e5\u6444\u50cf\u5934\u662f\u5426\u8fde\u63a5\n    if not self.app_service.is_camera_connected():\n        self.status_updated.emit(\"\u8bf7\u5148\u8fde\u63a5\u6444\u50cf\u5934\")\n        return\n\n    # \u8bbe\u7f6e\u663e\u793a\u6a21\u5f0f\n    self.current_display_mode = 'color'\n\n    # \u542f\u52a8\u5b9a\u65f6\u5668\uff0833ms = ~30FPS\uff09\n    self.display_timer.start(33)\n\n    # \u66f4\u65b0\u72b6\u6001\n    self.status_updated.emit(\"\u663e\u793a\u5f69\u8272\u56fe\u50cf\")\n    self.button_states_changed.emit(True, False)\n</code></pre>"},{"location":"api/presentation/features/camera/#controller.presentation.view_models.camera_view_model.CameraViewModel.start_depth_display","title":"start_depth_display","text":"<pre><code>start_depth_display()\n</code></pre> <p>\u5f00\u59cb\u663e\u793a\u6df1\u5ea6\u56fe\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/camera_view_model.py</code> <pre><code>def start_depth_display(self):\n    \"\"\"\u5f00\u59cb\u663e\u793a\u6df1\u5ea6\u56fe\u3002\"\"\"\n    # \u2705 \u901a\u8fc7Application\u5c42\u68c0\u67e5\u6444\u50cf\u5934\u662f\u5426\u8fde\u63a5\n    if not self.app_service.is_camera_connected():\n        self.status_updated.emit(\"\u8bf7\u5148\u8fde\u63a5\u6444\u50cf\u5934\")\n        return\n\n    # \u8bbe\u7f6e\u663e\u793a\u6a21\u5f0f\n    self.current_display_mode = 'depth'\n\n    # \u542f\u52a8\u5b9a\u65f6\u5668\n    self.display_timer.start(33)\n\n    # \u66f4\u65b0\u72b6\u6001\n    self.status_updated.emit(\"\u663e\u793a\u6df1\u5ea6\u56fe\u50cf\")\n    self.button_states_changed.emit(False, True)\n</code></pre>"},{"location":"api/presentation/features/camera/#controller.presentation.view_models.camera_view_model.CameraViewModel.stop_display","title":"stop_display","text":"<pre><code>stop_display()\n</code></pre> <p>\u505c\u6b62\u663e\u793a\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/camera_view_model.py</code> <pre><code>def stop_display(self):\n    \"\"\"\u505c\u6b62\u663e\u793a\u3002\"\"\"\n    # \u505c\u6b62\u5b9a\u65f6\u5668\n    self.display_timer.stop()\n\n    # \u6e05\u9664\u663e\u793a\u6a21\u5f0f\n    self.current_display_mode = None\n\n    # \u6e05\u9664\u663e\u793a\n    self.clear_display_requested.emit()\n\n    # \u66f4\u65b0\u72b6\u6001\n    self.status_updated.emit(\"\u5df2\u505c\u6b62\u663e\u793a\")\n    self.button_states_changed.emit(False, False)\n    self.image_info_updated.emit({})\n</code></pre>"},{"location":"api/presentation/features/camera/#controller.presentation.view_models.camera_view_model.CameraViewModel.start_detection","title":"start_detection","text":"<pre><code>start_detection()\n</code></pre> <p>\u5f00\u59cb\u68c0\u6d4b\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/camera_view_model.py</code> <pre><code>def start_detection(self):\n    \"\"\"\u5f00\u59cb\u68c0\u6d4b\u3002\"\"\"\n    self.app_service.start_detection()\n</code></pre>"},{"location":"api/presentation/features/camera/#controller.presentation.view_models.camera_view_model.CameraViewModel.stop_detection","title":"stop_detection","text":"<pre><code>stop_detection()\n</code></pre> <p>\u505c\u6b62\u68c0\u6d4b\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/camera_view_model.py</code> <pre><code>def stop_detection(self):\n    \"\"\"\u505c\u6b62\u68c0\u6d4b\u3002\"\"\"\n    self.app_service.stop_detection()\n</code></pre>"},{"location":"api/presentation/features/camera/#controller.presentation.view_models.camera_view_model.CameraViewModel.move_to_detected_part","title":"move_to_detected_part","text":"<pre><code>move_to_detected_part()\n</code></pre> <p>\u8fd0\u52a8\u5230\u68c0\u6d4b\u5230\u7684\u96f6\u4ef6\u4f4d\u7f6e\u3002</p> <p>\u804c\u8d23\uff1a\u4ec5\u8f6c\u53d1\u5230 Application \u5c42\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/camera_view_model.py</code> <pre><code>def move_to_detected_part(self):\n    \"\"\"\u8fd0\u52a8\u5230\u68c0\u6d4b\u5230\u7684\u96f6\u4ef6\u4f4d\u7f6e\u3002\n\n    \u804c\u8d23\uff1a\u4ec5\u8f6c\u53d1\u5230 Application \u5c42\u3002\n    \"\"\"\n    self.app_service.move_to_detected_part()\n</code></pre>"},{"location":"api/presentation/features/camera/#controller.presentation.view_models.camera_view_model.CameraViewModel.cleanup","title":"cleanup","text":"<pre><code>cleanup()\n</code></pre> <p>\u6e05\u7406\u8d44\u6e90\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/camera_view_model.py</code> <pre><code>def cleanup(self):\n    \"\"\"\u6e05\u7406\u8d44\u6e90\u3002\"\"\"\n    try:\n        # \u505c\u6b62\u68c0\u6d4b\uff08\u2705 \u901a\u8fc7Application\u5c42\uff09\n        if self.app_service.is_detection_running():\n            self.app_service.stop_detection()\n\n        # \u505c\u6b62\u663e\u793a\n        self.stop_display()\n\n        # \u65ad\u5f00\u6444\u50cf\u5934\uff08\u2705 \u901a\u8fc7Application\u5c42\uff09\n        if self.app_service.is_camera_connected():\n            self.app_service.disconnect_camera()\n\n    except Exception as e:\n        pass\n</code></pre>"},{"location":"api/presentation/features/dynamics/","title":"Dynamics ViewModel","text":""},{"location":"api/presentation/features/dynamics/#controller.presentation.view_models.dynamics_view_model","title":"controller.presentation.view_models.dynamics_view_model","text":"<p>\u52a8\u529b\u5b66\u89c6\u56fe\u6a21\u578b - Presentation\u5c42 \u8ba2\u9605 RobotStateDomainService\uff0c\u5b9e\u73b0\u529b\u77e9\u8865\u507f\u548c\u793a\u6559\u8bb0\u5f55</p>"},{"location":"api/presentation/features/dynamics/#controller.presentation.view_models.dynamics_view_model.DynamicsViewModel","title":"DynamicsViewModel","text":"<pre><code>DynamicsViewModel(command_hub_service: CommandHubService, robot_state_service: RobotStateDomainService, dynamic_service: DynamicDomainService, teach_record_service: TeachRecordDomainService, record_repository: RecordRepository, parent: Optional[object] = None)\n</code></pre> <p>               Bases: <code>BaseViewModel</code></p> <p>\u52a8\u529b\u5b66\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u8ba2\u9605 RobotStateDomainService\uff0c\u5b9e\u73b0\u529b\u77e9\u8865\u507f\u548c\u793a\u6559\u8bb0\u5f55\u3002</p> <p>\u804c\u8d23\uff1a 1. \u5904\u7406\u793a\u6559\u6a21\u5f0f\u5207\u6362 2. \u8ba2\u9605\u529b\u77e9\u8865\u507f\u8bf7\u6c42\uff08\u6570\u636e\u9a71\u52a8\uff09 3. \u8ba1\u7b97\u5e76\u53d1\u9001\u529b\u77e9\u8865\u507f 4. \u7ba1\u7406\u793a\u6559\u8bb0\u5f55\u7684\u5f55\u5236\u3001\u4fdd\u5b58\u3001\u64ad\u653e</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>recording_state_changed</code> <code>pyqtSignal</code> <p>\u8bb0\u5f55\u72b6\u6001\u53d8\u5316\u4fe1\u53f7\u3002</p> <code>record_list_updated</code> <code>pyqtSignal</code> <p>\u8bb0\u5f55\u5217\u8868\u66f4\u65b0\u4fe1\u53f7\u3002</p> <code>command_hub</code> <code>CommandHubService</code> <p>\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002</p> <code>robot_state</code> <code>RobotStateDomainService</code> <p>\u673a\u68b0\u81c2\u72b6\u6001\u670d\u52a1\u3002</p> <code>dynamic_service</code> <code>DynamicDomainService</code> <p>\u52a8\u529b\u5b66\u670d\u52a1\u3002</p> <code>teach_record_service</code> <code>TeachRecordDomainService</code> <p>\u793a\u6559\u8bb0\u5f55\u670d\u52a1\u3002</p> <code>record_repository</code> <code>RecordRepository</code> <p>\u8bb0\u5f55\u4ed3\u50a8\u3002</p> <p>\u521d\u59cb\u5316\u52a8\u529b\u5b66\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>command_hub_service</code> <code>CommandHubService</code> <p>\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>robot_state_service</code> <code>RobotStateDomainService</code> <p>\u673a\u68b0\u81c2\u72b6\u6001\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>dynamic_service</code> <code>DynamicDomainService</code> <p>\u52a8\u529b\u5b66\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>teach_record_service</code> <code>TeachRecordDomainService</code> <p>\u793a\u6559\u8bb0\u5f55\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>record_repository</code> <code>RecordRepository</code> <p>\u8bb0\u5f55\u4ed3\u50a8\u3002</p> \u5fc5\u9700 <code>parent</code> <code>Optional[object]</code> <p>\u7236\u5bf9\u8c61\u3002</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code> <pre><code>def __init__(\n    self,\n    command_hub_service: CommandHubService,\n    robot_state_service: RobotStateDomainService,\n    dynamic_service: DynamicDomainService,\n    teach_record_service: TeachRecordDomainService,\n    record_repository: RecordRepository,\n    parent: Optional[object] = None):\n    \"\"\"\u521d\u59cb\u5316\u52a8\u529b\u5b66\u89c6\u56fe\u6a21\u578b\u3002\n\n    Args:\n        command_hub_service: \u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002\n        robot_state_service: \u673a\u68b0\u81c2\u72b6\u6001\u670d\u52a1\u3002\n        dynamic_service: \u52a8\u529b\u5b66\u670d\u52a1\u3002\n        teach_record_service: \u793a\u6559\u8bb0\u5f55\u670d\u52a1\u3002\n        record_repository: \u8bb0\u5f55\u4ed3\u50a8\u3002\n        parent: \u7236\u5bf9\u8c61\u3002\n    \"\"\"\n    super().__init__(parent)\n    self.command_hub = command_hub_service\n    self.robot_state = robot_state_service\n    self.dynamic_service = dynamic_service\n    self.teach_record_service = teach_record_service\n    self.record_repository = record_repository\n\n    # \u8ba2\u9605\u529b\u77e9\u8865\u507f\u8bf7\u6c42\u4fe1\u53f7\uff08\u6570\u636e\u9a71\u52a8\uff0c\u4e0d\u662f\u5b9a\u65f6\u5668\uff09\n    self.robot_state.torque_compensation_requested.connect(\n        self._on_torque_compensation_requested\n    )\n\n    # \u8ba2\u9605\u8bb0\u5f55\u670d\u52a1\u7684\u4fe1\u53f7\n    self.teach_record_service.recording_state_changed.connect(\n        self.recording_state_changed.emit\n    )\n    self.teach_record_service.record_added.connect(\n        self._on_record_added\n    )\n    self.teach_record_service.record_deleted.connect(\n        self._on_record_deleted\n    )\n\n    # \u8fde\u63a5\u8bb0\u5f55\u5b9a\u65f6\u5668\u5230\u72b6\u6001\u66f4\u65b0\n    record_timer = self.teach_record_service.get_record_timer()\n    record_timer.timeout.connect(self._on_record_timer_timeout)\n\n    # \u52a0\u8f7d\u5df2\u5b58\u5728\u7684\u8bb0\u5f55\n    self._load_records_from_file()\n</code></pre>"},{"location":"api/presentation/features/dynamics/#controller.presentation.view_models.dynamics_view_model.DynamicsViewModel.toggle_teaching_mode","title":"toggle_teaching_mode","text":"<pre><code>toggle_teaching_mode(command_dict: dict)\n</code></pre> <p>\u5207\u6362\u793a\u6559\u6a21\u5f0f\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>command_dict</code> <code>dict</code> <p>\u547d\u4ee4\u5b57\u5178\uff0c\u5305\u542b control \u548c mode\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code> <pre><code>def toggle_teaching_mode(self, command_dict: dict):\n    \"\"\"\u5207\u6362\u793a\u6559\u6a21\u5f0f\u3002\n\n    Args:\n        command_dict (dict): \u547d\u4ee4\u5b57\u5178\uff0c\u5305\u542b control \u548c mode\u3002\n    \"\"\"\n    # 1. \u53d1\u9001\u4e32\u53e3\u547d\u4ee4\n    self.command_hub.command_distribution(command_dict)\n\n    # 2. \u66f4\u65b0\u72b6\u6001\u670d\u52a1\u7684\u793a\u6559\u6a21\u5f0f\u6807\u5fd7\n    is_enable = (command_dict['control'] == 0x07)\n    self.robot_state.set_teaching_mode(is_enable)\n</code></pre>"},{"location":"api/presentation/features/dynamics/#controller.presentation.view_models.dynamics_view_model.DynamicsViewModel.send_torque","title":"send_torque","text":"<pre><code>send_torque(torque_values: list)\n</code></pre> <p>\u53d1\u9001\u529b\u77e9\u63a7\u5236\u547d\u4ee4\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>torque_values</code> <code>list</code> <p>\u529b\u77e9\u503c\u5217\u8868\uff086\u4e2a\u5173\u8282\uff09\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code> <pre><code>def send_torque(self, torque_values: list):\n    \"\"\"\u53d1\u9001\u529b\u77e9\u63a7\u5236\u547d\u4ee4\u3002\n\n    Args:\n        torque_values (list): \u529b\u77e9\u503c\u5217\u8868\uff086\u4e2a\u5173\u8282\uff09\u3002\n    \"\"\"\n    command_dict = {\n        'control': 0x06,  # \u529b\u77e9\u63a7\u5236\n        'mode': 0x0A,     # \u5468\u671f\u529b\u77e9\u6a21\u5f0f\n        'torque': torque_values\n    }\n    self.command_hub.command_distribution(command_dict)\n</code></pre>"},{"location":"api/presentation/features/dynamics/#controller.presentation.view_models.dynamics_view_model.DynamicsViewModel.toggle_recording","title":"toggle_recording","text":"<pre><code>toggle_recording()\n</code></pre> <p>\u5207\u6362\u8bb0\u5f55\u72b6\u6001\uff08\u5f00\u59cb/\u505c\u6b62\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code> <pre><code>def toggle_recording(self):\n    \"\"\"\u5207\u6362\u8bb0\u5f55\u72b6\u6001\uff08\u5f00\u59cb/\u505c\u6b62\uff09\u3002\"\"\"\n    if self.teach_record_service.is_recording():\n        # \u505c\u6b62\u8bb0\u5f55\n        record_name = self.teach_record_service.stop_recording()\n        if record_name:\n            # \u4fdd\u5b58\u5230\u6587\u4ef6\n            self._save_records_to_file()\n    else:\n        # \u5f00\u59cb\u8bb0\u5f55\n        self.teach_record_service.start_recording()\n</code></pre>"},{"location":"api/presentation/features/dynamics/#controller.presentation.view_models.dynamics_view_model.DynamicsViewModel.delete_record","title":"delete_record","text":"<pre><code>delete_record(record_name: str) -&gt; bool\n</code></pre> <p>\u5220\u9664\u6307\u5b9a\u8bb0\u5f55\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>record_name</code> <code>str</code> <p>\u8bb0\u5f55\u540d\u79f0\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u5220\u9664\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code> <pre><code>def delete_record(self, record_name: str) -&gt; bool:\n    \"\"\"\u5220\u9664\u6307\u5b9a\u8bb0\u5f55\u3002\n\n    Args:\n        record_name (str): \u8bb0\u5f55\u540d\u79f0\u3002\n\n    Returns:\n        bool: \u662f\u5426\u5220\u9664\u6210\u529f\u3002\n    \"\"\"\n    success = self.teach_record_service.delete_record(record_name)\n    if success:\n        self._save_records_to_file()\n    return success\n</code></pre>"},{"location":"api/presentation/features/dynamics/#controller.presentation.view_models.dynamics_view_model.DynamicsViewModel.run_record","title":"run_record","text":"<pre><code>run_record(record_name: str)\n</code></pre> <p>\u8fd0\u884c\u6307\u5b9a\u8bb0\u5f55\uff08\u64ad\u653e\u793a\u6559\u8f68\u8ff9\uff09\u3002</p> <p>\u6d41\u7a0b\uff1a 1. \u83b7\u53d6\u793a\u6559\u8bb0\u5f55\u7684\u89d2\u5ea6\u5217\u8868 2. \u59d4\u6258\u7ed9 CommandHubService \u5904\u7406</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>record_name</code> <code>str</code> <p>\u8bb0\u5f55\u540d\u79f0\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code> <pre><code>def run_record(self, record_name: str):\n    \"\"\"\u8fd0\u884c\u6307\u5b9a\u8bb0\u5f55\uff08\u64ad\u653e\u793a\u6559\u8f68\u8ff9\uff09\u3002\n\n    \u6d41\u7a0b\uff1a\n    1. \u83b7\u53d6\u793a\u6559\u8bb0\u5f55\u7684\u89d2\u5ea6\u5217\u8868\n    2. \u59d4\u6258\u7ed9 CommandHubService \u5904\u7406\n\n    Args:\n        record_name (str): \u8bb0\u5f55\u540d\u79f0\u3002\n    \"\"\"\n    angles_list = self.teach_record_service.get_record(record_name)\n    if angles_list:\n        self.command_hub.run_teach_record(angles_list)\n</code></pre>"},{"location":"api/presentation/features/dynamics/#controller.presentation.view_models.dynamics_view_model.DynamicsViewModel.reverse_record","title":"reverse_record","text":"<pre><code>reverse_record(record_name: str) -&gt; Optional[str]\n</code></pre> <p>\u53cd\u8f6c\u6307\u5b9a\u8bb0\u5f55\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>record_name</code> <code>str</code> <p>\u8bb0\u5f55\u540d\u79f0\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[str]</code> <p>Optional[str]: \u65b0\u8bb0\u5f55\u540d\u79f0\uff0c\u5931\u8d25\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code> <pre><code>def reverse_record(self, record_name: str) -&gt; Optional[str]:\n    \"\"\"\u53cd\u8f6c\u6307\u5b9a\u8bb0\u5f55\u3002\n\n    Args:\n        record_name (str): \u8bb0\u5f55\u540d\u79f0\u3002\n\n    Returns:\n        Optional[str]: \u65b0\u8bb0\u5f55\u540d\u79f0\uff0c\u5931\u8d25\u8fd4\u56de None\u3002\n    \"\"\"\n    new_name = self.teach_record_service.reverse_record(record_name)\n    if new_name:\n        self._save_records_to_file()\n    return new_name\n</code></pre>"},{"location":"api/presentation/features/dynamics/#controller.presentation.view_models.dynamics_view_model.DynamicsViewModel.get_record_names","title":"get_record_names","text":"<pre><code>get_record_names() -&gt; List[str]\n</code></pre> <p>\u83b7\u53d6\u6240\u6709\u8bb0\u5f55\u540d\u79f0\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>List[str]: \u8bb0\u5f55\u540d\u79f0\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code> <pre><code>def get_record_names(self) -&gt; List[str]:\n    \"\"\"\u83b7\u53d6\u6240\u6709\u8bb0\u5f55\u540d\u79f0\u3002\n\n    Returns:\n        List[str]: \u8bb0\u5f55\u540d\u79f0\u5217\u8868\u3002\n    \"\"\"\n    return self.teach_record_service.get_record_names()\n</code></pre>"},{"location":"api/presentation/features/dynamics/#controller.presentation.view_models.dynamics_view_model.DynamicsViewModel.is_recording","title":"is_recording","text":"<pre><code>is_recording() -&gt; bool\n</code></pre> <p>\u67e5\u8be2\u662f\u5426\u6b63\u5728\u8bb0\u5f55\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u6b63\u5728\u8bb0\u5f55\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code> <pre><code>def is_recording(self) -&gt; bool:\n    \"\"\"\u67e5\u8be2\u662f\u5426\u6b63\u5728\u8bb0\u5f55\u3002\n\n    Returns:\n        bool: \u662f\u5426\u6b63\u5728\u8bb0\u5f55\u3002\n    \"\"\"\n    return self.teach_record_service.is_recording()\n</code></pre>"},{"location":"api/presentation/features/motion_planning/","title":"Motion Planning ViewModel","text":""},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model","title":"controller.presentation.view_models.motion_planning_view_model","text":"<p>\u8fd0\u52a8\u89c4\u5212ViewModel</p>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel","title":"MotionPlanningViewModel","text":"<pre><code>MotionPlanningViewModel(app_service: MotionPlanningApplicationService, dynamics_vm: DynamicsViewModel)\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u8fd0\u52a8\u89c4\u5212 ViewModel\u3002</p> <p>\u804c\u8d23\uff1a 1. \u8f6c\u53d1 UI \u547d\u4ee4\u5230 Application Service 2. \u8f6c\u53d1 Application Service \u4fe1\u53f7\u5230 UI \u7ec4\u4ef6 3. \u901a\u8fc7 DynamicsViewModel \u83b7\u53d6\u793a\u6559\u8bb0\u5f55\uff08\u907f\u514d\u91cd\u590d\u6ce8\u5165\uff09</p> <p>\u8bbe\u8ba1\u539f\u5219\uff1a - ViewModel \u53ea\u4f9d\u8d56 Application Service\uff0c\u4e0d\u76f4\u63a5\u8bbf\u95ee Domain \u6216 Infrastructure - \u6240\u6709\u4e1a\u52a1\u903b\u8f91\u5728 Application Service \u4e2d\u5c01\u88c5</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>plan_list_changed</code> <code>pyqtSignal</code> <p>\u65b9\u6848\u5217\u8868\u53d8\u66f4\u4fe1\u53f7\u3002</p> <code>current_plan_changed</code> <code>pyqtSignal</code> <p>\u5f53\u524d\u65b9\u6848\u53d8\u66f4\u4fe1\u53f7\uff0c\u643a\u5e26\u7d22\u5f15\u3002</p> <code>point_list_changed</code> <code>pyqtSignal</code> <p>\u8282\u70b9\u5217\u8868\u53d8\u66f4\u4fe1\u53f7\u3002</p> <code>current_position_received</code> <code>pyqtSignal</code> <p>\u5f53\u524d\u4f4d\u7f6e\u6570\u636e\u4fe1\u53f7\uff0c\u643a\u5e26\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\u3002</p> <code>trajectory_preview_signal</code> <code>pyqtSignal</code> <p>\u8f68\u8ff9\u9884\u89c8\u4fe1\u53f7\uff0c\u643a\u5e26 (\u8f68\u8ff9\u6570\u636e, \u4e0a\u4e0b\u6587)\u3002</p> <code>app_service</code> <code>MotionPlanningApplicationService</code> <p>\u8fd0\u52a8\u89c4\u5212\u5e94\u7528\u670d\u52a1\u3002</p> <code>dynamics_vm</code> <code>DynamicsViewModel</code> <p>\u52a8\u529b\u5b66 ViewModel\u3002</p> <p>\u521d\u59cb\u5316\u8fd0\u52a8\u89c4\u5212 ViewModel\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>app_service</code> <code>MotionPlanningApplicationService</code> <p>\u8fd0\u52a8\u89c4\u5212\u5e94\u7528\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>dynamics_vm</code> <code>DynamicsViewModel</code> <p>\u52a8\u529b\u5b66 ViewModel\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def __init__(\n    self, \n    app_service: MotionPlanningApplicationService,\n    dynamics_vm: DynamicsViewModel\n):\n    \"\"\"\u521d\u59cb\u5316\u8fd0\u52a8\u89c4\u5212 ViewModel\u3002\n\n    Args:\n        app_service (MotionPlanningApplicationService): \u8fd0\u52a8\u89c4\u5212\u5e94\u7528\u670d\u52a1\u3002\n        dynamics_vm (DynamicsViewModel): \u52a8\u529b\u5b66 ViewModel\u3002\n    \"\"\"\n    super().__init__()\n    self.app_service = app_service\n    self.dynamics_vm = dynamics_vm\n\n    # \u8fde\u63a5Application Service\u7684\u4fe1\u53f7\n    self.app_service.plan_list_changed.connect(self.plan_list_changed.emit)\n    self.app_service.current_plan_changed.connect(self.current_plan_changed.emit)\n    self.app_service.point_list_changed.connect(self.point_list_changed.emit)\n    self.app_service.current_position_received.connect(self.current_position_received.emit)\n    self.app_service.trajectory_preview_signal.connect(self.trajectory_preview_signal.emit)\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.create_plan","title":"create_plan","text":"<pre><code>create_plan(name: str)\n</code></pre> <p>\u521b\u5efa\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>name</code> <code>str</code> <p>\u65b9\u6848\u540d\u79f0\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def create_plan(self, name: str):\n    \"\"\"\u521b\u5efa\u65b9\u6848\u3002\n\n    Args:\n        name (str): \u65b9\u6848\u540d\u79f0\u3002\n    \"\"\"\n    self.app_service.create_plan(name)\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.delete_plan","title":"delete_plan","text":"<pre><code>delete_plan(index: int) -&gt; bool\n</code></pre> <p>\u5220\u9664\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u65b9\u6848\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u5220\u9664\u6210\u529f, False=\u5220\u9664\u5931\u8d25\uff08\u8fdd\u53cd\u4e1a\u52a1\u89c4\u5219\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def delete_plan(self, index: int) -&gt; bool:\n    \"\"\"\u5220\u9664\u65b9\u6848\u3002\n\n    Args:\n        index (int): \u65b9\u6848\u7d22\u5f15\u3002\n\n    Returns:\n        bool: True=\u5220\u9664\u6210\u529f, False=\u5220\u9664\u5931\u8d25\uff08\u8fdd\u53cd\u4e1a\u52a1\u89c4\u5219\uff09\u3002\n    \"\"\"\n    return self.app_service.delete_plan(index)\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.switch_plan","title":"switch_plan","text":"<pre><code>switch_plan(index: int)\n</code></pre> <p>\u5207\u6362\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u65b9\u6848\u7d22\u5f15\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def switch_plan(self, index: int):\n    \"\"\"\u5207\u6362\u65b9\u6848\u3002\n\n    Args:\n        index (int): \u65b9\u6848\u7d22\u5f15\u3002\n    \"\"\"\n    self.app_service.switch_plan(index)\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.rename_plan","title":"rename_plan","text":"<pre><code>rename_plan(index: int, new_name: str)\n</code></pre> <p>\u91cd\u547d\u540d\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u65b9\u6848\u7d22\u5f15\u3002</p> \u5fc5\u9700 <code>new_name</code> <code>str</code> <p>\u65b0\u540d\u79f0\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def rename_plan(self, index: int, new_name: str):\n    \"\"\"\u91cd\u547d\u540d\u65b9\u6848\u3002\n\n    Args:\n        index (int): \u65b9\u6848\u7d22\u5f15\u3002\n        new_name (str): \u65b0\u540d\u79f0\u3002\n    \"\"\"\n    self.app_service.rename_plan(index, new_name)\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.get_plan_names","title":"get_plan_names","text":"<pre><code>get_plan_names() -&gt; List[str]\n</code></pre> <p>\u83b7\u53d6\u6240\u6709\u65b9\u6848\u540d\u79f0\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>List[str]: \u65b9\u6848\u540d\u79f0\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def get_plan_names(self) -&gt; List[str]:\n    \"\"\"\u83b7\u53d6\u6240\u6709\u65b9\u6848\u540d\u79f0\u3002\n\n    Returns:\n        List[str]: \u65b9\u6848\u540d\u79f0\u5217\u8868\u3002\n    \"\"\"\n    return self.app_service.domain_service.get_plan_names()\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.get_current_plan_index","title":"get_current_plan_index","text":"<pre><code>get_current_plan_index() -&gt; int\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u65b9\u6848\u7d22\u5f15\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>int</code> <code>int</code> <p>\u5f53\u524d\u7d22\u5f15\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def get_current_plan_index(self) -&gt; int:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u65b9\u6848\u7d22\u5f15\u3002\n\n    Returns:\n        int: \u5f53\u524d\u7d22\u5f15\u3002\n    \"\"\"\n    return self.app_service.domain_service.get_current_index()\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.get_plan_count","title":"get_plan_count","text":"<pre><code>get_plan_count() -&gt; int\n</code></pre> <p>\u83b7\u53d6\u65b9\u6848\u6570\u91cf\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>int</code> <code>int</code> <p>\u65b9\u6848\u6570\u91cf\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def get_plan_count(self) -&gt; int:\n    \"\"\"\u83b7\u53d6\u65b9\u6848\u6570\u91cf\u3002\n\n    Returns:\n        int: \u65b9\u6848\u6570\u91cf\u3002\n    \"\"\"\n    return self.app_service.domain_service.get_plan_count()\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.add_point","title":"add_point","text":"<pre><code>add_point(point_data: dict)\n</code></pre> <p>\u6dfb\u52a0\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>point_data</code> <code>dict</code> <p>\u8282\u70b9\u6570\u636e\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def add_point(self, point_data: dict):\n    \"\"\"\u6dfb\u52a0\u8282\u70b9\u3002\n\n    Args:\n        point_data (dict): \u8282\u70b9\u6570\u636e\u3002\n    \"\"\"\n    self.app_service.add_point(point_data)\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.delete_point","title":"delete_point","text":"<pre><code>delete_point(index: int)\n</code></pre> <p>\u5220\u9664\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def delete_point(self, index: int):\n    \"\"\"\u5220\u9664\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n    \"\"\"\n    self.app_service.delete_point(index)\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.move_point_up","title":"move_point_up","text":"<pre><code>move_point_up(index: int)\n</code></pre> <p>\u4e0a\u79fb\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def move_point_up(self, index: int):\n    \"\"\"\u4e0a\u79fb\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n    \"\"\"\n    self.app_service.move_point_up(index)\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.move_point_down","title":"move_point_down","text":"<pre><code>move_point_down(index: int)\n</code></pre> <p>\u4e0b\u79fb\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def move_point_down(self, index: int):\n    \"\"\"\u4e0b\u79fb\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n    \"\"\"\n    self.app_service.move_point_down(index)\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.update_point","title":"update_point","text":"<pre><code>update_point(index: int, point_data: dict)\n</code></pre> <p>\u66f4\u65b0\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <code>point_data</code> <code>dict</code> <p>\u8282\u70b9\u6570\u636e\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def update_point(self, index: int, point_data: dict):\n    \"\"\"\u66f4\u65b0\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n        point_data (dict): \u8282\u70b9\u6570\u636e\u3002\n    \"\"\"\n    self.app_service.update_point(index, point_data)\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.get_all_points","title":"get_all_points","text":"<pre><code>get_all_points() -&gt; List[dict]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u65b9\u6848\u7684\u6240\u6709\u8282\u70b9\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[dict]</code> <p>List[dict]: \u8282\u70b9\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def get_all_points(self) -&gt; List[dict]:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u65b9\u6848\u7684\u6240\u6709\u8282\u70b9\u3002\n\n    Returns:\n        List[dict]: \u8282\u70b9\u5217\u8868\u3002\n    \"\"\"\n    return self.app_service.domain_service.get_all_points()\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.get_single_point","title":"get_single_point","text":"<pre><code>get_single_point(index: int) -&gt; dict\n</code></pre> <p>\u83b7\u53d6\u5355\u4e2a\u8282\u70b9\u6570\u636e\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>dict</code> <code>dict</code> <p>\u8282\u70b9\u6570\u636e\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def get_single_point(self, index: int) -&gt; dict:\n    \"\"\"\u83b7\u53d6\u5355\u4e2a\u8282\u70b9\u6570\u636e\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n\n    Returns:\n        dict: \u8282\u70b9\u6570\u636e\u3002\n    \"\"\"\n    return self.app_service.get_single_point(index)\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.get_teach_record_names","title":"get_teach_record_names","text":"<pre><code>get_teach_record_names() -&gt; List[str]\n</code></pre> <p>\u83b7\u53d6\u6240\u6709\u793a\u6559\u8bb0\u5f55\u540d\u79f0\uff08\u59d4\u6258\u7ed9 DynamicsViewModel\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>List[str]: \u8bb0\u5f55\u540d\u79f0\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def get_teach_record_names(self) -&gt; List[str]:\n    \"\"\"\u83b7\u53d6\u6240\u6709\u793a\u6559\u8bb0\u5f55\u540d\u79f0\uff08\u59d4\u6258\u7ed9 DynamicsViewModel\uff09\u3002\n\n    Returns:\n        List[str]: \u8bb0\u5f55\u540d\u79f0\u5217\u8868\u3002\n    \"\"\"\n    return self.dynamics_vm.get_record_names()\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.get_teach_record","title":"get_teach_record","text":"<pre><code>get_teach_record(name: str) -&gt; List[List[float]]\n</code></pre> <p>\u83b7\u53d6\u6307\u5b9a\u793a\u6559\u8bb0\u5f55\u7684\u6570\u636e\uff08\u59d4\u6258\u7ed9 DynamicsViewModel\uff09\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>name</code> <code>str</code> <p>\u8bb0\u5f55\u540d\u79f0\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[List[float]]</code> <p>List[List[float]]: \u8bb0\u5f55\u6570\u636e\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def get_teach_record(self, name: str) -&gt; List[List[float]]:\n    \"\"\"\u83b7\u53d6\u6307\u5b9a\u793a\u6559\u8bb0\u5f55\u7684\u6570\u636e\uff08\u59d4\u6258\u7ed9 DynamicsViewModel\uff09\u3002\n\n    Args:\n        name (str): \u8bb0\u5f55\u540d\u79f0\u3002\n\n    Returns:\n        List[List[float]]: \u8bb0\u5f55\u6570\u636e\u3002\n    \"\"\"\n    angles_list = self.dynamics_vm.teach_record_service.get_record(name)\n    return angles_list if angles_list else []\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.execute_single_point","title":"execute_single_point","text":"<pre><code>execute_single_point(index: int)\n</code></pre> <p>\u6267\u884c\u5355\u4e2a\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def execute_single_point(self, index: int):\n    \"\"\"\u6267\u884c\u5355\u4e2a\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n    \"\"\"\n    self.app_service.execute_single_point(index)\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.execute_motion_plan","title":"execute_motion_plan","text":"<pre><code>execute_motion_plan()\n</code></pre> <p>\u6267\u884c\u6574\u4e2a\u8fd0\u52a8\u89c4\u5212\u65b9\u6848\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def execute_motion_plan(self):\n    \"\"\"\u6267\u884c\u6574\u4e2a\u8fd0\u52a8\u89c4\u5212\u65b9\u6848\u3002\"\"\"\n    self.app_service.execute_motion_plan()\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.request_current_position","title":"request_current_position","text":"<pre><code>request_current_position()\n</code></pre> <p>\u8bf7\u6c42\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\uff08\u4ec5\u7528\u4e8eUI\u663e\u793a\uff09\u3002</p> <p>\u59d4\u6258\u7ed9 Application Service \u5904\u7406\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def request_current_position(self):\n    \"\"\"\u8bf7\u6c42\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\uff08\u4ec5\u7528\u4e8eUI\u663e\u793a\uff09\u3002\n\n    \u59d4\u6258\u7ed9 Application Service \u5904\u7406\u3002\n    \"\"\"\n    self.app_service.request_current_position()\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.save_node_trajectory","title":"save_node_trajectory","text":"<pre><code>save_node_trajectory(node_index: int) -&gt; bool\n</code></pre> <p>\u4fdd\u5b58\u5355\u4e2a\u8282\u70b9\u7684\u8f68\u8ff9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>node_index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u51c6\u5907\u6210\u529f, False=\u51c6\u5907\u5931\u8d25\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def save_node_trajectory(self, node_index: int) -&gt; bool:\n    \"\"\"\u4fdd\u5b58\u5355\u4e2a\u8282\u70b9\u7684\u8f68\u8ff9\u3002\n\n    Args:\n        node_index (int): \u8282\u70b9\u7d22\u5f15\u3002\n\n    Returns:\n        bool: True=\u51c6\u5907\u6210\u529f, False=\u51c6\u5907\u5931\u8d25\u3002\n    \"\"\"\n    return self.app_service.save_node_trajectory(node_index)\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.save_plan_trajectory","title":"save_plan_trajectory","text":"<pre><code>save_plan_trajectory() -&gt; bool\n</code></pre> <p>\u4fdd\u5b58\u6574\u4e2a\u65b9\u6848\u7684\u8f68\u8ff9\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u51c6\u5907\u6210\u529f, False=\u51c6\u5907\u5931\u8d25\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def save_plan_trajectory(self) -&gt; bool:\n    \"\"\"\u4fdd\u5b58\u6574\u4e2a\u65b9\u6848\u7684\u8f68\u8ff9\u3002\n\n    Returns:\n        bool: True=\u51c6\u5907\u6210\u529f, False=\u51c6\u5907\u5931\u8d25\u3002\n    \"\"\"\n    return self.app_service.save_plan_trajectory()\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.preview_node_trajectory","title":"preview_node_trajectory","text":"<pre><code>preview_node_trajectory(node_index: int) -&gt; bool\n</code></pre> <p>\u9884\u89c8\u5355\u4e2a\u8282\u70b9\u7684\u8f68\u8ff9\u66f2\u7ebf\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>node_index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u51c6\u5907\u6210\u529f, False=\u51c6\u5907\u5931\u8d25\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def preview_node_trajectory(self, node_index: int) -&gt; bool:\n    \"\"\"\u9884\u89c8\u5355\u4e2a\u8282\u70b9\u7684\u8f68\u8ff9\u66f2\u7ebf\u3002\n\n    Args:\n        node_index (int): \u8282\u70b9\u7d22\u5f15\u3002\n\n    Returns:\n        bool: True=\u51c6\u5907\u6210\u529f, False=\u51c6\u5907\u5931\u8d25\u3002\n    \"\"\"\n    return self.app_service.preview_node_trajectory(node_index)\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.preview_plan_trajectory","title":"preview_plan_trajectory","text":"<pre><code>preview_plan_trajectory() -&gt; bool\n</code></pre> <p>\u9884\u89c8\u6574\u4e2a\u65b9\u6848\u7684\u8f68\u8ff9\u66f2\u7ebf\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u51c6\u5907\u6210\u529f, False=\u51c6\u5907\u5931\u8d25\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def preview_plan_trajectory(self) -&gt; bool:\n    \"\"\"\u9884\u89c8\u6574\u4e2a\u65b9\u6848\u7684\u8f68\u8ff9\u66f2\u7ebf\u3002\n\n    Returns:\n        bool: True=\u51c6\u5907\u6210\u529f, False=\u51c6\u5907\u5931\u8d25\u3002\n    \"\"\"\n    return self.app_service.preview_plan_trajectory()\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.load_local_trajectory","title":"load_local_trajectory","text":"<pre><code>load_local_trajectory(file_path: str) -&gt; bool\n</code></pre> <p>\u4ece plans \u76ee\u5f55\u52a0\u8f7d\u8f68\u8ff9\u6587\u4ef6\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>str</code> <p>\u8f68\u8ff9\u6587\u4ef6\u7684\u5b8c\u6574\u8def\u5f84\u6216\u6587\u4ef6\u540d\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u52a0\u8f7d\u6210\u529f, False=\u52a0\u8f7d\u5931\u8d25\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def load_local_trajectory(self, file_path: str) -&gt; bool:\n    \"\"\"\u4ece plans \u76ee\u5f55\u52a0\u8f7d\u8f68\u8ff9\u6587\u4ef6\u3002\n\n    Args:\n        file_path (str): \u8f68\u8ff9\u6587\u4ef6\u7684\u5b8c\u6574\u8def\u5f84\u6216\u6587\u4ef6\u540d\u3002\n\n    Returns:\n        bool: True=\u52a0\u8f7d\u6210\u529f, False=\u52a0\u8f7d\u5931\u8d25\u3002\n    \"\"\"\n    return self.app_service.load_local_trajectory(file_path)\n</code></pre>"},{"location":"api/presentation/features/motion_planning/#controller.presentation.view_models.motion_planning_view_model.MotionPlanningViewModel.get_local_trajectory_files","title":"get_local_trajectory_files","text":"<pre><code>get_local_trajectory_files() -&gt; List[str]\n</code></pre> <p>\u83b7\u53d6\u6240\u6709\u53ef\u7528\u7684\u672c\u5730\u8f68\u8ff9\u6587\u4ef6\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>List[str]: \u6587\u4ef6\u540d\u5217\u8868\uff08\u4e0d\u5e26\u6269\u5c55\u540d\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def get_local_trajectory_files(self) -&gt; List[str]:\n    \"\"\"\u83b7\u53d6\u6240\u6709\u53ef\u7528\u7684\u672c\u5730\u8f68\u8ff9\u6587\u4ef6\u3002\n\n    Returns:\n        List[str]: \u6587\u4ef6\u540d\u5217\u8868\uff08\u4e0d\u5e26\u6269\u5c55\u540d\uff09\u3002\n    \"\"\"\n    return self.app_service.get_local_trajectory_files()\n</code></pre>"},{"location":"api/presentation/features/tools/","title":"Tools ViewModel","text":""},{"location":"api/presentation/features/tools/#controller.presentation.view_models.tools_view_model","title":"controller.presentation.view_models.tools_view_model","text":"<p>\u5de5\u5177ViewModel</p>"},{"location":"api/presentation/features/tools/#controller.presentation.view_models.tools_view_model.ToolsViewModel","title":"ToolsViewModel","text":"<pre><code>ToolsViewModel(app_service: ToolsApplicationService)\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u5de5\u5177 ViewModel\u3002</p> <p>\u804c\u8d23\uff1a 1. \u8f6c\u53d1 UI \u7684\u8ba1\u7b97\u8bf7\u6c42\u5230 Application Service 2. \u8f6c\u53d1 Application Service \u7684\u7ed3\u679c\u4fe1\u53f7\u5230 UI 3. \u5904\u7406\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\u548c\u9006\u8fd0\u52a8\u5b66\u8ba1\u7b97\u8bf7\u6c42</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>calculation_result</code> <code>pyqtSignal</code> <p>\u6b63\u8fd0\u52a8\u5b66\u7ed3\u679c\u4fe1\u53f7\uff0c\u643a\u5e26\u7ed3\u679c\u5b57\u5178\u3002</p> <code>current_angles_received</code> <code>pyqtSignal</code> <p>\u5f53\u524d\u5173\u8282\u89d2\u5ea6\u4fe1\u53f7\uff0c\u643a\u5e26\u89d2\u5ea6\u5217\u8868\u3002</p> <code>inverse_result</code> <code>pyqtSignal</code> <p>\u9006\u8fd0\u52a8\u5b66\u7ed3\u679c\u4fe1\u53f7\uff0c\u643a\u5e26\u7ed3\u679c\u5b57\u5178\u3002</p> <code>app_service</code> <code>ToolsApplicationService</code> <p>\u5de5\u5177\u5e94\u7528\u670d\u52a1\u3002</p> <p>\u521d\u59cb\u5316\u5de5\u5177 ViewModel\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>app_service</code> <code>ToolsApplicationService</code> <p>\u5de5\u5177\u5e94\u7528\u670d\u52a1\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/tools_view_model.py</code> <pre><code>def __init__(self, app_service: ToolsApplicationService):\n    \"\"\"\u521d\u59cb\u5316\u5de5\u5177 ViewModel\u3002\n\n    Args:\n        app_service (ToolsApplicationService): \u5de5\u5177\u5e94\u7528\u670d\u52a1\u3002\n    \"\"\"\n    super().__init__()\n    self.app_service = app_service\n\n    # \u8fde\u63a5Application Service\u7684\u4fe1\u53f7\n    self.app_service.calculation_result_signal.connect(\n        self.calculation_result.emit\n    )\n    self.app_service.current_angles_signal.connect(\n        self.current_angles_received.emit\n    )\n    self.app_service.inverse_result_signal.connect(\n        self.inverse_result.emit\n    )\n</code></pre>"},{"location":"api/presentation/features/tools/#controller.presentation.view_models.tools_view_model.ToolsViewModel.calculate_kinematics","title":"calculate_kinematics","text":"<pre><code>calculate_kinematics(joint_angles: List[float])\n</code></pre> <p>\u8bf7\u6c42\u8ba1\u7b97\u6b63\u8fd0\u52a8\u5b66\uff08\u8f6c\u53d1\u7ed9 Application Service\uff09\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>joint_angles</code> <code>List[float]</code> <p>6\u4e2a\u5173\u8282\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/tools_view_model.py</code> <pre><code>def calculate_kinematics(self, joint_angles: List[float]):\n    \"\"\"\u8bf7\u6c42\u8ba1\u7b97\u6b63\u8fd0\u52a8\u5b66\uff08\u8f6c\u53d1\u7ed9 Application Service\uff09\u3002\n\n    Args:\n        joint_angles (List[float]): 6\u4e2a\u5173\u8282\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002\n    \"\"\"\n    self.app_service.calculate_forward_kinematics(joint_angles)\n</code></pre>"},{"location":"api/presentation/features/tools/#controller.presentation.view_models.tools_view_model.ToolsViewModel.get_current_position","title":"get_current_position","text":"<pre><code>get_current_position()\n</code></pre> <p>\u8bf7\u6c42\u83b7\u53d6\u5f53\u524d\u673a\u68b0\u81c2\u5173\u8282\u89d2\u5ea6\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/tools_view_model.py</code> <pre><code>def get_current_position(self):\n    \"\"\"\u8bf7\u6c42\u83b7\u53d6\u5f53\u524d\u673a\u68b0\u81c2\u5173\u8282\u89d2\u5ea6\u3002\"\"\"\n    self.app_service.get_current_joint_angles()\n</code></pre>"},{"location":"api/presentation/features/tools/#controller.presentation.view_models.tools_view_model.ToolsViewModel.calculate_inverse_kinematics","title":"calculate_inverse_kinematics","text":"<pre><code>calculate_inverse_kinematics(rotation_matrix: List[List[float]], position: List[float], initial_theta: List[float] = None)\n</code></pre> <p>\u8bf7\u6c42\u8ba1\u7b97\u9006\u8fd0\u52a8\u5b66\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>rotation_matrix</code> <code>List[List[float]]</code> <p>3x3 \u65cb\u8f6c\u77e9\u9635\u3002</p> \u5fc5\u9700 <code>position</code> <code>List[float]</code> <p>[x, y, z] \u4f4d\u7f6e\uff08\u7c73\uff09\u3002</p> \u5fc5\u9700 <code>initial_theta</code> <code>List[float]</code> <p>\u521d\u59cb\u5173\u8282\u89d2\u5ea6. Defaults to None.</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/tools_view_model.py</code> <pre><code>def calculate_inverse_kinematics(self, rotation_matrix: List[List[float]], position: List[float], initial_theta: List[float] = None):\n    \"\"\"\u8bf7\u6c42\u8ba1\u7b97\u9006\u8fd0\u52a8\u5b66\u3002\n\n    Args:\n        rotation_matrix (List[List[float]]): 3x3 \u65cb\u8f6c\u77e9\u9635\u3002\n        position (List[float]): [x, y, z] \u4f4d\u7f6e\uff08\u7c73\uff09\u3002\n        initial_theta (List[float], optional): \u521d\u59cb\u5173\u8282\u89d2\u5ea6. Defaults to None.\n    \"\"\"\n    self.app_service.calculate_inverse_kinematics(rotation_matrix, position, initial_theta)\n</code></pre>"},{"location":"api/presentation/features/trajectory/","title":"Trajectory ViewModel","text":""},{"location":"api/presentation/features/trajectory/#controller.presentation.view_models.trajectory_view_model","title":"controller.presentation.view_models.trajectory_view_model","text":"<p>\u8f68\u8ff9\u89c4\u5212\u89c6\u56fe\u6a21\u578b - Presentation\u5c42</p>"},{"location":"api/presentation/features/trajectory/#controller.presentation.view_models.trajectory_view_model.TrajectoryViewModel","title":"TrajectoryViewModel","text":"<pre><code>TrajectoryViewModel(parent=None)\n</code></pre> <p>               Bases: <code>BaseViewModel</code></p> <p>\u8f68\u8ff9\u89c4\u5212\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u8d1f\u8d23\u8f68\u8ff9\u89c4\u5212\u76f8\u5173\u7684 UI \u4ea4\u4e92\u903b\u8f91\u3002</p> <p>\u521d\u59cb\u5316\u8f68\u8ff9\u89c4\u5212\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>parent</code> <code>QObject</code> <p>\u7236\u5bf9\u8c61. Defaults to None.</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/trajectory_view_model.py</code> <pre><code>def __init__(self, parent=None):\n    \"\"\"\u521d\u59cb\u5316\u8f68\u8ff9\u89c4\u5212\u89c6\u56fe\u6a21\u578b\u3002\n\n    Args:\n        parent (QObject, optional): \u7236\u5bf9\u8c61. Defaults to None.\n    \"\"\"\n    super().__init__(parent)\n</code></pre>"},{"location":"api/shared/config/di_container/","title":"DI Container","text":""},{"location":"api/shared/config/di_container/#controller.shared.config.di_container","title":"controller.shared.config.di_container","text":"<p>\u4f9d\u8d56\u6ce8\u5165\u5bb9\u5668 - Shared Config \u7b80\u6d01\u7684DI\u5bb9\u5668\u5b9e\u73b0\uff0c\u53ea\u652f\u6301\u5355\u4f8b\u548c\u77ac\u65f6\u670d\u52a1</p>"},{"location":"api/shared/config/di_container/#controller.shared.config.di_container.ServiceLifetime","title":"ServiceLifetime","text":"<p>\u670d\u52a1\u751f\u547d\u5468\u671f\u679a\u4e3e\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>SINGLETON</code> <p>\u5355\u4f8b\u6a21\u5f0f\uff0c\u6574\u4e2a\u5bb9\u5668\u751f\u547d\u5468\u671f\u5185\u53ea\u521b\u5efa\u4e00\u4e2a\u5b9e\u4f8b\u3002</p> <code>TRANSIENT</code> <p>\u77ac\u65f6\u6a21\u5f0f\uff0c\u6bcf\u6b21\u8bf7\u6c42\u90fd\u521b\u5efa\u65b0\u7684\u5b9e\u4f8b\u3002</p>"},{"location":"api/shared/config/di_container/#controller.shared.config.di_container.ServiceDescriptor","title":"ServiceDescriptor","text":"<pre><code>ServiceDescriptor(service_type: Type, implementation_type: Type = None, lifetime: str = ServiceLifetime.SINGLETON)\n</code></pre> <p>\u670d\u52a1\u63cf\u8ff0\u7b26\u3002</p> <p>\u7528\u4e8e\u5b58\u50a8\u670d\u52a1\u7684\u6ce8\u518c\u4fe1\u606f\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>service_type</code> <code>Type</code> <p>\u670d\u52a1\u7c7b\u578b\uff08\u63a5\u53e3\u6216\u57fa\u7c7b\uff09\u3002</p> <code>implementation_type</code> <code>Type</code> <p>\u5b9e\u73b0\u7c7b\u578b\uff08\u5177\u4f53\u7c7b\uff09\u3002</p> <code>lifetime</code> <code>str</code> <p>\u670d\u52a1\u751f\u547d\u5468\u671f\u3002</p> <p>\u521d\u59cb\u5316\u670d\u52a1\u63cf\u8ff0\u7b26\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>service_type</code> <code>Type</code> <p>\u670d\u52a1\u7c7b\u578b\u3002</p> \u5fc5\u9700 <code>implementation_type</code> <code>Type</code> <p>\u5b9e\u73b0\u7c7b\u578b. Defaults to None.</p> <code>None</code> <code>lifetime</code> <code>str</code> <p>\u751f\u547d\u5468\u671f. Defaults to ServiceLifetime.SINGLETON.</p> <code>SINGLETON</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/shared/config/di_container.py</code> <pre><code>def __init__(self, service_type: Type, implementation_type: Type = None, \n             lifetime: str = ServiceLifetime.SINGLETON):\n    \"\"\"\u521d\u59cb\u5316\u670d\u52a1\u63cf\u8ff0\u7b26\u3002\n\n    Args:\n        service_type (Type): \u670d\u52a1\u7c7b\u578b\u3002\n        implementation_type (Type, optional): \u5b9e\u73b0\u7c7b\u578b. Defaults to None.\n        lifetime (str, optional): \u751f\u547d\u5468\u671f. Defaults to ServiceLifetime.SINGLETON.\n    \"\"\"\n    self.service_type = service_type\n    self.implementation_type = implementation_type or service_type\n    self.lifetime = lifetime\n</code></pre>"},{"location":"api/shared/config/di_container/#controller.shared.config.di_container.DIContainer","title":"DIContainer","text":"<pre><code>DIContainer()\n</code></pre> <p>\u4f9d\u8d56\u6ce8\u5165\u5bb9\u5668\u3002</p> <p>\u7b80\u6d01\u7684 DI \u5bb9\u5668\u5b9e\u73b0\uff0c\u53ea\u652f\u6301\u5355\u4f8b\u548c\u77ac\u65f6\u670d\u52a1\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>_services</code> <code>Dict[Type, ServiceDescriptor]</code> <p>\u5df2\u6ce8\u518c\u7684\u670d\u52a1\u63cf\u8ff0\u7b26\u5b57\u5178\u3002</p> <code>_instances</code> <code>Dict[Type, Any]</code> <p>\u5df2\u521b\u5efa\u7684\u5355\u4f8b\u5b9e\u4f8b\u5b57\u5178\u3002</p> <p>\u521d\u59cb\u5316\u5bb9\u5668\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/shared/config/di_container.py</code> <pre><code>def __init__(self):\n    \"\"\"\u521d\u59cb\u5316\u5bb9\u5668\u3002\"\"\"\n    self._services: Dict[Type, ServiceDescriptor] = {}\n    self._instances: Dict[Type, Any] = {}\n</code></pre>"},{"location":"api/shared/config/di_container/#controller.shared.config.di_container.DIContainer.register_singleton","title":"register_singleton","text":"<pre><code>register_singleton(service_type: Type, implementation_type: Type = None) -&gt; DIContainer\n</code></pre> <p>\u6ce8\u518c\u5355\u4f8b\u670d\u52a1\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>service_type</code> <code>Type</code> <p>\u670d\u52a1\u7c7b\u578b\u3002</p> \u5fc5\u9700 <code>implementation_type</code> <code>Type</code> <p>\u5b9e\u73b0\u7c7b\u578b. Defaults to None.</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>DIContainer</code> <code>DIContainer</code> <p>\u5bb9\u5668\u5b9e\u4f8b\u672c\u8eab\uff08\u652f\u6301\u94fe\u5f0f\u8c03\u7528\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/shared/config/di_container.py</code> <pre><code>def register_singleton(self, service_type: Type, implementation_type: Type = None) -&gt; 'DIContainer':\n    \"\"\"\u6ce8\u518c\u5355\u4f8b\u670d\u52a1\u3002\n\n    Args:\n        service_type (Type): \u670d\u52a1\u7c7b\u578b\u3002\n        implementation_type (Type, optional): \u5b9e\u73b0\u7c7b\u578b. Defaults to None.\n\n    Returns:\n        DIContainer: \u5bb9\u5668\u5b9e\u4f8b\u672c\u8eab\uff08\u652f\u6301\u94fe\u5f0f\u8c03\u7528\uff09\u3002\n    \"\"\"\n    self._services[service_type] = ServiceDescriptor(\n        service_type, implementation_type, lifetime=ServiceLifetime.SINGLETON\n    )\n    return self\n</code></pre>"},{"location":"api/shared/config/di_container/#controller.shared.config.di_container.DIContainer.register_transient","title":"register_transient","text":"<pre><code>register_transient(service_type: Type, implementation_type: Type = None) -&gt; DIContainer\n</code></pre> <p>\u6ce8\u518c\u77ac\u65f6\u670d\u52a1\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>service_type</code> <code>Type</code> <p>\u670d\u52a1\u7c7b\u578b\u3002</p> \u5fc5\u9700 <code>implementation_type</code> <code>Type</code> <p>\u5b9e\u73b0\u7c7b\u578b. Defaults to None.</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>DIContainer</code> <code>DIContainer</code> <p>\u5bb9\u5668\u5b9e\u4f8b\u672c\u8eab\uff08\u652f\u6301\u94fe\u5f0f\u8c03\u7528\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/shared/config/di_container.py</code> <pre><code>def register_transient(self, service_type: Type, implementation_type: Type = None) -&gt; 'DIContainer':\n    \"\"\"\u6ce8\u518c\u77ac\u65f6\u670d\u52a1\u3002\n\n    Args:\n        service_type (Type): \u670d\u52a1\u7c7b\u578b\u3002\n        implementation_type (Type, optional): \u5b9e\u73b0\u7c7b\u578b. Defaults to None.\n\n    Returns:\n        DIContainer: \u5bb9\u5668\u5b9e\u4f8b\u672c\u8eab\uff08\u652f\u6301\u94fe\u5f0f\u8c03\u7528\uff09\u3002\n    \"\"\"\n    self._services[service_type] = ServiceDescriptor(\n        service_type, implementation_type, lifetime=ServiceLifetime.TRANSIENT\n    )\n    return self\n</code></pre>"},{"location":"api/shared/config/di_container/#controller.shared.config.di_container.DIContainer.get_service","title":"get_service","text":"<pre><code>get_service(service_type: Type) -&gt; Any\n</code></pre> <p>\u83b7\u53d6\u670d\u52a1\u5b9e\u4f8b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>service_type</code> <code>Type</code> <p>\u670d\u52a1\u7c7b\u578b\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Any</code> <code>Any</code> <p>\u670d\u52a1\u5b9e\u4f8b\u3002</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ValueError</code> <p>\u5982\u679c\u670d\u52a1\u672a\u6ce8\u518c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/shared/config/di_container.py</code> <pre><code>def get_service(self, service_type: Type) -&gt; Any:\n    \"\"\"\u83b7\u53d6\u670d\u52a1\u5b9e\u4f8b\u3002\n\n    Args:\n        service_type (Type): \u670d\u52a1\u7c7b\u578b\u3002\n\n    Returns:\n        Any: \u670d\u52a1\u5b9e\u4f8b\u3002\n\n    Raises:\n        ValueError: \u5982\u679c\u670d\u52a1\u672a\u6ce8\u518c\u3002\n    \"\"\"\n    if service_type not in self._services:\n        raise ValueError(f\"\u670d\u52a1 {service_type.__name__} \u672a\u6ce8\u518c\")\n\n    descriptor = self._services[service_type]\n\n    # \u5982\u679c\u662f\u5355\u4f8b\u4e14\u5df2\u521b\u5efa\uff0c\u76f4\u63a5\u8fd4\u56de\n    if descriptor.lifetime == ServiceLifetime.SINGLETON and service_type in self._instances:\n        return self._instances[service_type]\n\n    # \u521b\u5efa\u65b0\u5b9e\u4f8b\n    instance = self._create_with_constructor(descriptor.implementation_type)\n\n    # \u5982\u679c\u662f\u5355\u4f8b\uff0c\u7f13\u5b58\u5b9e\u4f8b\n    if descriptor.lifetime == ServiceLifetime.SINGLETON:\n        self._instances[service_type] = instance\n\n    return instance\n</code></pre>"},{"location":"api/shared/config/di_container/#controller.shared.config.di_container.DIContainer.is_registered","title":"is_registered","text":"<pre><code>is_registered(service_type: Type) -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u670d\u52a1\u662f\u5426\u5df2\u6ce8\u518c\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>service_type</code> <code>Type</code> <p>\u670d\u52a1\u7c7b\u578b\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u5df2\u6ce8\u518c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/shared/config/di_container.py</code> <pre><code>def is_registered(self, service_type: Type) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u670d\u52a1\u662f\u5426\u5df2\u6ce8\u518c\u3002\n\n    Args:\n        service_type (Type): \u670d\u52a1\u7c7b\u578b\u3002\n\n    Returns:\n        bool: \u662f\u5426\u5df2\u6ce8\u518c\u3002\n    \"\"\"\n    return service_type in self._services\n</code></pre>"},{"location":"api/shared/config/di_container/#controller.shared.config.di_container.DIContainer.clear","title":"clear","text":"<pre><code>clear() -&gt; None\n</code></pre> <p>\u6e05\u7a7a\u5bb9\u5668\u3002</p> <p>\u6e05\u7406\u6240\u6709\u6ce8\u518c\u7684\u670d\u52a1\u548c\u5df2\u521b\u5efa\u7684\u5355\u4f8b\u5b9e\u4f8b\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/shared/config/di_container.py</code> <pre><code>def clear(self) -&gt; None:\n    \"\"\"\u6e05\u7a7a\u5bb9\u5668\u3002\n\n    \u6e05\u7406\u6240\u6709\u6ce8\u518c\u7684\u670d\u52a1\u548c\u5df2\u521b\u5efa\u7684\u5355\u4f8b\u5b9e\u4f8b\u3002\n    \"\"\"\n    # \u6e05\u7406\u5355\u4f8b\u5b9e\u4f8b\n    for instance in self._instances.values():\n        if hasattr(instance, 'cleanup'):\n            try:\n                instance.cleanup()\n            except Exception:\n                pass  # \u5ffd\u7565\u6e05\u7406\u9519\u8bef\n\n    self._services.clear()\n    self._instances.clear()\n</code></pre>"},{"location":"api/shared/config/di_container/#controller.shared.config.di_container.get_container","title":"get_container","text":"<pre><code>get_container() -&gt; DIContainer\n</code></pre> <p>\u83b7\u53d6\u5168\u5c40DI\u5bb9\u5668\u3002</p> <p>\u5982\u679c\u5bb9\u5668\u4e0d\u5b58\u5728\uff0c\u5219\u521b\u5efa\u4e00\u4e2a\u65b0\u5b9e\u4f8b\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>DIContainer</code> <code>DIContainer</code> <p>\u5168\u5c40\u5bb9\u5668\u5b9e\u4f8b\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/shared/config/di_container.py</code> <pre><code>def get_container() -&gt; DIContainer:\n    \"\"\"\u83b7\u53d6\u5168\u5c40DI\u5bb9\u5668\u3002\n\n    \u5982\u679c\u5bb9\u5668\u4e0d\u5b58\u5728\uff0c\u5219\u521b\u5efa\u4e00\u4e2a\u65b0\u5b9e\u4f8b\u3002\n\n    Returns:\n        DIContainer: \u5168\u5c40\u5bb9\u5668\u5b9e\u4f8b\u3002\n    \"\"\"\n    global _container\n    if _container is None:\n        _container = DIContainer()\n    return _container\n</code></pre>"},{"location":"api/shared/config/di_container/#controller.shared.config.di_container.resolve","title":"resolve","text":"<pre><code>resolve(service_type: Type) -&gt; Any\n</code></pre> <p>\u4fbf\u6377\u65b9\u6cd5\uff1a\u89e3\u6790\u670d\u52a1\u3002</p> <p>\u4ece\u5168\u5c40\u5bb9\u5668\u4e2d\u83b7\u53d6\u6307\u5b9a\u7c7b\u578b\u7684\u670d\u52a1\u5b9e\u4f8b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>service_type</code> <code>Type</code> <p>\u670d\u52a1\u7c7b\u578b\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Any</code> <code>Any</code> <p>\u670d\u52a1\u5b9e\u4f8b\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/shared/config/di_container.py</code> <pre><code>def resolve(service_type: Type) -&gt; Any:\n    \"\"\"\u4fbf\u6377\u65b9\u6cd5\uff1a\u89e3\u6790\u670d\u52a1\u3002\n\n    \u4ece\u5168\u5c40\u5bb9\u5668\u4e2d\u83b7\u53d6\u6307\u5b9a\u7c7b\u578b\u7684\u670d\u52a1\u5b9e\u4f8b\u3002\n\n    Args:\n        service_type (Type): \u670d\u52a1\u7c7b\u578b\u3002\n\n    Returns:\n        Any: \u670d\u52a1\u5b9e\u4f8b\u3002\n    \"\"\"\n    return get_container().get_service(service_type) \n</code></pre>"},{"location":"api/shared/config/service_registry/","title":"Service Registry","text":""},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry","title":"controller.shared.config.service_registry","text":"<p>\u670d\u52a1\u6ce8\u518c\u914d\u7f6e - Shared Config \u6ce8\u518c\u6240\u6709\u5e94\u7528\u670d\u52a1\u5230DI\u5bb9\u5668 - \u7b80\u5316\u7248</p>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialApplicationService","title":"SerialApplicationService","text":"<pre><code>SerialApplicationService(message_display: MessageDisplay, serial_domain_service: SerialDomainService)\n</code></pre> <p>               Bases: <code>BaseService</code></p> <p>\u4e32\u53e3\u5e94\u7528\u670d\u52a1\u3002</p> <p>\u53ea\u8d1f\u8d23\u4e32\u53e3\u8fde\u63a5\u7ba1\u7406\u548c\u72b6\u6001\u534f\u8c03\uff0c\u4e0d\u5904\u7406\u6570\u636e\u6536\u53d1\u3002 \u6570\u636e\u6536\u53d1\u7531\u5404\u4e2aDomain\u670d\u52a1\u76f4\u63a5\u4f7f\u7528SerialDomainService\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>connection_status_changed</code> <code>pyqtSignal</code> <p>\u4e32\u53e3\u8fde\u63a5\u72b6\u6001\u53d8\u5316\u4fe1\u53f7\u3002</p> <code>port_list_updated</code> <code>pyqtSignal</code> <p>\u7aef\u53e3\u5217\u8868\u66f4\u65b0\u4fe1\u53f7\u3002</p> <p>\u521d\u59cb\u5316\u4e32\u53e3\u5e94\u7528\u670d\u52a1\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/serial_application_service.py</code> <pre><code>def __init__(self, message_display: MessageDisplay, serial_domain_service: SerialDomainService):\n    \"\"\"\u521d\u59cb\u5316\u4e32\u53e3\u5e94\u7528\u670d\u52a1\u3002\"\"\"\n    super().__init__(message_display)\n\n    self.serial_domain_service = serial_domain_service\n\n    # \u8fde\u63a5Domain\u5c42\u4fe1\u53f7\u5230Application\u5c42\n    self._connect_domain_signals()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialApplicationService.refresh_ports","title":"refresh_ports","text":"<pre><code>refresh_ports() -&gt; List[str]\n</code></pre> <p>\u5237\u65b0\u53ef\u7528\u7aef\u53e3\u5217\u8868\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>List[str]: \u53ef\u7528\u7aef\u53e3\u540d\u79f0\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/serial_application_service.py</code> <pre><code>def refresh_ports(self) -&gt; List[str]:\n    \"\"\"\u5237\u65b0\u53ef\u7528\u7aef\u53e3\u5217\u8868\u3002\n\n    Returns:\n        List[str]: \u53ef\u7528\u7aef\u53e3\u540d\u79f0\u5217\u8868\u3002\n    \"\"\"\n    try:\n        ports = self.serial_domain_service.scan_available_ports()\n        self.port_list_updated.emit(ports)\n        self._display_message(f\"\u53d1\u73b0 {len(ports)} \u4e2a\u53ef\u7528\u7aef\u53e3\", \"\u7cfb\u7edf\")\n        return ports\n    except Exception as e:\n        self._display_message(f\"\u5237\u65b0\u7aef\u53e3\u5931\u8d25: {str(e)}\", \"\u9519\u8bef\")\n        return []\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialApplicationService.get_port_info","title":"get_port_info","text":"<pre><code>get_port_info(port_name: str) -&gt; Optional[Dict[str, str]]\n</code></pre> <p>\u83b7\u53d6\u6307\u5b9a\u7aef\u53e3\u4fe1\u606f\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>port_name</code> <code>str</code> <p>\u7aef\u53e3\u540d\u79f0\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[Dict[str, str]]</code> <p>Optional[Dict[str, str]]: \u7aef\u53e3\u4fe1\u606f\u5b57\u5178\uff0c\u5931\u8d25\u65f6\u8fd4\u56deNone\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/serial_application_service.py</code> <pre><code>def get_port_info(self, port_name: str) -&gt; Optional[Dict[str, str]]:\n    \"\"\"\u83b7\u53d6\u6307\u5b9a\u7aef\u53e3\u4fe1\u606f\u3002\n\n    Args:\n        port_name (str): \u7aef\u53e3\u540d\u79f0\u3002\n\n    Returns:\n        Optional[Dict[str, str]]: \u7aef\u53e3\u4fe1\u606f\u5b57\u5178\uff0c\u5931\u8d25\u65f6\u8fd4\u56deNone\u3002\n    \"\"\"\n    try:\n        return self.serial_domain_service.get_port_info(port_name)\n    except Exception as e:\n        self._display_message(f\"\u83b7\u53d6\u7aef\u53e3\u4fe1\u606f\u5931\u8d25: {str(e)}\", \"\u9519\u8bef\")\n        return None\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialApplicationService.get_available_ports","title":"get_available_ports","text":"<pre><code>get_available_ports() -&gt; List[str]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u53ef\u7528\u7aef\u53e3\u5217\u8868\uff08\u4e0d\u5237\u65b0\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>List[str]: \u53ef\u7528\u7aef\u53e3\u540d\u79f0\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/serial_application_service.py</code> <pre><code>def get_available_ports(self) -&gt; List[str]:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u53ef\u7528\u7aef\u53e3\u5217\u8868\uff08\u4e0d\u5237\u65b0\uff09\u3002\n\n    Returns:\n        List[str]: \u53ef\u7528\u7aef\u53e3\u540d\u79f0\u5217\u8868\u3002\n    \"\"\"\n    try:\n        return self.serial_domain_service.scan_available_ports()\n    except Exception as e:\n        self._display_message(f\"\u83b7\u53d6\u7aef\u53e3\u5217\u8868\u5931\u8d25: {str(e)}\", \"\u9519\u8bef\")\n        return []\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialApplicationService.get_current_port","title":"get_current_port","text":"<pre><code>get_current_port() -&gt; Optional[str]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u7684\u7aef\u53e3\u540d\u79f0\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[str]</code> <p>Optional[str]: \u7aef\u53e3\u540d\u79f0\uff0c\u672a\u8fde\u63a5\u65f6\u8fd4\u56deNone\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/serial_application_service.py</code> <pre><code>def get_current_port(self) -&gt; Optional[str]:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u7684\u7aef\u53e3\u540d\u79f0\u3002\n\n    Returns:\n        Optional[str]: \u7aef\u53e3\u540d\u79f0\uff0c\u672a\u8fde\u63a5\u65f6\u8fd4\u56deNone\u3002\n    \"\"\"\n    return self.serial_domain_service.get_current_port()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialApplicationService.connect_serial","title":"connect_serial","text":"<pre><code>connect_serial(port: str, config: Dict[str, Any]) -&gt; bool\n</code></pre> <p>\u8fde\u63a5\u4e32\u53e3\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>port</code> <code>str</code> <p>\u4e32\u53e3\u540d\u79f0\u3002</p> \u5fc5\u9700 <code>config</code> <code>Dict[str, Any]</code> <p>\u4e32\u53e3\u914d\u7f6e\u53c2\u6570\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u8fde\u63a5\u662f\u5426\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/serial_application_service.py</code> <pre><code>def connect_serial(self, port: str, config: Dict[str, Any]) -&gt; bool:\n    \"\"\"\u8fde\u63a5\u4e32\u53e3\u3002\n\n    Args:\n        port (str): \u4e32\u53e3\u540d\u79f0\u3002\n        config (Dict[str, Any]): \u4e32\u53e3\u914d\u7f6e\u53c2\u6570\u3002\n\n    Returns:\n        bool: \u8fde\u63a5\u662f\u5426\u6210\u529f\u3002\n    \"\"\"\n    self._display_message(f\"\u8fde\u63a5\u4e32\u53e3: {port}, \u914d\u7f6e: {config}\", \"\u7cfb\u7edf\")\n    try:\n        success = self.serial_domain_service.connect_port(port, config)\n        if success:\n            self._display_message(f\"\u6210\u529f\u8fde\u63a5\u5230\u7aef\u53e3 {port}\", \"\u7cfb\u7edf\")\n        return success\n    except Exception as e:\n        self._display_message(f\"\u8fde\u63a5\u5931\u8d25: {str(e)}\", \"\u9519\u8bef\")\n        return False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialApplicationService.disconnect_serial","title":"disconnect_serial","text":"<pre><code>disconnect_serial() -&gt; bool\n</code></pre> <p>\u65ad\u5f00\u4e32\u53e3\u8fde\u63a5\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u65ad\u5f00\u662f\u5426\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/serial_application_service.py</code> <pre><code>def disconnect_serial(self) -&gt; bool:\n    \"\"\"\u65ad\u5f00\u4e32\u53e3\u8fde\u63a5\u3002\n\n    Returns:\n        bool: \u65ad\u5f00\u662f\u5426\u6210\u529f\u3002\n    \"\"\"\n    try:\n        success = self.serial_domain_service.disconnect_port()\n        if success:\n            self._display_message(\"\u5df2\u65ad\u5f00\u4e32\u53e3\u8fde\u63a5\", \"\u7cfb\u7edf\")\n        return success\n    except Exception as e:\n        self._display_message(f\"\u65ad\u5f00\u8fde\u63a5\u5931\u8d25: {str(e)}\", \"\u9519\u8bef\")\n        return False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialApplicationService.is_connected","title":"is_connected","text":"<pre><code>is_connected() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u4e32\u53e3\u662f\u5426\u5df2\u8fde\u63a5\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u5df2\u8fde\u63a5\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/serial_application_service.py</code> <pre><code>def is_connected(self) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u4e32\u53e3\u662f\u5426\u5df2\u8fde\u63a5\u3002\n\n    Returns:\n        bool: \u662f\u5426\u5df2\u8fde\u63a5\u3002\n    \"\"\"\n    return self.serial_domain_service.is_connected()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialApplicationService.cleanup","title":"cleanup","text":"<pre><code>cleanup() -&gt; None\n</code></pre> <p>\u6e05\u7406\u8d44\u6e90\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/serial_application_service.py</code> <pre><code>def cleanup(self) -&gt; None:\n    \"\"\"\u6e05\u7406\u8d44\u6e90\u3002\"\"\"\n    try:\n        self._disconnect_domain_signals()\n        self.serial_domain_service.cleanup()\n    except Exception:\n        pass  # \u5ffd\u7565\u6e05\u7406\u65f6\u7684\u5f02\u5e38 \n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CommandHubService","title":"CommandHubService","text":"<pre><code>CommandHubService(message_domain_service: MessageDomainService, motion_runner: MotionRunner, serial_domain_service: SerialDomainService, message_display: MessageDisplay, motion_constructor: MotionConstructor)\n</code></pre> <p>               Bases: <code>BaseService</code></p> <p>\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1 - Application\u5c42\u3002</p> <p>\u804c\u8d23\uff1a 1. \u5206\u53d1\u7528\u6237\u547d\u4ee4\u5230\u4e0d\u540c\u7684\u5904\u7406\u903b\u8f91 2. \u534f\u8c03\u8fd0\u52a8\u4efb\u52a1\u7684\u51c6\u5907\u548c\u6267\u884c 3. \u7ba1\u7406\u6d88\u606f\u663e\u793a</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>message_domain_service</code> <p>\u6d88\u606f\u9886\u57df\u670d\u52a1\u3002</p> <code>motion_runner</code> <p>\u8fd0\u52a8\u6267\u884c\u5668\u3002</p> <code>serial_domain_service</code> <p>\u4e32\u53e3\u9886\u57df\u670d\u52a1\u3002</p> <code>motion_constructor</code> <p>\u8fd0\u52a8\u6784\u9020\u5668\u3002</p> <p>\u521d\u59cb\u5316\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/command_hub_service.py</code> <pre><code>def __init__(self, \nmessage_domain_service: MessageDomainService, \nmotion_runner: MotionRunner,\nserial_domain_service: SerialDomainService, \nmessage_display: MessageDisplay,\nmotion_constructor: MotionConstructor):\n    \"\"\"\u521d\u59cb\u5316\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002\"\"\"\n    super().__init__(message_display)\n    self.message_domain_service = message_domain_service\n    self.motion_runner = motion_runner\n    self.serial_domain_service = serial_domain_service\n    self.motion_constructor = motion_constructor\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CommandHubService.single_send_command","title":"single_send_command","text":"<pre><code>single_send_command(**kwargs: Any) -&gt; bool\n</code></pre> <p>\u53d1\u9001\u5355\u4e2a\u547d\u4ee4\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>**kwargs</code> <code>Any</code> <p>\u547d\u4ee4\u53c2\u6570\uff0c\u5c06\u88ab\u7f16\u7801\u4e3a\u6d88\u606f\u5e27\u3002</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u53d1\u9001\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/command_hub_service.py</code> <pre><code>def single_send_command(self, **kwargs: Any) -&gt; bool:\n    \"\"\"\u53d1\u9001\u5355\u4e2a\u547d\u4ee4\u3002\n\n    Args:\n        **kwargs: \u547d\u4ee4\u53c2\u6570\uff0c\u5c06\u88ab\u7f16\u7801\u4e3a\u6d88\u606f\u5e27\u3002\n\n    Returns:\n        bool: \u662f\u5426\u53d1\u9001\u6210\u529f\u3002\n    \"\"\"\n    try:\n        msg = self.message_domain_service.encode_message(**kwargs)\n        self._display_message(msg, \"\u53d1\u9001\")\n        success = self.serial_domain_service.send_data(msg)\n        if not success:\n            self._display_message(\"\u53d1\u9001\u5931\u8d25\uff1a\u4e32\u53e3\u672a\u8fde\u63a5\", \"\u9519\u8bef\")\n        return success\n    except Exception as e:\n        self._display_message(f\"\u53d1\u9001\u547d\u4ee4\u5931\u8d25: {str(e)}\", \"\u9519\u8bef\")\n        return False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CommandHubService.command_distribution","title":"command_distribution","text":"<pre><code>command_distribution(config_dict: dict)\n</code></pre> <p>\u5206\u53d1\u7528\u6237\u547d\u4ee4\u5230\u5bf9\u5e94\u7684\u5904\u7406\u903b\u8f91\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config_dict</code> <code>dict</code> <p>\u914d\u7f6e\u5b57\u5178\uff0c\u5305\u542b control, mode \u7b49\u53c2\u6570\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/command_hub_service.py</code> <pre><code>def command_distribution(self, config_dict: dict):\n    \"\"\"\u5206\u53d1\u7528\u6237\u547d\u4ee4\u5230\u5bf9\u5e94\u7684\u5904\u7406\u903b\u8f91\u3002\n\n    Args:\n        config_dict (dict): \u914d\u7f6e\u5b57\u5178\uff0c\u5305\u542b control, mode \u7b49\u53c2\u6570\u3002\n    \"\"\"\n    control = config_dict.get('control')\n    mode = config_dict.get('mode')\n\n    if control in [0x00, 0x01, 0x02, 0x03, 0x04]:\n        self.single_send_command(**config_dict)\n        self.get_current_position()\n\n    elif control == 0x05:\n        if mode == 0x0A:\n            self._display_message(\"\u5173\u95ed\u793a\u6559\u6a21\u5f0f\", \"\u52a8\u529b\u5b66\")\n        self.single_send_command(**config_dict)\n        self.motion_runner.stop_motion()\n\n    elif control == 0x07:\n        if mode == 0x0A:\n            self._display_message(\"\u5f00\u542f\u793a\u6559\u6a21\u5f0f\", \"\u52a8\u529b\u5b66\")\n        self.single_send_command(**config_dict)\n        if mode != 0x0A:\n            self.get_current_position()\n\n    elif control == 0x06:\n        if mode == 0x0A:\n            torque_values = config_dict.get('torque')\n            self._display_message(f\"\u53d1\u9001\u529b\u77e9: {torque_values}\", \"\u52a8\u529b\u5b66\")\n            self.single_send_command(**config_dict)\n        else:\n            # \u89d2\u5ea6\u63a7\u5236\uff1a\u9ed8\u8ba4\u4f7f\u7528 S \u66f2\u7ebf\u548c 0.01 \u9891\u7387\n            target_angles = config_dict.get('target_angles')\n            task = {\n                \"type\": \"motion\",\n                \"target_angles\": target_angles,\n                \"curve_type\": \"s_curve\",\n                \"frequency\": 0.01\n            }\n            self.motion_constructor.prepare_operation(\n                MotionOperationMode.EXECUTE,\n                [task]\n            )\n            self._display_message(f\"\u51c6\u5907\u8fd0\u52a8\u5230\u76ee\u6807\u4f4d\u7f6e: {target_angles}\", \"\u63a7\u5236\")\n            self.get_current_position()\n\n    elif control == 0x08:\n        self.single_send_command(**config_dict)\n        self.motion_runner.stop_motion()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CommandHubService.get_current_position","title":"get_current_position","text":"<pre><code>get_current_position()\n</code></pre> <p>\u8bf7\u6c42\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/command_hub_service.py</code> <pre><code>def get_current_position(self):\n    \"\"\"\u8bf7\u6c42\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\u3002\"\"\"\n    self.message_display.clear_messages()\n    self._display_message(\"\u6b63\u5728\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e...\", \"\u63a7\u5236\")\n    self.single_send_command(control=0x07)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CommandHubService.run_teach_record","title":"run_teach_record","text":"<pre><code>run_teach_record(angles_list: list)\n</code></pre> <p>\u8fd0\u884c\u793a\u6559\u8bb0\u5f55\uff08\u64ad\u653e\u793a\u6559\u8f68\u8ff9\uff09\u3002</p> <p>\u6d41\u7a0b\uff1a 1. \u51c6\u5907\u793a\u6559\u8fd0\u52a8\u4efb\u52a1 2. \u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e 3. \u5f02\u6b65\u56de\u8c03\u65f6\u81ea\u52a8\u6784\u5efa\u5e73\u6ed1\u8f68\u8ff9\u5e76\u6267\u884c</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>angles_list</code> <code>list[list[float]]</code> <p>\u793a\u6559\u8bb0\u5f55\u7684\u89d2\u5ea6\u5217\u8868 [[\u03b81,...,\u03b86], ...]\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/command_hub_service.py</code> <pre><code>def run_teach_record(self, angles_list: list):\n    \"\"\"\u8fd0\u884c\u793a\u6559\u8bb0\u5f55\uff08\u64ad\u653e\u793a\u6559\u8f68\u8ff9\uff09\u3002\n\n    \u6d41\u7a0b\uff1a\n    1. \u51c6\u5907\u793a\u6559\u8fd0\u52a8\u4efb\u52a1\n    2. \u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\n    3. \u5f02\u6b65\u56de\u8c03\u65f6\u81ea\u52a8\u6784\u5efa\u5e73\u6ed1\u8f68\u8ff9\u5e76\u6267\u884c\n\n    Args:\n        angles_list (list[list[float]]): \u793a\u6559\u8bb0\u5f55\u7684\u89d2\u5ea6\u5217\u8868 [[\u03b81,...,\u03b86], ...]\u3002\n    \"\"\"\n    task = {\n        \"type\": \"teach\",\n        \"teach_data\": angles_list\n    }\n    self.motion_constructor.prepare_operation(\n        MotionOperationMode.EXECUTE,\n        [task]\n    )\n    self._display_message(f\"\u51c6\u5907\u64ad\u653e\u793a\u6559\u8f68\u8ff9\uff0c\u5171 {len(angles_list)} \u4e2a\u70b9\", \"\u793a\u6559\")\n    self.get_current_position()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CommandHubService.run_motion_sequence","title":"run_motion_sequence","text":"<pre><code>run_motion_sequence()\n</code></pre> <p>\u5f00\u59cb\u6267\u884c\u8fd0\u52a8\u5e8f\u5217\uff08\u7528\u4e8e\u8fd0\u52a8\u89c4\u5212\u65b9\u6848\uff09\u3002</p> <p>\u6d41\u7a0b\uff1a 1. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e 2. \u6536\u5230\u4f4d\u7f6e\u53cd\u9988\u540e\uff0cMotionConstructor \u81ea\u52a8\u89c4\u5212\u6240\u6709\u4efb\u52a1</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/command_hub_service.py</code> <pre><code>def run_motion_sequence(self):\n    \"\"\"\u5f00\u59cb\u6267\u884c\u8fd0\u52a8\u5e8f\u5217\uff08\u7528\u4e8e\u8fd0\u52a8\u89c4\u5212\u65b9\u6848\uff09\u3002\n\n    \u6d41\u7a0b\uff1a\n    1. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e\n    2. \u6536\u5230\u4f4d\u7f6e\u53cd\u9988\u540e\uff0cMotionConstructor \u81ea\u52a8\u89c4\u5212\u6240\u6709\u4efb\u52a1\n    \"\"\"\n    self._display_message(\"\u5f00\u59cb\u6267\u884c\u8fd0\u52a8\u89c4\u5212\u65b9\u6848...\", \"\u8fd0\u52a8\u89c4\u5212\")\n    self.get_current_position()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MessageResponseService","title":"MessageResponseService","text":"<pre><code>MessageResponseService(message_display: MessageDisplay, serial_domain_service: SerialDomainService, message_domain_service: MessageDomainService, robot_state_service: RobotStateDomainService, motion_runner: MotionRunner, motion_constructor: MotionConstructor, trajectory_planner: TrajectoryPlanningService, trajectory_repository: TrajectoryRepository)\n</code></pre> <p>               Bases: <code>BaseService</code></p> <p>\u6d88\u606f\u54cd\u5e94\u670d\u52a1 - Application\u5c42\u3002</p> <p>\u5904\u7406\u4e32\u53e3\u63a5\u6536\u7684\u6570\u636e\uff0c\u89e3\u7801\u5e76\u66f4\u65b0\u72b6\u6001\u670d\u52a1\u3002</p> <p>\u804c\u8d23\uff1a 1. \u63a5\u6536\u4e32\u53e3\u6570\u636e 2. \u62fc\u63a5\u7f13\u51b2\uff0c\u68c0\u6d4b\u5b8c\u6574\u5e27 3. \u89e3\u7801\u6d88\u606f 4. \u66f4\u65b0\u72b6\u6001\u670d\u52a1\uff08\u7edf\u4e00\u5165\u53e3\uff09 5. \u6839\u636e\u64cd\u4f5c\u6a21\u5f0f\u5206\u53d1\u5904\u7406\uff08\u6267\u884c/\u4fdd\u5b58/\u9884\u89c8\uff09</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>get_current_position_signal</code> <code>pyqtSignal</code> <p>\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\u4fe1\u53f7\uff08\u7528\u4e8eUI\u663e\u793a\uff09\u3002</p> <code>trajectory_preview_signal</code> <code>pyqtSignal</code> <p>\u8f68\u8ff9\u9884\u89c8\u6570\u636e\u4fe1\u53f7\u3002</p> <p>\u521d\u59cb\u5316\u6d88\u606f\u54cd\u5e94\u670d\u52a1\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/message_response_service.py</code> <pre><code>def __init__(\n    self, \n    message_display: MessageDisplay,\n    serial_domain_service: SerialDomainService,\n    message_domain_service: MessageDomainService,\n    robot_state_service: RobotStateDomainService,\n    motion_runner: MotionRunner,\n    motion_constructor: MotionConstructor,\n    trajectory_planner: TrajectoryPlanningService,\n    trajectory_repository: TrajectoryRepository\n):\n    \"\"\"\u521d\u59cb\u5316\u6d88\u606f\u54cd\u5e94\u670d\u52a1\u3002\"\"\"\n    super().__init__(message_display)\n    self.serial_domain_service = serial_domain_service\n    self.message_domain_service = message_domain_service\n    self.robot_state_service = robot_state_service\n    self.motion_runner = motion_runner\n    self.motion_constructor = motion_constructor\n    self.trajectory_planner = trajectory_planner\n    self.trajectory_repository = trajectory_repository\n\n    self._connect_signals()\n    self.message_buffer = \"\"\n\n    # \u64cd\u4f5c\u5904\u7406\u5668\u6620\u5c04\uff08\u7b56\u7565\u6a21\u5f0f\uff09\n    self._operation_handlers = {\n        MotionOperationMode.EXECUTE: self._handle_execute,\n        MotionOperationMode.SAVE: self._handle_save,\n        MotionOperationMode.PREVIEW: self._handle_preview,\n    }\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MessageResponseService.handle_message","title":"handle_message","text":"<pre><code>handle_message(message_in: str)\n</code></pre> <p>\u5904\u7406\u63a5\u6536\u5230\u7684\u6d88\u606f\u3002</p> <p>\u6d41\u7a0b\uff1a 1. \u62fc\u63a5\u7f13\u51b2 2. \u68c0\u6d4b\u5b8c\u6574\u5e27\uff08AA55...0D0A\uff09 3. \u89e3\u7801\u6d88\u606f 4. \u66f4\u65b0\u72b6\u6001\u670d\u52a1 5. \u5904\u7406\u8fd0\u52a8\u6d88\u606f</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>message_in</code> <code>str</code> <p>\u8f93\u5165\u7684\u539f\u59cb\u4e32\u53e3\u6570\u636e\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/message_response_service.py</code> <pre><code>def handle_message(self, message_in: str):\n    \"\"\"\u5904\u7406\u63a5\u6536\u5230\u7684\u6d88\u606f\u3002\n\n    \u6d41\u7a0b\uff1a\n    1. \u62fc\u63a5\u7f13\u51b2\n    2. \u68c0\u6d4b\u5b8c\u6574\u5e27\uff08AA55...0D0A\uff09\n    3. \u89e3\u7801\u6d88\u606f\n    4. \u66f4\u65b0\u72b6\u6001\u670d\u52a1\n    5. \u5904\u7406\u8fd0\u52a8\u6d88\u606f\n\n    Args:\n        message_in (str): \u8f93\u5165\u7684\u539f\u59cb\u4e32\u53e3\u6570\u636e\u3002\n    \"\"\"\n    self.message_buffer += message_in\n    if \"0D0A\" in self.message_buffer:\n        if self.message_buffer.startswith(\"AA55\") and len(self.message_buffer) &lt; 120:\n            return\n        lines = self.message_buffer.rsplit(\"0D0A\", 1)            \n        self.message_buffer = lines[-1]\n        command_line = lines[0]\n        self._display_message(command_line + \"0D0A\", \"\u63a5\u6536\")\n\n        if command_line.startswith(\"AA55\"):\n            try:\n                # \u89e3\u7801\u6d88\u606f\n                decoded_message = self.message_domain_service.decode_message(\n                    command_line + \"0D0A\"\n                )\n                # \u66f4\u65b0\u7edf\u4e00\u7684\u72b6\u6001\u670d\u52a1\uff08\u5355\u4e00\u5165\u53e3\uff09\n                self.robot_state_service.update_state(decoded_message)\n\n                # \u5904\u7406\u8fd0\u52a8\u6d88\u606f\n                if decoded_message.control == 0x07 and decoded_message.mode == 0x08:\n                    self.handle_motion_message(decoded_message.positions)\n\n            except Exception as e:\n                self._display_message(f\"\u89e3\u7801\u6d88\u606f\u5931\u8d25: {str(e)}\", \"\u9519\u8bef\")\n        else:\n            try:\n                ascii_text = bytes.fromhex(command_line).decode('ascii', errors='replace')\n                printable_text = ''.join(\n                    c if c.isprintable() or c in '\\n\\r\\t' \n                    else f'\\\\x{ord(c):02x}' \n                    for c in ascii_text\n                )\n                if printable_text.strip():\n                    self._display_message(f\"ASCII: {printable_text}\", \"\u63a5\u6536\")\n            except Exception:\n                pass\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MessageResponseService.handle_motion_message","title":"handle_motion_message","text":"<pre><code>handle_motion_message(current_position)\n</code></pre> <p>\u5904\u7406\u8fd0\u52a8\u6d88\u606f\uff08\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\u7684\u56de\u590d\uff09\u3002</p> <p>\u6839\u636e\u72b6\u6001\u51b3\u5b9a\u884c\u4e3a\uff1a 1. \u6709\u5f85\u5904\u7406\u7684\u64cd\u4f5c \u2192 \u8c03\u7528\u5bf9\u5e94\u7684\u5904\u7406\u5668 2. \u65e0\u64cd\u4f5c \u2192 \u4ec5\u53d1\u5c04\u4fe1\u53f7\u4f9bUI\u663e\u793a</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>current_position</code> <code>list[float]</code> <p>\u5f53\u524d\u5173\u8282\u4f4d\u7f6e\uff08\u7f16\u7801\u5668\u503c\uff09\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/message_response_service.py</code> <pre><code>def handle_motion_message(self, current_position):\n    \"\"\"\u5904\u7406\u8fd0\u52a8\u6d88\u606f\uff08\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\u7684\u56de\u590d\uff09\u3002\n\n    \u6839\u636e\u72b6\u6001\u51b3\u5b9a\u884c\u4e3a\uff1a\n    1. \u6709\u5f85\u5904\u7406\u7684\u64cd\u4f5c \u2192 \u8c03\u7528\u5bf9\u5e94\u7684\u5904\u7406\u5668\n    2. \u65e0\u64cd\u4f5c \u2192 \u4ec5\u53d1\u5c04\u4fe1\u53f7\u4f9bUI\u663e\u793a\n\n    Args:\n        current_position (list[float]): \u5f53\u524d\u5173\u8282\u4f4d\u7f6e\uff08\u7f16\u7801\u5668\u503c\uff09\u3002\n    \"\"\"\n    if self.motion_constructor.has_pending_operation():\n        # \u83b7\u53d6\u64cd\u4f5c\u6a21\u5f0f\n        mode = self.motion_constructor.get_operation_mode()\n\n        # \u4ece\u5b57\u5178\u4e2d\u83b7\u53d6\u5bf9\u5e94\u7684\u5904\u7406\u51fd\u6570\n        handler = self._operation_handlers.get(mode)\n\n        if handler:\n            # \u8c03\u7528\u5904\u7406\u51fd\u6570\n            handler(current_position)\n        else:\n            self._display_message(f\"\u672a\u77e5\u64cd\u4f5c\u6a21\u5f0f: {mode}\", \"\u9519\u8bef\")\n            self.motion_constructor.clear_operation()\n    else:\n        # \u65e0\u64cd\u4f5c\uff1a\u4ec5\u53d1\u5c04\u4fe1\u53f7\u4f9bUI\u663e\u793a\n        self.get_current_position_signal.emit(current_position)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningApplicationService","title":"MotionPlanningApplicationService","text":"<pre><code>MotionPlanningApplicationService(domain_service: MotionPlanningDomainService, repository: MotionPlanRepository, motion_constructor: MotionConstructor, command_hub: CommandHubService, message_response: MessageResponseService, trajectory_repository: TrajectoryRepository)\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u8fd0\u52a8\u89c4\u5212\u5e94\u7528\u670d\u52a1\u3002</p> <p>\u804c\u8d23\uff1a 1. \u534f\u8c03Domain\u548cInfrastructure 2. \u81ea\u52a8\u4fdd\u5b58 3. \u53d1\u9001UI\u66f4\u65b0\u4fe1\u53f7 4. \u6267\u884c\u8fd0\u52a8\u89c4\u5212\uff08\u5355\u70b9\u548c\u6574\u4f53\u65b9\u6848\uff09 5. \u5904\u7406\"\u83b7\u53d6\u4f4d\u7f6e\"\u529f\u80fd</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>plan_list_changed</code> <code>pyqtSignal</code> <p>\u65b9\u6848\u5217\u8868\u53d8\u5316\u4fe1\u53f7\u3002</p> <code>current_plan_changed</code> <code>pyqtSignal</code> <p>\u5f53\u524d\u65b9\u6848\u5207\u6362\u4fe1\u53f7\u3002</p> <code>point_list_changed</code> <code>pyqtSignal</code> <p>\u8282\u70b9\u5217\u8868\u53d8\u5316\u4fe1\u53f7\u3002</p> <code>current_position_received</code> <code>pyqtSignal</code> <p>\u5f53\u524d\u4f4d\u7f6e\u6570\u636e\u4fe1\u53f7\uff08\u5f27\u5ea6\u503c\uff09\u3002</p> <code>trajectory_preview_signal</code> <code>pyqtSignal</code> <p>\u8f68\u8ff9\u9884\u89c8\u6570\u636e\u4fe1\u53f7\uff08\u8f68\u8ff9\u6570\u636e\uff0c\u4e0a\u4e0b\u6587\uff09\u3002</p> <p>\u521d\u59cb\u5316\u8fd0\u52a8\u89c4\u5212\u5e94\u7528\u670d\u52a1\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>domain_service</code> <code>MotionPlanningDomainService</code> <p>\u8fd0\u52a8\u89c4\u5212\u9886\u57df\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>repository</code> <code>MotionPlanRepository</code> <p>\u8fd0\u52a8\u65b9\u6848\u4ed3\u50a8\u3002</p> \u5fc5\u9700 <code>motion_constructor</code> <code>MotionConstructor</code> <p>\u8fd0\u52a8\u6784\u9020\u5668\u3002</p> \u5fc5\u9700 <code>command_hub</code> <code>CommandHubService</code> <p>\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>message_response</code> <code>MessageResponseService</code> <p>\u6d88\u606f\u54cd\u5e94\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>trajectory_repository</code> <code>TrajectoryRepository</code> <p>\u8f68\u8ff9\u4ed3\u50a8\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def __init__(\n    self,\n    domain_service: MotionPlanningDomainService,\n    repository: MotionPlanRepository,\n    motion_constructor: MotionConstructor,\n    command_hub: CommandHubService,\n    message_response: MessageResponseService,\n    trajectory_repository: TrajectoryRepository\n):\n    \"\"\"\u521d\u59cb\u5316\u8fd0\u52a8\u89c4\u5212\u5e94\u7528\u670d\u52a1\u3002\n\n    Args:\n        domain_service: \u8fd0\u52a8\u89c4\u5212\u9886\u57df\u670d\u52a1\u3002\n        repository: \u8fd0\u52a8\u65b9\u6848\u4ed3\u50a8\u3002\n        motion_constructor: \u8fd0\u52a8\u6784\u9020\u5668\u3002\n        command_hub: \u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002\n        message_response: \u6d88\u606f\u54cd\u5e94\u670d\u52a1\u3002\n        trajectory_repository: \u8f68\u8ff9\u4ed3\u50a8\u3002\n    \"\"\"\n    super().__init__()\n    self.domain_service = domain_service\n    self.repository = repository\n    self.motion_constructor = motion_constructor\n    self.command_hub = command_hub\n    self.message_response = message_response\n    self.trajectory_repository = trajectory_repository\n\n    # \u8fde\u63a5MessageResponse\u7684\u4f4d\u7f6e\u6570\u636e\u4fe1\u53f7\n    self.message_response.get_current_position_signal.connect(\n        self.current_position_received.emit\n    )\n\n    # \u8fde\u63a5MessageResponse\u7684\u8f68\u8ff9\u9884\u89c8\u4fe1\u53f7\n    self.message_response.trajectory_preview_signal.connect(\n        self.trajectory_preview_signal.emit\n    )\n\n    self._load_data()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningApplicationService.create_plan","title":"create_plan","text":"<pre><code>create_plan(name: str)\n</code></pre> <p>\u521b\u5efa\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>name</code> <code>str</code> <p>\u65b9\u6848\u540d\u79f0\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def create_plan(self, name: str):\n    \"\"\"\u521b\u5efa\u65b9\u6848\u3002\n\n    Args:\n        name (str): \u65b9\u6848\u540d\u79f0\u3002\n    \"\"\"\n    new_index = self.domain_service.create_plan(name)\n    self._save_data()\n    self.plan_list_changed.emit()\n    self.current_plan_changed.emit(new_index)\n    self.point_list_changed.emit()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningApplicationService.delete_plan","title":"delete_plan","text":"<pre><code>delete_plan(index: int) -&gt; bool\n</code></pre> <p>\u5220\u9664\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u65b9\u6848\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u5220\u9664\u6210\u529f, False=\u5220\u9664\u5931\u8d25\uff08\u8fdd\u53cd\u4e1a\u52a1\u89c4\u5219\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def delete_plan(self, index: int) -&gt; bool:\n    \"\"\"\u5220\u9664\u65b9\u6848\u3002\n\n    Args:\n        index (int): \u65b9\u6848\u7d22\u5f15\u3002\n\n    Returns:\n        bool: True=\u5220\u9664\u6210\u529f, False=\u5220\u9664\u5931\u8d25\uff08\u8fdd\u53cd\u4e1a\u52a1\u89c4\u5219\uff09\u3002\n    \"\"\"\n    if self.domain_service.delete_plan(index):\n        self._save_data()\n        self.plan_list_changed.emit()\n        self.current_plan_changed.emit(self.domain_service.get_current_index())\n        self.point_list_changed.emit()\n        return True\n    return False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningApplicationService.switch_plan","title":"switch_plan","text":"<pre><code>switch_plan(index: int)\n</code></pre> <p>\u5207\u6362\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u76ee\u6807\u65b9\u6848\u7d22\u5f15\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def switch_plan(self, index: int):\n    \"\"\"\u5207\u6362\u65b9\u6848\u3002\n\n    Args:\n        index (int): \u76ee\u6807\u65b9\u6848\u7d22\u5f15\u3002\n    \"\"\"\n    if self.domain_service.set_current_index(index):\n        self._save_data()\n        self.current_plan_changed.emit(index)\n        self.point_list_changed.emit()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningApplicationService.rename_plan","title":"rename_plan","text":"<pre><code>rename_plan(index: int, new_name: str)\n</code></pre> <p>\u91cd\u547d\u540d\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u65b9\u6848\u7d22\u5f15\u3002</p> \u5fc5\u9700 <code>new_name</code> <code>str</code> <p>\u65b0\u540d\u79f0\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def rename_plan(self, index: int, new_name: str):\n    \"\"\"\u91cd\u547d\u540d\u65b9\u6848\u3002\n\n    Args:\n        index (int): \u65b9\u6848\u7d22\u5f15\u3002\n        new_name (str): \u65b0\u540d\u79f0\u3002\n    \"\"\"\n    if self.domain_service.rename_plan(index, new_name):\n        self._save_data()\n        self.plan_list_changed.emit()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningApplicationService.add_point","title":"add_point","text":"<pre><code>add_point(point_data: dict)\n</code></pre> <p>\u6dfb\u52a0\u8282\u70b9</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def add_point(self, point_data: dict):\n    \"\"\"\u6dfb\u52a0\u8282\u70b9\"\"\"\n    self.domain_service.add_point(point_data)\n    self._save_data()\n    self.point_list_changed.emit()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningApplicationService.delete_point","title":"delete_point","text":"<pre><code>delete_point(index: int)\n</code></pre> <p>\u5220\u9664\u8282\u70b9</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def delete_point(self, index: int):\n    \"\"\"\u5220\u9664\u8282\u70b9\"\"\"\n    self.domain_service.remove_point(index)\n    self._save_data()\n    self.point_list_changed.emit()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningApplicationService.move_point_up","title":"move_point_up","text":"<pre><code>move_point_up(index: int)\n</code></pre> <p>\u4e0a\u79fb\u8282\u70b9</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def move_point_up(self, index: int):\n    \"\"\"\u4e0a\u79fb\u8282\u70b9\"\"\"\n    if self.domain_service.move_point_up(index):\n        self._save_data()\n        self.point_list_changed.emit()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningApplicationService.move_point_down","title":"move_point_down","text":"<pre><code>move_point_down(index: int)\n</code></pre> <p>\u4e0b\u79fb\u8282\u70b9</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def move_point_down(self, index: int):\n    \"\"\"\u4e0b\u79fb\u8282\u70b9\"\"\"\n    if self.domain_service.move_point_down(index):\n        self._save_data()\n        self.point_list_changed.emit()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningApplicationService.update_point","title":"update_point","text":"<pre><code>update_point(index: int, point_data: dict)\n</code></pre> <p>\u66f4\u65b0\u8282\u70b9</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def update_point(self, index: int, point_data: dict):\n    \"\"\"\u66f4\u65b0\u8282\u70b9\"\"\"\n    self.domain_service.update_point(index, point_data)\n    self._save_data()\n    self.point_list_changed.emit()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningApplicationService.get_single_point","title":"get_single_point","text":"<pre><code>get_single_point(index: int) -&gt; dict\n</code></pre> <p>\u83b7\u53d6\u5355\u4e2a\u8282\u70b9\u6570\u636e\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>dict</code> <code>dict</code> <p>\u8282\u70b9\u6570\u636e\u5b57\u5178\uff0c\u5982\u679c\u7d22\u5f15\u65e0\u6548\u5219\u8fd4\u56deNone\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def get_single_point(self, index: int) -&gt; dict:\n    \"\"\"\u83b7\u53d6\u5355\u4e2a\u8282\u70b9\u6570\u636e\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n\n    Returns:\n        dict: \u8282\u70b9\u6570\u636e\u5b57\u5178\uff0c\u5982\u679c\u7d22\u5f15\u65e0\u6548\u5219\u8fd4\u56deNone\u3002\n    \"\"\"\n    points = self.domain_service.get_all_points()\n    if 0 &lt;= index &lt; len(points):\n        return points[index]\n    return None\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningApplicationService.execute_single_point","title":"execute_single_point","text":"<pre><code>execute_single_point(index: int)\n</code></pre> <p>\u6267\u884c\u5355\u4e2a\u8282\u70b9\u3002</p> <p>\u6d41\u7a0b\uff1a 1. \u83b7\u53d6\u8282\u70b9\u6570\u636e 2. \u89e3\u6790\u4e3a\u4efb\u52a1\u5217\u8868 3. \u51c6\u5907\u6267\u884c\u64cd\u4f5c 4. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def execute_single_point(self, index: int):\n    \"\"\"\u6267\u884c\u5355\u4e2a\u8282\u70b9\u3002\n\n    \u6d41\u7a0b\uff1a\n    1. \u83b7\u53d6\u8282\u70b9\u6570\u636e\n    2. \u89e3\u6790\u4e3a\u4efb\u52a1\u5217\u8868\n    3. \u51c6\u5907\u6267\u884c\u64cd\u4f5c\n    4. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n    \"\"\"\n    tasks = self._get_node_tasks(index)\n    if not tasks:\n        return\n\n    # \u51c6\u5907\u6267\u884c\u64cd\u4f5c\n    self.motion_constructor.prepare_operation(\n        MotionOperationMode.EXECUTE,\n        tasks\n    )\n\n    # \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e\uff0c\u89e6\u53d1\u6267\u884c\n    self.command_hub.get_current_position()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningApplicationService.execute_motion_plan","title":"execute_motion_plan","text":"<pre><code>execute_motion_plan()\n</code></pre> <p>\u6267\u884c\u6574\u4e2a\u8fd0\u52a8\u89c4\u5212\u65b9\u6848\u3002</p> <p>\u6d41\u7a0b\uff1a 1. \u83b7\u53d6\u6240\u6709\u8282\u70b9\u7684\u4efb\u52a1 2. \u51c6\u5907\u6267\u884c\u64cd\u4f5c 3. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e\uff0c\u89e6\u53d1\u6267\u884c</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def execute_motion_plan(self):\n    \"\"\"\u6267\u884c\u6574\u4e2a\u8fd0\u52a8\u89c4\u5212\u65b9\u6848\u3002\n\n    \u6d41\u7a0b\uff1a\n    1. \u83b7\u53d6\u6240\u6709\u8282\u70b9\u7684\u4efb\u52a1\n    2. \u51c6\u5907\u6267\u884c\u64cd\u4f5c\n    3. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e\uff0c\u89e6\u53d1\u6267\u884c\n    \"\"\"\n    tasks = self._get_plan_tasks()\n    if not tasks:\n        return\n\n    # \u51c6\u5907\u6267\u884c\u64cd\u4f5c\n    self.motion_constructor.prepare_operation(\n        MotionOperationMode.EXECUTE,\n        tasks\n    )\n\n    # \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e\uff0c\u89e6\u53d1\u6267\u884c\n    self.command_hub.run_motion_sequence()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningApplicationService.request_current_position","title":"request_current_position","text":"<pre><code>request_current_position()\n</code></pre> <p>\u8bf7\u6c42\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\uff08\u4ec5\u7528\u4e8eUI\u663e\u793a\uff09\u3002</p> <p>\u6d41\u7a0b\uff1a 1. \u53d1\u9001 0x07 \u547d\u4ee4\u67e5\u8be2\u4f4d\u7f6e 2. \u4e32\u53e3\u8fd4\u56de\u6570\u636e\u540e\uff0cMessageResponseService \u68c0\u67e5 has_pending_operation() 3. \u56e0\u4e3a\u6ca1\u6709\u8c03\u7528 prepare_operation\uff0c\u6240\u4ee5\u8fd4\u56de False 4. MessageResponseService emit get_current_position_signal 5. \u672cService\u8f6c\u53d1\u4fe1\u53f7\u7ed9ViewModel</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def request_current_position(self):\n    \"\"\"\u8bf7\u6c42\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\uff08\u4ec5\u7528\u4e8eUI\u663e\u793a\uff09\u3002\n\n    \u6d41\u7a0b\uff1a\n    1. \u53d1\u9001 0x07 \u547d\u4ee4\u67e5\u8be2\u4f4d\u7f6e\n    2. \u4e32\u53e3\u8fd4\u56de\u6570\u636e\u540e\uff0cMessageResponseService \u68c0\u67e5 has_pending_operation()\n    3. \u56e0\u4e3a\u6ca1\u6709\u8c03\u7528 prepare_operation\uff0c\u6240\u4ee5\u8fd4\u56de False\n    4. MessageResponseService emit get_current_position_signal\n    5. \u672cService\u8f6c\u53d1\u4fe1\u53f7\u7ed9ViewModel\n    \"\"\"\n    self.command_hub.single_send_command(control=0x07)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningApplicationService.save_node_trajectory","title":"save_node_trajectory","text":"<pre><code>save_node_trajectory(node_index: int) -&gt; bool\n</code></pre> <p>\u4fdd\u5b58\u5355\u4e2a\u8282\u70b9\u7684\u8f68\u8ff9\u3002</p> <p>\u6d41\u7a0b\uff1a 1. \u83b7\u53d6\u8282\u70b9\u4efb\u52a1 2. \u51c6\u5907\u4fdd\u5b58\u64cd\u4f5c 3. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e 4. MessageResponseService \u81ea\u52a8\u5b8c\u6210\u4fdd\u5b58</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>node_index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True: \u51c6\u5907\u6210\u529f, False: \u51c6\u5907\u5931\u8d25\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def save_node_trajectory(self, node_index: int) -&gt; bool:\n    \"\"\"\u4fdd\u5b58\u5355\u4e2a\u8282\u70b9\u7684\u8f68\u8ff9\u3002\n\n    \u6d41\u7a0b\uff1a\n    1. \u83b7\u53d6\u8282\u70b9\u4efb\u52a1\n    2. \u51c6\u5907\u4fdd\u5b58\u64cd\u4f5c\n    3. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e\n    4. MessageResponseService \u81ea\u52a8\u5b8c\u6210\u4fdd\u5b58\n\n    Args:\n        node_index (int): \u8282\u70b9\u7d22\u5f15\u3002\n\n    Returns:\n        bool: True: \u51c6\u5907\u6210\u529f, False: \u51c6\u5907\u5931\u8d25\u3002\n    \"\"\"\n    try:\n        tasks = self._get_node_tasks(node_index)\n        if not tasks:\n            return False\n\n        current_plan = self.domain_service.get_current_plan()\n        if not current_plan:\n            return False\n\n        context = {\n            \"filename\": f\"{current_plan.name}-{node_index}\",\n            \"type\": \"node\"\n        }\n\n        self.motion_constructor.prepare_operation(\n            MotionOperationMode.SAVE,\n            tasks,\n            context\n        )\n\n        self.command_hub.get_current_position()\n        return True\n    except Exception:\n        return False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningApplicationService.save_plan_trajectory","title":"save_plan_trajectory","text":"<pre><code>save_plan_trajectory() -&gt; bool\n</code></pre> <p>\u4fdd\u5b58\u6574\u4e2a\u65b9\u6848\u7684\u8f68\u8ff9</p> <p>\u6d41\u7a0b\uff1a 1. \u83b7\u53d6\u65b9\u6848\u6240\u6709\u4efb\u52a1 2. \u51c6\u5907\u4fdd\u5b58\u64cd\u4f5c 3. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e 4. MessageResponseService \u81ea\u52a8\u5b8c\u6210\u4fdd\u5b58</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>True</code> <code>bool</code> <p>\u51c6\u5907\u6210\u529f</p> <code>False</code> <code>bool</code> <p>\u51c6\u5907\u5931\u8d25</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def save_plan_trajectory(self) -&gt; bool:\n    \"\"\"\n    \u4fdd\u5b58\u6574\u4e2a\u65b9\u6848\u7684\u8f68\u8ff9\n\n    \u6d41\u7a0b\uff1a\n    1. \u83b7\u53d6\u65b9\u6848\u6240\u6709\u4efb\u52a1\n    2. \u51c6\u5907\u4fdd\u5b58\u64cd\u4f5c\n    3. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e\n    4. MessageResponseService \u81ea\u52a8\u5b8c\u6210\u4fdd\u5b58\n\n    Returns:\n        True: \u51c6\u5907\u6210\u529f\n        False: \u51c6\u5907\u5931\u8d25\n    \"\"\"\n    try:\n        tasks = self._get_plan_tasks()\n        if not tasks:\n            return False\n\n        current_plan = self.domain_service.get_current_plan()\n        if not current_plan:\n            return False\n\n        context = {\n            \"filename\": current_plan.name,\n            \"type\": \"plan\"\n        }\n\n        self.motion_constructor.prepare_operation(\n            MotionOperationMode.SAVE,\n            tasks,\n            context\n        )\n\n        self.command_hub.get_current_position()\n        return True\n    except Exception:\n        return False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningApplicationService.preview_node_trajectory","title":"preview_node_trajectory","text":"<pre><code>preview_node_trajectory(node_index: int) -&gt; bool\n</code></pre> <p>\u9884\u89c8\u5355\u4e2a\u8282\u70b9\u7684\u8f68\u8ff9\u66f2\u7ebf</p> <p>\u6d41\u7a0b\uff1a 1. \u83b7\u53d6\u8282\u70b9\u4efb\u52a1 2. \u51c6\u5907\u9884\u89c8\u64cd\u4f5c 3. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e 4. MessageResponseService \u81ea\u52a8\u53d1\u5c04\u9884\u89c8\u4fe1\u53f7</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>node_index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>True</code> <code>bool</code> <p>\u51c6\u5907\u6210\u529f</p> <code>False</code> <code>bool</code> <p>\u51c6\u5907\u5931\u8d25</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def preview_node_trajectory(self, node_index: int) -&gt; bool:\n    \"\"\"\n    \u9884\u89c8\u5355\u4e2a\u8282\u70b9\u7684\u8f68\u8ff9\u66f2\u7ebf\n\n    \u6d41\u7a0b\uff1a\n    1. \u83b7\u53d6\u8282\u70b9\u4efb\u52a1\n    2. \u51c6\u5907\u9884\u89c8\u64cd\u4f5c\n    3. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e\n    4. MessageResponseService \u81ea\u52a8\u53d1\u5c04\u9884\u89c8\u4fe1\u53f7\n\n    Args:\n        node_index: \u8282\u70b9\u7d22\u5f15\n\n    Returns:\n        True: \u51c6\u5907\u6210\u529f\n        False: \u51c6\u5907\u5931\u8d25\n    \"\"\"\n    try:\n        tasks = self._get_node_tasks(node_index)\n        if not tasks:\n            return False\n\n        context = {\n            \"type\": \"node\",\n            \"node_index\": node_index\n        }\n\n        self.motion_constructor.prepare_operation(\n            MotionOperationMode.PREVIEW,\n            tasks,\n            context\n        )\n\n        self.command_hub.get_current_position()\n        return True\n    except Exception:\n        return False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningApplicationService.preview_plan_trajectory","title":"preview_plan_trajectory","text":"<pre><code>preview_plan_trajectory() -&gt; bool\n</code></pre> <p>\u9884\u89c8\u6574\u4e2a\u65b9\u6848\u7684\u8f68\u8ff9\u66f2\u7ebf</p> <p>\u6d41\u7a0b\uff1a 1. \u83b7\u53d6\u65b9\u6848\u6240\u6709\u4efb\u52a1 2. \u51c6\u5907\u9884\u89c8\u64cd\u4f5c 3. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e 4. MessageResponseService \u81ea\u52a8\u53d1\u5c04\u9884\u89c8\u4fe1\u53f7</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>True</code> <code>bool</code> <p>\u51c6\u5907\u6210\u529f</p> <code>False</code> <code>bool</code> <p>\u51c6\u5907\u5931\u8d25</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def preview_plan_trajectory(self) -&gt; bool:\n    \"\"\"\n    \u9884\u89c8\u6574\u4e2a\u65b9\u6848\u7684\u8f68\u8ff9\u66f2\u7ebf\n\n    \u6d41\u7a0b\uff1a\n    1. \u83b7\u53d6\u65b9\u6848\u6240\u6709\u4efb\u52a1\n    2. \u51c6\u5907\u9884\u89c8\u64cd\u4f5c\n    3. \u67e5\u8be2\u5f53\u524d\u4f4d\u7f6e\n    4. MessageResponseService \u81ea\u52a8\u53d1\u5c04\u9884\u89c8\u4fe1\u53f7\n\n    Returns:\n        True: \u51c6\u5907\u6210\u529f\n        False: \u51c6\u5907\u5931\u8d25\n    \"\"\"\n    try:\n        tasks = self._get_plan_tasks()\n        if not tasks:\n            return False\n\n        context = {\"type\": \"plan\"}\n\n        self.motion_constructor.prepare_operation(\n            MotionOperationMode.PREVIEW,\n            tasks,\n            context\n        )\n\n        self.command_hub.get_current_position()\n        return True\n    except Exception:\n        return False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningApplicationService.load_local_trajectory","title":"load_local_trajectory","text":"<pre><code>load_local_trajectory(file_path: str) -&gt; bool\n</code></pre> <p>\u4ece plans \u76ee\u5f55\u52a0\u8f7d\u8f68\u8ff9\u6587\u4ef6\uff0c\u4f5c\u4e3a\u793a\u6559\u8282\u70b9\u6dfb\u52a0</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>str</code> <p>\u8f68\u8ff9\u6587\u4ef6\u7684\u5b8c\u6574\u8def\u5f84\u6216\u6587\u4ef6\u540d</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>True</code> <code>bool</code> <p>\u52a0\u8f7d\u6210\u529f</p> <code>False</code> <code>bool</code> <p>\u52a0\u8f7d\u5931\u8d25</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def load_local_trajectory(self, file_path: str) -&gt; bool:\n    \"\"\"\n    \u4ece plans \u76ee\u5f55\u52a0\u8f7d\u8f68\u8ff9\u6587\u4ef6\uff0c\u4f5c\u4e3a\u793a\u6559\u8282\u70b9\u6dfb\u52a0\n\n    Args:\n        file_path: \u8f68\u8ff9\u6587\u4ef6\u7684\u5b8c\u6574\u8def\u5f84\u6216\u6587\u4ef6\u540d\n\n    Returns:\n        True: \u52a0\u8f7d\u6210\u529f\n        False: \u52a0\u8f7d\u5931\u8d25\n    \"\"\"\n    try:\n        # 1. \u63d0\u53d6\u6587\u4ef6\u540d\uff08\u4e0d\u5e26\u8def\u5f84\u548c\u6269\u5c55\u540d\uff09\n        file_stem = Path(file_path).stem\n\n        # 2. \u4ece TrajectoryRepository \u52a0\u8f7d\n        trajectory_data = self.trajectory_repository.load_trajectory(file_stem)\n\n        # 3. \u9a8c\u8bc1\u6570\u636e\n        if not self._validate_trajectory_data(trajectory_data):\n            return False\n\n        # 4. \u521b\u5efa\u793a\u6559\u8282\u70b9\u6570\u636e\uff08\u590d\u7528\u793a\u6559\u6a21\u5f0f\u7684\u683c\u5f0f\uff09\n        point_data = {\n            \"mode\": f\"\u793a\u6559-{file_stem}\",\n            \"joint1\": 0.0,\n            \"joint2\": 0.0,\n            \"joint3\": 0.0,\n            \"joint4\": 0.0,\n            \"joint5\": 0.0,\n            \"joint6\": 0.0,\n            \"frequency\": 0.01,\n            \"curve_type\": \"S\u66f2\u7ebf\",\n            \"gripper_command\": \"00: \u4e0d\u8fdb\u884c\u4efb\u4f55\u64cd\u4f5c\",\n            \"gripper_param\": 0.0,\n            \"note\": f\"\u672c\u5730\u8f68\u8ff9\uff0c\u5171{len(trajectory_data)}\u4e2a\u70b9\",\n            \"teach_record_name\": file_stem,\n            \"teach_data\": trajectory_data,\n            \"source\": \"local_trajectory\"  # \u6807\u8bb0\u6765\u6e90\n        }\n\n        # 5. \u6dfb\u52a0\u8282\u70b9\n        self.domain_service.add_point(point_data)\n        self._save_data()  # \u6301\u4e45\u5316\u4fdd\u5b58\n        self.point_list_changed.emit()\n        return True\n\n    except Exception:\n        return False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningApplicationService.get_local_trajectory_files","title":"get_local_trajectory_files","text":"<pre><code>get_local_trajectory_files() -&gt; List[str]\n</code></pre> <p>\u83b7\u53d6\u6240\u6709\u53ef\u7528\u7684\u672c\u5730\u8f68\u8ff9\u6587\u4ef6</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>\u6587\u4ef6\u540d\u5217\u8868\uff08\u4e0d\u5e26\u6269\u5c55\u540d\uff09</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/motion_planning_application_service.py</code> <pre><code>def get_local_trajectory_files(self) -&gt; List[str]:\n    \"\"\"\n    \u83b7\u53d6\u6240\u6709\u53ef\u7528\u7684\u672c\u5730\u8f68\u8ff9\u6587\u4ef6\n\n    Returns:\n        \u6587\u4ef6\u540d\u5217\u8868\uff08\u4e0d\u5e26\u6269\u5c55\u540d\uff09\n    \"\"\"\n    return self.trajectory_repository.list_trajectory_files()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraApplicationService","title":"CameraApplicationService","text":"<pre><code>CameraApplicationService(camera_service: CameraDomainService, recognition_service: RecognitionDomainService, hand_eye_service: HandEyeTransformDomainService, kinematic_service: KinematicDomainService, robot_state_service: RobotStateDomainService, motion_constructor: MotionConstructor, command_hub: CommandHubService, message_display: MessageDisplay)\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u6444\u50cf\u5934\u5e94\u7528\u670d\u52a1\u3002</p> <p>\u534f\u8c03\u6444\u50cf\u5934Domain\u670d\u52a1\u3001\u68c0\u6d4b\u670d\u52a1\u548c\u6d88\u606f\u663e\u793a\uff0c\u63d0\u4f9b\u7edf\u4e00\u7684\u67e5\u8be2\u63a5\u53e3\uff0c\u907f\u514dViewModel\u76f4\u63a5\u8bbf\u95eeDomain\u5c42\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>connection_status_changed</code> <code>pyqtSignal</code> <p>\u6444\u50cf\u5934\u8fde\u63a5\u72b6\u6001\u53d8\u5316\u4fe1\u53f7\u3002</p> <code>detection_status_changed</code> <code>pyqtSignal</code> <p>\u68c0\u6d4b\u72b6\u6001\u53d8\u5316\u4fe1\u53f7\u3002</p> <p>\u521d\u59cb\u5316\u6444\u50cf\u5934\u5e94\u7528\u670d\u52a1\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def __init__(\n    self,\n    camera_service: CameraDomainService,\n    recognition_service: RecognitionDomainService,\n    hand_eye_service: HandEyeTransformDomainService,\n    kinematic_service: KinematicDomainService,\n    robot_state_service: RobotStateDomainService,\n    motion_constructor: MotionConstructor,\n    command_hub: CommandHubService,\n    message_display: MessageDisplay\n):\n    \"\"\"\u521d\u59cb\u5316\u6444\u50cf\u5934\u5e94\u7528\u670d\u52a1\u3002\"\"\"\n    super().__init__()\n    self.camera_service = camera_service\n    self.recognition_service = recognition_service\n    self.hand_eye_service = hand_eye_service\n    self.kinematic_service = kinematic_service\n    self.robot_state_service = robot_state_service\n    self.motion_constructor = motion_constructor\n    self.command_hub = command_hub\n    self.message_display = message_display\n\n    # \u8fde\u63a5Domain Service\u4fe1\u53f7\n    self._connect_signals()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraApplicationService.connect_camera","title":"connect_camera","text":"<pre><code>connect_camera()\n</code></pre> <p>\u8fde\u63a5\u6444\u50cf\u5934\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def connect_camera(self):\n    \"\"\"\u8fde\u63a5\u6444\u50cf\u5934\u3002\"\"\"\n    self.message_display.clear_messages()\n    self._display_message(\"\u6b63\u5728\u8fde\u63a5\u6444\u50cf\u5934...\", \"\u6444\u50cf\u5934\")\n\n    success = self.camera_service.connect()\n\n    if success:\n        self._display_message(\"\u6444\u50cf\u5934\u8fde\u63a5\u6210\u529f\", \"\u6444\u50cf\u5934\")\n        self.connection_status_changed.emit(True)\n    else:\n        self._display_message(\"\u6444\u50cf\u5934\u8fde\u63a5\u5931\u8d25\", \"\u9519\u8bef\")\n        self.connection_status_changed.emit(False)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraApplicationService.disconnect_camera","title":"disconnect_camera","text":"<pre><code>disconnect_camera()\n</code></pre> <p>\u65ad\u5f00\u6444\u50cf\u5934\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def disconnect_camera(self):\n    \"\"\"\u65ad\u5f00\u6444\u50cf\u5934\u3002\"\"\"\n    self.message_display.clear_messages()\n    self._display_message(\"\u6b63\u5728\u65ad\u5f00\u6444\u50cf\u5934...\", \"\u6444\u50cf\u5934\")\n\n    success = self.camera_service.disconnect()\n\n    if success:\n        self._display_message(\"\u6444\u50cf\u5934\u5df2\u65ad\u5f00\", \"\u6444\u50cf\u5934\")\n        self.connection_status_changed.emit(False)\n    else:\n        self._display_message(\"\u65ad\u5f00\u6444\u50cf\u5934\u5931\u8d25\", \"\u9519\u8bef\")\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraApplicationService.start_detection","title":"start_detection","text":"<pre><code>start_detection()\n</code></pre> <p>\u5f00\u59cb\u68c0\u6d4b\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def start_detection(self):\n    \"\"\"\u5f00\u59cb\u68c0\u6d4b\u3002\"\"\"\n    self.message_display.clear_messages()\n    self._display_message(\"\u6b63\u5728\u542f\u52a8\u68c0\u6d4b...\", \"\u68c0\u6d4b\")\n\n    success = self.recognition_service.start_detection()\n\n    if success:\n        self._display_message(\"\u5f00\u59cb\u96f6\u4ef6\u8bc6\u522b\", \"\u68c0\u6d4b\")\n        self.detection_status_changed.emit(True)\n    else:\n        self._display_message(\"\u542f\u52a8\u68c0\u6d4b\u5931\u8d25\", \"\u9519\u8bef\")\n        self.detection_status_changed.emit(False)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraApplicationService.stop_detection","title":"stop_detection","text":"<pre><code>stop_detection()\n</code></pre> <p>\u505c\u6b62\u68c0\u6d4b\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def stop_detection(self):\n    \"\"\"\u505c\u6b62\u68c0\u6d4b\u3002\"\"\"\n    self.message_display.clear_messages()\n    self._display_message(\"\u6b63\u5728\u505c\u6b62\u68c0\u6d4b...\", \"\u68c0\u6d4b\")\n\n    success = self.recognition_service.stop_detection()\n\n    if success:\n        self._display_message(\"\u505c\u6b62\u96f6\u4ef6\u8bc6\u522b\", \"\u68c0\u6d4b\")\n        self.detection_status_changed.emit(False)\n    else:\n        self._display_message(\"\u505c\u6b62\u68c0\u6d4b\u5931\u8d25\", \"\u9519\u8bef\")\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraApplicationService.move_to_detected_part","title":"move_to_detected_part","text":"<pre><code>move_to_detected_part()\n</code></pre> <p>\u8fd0\u52a8\u5230\u68c0\u6d4b\u5230\u7684\u96f6\u4ef6\u4f4d\u7f6e\u3002</p> <p>\u5b8c\u6574\u6d41\u7a0b\uff1a 1. \u68c0\u67e5\u68c0\u6d4b\u72b6\u6001 2. \u83b7\u53d6\u68c0\u6d4b\u7ed3\u679c 3. \u83b7\u53d6\u5f53\u524d\u5173\u8282\u89d2\u5ea6 4. \u624b\u773c\u6807\u5b9a\u8ba1\u7b97\u76ee\u6807\u5173\u8282\u89d2\u5ea6 5. \u6784\u5efa\u8fd0\u52a8\u4efb\u52a1 6. \u89e6\u53d1\u8fd0\u52a8\u6267\u884c 7. \u505c\u6b62\u68c0\u6d4b\uff08\u53ef\u9009\uff09</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def move_to_detected_part(self):\n    \"\"\"\u8fd0\u52a8\u5230\u68c0\u6d4b\u5230\u7684\u96f6\u4ef6\u4f4d\u7f6e\u3002\n\n    \u5b8c\u6574\u6d41\u7a0b\uff1a\n    1. \u68c0\u67e5\u68c0\u6d4b\u72b6\u6001\n    2. \u83b7\u53d6\u68c0\u6d4b\u7ed3\u679c\n    3. \u83b7\u53d6\u5f53\u524d\u5173\u8282\u89d2\u5ea6\n    4. \u624b\u773c\u6807\u5b9a\u8ba1\u7b97\u76ee\u6807\u5173\u8282\u89d2\u5ea6\n    5. \u6784\u5efa\u8fd0\u52a8\u4efb\u52a1\n    6. \u89e6\u53d1\u8fd0\u52a8\u6267\u884c\n    7. \u505c\u6b62\u68c0\u6d4b\uff08\u53ef\u9009\uff09\n    \"\"\"\n    # 1. \u68c0\u67e5\u68c0\u6d4b\u662f\u5426\u8fd0\u884c\n    if not self.recognition_service.is_detection_running():\n        self._display_message(\"\u68c0\u6d4b\u672a\u8fd0\u884c\uff0c\u65e0\u6cd5\u6267\u884c\u8fd0\u52a8\", \"\u9519\u8bef\")\n        return\n\n    # 2. \u83b7\u53d6\u6700\u65b0\u68c0\u6d4b\u7ed3\u679c\n    detection_result = self.recognition_service.get_latest_result()\n    if not detection_result:\n        self._display_message(\"\u672a\u68c0\u6d4b\u5230\u96f6\u4ef6\uff0c\u65e0\u6cd5\u6267\u884c\u8fd0\u52a8\", \"\u8b66\u544a\")\n        return\n\n    # 3. \u83b7\u53d6\u5f53\u524d\u5173\u8282\u89d2\u5ea6\n    current_state = self.robot_state_service.get_current_state()\n    if not current_state:\n        self._display_message(\"\u65e0\u6cd5\u83b7\u53d6\u5f53\u524d\u673a\u5668\u4eba\u72b6\u6001\", \"\u9519\u8bef\")\n        return\n\n    current_joint_angles = current_state.joint_angles  # \u2705 \u4fee\u590d\uff1a\u6b63\u786e\u7684\u5c5e\u6027\u540d\uff08\u5f27\u5ea6\uff09\n\n    # 4. \u624b\u773c\u6807\u5b9a\u8ba1\u7b97\u76ee\u6807\u5173\u8282\u89d2\u5ea6\n    try:\n        target_angles = self.hand_eye_service.calculate_target_joint_angles(\n            central_center=detection_result['central_center'],\n            depth=detection_result['depth'],\n            real_center=detection_result['real_center'],\n            real_depth=detection_result['real_depth'],\n            angle=detection_result['angle'],\n            current_joint_angles=current_joint_angles\n        )\n\n        if target_angles is None:\n            self._display_message(\"\u9006\u8fd0\u52a8\u5b66\u65e0\u89e3\uff0c\u65e0\u6cd5\u5230\u8fbe\u76ee\u6807\u4f4d\u7f6e\", \"\u9519\u8bef\")\n            return\n\n    except Exception as e:\n        self._display_message(f\"\u8ba1\u7b97\u76ee\u6807\u4f4d\u59ff\u5931\u8d25: {str(e)}\", \"\u9519\u8bef\")\n        return\n\n    # 5. \u6784\u5efa\u8fd0\u52a8\u4efb\u52a1\n    motion_task = {\n        'type': 'motion',\n        'target_angles': target_angles,\n        'curve_type': 's_curve',  # 's_curve' \u6216 'linear'\uff08\u7b1b\u5361\u5c14\u76f4\u7ebf\uff09\n        'frequency': 0.01\n    }\n\n    # 6. \u51c6\u5907\u8fd0\u52a8\u5e76\u89e6\u53d1\u6267\u884c\n    try:\n        # \u4f7f\u7528\u7edf\u4e00\u7684 prepare_operation \u63a5\u53e3\n        self.motion_constructor.prepare_operation(\n            MotionOperationMode.EXECUTE,\n            [motion_task]  # \u9700\u8981\u4f20\u5165\u4efb\u52a1\u5217\u8868\n        )\n        self.command_hub.get_current_position()  # \u89e6\u53d1\u8fd0\u52a8\u6267\u884c\n\n        self._display_message(\n            f\"\u5f00\u59cb\u8fd0\u52a8\u5230\u96f6\u4ef6\u4f4d\u7f6e \"\n            f\"(\u4e2d\u5fc3: {detection_result['central_center']}, \"\n            f\"\u6df1\u5ea6: {detection_result['depth']:.2f}mm, \"\n            f\"\u89d2\u5ea6: {np.degrees(detection_result['angle']):.1f}\u00b0)\",\n            \"\u8fd0\u52a8\"\n        )\n\n    except Exception as e:\n        self._display_message(f\"\u542f\u52a8\u8fd0\u52a8\u5931\u8d25: {str(e)}\", \"\u9519\u8bef\")\n        return\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraApplicationService.is_camera_connected","title":"is_camera_connected","text":"<pre><code>is_camera_connected() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u6444\u50cf\u5934\u662f\u5426\u8fde\u63a5\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u5df2\u8fde\u63a5, False=\u672a\u8fde\u63a5\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def is_camera_connected(self) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u6444\u50cf\u5934\u662f\u5426\u8fde\u63a5\u3002\n\n    Returns:\n        bool: True=\u5df2\u8fde\u63a5, False=\u672a\u8fde\u63a5\u3002\n    \"\"\"\n    return self.camera_service.is_connected\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraApplicationService.is_color_available","title":"is_color_available","text":"<pre><code>is_color_available() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u5f69\u8272\u56fe\u50cf\u662f\u5426\u53ef\u7528\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u6709\u6570\u636e, False=\u65e0\u6570\u636e\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def is_color_available(self) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u5f69\u8272\u56fe\u50cf\u662f\u5426\u53ef\u7528\u3002\n\n    Returns:\n        bool: True=\u6709\u6570\u636e, False=\u65e0\u6570\u636e\u3002\n    \"\"\"\n    return self.camera_service.is_color_available()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraApplicationService.is_depth_available","title":"is_depth_available","text":"<pre><code>is_depth_available() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u6df1\u5ea6\u56fe\u50cf\u662f\u5426\u53ef\u7528\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u6709\u6570\u636e, False=\u65e0\u6570\u636e\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def is_depth_available(self) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u6df1\u5ea6\u56fe\u50cf\u662f\u5426\u53ef\u7528\u3002\n\n    Returns:\n        bool: True=\u6709\u6570\u636e, False=\u65e0\u6570\u636e\u3002\n    \"\"\"\n    return self.camera_service.is_depth_available()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraApplicationService.get_latest_color_image","title":"get_latest_color_image","text":"<pre><code>get_latest_color_image() -&gt; Optional[np.ndarray]\n</code></pre> <p>\u83b7\u53d6\u6700\u65b0\u5f69\u8272\u56fe\u50cf\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[ndarray]</code> <p>Optional[np.ndarray]: \u5f69\u8272\u56fe\u50cf\uff08BGR\u683c\u5f0f\uff09\uff0c\u5982\u679c\u65e0\u6570\u636e\u5219\u8fd4\u56deNone\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def get_latest_color_image(self) -&gt; Optional[np.ndarray]:\n    \"\"\"\u83b7\u53d6\u6700\u65b0\u5f69\u8272\u56fe\u50cf\u3002\n\n    Returns:\n        Optional[np.ndarray]: \u5f69\u8272\u56fe\u50cf\uff08BGR\u683c\u5f0f\uff09\uff0c\u5982\u679c\u65e0\u6570\u636e\u5219\u8fd4\u56deNone\u3002\n    \"\"\"\n    return self.camera_service.get_latest_color_image()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraApplicationService.get_latest_depth_image","title":"get_latest_depth_image","text":"<pre><code>get_latest_depth_image() -&gt; Optional[np.ndarray]\n</code></pre> <p>\u83b7\u53d6\u6700\u65b0\u6df1\u5ea6\u56fe\u50cf\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[ndarray]</code> <p>Optional[np.ndarray]: \u6df1\u5ea6\u56fe\u50cf\uff0816\u4f4d\u621632\u4f4d\u6d6e\u70b9\uff09\uff0c\u5982\u679c\u65e0\u6570\u636e\u5219\u8fd4\u56deNone\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def get_latest_depth_image(self) -&gt; Optional[np.ndarray]:\n    \"\"\"\u83b7\u53d6\u6700\u65b0\u6df1\u5ea6\u56fe\u50cf\u3002\n\n    Returns:\n        Optional[np.ndarray]: \u6df1\u5ea6\u56fe\u50cf\uff0816\u4f4d\u621632\u4f4d\u6d6e\u70b9\uff09\uff0c\u5982\u679c\u65e0\u6570\u636e\u5219\u8fd4\u56deNone\u3002\n    \"\"\"\n    return self.camera_service.get_latest_depth_image()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraApplicationService.visualize_depth_image","title":"visualize_depth_image","text":"<pre><code>visualize_depth_image(depth_image: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u6df1\u5ea6\u56fe\u53ef\u89c6\u5316\u4e3a\u4f2a\u5f69\u8272\u56fe\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>depth_image</code> <code>ndarray</code> <p>\u539f\u59cb\u6df1\u5ea6\u56fe\uff0816\u4f4d\u621632\u4f4d\u6d6e\u70b9\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u4f2a\u5f69\u8272\u6df1\u5ea6\u56fe\uff08BGR, uint8\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def visualize_depth_image(self, depth_image: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u6df1\u5ea6\u56fe\u53ef\u89c6\u5316\u4e3a\u4f2a\u5f69\u8272\u56fe\u3002\n\n    Args:\n        depth_image (np.ndarray): \u539f\u59cb\u6df1\u5ea6\u56fe\uff0816\u4f4d\u621632\u4f4d\u6d6e\u70b9\uff09\u3002\n\n    Returns:\n        np.ndarray: \u4f2a\u5f69\u8272\u6df1\u5ea6\u56fe\uff08BGR, uint8\uff09\u3002\n    \"\"\"\n    return self.camera_service.visualize_depth_image(depth_image)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraApplicationService.is_detection_running","title":"is_detection_running","text":"<pre><code>is_detection_running() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u68c0\u6d4b\u662f\u5426\u6b63\u5728\u8fd0\u884c\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u8fd0\u884c\u4e2d, False=\u672a\u8fd0\u884c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def is_detection_running(self) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u68c0\u6d4b\u662f\u5426\u6b63\u5728\u8fd0\u884c\u3002\n\n    Returns:\n        bool: True=\u8fd0\u884c\u4e2d, False=\u672a\u8fd0\u884c\u3002\n    \"\"\"\n    return self.recognition_service.is_detection_running()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraApplicationService.get_latest_detection_result","title":"get_latest_detection_result","text":"<pre><code>get_latest_detection_result() -&gt; Optional[Dict]\n</code></pre> <p>\u83b7\u53d6\u6700\u65b0\u68c0\u6d4b\u7ed3\u679c\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[Dict]</code> <p>Optional[Dict]: \u68c0\u6d4b\u7ed3\u679c\u5b57\u5178\uff0c\u5982\u679c\u65e0\u6570\u636e\u5219\u8fd4\u56deNone\u3002 \u5305\u542b\u5b57\u6bb5\uff1ahead_center, central_center, real_center, angle, depth, real_depth\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def get_latest_detection_result(self) -&gt; Optional[Dict]:\n    \"\"\"\u83b7\u53d6\u6700\u65b0\u68c0\u6d4b\u7ed3\u679c\u3002\n\n    Returns:\n        Optional[Dict]: \u68c0\u6d4b\u7ed3\u679c\u5b57\u5178\uff0c\u5982\u679c\u65e0\u6570\u636e\u5219\u8fd4\u56deNone\u3002\n            \u5305\u542b\u5b57\u6bb5\uff1ahead_center, central_center, real_center, angle, depth, real_depth\u3002\n    \"\"\"\n    return self.recognition_service.get_latest_result()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraApplicationService.get_image_with_detection","title":"get_image_with_detection","text":"<pre><code>get_image_with_detection(image: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u83b7\u53d6\u53e0\u52a0\u4e86\u68c0\u6d4b\u7ed3\u679c\u7684\u56fe\u50cf\u3002</p> <p>\u5c01\u88c5\u4e86\u68c0\u6d4b\u72b6\u6001\u68c0\u67e5\u548c\u56fe\u50cf\u7ed8\u5236\u903b\u8f91\uff0c\u63d0\u4f9b\u9ad8\u5c42\u4e1a\u52a1\u63a5\u53e3\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>image</code> <code>ndarray</code> <p>\u539f\u59cb\u56fe\u50cf\uff08BGR\u683c\u5f0f\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u5982\u679c\u68c0\u6d4b\u6b63\u5728\u8fd0\u884c\u4e14\u6709\u7ed3\u679c\uff0c\u8fd4\u56de\u53e0\u52a0\u4e86\u68c0\u6d4b\u6807\u6ce8\u7684\u56fe\u50cf\uff1b        \u5426\u5219\u8fd4\u56de\u539f\u56fe\u50cf\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/camera_application_service.py</code> <pre><code>def get_image_with_detection(self, image: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u83b7\u53d6\u53e0\u52a0\u4e86\u68c0\u6d4b\u7ed3\u679c\u7684\u56fe\u50cf\u3002\n\n    \u5c01\u88c5\u4e86\u68c0\u6d4b\u72b6\u6001\u68c0\u67e5\u548c\u56fe\u50cf\u7ed8\u5236\u903b\u8f91\uff0c\u63d0\u4f9b\u9ad8\u5c42\u4e1a\u52a1\u63a5\u53e3\u3002\n\n    Args:\n        image (np.ndarray): \u539f\u59cb\u56fe\u50cf\uff08BGR\u683c\u5f0f\uff09\u3002\n\n    Returns:\n        np.ndarray: \u5982\u679c\u68c0\u6d4b\u6b63\u5728\u8fd0\u884c\u4e14\u6709\u7ed3\u679c\uff0c\u8fd4\u56de\u53e0\u52a0\u4e86\u68c0\u6d4b\u6807\u6ce8\u7684\u56fe\u50cf\uff1b\n                   \u5426\u5219\u8fd4\u56de\u539f\u56fe\u50cf\u3002\n    \"\"\"\n    # \u68c0\u67e5\u68c0\u6d4b\u662f\u5426\u8fd0\u884c\n    if self.recognition_service.is_detection_running():\n        # \u83b7\u53d6\u6700\u65b0\u68c0\u6d4b\u7ed3\u679c\n        detection = self.recognition_service.get_latest_result()\n        if detection:\n            # \u7ed8\u5236\u68c0\u6d4b\u7ed3\u679c\u5230\u56fe\u50cf\u4e0a\n            return ImageDrawingUtils.draw_detection_result(image, detection)\n\n    # \u65e0\u68c0\u6d4b\u6216\u65e0\u7ed3\u679c\uff0c\u8fd4\u56de\u539f\u56fe\n    return image\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.ToolsApplicationService","title":"ToolsApplicationService","text":"<pre><code>ToolsApplicationService(kinematic_service: KinematicDomainService, robot_state_service: RobotStateDomainService)\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u5de5\u5177\u5e94\u7528\u670d\u52a1\u3002</p> <p>\u804c\u8d23\uff1a 1. \u63a5\u6536 6 \u4e2a\u5173\u8282\u89d2\u5ea6 2. \u8c03\u7528 KinematicDomainService \u8ba1\u7b97\u6b63\u8fd0\u52a8\u5b66 3. \u683c\u5f0f\u5316\u7ed3\u679c\u5e76\u53d1\u5c04\u4fe1\u53f7 4. \u83b7\u53d6\u5f53\u524d\u673a\u68b0\u81c2\u5173\u8282\u89d2\u5ea6 5. \u8ba1\u7b97\u9006\u8fd0\u52a8\u5b66</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>calculation_result_signal</code> <code>pyqtSignal</code> <p>\u53d1\u9001\u6b63\u8fd0\u52a8\u5b66\u8ba1\u7b97\u7ed3\u679c\u3002</p> <code>current_angles_signal</code> <code>pyqtSignal</code> <p>\u53d1\u9001\u5f53\u524d\u5173\u8282\u89d2\u5ea6\u3002</p> <code>inverse_result_signal</code> <code>pyqtSignal</code> <p>\u53d1\u9001\u9006\u8fd0\u52a8\u5b66\u8ba1\u7b97\u7ed3\u679c\u3002</p> <p>\u521d\u59cb\u5316\u5de5\u5177\u5e94\u7528\u670d\u52a1\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>kinematic_service</code> <code>KinematicDomainService</code> <p>\u8fd0\u52a8\u5b66\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>robot_state_service</code> <code>RobotStateDomainService</code> <p>\u673a\u68b0\u81c2\u72b6\u6001\u670d\u52a1\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/tools_application_service.py</code> <pre><code>def __init__(self, kinematic_service: KinematicDomainService, robot_state_service: RobotStateDomainService):\n    \"\"\"\u521d\u59cb\u5316\u5de5\u5177\u5e94\u7528\u670d\u52a1\u3002\n\n    Args:\n        kinematic_service (KinematicDomainService): \u8fd0\u52a8\u5b66\u670d\u52a1\u3002\n        robot_state_service (RobotStateDomainService): \u673a\u68b0\u81c2\u72b6\u6001\u670d\u52a1\u3002\n    \"\"\"\n    super().__init__()\n    self.kinematic_service = kinematic_service\n    self.robot_state_service = robot_state_service\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.ToolsApplicationService.calculate_forward_kinematics","title":"calculate_forward_kinematics","text":"<pre><code>calculate_forward_kinematics(joint_angles: List[float])\n</code></pre> <p>\u8ba1\u7b97\u6b63\u8fd0\u52a8\u5b66\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>joint_angles</code> <code>List[float]</code> <p>6\u4e2a\u5173\u8282\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002</p> \u5fc5\u9700 Emits <p>calculation_result_signal \u5305\u542b\uff1a {     \"quaternion\": [x, y, z, w],     \"position\": [x, y, z],     \"rotation_matrix\": [[...], [...], [...]]  # 3x3 } \u6216\u9519\u8bef\u4fe1\u606f\uff1a {     \"error\": \"\u9519\u8bef\u4fe1\u606f\" }</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/tools_application_service.py</code> <pre><code>def calculate_forward_kinematics(self, joint_angles: List[float]):\n    \"\"\"\u8ba1\u7b97\u6b63\u8fd0\u52a8\u5b66\u3002\n\n    Args:\n        joint_angles (List[float]): 6\u4e2a\u5173\u8282\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002\n\n    Emits:\n        calculation_result_signal \u5305\u542b\uff1a\n        {\n            \"quaternion\": [x, y, z, w],\n            \"position\": [x, y, z],\n            \"rotation_matrix\": [[...], [...], [...]]  # 3x3\n        }\n        \u6216\u9519\u8bef\u4fe1\u606f\uff1a\n        {\n            \"error\": \"\u9519\u8bef\u4fe1\u606f\"\n        }\n    \"\"\"\n    try:\n        # \u83b7\u53d6\u56db\u5143\u6570\u548c\u4f4d\u7f6e\n        quat, pos = self.kinematic_service.get_gripper2base(joint_angles)\n\n        # \u83b7\u53d6\u5b8c\u6574\u53d8\u6362\u77e9\u9635\n        transform_matrix = self.kinematic_service.get_gripper2base_rm(joint_angles)\n        rotation_matrix = transform_matrix[:3, :3]  # \u63d0\u53d6\u65cb\u8f6c\u77e9\u9635\u90e8\u5206\n\n        # \u6784\u5efa\u7ed3\u679c\u5b57\u5178\n        result = {\n            \"quaternion\": quat.tolist(),  # [x, y, z, w]\n            \"position\": pos.tolist(),     # [x, y, z]\n            \"rotation_matrix\": rotation_matrix.tolist()  # 3x3 list\n        }\n\n        # \u53d1\u5c04\u4fe1\u53f7\n        self.calculation_result_signal.emit(result)\n\n    except Exception as e:\n        # \u9519\u8bef\u5904\u7406\n        error_result = {\n            \"error\": f\"\u8ba1\u7b97\u5931\u8d25: {str(e)}\"\n        }\n        self.calculation_result_signal.emit(error_result)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.ToolsApplicationService.get_current_joint_angles","title":"get_current_joint_angles","text":"<pre><code>get_current_joint_angles()\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u673a\u68b0\u81c2\u5173\u8282\u89d2\u5ea6\u3002</p> Emits <p>current_angles_signal: List[float] - 6\u4e2a\u5173\u8282\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/tools_application_service.py</code> <pre><code>def get_current_joint_angles(self):\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u673a\u68b0\u81c2\u5173\u8282\u89d2\u5ea6\u3002\n\n    Emits:\n        current_angles_signal: List[float] - 6\u4e2a\u5173\u8282\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002\n    \"\"\"\n    try:\n        # \u4ece\u673a\u68b0\u81c2\u72b6\u6001\u670d\u52a1\u83b7\u53d6\u5f53\u524d\u89d2\u5ea6\n        current_angles = self.robot_state_service.get_current_angles()\n        # \u53d1\u5c04\u4fe1\u53f7\n        self.current_angles_signal.emit(current_angles)\n    except Exception as e:\n        # \u5982\u679c\u83b7\u53d6\u5931\u8d25\uff0c\u53d1\u9001\u7a7a\u5217\u8868\n        self.current_angles_signal.emit([0.0] * 6)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.ToolsApplicationService.calculate_inverse_kinematics","title":"calculate_inverse_kinematics","text":"<pre><code>calculate_inverse_kinematics(rotation_matrix: List[List[float]], position: List[float], initial_theta: List[float] = None)\n</code></pre> <p>\u8ba1\u7b97\u9006\u8fd0\u52a8\u5b66\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>rotation_matrix</code> <code>List[List[float]]</code> <p>3x3 \u65cb\u8f6c\u77e9\u9635\u3002</p> \u5fc5\u9700 <code>position</code> <code>List[float]</code> <p>[x, y, z] \u4f4d\u7f6e\uff08\u7c73\uff09\u3002</p> \u5fc5\u9700 <code>initial_theta</code> <code>List[float]</code> <p>\u521d\u59cb\u5173\u8282\u89d2\u5ea6\uff08\u7528\u4e8e\u9009\u62e9\u6700\u63a5\u8fd1\u7684\u89e3\uff09. Defaults to None.</p> <code>None</code> Emits <p>inverse_result_signal \u5305\u542b\uff1a {     \"joint_angles\": [\u03b81, \u03b82, \u03b83, \u03b84, \u03b85, \u03b86],  # \u5f27\u5ea6     \"joint_angles_deg\": [\u03b81, \u03b82, \u03b83, \u03b84, \u03b85, \u03b86]  # \u5ea6 } \u6216\u9519\u8bef\u4fe1\u606f\uff1a {     \"error\": \"\u9519\u8bef\u4fe1\u606f\" }</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/services/tools_application_service.py</code> <pre><code>def calculate_inverse_kinematics(self, rotation_matrix: List[List[float]], position: List[float], initial_theta: List[float] = None):\n    \"\"\"\u8ba1\u7b97\u9006\u8fd0\u52a8\u5b66\u3002\n\n    Args:\n        rotation_matrix (List[List[float]]): 3x3 \u65cb\u8f6c\u77e9\u9635\u3002\n        position (List[float]): [x, y, z] \u4f4d\u7f6e\uff08\u7c73\uff09\u3002\n        initial_theta (List[float], optional): \u521d\u59cb\u5173\u8282\u89d2\u5ea6\uff08\u7528\u4e8e\u9009\u62e9\u6700\u63a5\u8fd1\u7684\u89e3\uff09. Defaults to None.\n\n    Emits:\n        inverse_result_signal \u5305\u542b\uff1a\n        {\n            \"joint_angles\": [\u03b81, \u03b82, \u03b83, \u03b84, \u03b85, \u03b86],  # \u5f27\u5ea6\n            \"joint_angles_deg\": [\u03b81, \u03b82, \u03b83, \u03b84, \u03b85, \u03b86]  # \u5ea6\n        }\n        \u6216\u9519\u8bef\u4fe1\u606f\uff1a\n        {\n            \"error\": \"\u9519\u8bef\u4fe1\u606f\"\n        }\n    \"\"\"\n    try:\n        # \u8f6c\u6362\u4e3a numpy \u6570\u7ec4\n        rm = np.array(rotation_matrix)\n        pos = np.array(position)\n\n        # \u5982\u679c\u6ca1\u6709\u63d0\u4f9b\u521d\u59cb\u89d2\u5ea6\uff0c\u4f7f\u7528\u5f53\u524d\u89d2\u5ea6\n        if initial_theta is None:\n            initial_theta = self.robot_state_service.get_current_angles()\n\n        # \u8c03\u7528\u9006\u8fd0\u52a8\u5b66\u6c42\u89e3\n        solution = self.kinematic_service.inverse_kinematic(rm, pos, initial_theta)\n\n        # \u6784\u5efa\u7ed3\u679c\u5b57\u5178\n        result = {\n            \"joint_angles\": solution,  # \u5f27\u5ea6\n            \"joint_angles_deg\": [np.rad2deg(angle) for angle in solution]  # \u5ea6\n        }\n\n        # \u53d1\u5c04\u4fe1\u53f7\n        self.inverse_result_signal.emit(result)\n\n    except Exception as e:\n        # \u9519\u8bef\u5904\u7406\n        error_result = {\n            \"error\": f\"\u9006\u89e3\u8ba1\u7b97\u5931\u8d25: {str(e)}\"\n        }\n        self.inverse_result_signal.emit(error_result)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MessageDisplay","title":"MessageDisplay","text":"<pre><code>MessageDisplay()\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u6d88\u606f\u663e\u793a\u670d\u52a1\u3002</p> <p>\u8d1f\u8d23\u5728\u754c\u9762\u4e0a\u663e\u793a\u65e5\u5fd7\u548c\u72b6\u6001\u6d88\u606f\uff0c\u901a\u8fc7\u4fe1\u53f7\u5206\u53d1\u7ed9 UI \u7ec4\u4ef6\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>message_display_signal</code> <code>pyqtSignal</code> <p>\u6d88\u606f\u663e\u793a\u4fe1\u53f7\uff0c\u643a\u5e26 (\u6d88\u606f\u5185\u5bb9, \u6d88\u606f\u7c7b\u578b)\u3002</p> <code>clear_requested</code> <code>pyqtSignal</code> <p>\u6e05\u9664\u6d88\u606f\u8bf7\u6c42\u4fe1\u53f7\u3002</p> <p>\u521d\u59cb\u5316\u6d88\u606f\u663e\u793a\u670d\u52a1\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/commands/message_display.py</code> <pre><code>def __init__(self):\n    \"\"\"\u521d\u59cb\u5316\u6d88\u606f\u663e\u793a\u670d\u52a1\u3002\"\"\"\n    super().__init__()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MessageDisplay.display_message","title":"display_message","text":"<pre><code>display_message(message: str, message_type: str) -&gt; None\n</code></pre> <p>\u663e\u793a\u4e00\u6761\u6d88\u606f\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>message</code> <code>str</code> <p>\u6d88\u606f\u5185\u5bb9\u3002</p> \u5fc5\u9700 <code>message_type</code> <code>str</code> <p>\u6d88\u606f\u7c7b\u578b\uff08\u5982 \"info\", \"error\", \"warning\"\uff09\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/commands/message_display.py</code> <pre><code>def display_message(self, message: str, message_type: str) -&gt; None:\n    \"\"\"\u663e\u793a\u4e00\u6761\u6d88\u606f\u3002\n\n    Args:\n        message (str): \u6d88\u606f\u5185\u5bb9\u3002\n        message_type (str): \u6d88\u606f\u7c7b\u578b\uff08\u5982 \"info\", \"error\", \"warning\"\uff09\u3002\n    \"\"\"\n    self.message_display_signal.emit(message, message_type)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MessageDisplay.clear_messages","title":"clear_messages","text":"<pre><code>clear_messages() -&gt; None\n</code></pre> <p>\u6e05\u9664\u6240\u6709\u6d88\u606f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/commands/message_display.py</code> <pre><code>def clear_messages(self) -&gt; None:\n    \"\"\"\u6e05\u9664\u6240\u6709\u6d88\u606f\u3002\"\"\"\n    self.clear_requested.emit()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionListener","title":"MotionListener","text":"<pre><code>MotionListener(motion_runner: MotionRunner, message_display: MessageDisplay)\n</code></pre> <p>\u8fd0\u52a8\u6d88\u606f\u76d1\u542c\u5668\u3002</p> <p>\u8d1f\u8d23\u76d1\u542c\u8fd0\u52a8\u6267\u884c\u5668\u53d1\u9001\u7684\u6d88\u606f\uff0c\u89e3\u7801\u4f4d\u7f6e\u6570\u636e\u5e76\u663e\u793a\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>motion_runner</code> <code>MotionRunner</code> <p>\u8fd0\u52a8\u6267\u884c\u5668\u3002</p> <code>message_display</code> <code>MessageDisplay</code> <p>\u6d88\u606f\u663e\u793a\u670d\u52a1\u3002</p> <code>robot_utils</code> <code>RobotUtils</code> <p>\u673a\u5668\u4eba\u5de5\u5177\u7c7b\uff0c\u7528\u4e8e\u5750\u6807\u8f6c\u6362\u3002</p> <p>\u521d\u59cb\u5316\u8fd0\u52a8\u76d1\u542c\u5668\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>motion_runner</code> <code>MotionRunner</code> <p>\u8fd0\u52a8\u6267\u884c\u5668\u3002</p> \u5fc5\u9700 <code>message_display</code> <code>MessageDisplay</code> <p>\u6d88\u606f\u663e\u793a\u670d\u52a1\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/listener/motion_listener.py</code> <pre><code>def __init__(self, motion_runner: MotionRunner, message_display: MessageDisplay):\n    \"\"\"\u521d\u59cb\u5316\u8fd0\u52a8\u76d1\u542c\u5668\u3002\n\n    Args:\n        motion_runner (MotionRunner): \u8fd0\u52a8\u6267\u884c\u5668\u3002\n        message_display (MessageDisplay): \u6d88\u606f\u663e\u793a\u670d\u52a1\u3002\n    \"\"\"\n    self.motion_runner = motion_runner\n    self.message_display = message_display\n    self.robot_utils = RobotUtils()\n    self._connect_signals()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionListener.handle_motion_msg","title":"handle_motion_msg","text":"<pre><code>handle_motion_msg(message, message_type)\n</code></pre> <p>\u5904\u7406\u8fd0\u52a8\u6d88\u606f\uff0c\u624b\u52a8\u89e3\u6790\u4f4d\u7f6e\u6570\u636e\u3002</p> <p>\u6d88\u606f\u683c\u5f0f\uff1aAA55 + control(1) + mode(1) + joint_angles(24) + ... + CRC(2) + 0D0A \u7f16\u7801\u8fc7\u7a0b\uff1a\u5f27\u5ea6 -&gt; radian2position -&gt; \u4f4d\u7f6e\u503c(32\u4f4d) -&gt; \u5927\u7aef\u5e8f16\u8fdb\u5236</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>message</code> <code>str</code> <p>\u539f\u59cb16\u8fdb\u5236\u6d88\u606f\u5b57\u7b26\u4e32\u3002</p> \u5fc5\u9700 <code>message_type</code> <code>str</code> <p>\u6d88\u606f\u7c7b\u578b\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/application/listener/motion_listener.py</code> <pre><code>def handle_motion_msg(self, message, message_type):\n    \"\"\"\u5904\u7406\u8fd0\u52a8\u6d88\u606f\uff0c\u624b\u52a8\u89e3\u6790\u4f4d\u7f6e\u6570\u636e\u3002\n\n    \u6d88\u606f\u683c\u5f0f\uff1aAA55 + control(1) + mode(1) + joint_angles(24) + ... + CRC(2) + 0D0A\n    \u7f16\u7801\u8fc7\u7a0b\uff1a\u5f27\u5ea6 -&gt; radian2position -&gt; \u4f4d\u7f6e\u503c(32\u4f4d) -&gt; \u5927\u7aef\u5e8f16\u8fdb\u5236\n\n    Args:\n        message (str): \u539f\u59cb16\u8fdb\u5236\u6d88\u606f\u5b57\u7b26\u4e32\u3002\n        message_type (str): \u6d88\u606f\u7c7b\u578b\u3002\n    \"\"\"\n    try:\n        # \u624b\u52a8\u89e3\u6790\u4f4d\u7f6e\u6570\u636e\n        joint_angles = self._extract_joint_angles(message)\n\n        if joint_angles:\n            # \u683c\u5f0f\u5316\u663e\u793a\u5f27\u5ea6\u503c\n            angles_str = \", \".join([f\"{angle:.4f}\" for angle in joint_angles])\n            display_text = f\"[{message_type}] \u4f4d\u7f6e(\u5f27\u5ea6): [{angles_str}]\"\n            self.message_display.display_message(display_text, message_type)\n\n            # \u540c\u65f6\u663e\u793a\u539f\u59cb16\u8fdb\u5236\u6570\u636e\n            raw_text = f\"[{message_type}] \u539f\u59cb\u6570\u636e: {message}\"\n            self.message_display.display_message(raw_text, message_type)\n        else:\n            # \u65e0\u6cd5\u89e3\u6790\uff0c\u53ea\u663e\u793a\u539f\u59cb\u6d88\u606f\n            self.message_display.display_message(str(message), message_type)\n\n    except Exception as e:\n        # \u89e3\u6790\u5931\u8d25\uff0c\u663e\u793a\u539f\u59cb\u6d88\u606f\n        self.message_display.display_message(str(message), message_type)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.BaseViewModel","title":"BaseViewModel","text":"<pre><code>BaseViewModel(parent=None)\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u57fa\u7840\u89c6\u56fe\u6a21\u578b\u7c7b\u3002</p> <p>\u6240\u6709\u89c6\u56fe\u6a21\u578b\u7684\u57fa\u7c7b\uff0c\u63d0\u4f9b\u901a\u7528\u7684\u4fe1\u53f7\u548c\u6e05\u7406\u63a5\u53e3\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>connection_status_changed</code> <code>pyqtSignal</code> <p>\u8fde\u63a5\u72b6\u6001\u53d8\u66f4\u4fe1\u53f7\uff0c\u643a\u5e26 bool \u72b6\u6001\u3002</p> <p>\u521d\u59cb\u5316\u57fa\u7840\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>parent</code> <code>QObject</code> <p>\u7236\u5bf9\u8c61. Defaults to None.</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/base_view_model.py</code> <pre><code>def __init__(self, parent=None):\n    \"\"\"\u521d\u59cb\u5316\u57fa\u7840\u89c6\u56fe\u6a21\u578b\u3002\n\n    Args:\n        parent (QObject, optional): \u7236\u5bf9\u8c61. Defaults to None.\n    \"\"\"\n    super().__init__(parent)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.BaseViewModel.cleanup","title":"cleanup","text":"<pre><code>cleanup()\n</code></pre> <p>\u6e05\u7406\u8d44\u6e90\u3002</p> <p>\u5b50\u7c7b\u5e94\u91cd\u5199\u6b64\u65b9\u6cd5\u4ee5\u91ca\u653e\u8d44\u6e90\uff08\u5982\u5173\u95ed\u8fde\u63a5\u3001\u505c\u6b62\u5b9a\u65f6\u5668\u7b49\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/base_view_model.py</code> <pre><code>def cleanup(self):\n    \"\"\"\u6e05\u7406\u8d44\u6e90\u3002\n\n    \u5b50\u7c7b\u5e94\u91cd\u5199\u6b64\u65b9\u6cd5\u4ee5\u91ca\u653e\u8d44\u6e90\uff08\u5982\u5173\u95ed\u8fde\u63a5\u3001\u505c\u6b62\u5b9a\u65f6\u5668\u7b49\uff09\u3002\n    \"\"\"\n    pass \n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MainViewModel","title":"MainViewModel","text":"<pre><code>MainViewModel(serial_vm: SerialViewModel, display_vm: DisplayViewModel, control_vm: ControlViewModel, status_vm: StatusViewModel, effector_vm: EffectorViewModel, trajectory_vm: TrajectoryViewModel, dynamics_vm: DynamicsViewModel, camera_vm: CameraViewModel, motion_planning_vm: MotionPlanningViewModel, tools_vm: ToolsViewModel, parent=None)\n</code></pre> <p>               Bases: <code>BaseViewModel</code></p> <p>\u4e3b\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u6574\u5408\u6240\u6709\u5b50\u89c6\u56fe\u6a21\u578b\uff0c\u5e76\u7ba1\u7406\u5b83\u4eec\u4e4b\u95f4\u7684\u4fe1\u53f7\u4ea4\u4e92\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>connection_status_changed</code> <code>pyqtSignal</code> <p>\u4e32\u53e3\u8fde\u63a5\u72b6\u6001\u4fe1\u53f7\u3002</p> <code>status_message_changed</code> <code>pyqtSignal</code> <p>\u72b6\u6001\u6d88\u606f\u53d8\u66f4\u4fe1\u53f7\u3002</p> <code>progress_changed</code> <code>pyqtSignal</code> <p>\u8fdb\u5ea6\u53d8\u66f4\u4fe1\u53f7\u3002</p> <code>serial_vm</code> <code>SerialViewModel</code> <p>\u4e32\u53e3\u89c6\u56fe\u6a21\u578b\u3002</p> <code>display_vm</code> <code>DisplayViewModel</code> <p>\u663e\u793a\u89c6\u56fe\u6a21\u578b\u3002</p> <code>control_vm</code> <code>ControlViewModel</code> <p>\u63a7\u5236\u89c6\u56fe\u6a21\u578b\u3002</p> <code>status_vm</code> <code>StatusViewModel</code> <p>\u72b6\u6001\u89c6\u56fe\u6a21\u578b\u3002</p> <code>effector_vm</code> <code>EffectorViewModel</code> <p>\u672b\u7aef\u6267\u884c\u5668\u89c6\u56fe\u6a21\u578b\u3002</p> <code>trajectory_vm</code> <code>TrajectoryViewModel</code> <p>\u8f68\u8ff9\u89c6\u56fe\u6a21\u578b\u3002</p> <code>dynamics_vm</code> <code>DynamicsViewModel</code> <p>\u52a8\u529b\u5b66\u89c6\u56fe\u6a21\u578b\u3002</p> <code>camera_vm</code> <code>CameraViewModel</code> <p>\u76f8\u673a\u89c6\u56fe\u6a21\u578b\u3002</p> <code>motion_planning_vm</code> <code>MotionPlanningViewModel</code> <p>\u8fd0\u52a8\u89c4\u5212\u89c6\u56fe\u6a21\u578b\u3002</p> <code>tools_vm</code> <code>ToolsViewModel</code> <p>\u5de5\u5177\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u521d\u59cb\u5316\u4e3b\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>serial_vm</code> <code>SerialViewModel</code> <p>\u6ce8\u5165\u7684\u4e32\u53e3 VM\u3002</p> \u5fc5\u9700 <code>display_vm</code> <code>DisplayViewModel</code> <p>\u6ce8\u5165\u7684\u663e\u793a VM\u3002</p> \u5fc5\u9700 <code>control_vm</code> <code>ControlViewModel</code> <p>\u6ce8\u5165\u7684\u63a7\u5236 VM\u3002</p> \u5fc5\u9700 <code>status_vm</code> <code>StatusViewModel</code> <p>\u6ce8\u5165\u7684\u72b6\u6001 VM\u3002</p> \u5fc5\u9700 <code>effector_vm</code> <code>EffectorViewModel</code> <p>\u6ce8\u5165\u7684\u672b\u7aef VM\u3002</p> \u5fc5\u9700 <code>trajectory_vm</code> <code>TrajectoryViewModel</code> <p>\u6ce8\u5165\u7684\u8f68\u8ff9 VM\u3002</p> \u5fc5\u9700 <code>dynamics_vm</code> <code>DynamicsViewModel</code> <p>\u6ce8\u5165\u7684\u52a8\u529b\u5b66 VM\u3002</p> \u5fc5\u9700 <code>camera_vm</code> <code>CameraViewModel</code> <p>\u6ce8\u5165\u7684\u76f8\u673a VM\u3002</p> \u5fc5\u9700 <code>motion_planning_vm</code> <code>MotionPlanningViewModel</code> <p>\u6ce8\u5165\u7684\u89c4\u5212 VM\u3002</p> \u5fc5\u9700 <code>tools_vm</code> <code>ToolsViewModel</code> <p>\u6ce8\u5165\u7684\u5de5\u5177 VM\u3002</p> \u5fc5\u9700 <code>parent</code> <code>QObject</code> <p>\u7236\u5bf9\u8c61. Defaults to None.</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/main_view_model.py</code> <pre><code>def __init__(\n    self, \n    serial_vm: SerialViewModel, \n    display_vm: DisplayViewModel, \n    control_vm: ControlViewModel, \n    status_vm: StatusViewModel,\n    effector_vm: EffectorViewModel,\n    trajectory_vm: TrajectoryViewModel,\n    dynamics_vm: DynamicsViewModel,\n    camera_vm: CameraViewModel,\n    motion_planning_vm: MotionPlanningViewModel,\n    tools_vm: ToolsViewModel,\n    parent=None\n):\n    \"\"\"\u521d\u59cb\u5316\u4e3b\u89c6\u56fe\u6a21\u578b\u3002\n\n    Args:\n        serial_vm (SerialViewModel): \u6ce8\u5165\u7684\u4e32\u53e3 VM\u3002\n        display_vm (DisplayViewModel): \u6ce8\u5165\u7684\u663e\u793a VM\u3002\n        control_vm (ControlViewModel): \u6ce8\u5165\u7684\u63a7\u5236 VM\u3002\n        status_vm (StatusViewModel): \u6ce8\u5165\u7684\u72b6\u6001 VM\u3002\n        effector_vm (EffectorViewModel): \u6ce8\u5165\u7684\u672b\u7aef VM\u3002\n        trajectory_vm (TrajectoryViewModel): \u6ce8\u5165\u7684\u8f68\u8ff9 VM\u3002\n        dynamics_vm (DynamicsViewModel): \u6ce8\u5165\u7684\u52a8\u529b\u5b66 VM\u3002\n        camera_vm (CameraViewModel): \u6ce8\u5165\u7684\u76f8\u673a VM\u3002\n        motion_planning_vm (MotionPlanningViewModel): \u6ce8\u5165\u7684\u89c4\u5212 VM\u3002\n        tools_vm (ToolsViewModel): \u6ce8\u5165\u7684\u5de5\u5177 VM\u3002\n        parent (QObject, optional): \u7236\u5bf9\u8c61. Defaults to None.\n    \"\"\"\n    super().__init__(parent)\n    self.serial_vm = serial_vm\n    self.display_vm = display_vm\n    self.control_vm = control_vm\n    self.status_vm = status_vm\n    self.effector_vm = effector_vm\n    self.trajectory_vm = trajectory_vm\n    self.dynamics_vm = dynamics_vm\n    self.camera_vm = camera_vm\n    self.motion_planning_vm = motion_planning_vm\n    self.tools_vm = tools_vm\n\n    # \u8fde\u63a5\u8fde\u63a5\u72b6\u6001\u4fe1\u53f7\n    self._connect_status_update_signals()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MainViewModel.cleanup","title":"cleanup","text":"<pre><code>cleanup()\n</code></pre> <p>\u6e05\u7406\u8d44\u6e90\u3002</p> <p>\u8c03\u7528\u6240\u6709\u5b50 ViewModel \u7684 cleanup \u65b9\u6cd5\uff0c\u786e\u4fdd\u8d44\u6e90\u91ca\u653e\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/main_view_model.py</code> <pre><code>def cleanup(self):\n    \"\"\"\u6e05\u7406\u8d44\u6e90\u3002\n\n    \u8c03\u7528\u6240\u6709\u5b50 ViewModel \u7684 cleanup \u65b9\u6cd5\uff0c\u786e\u4fdd\u8d44\u6e90\u91ca\u653e\u3002\n    \"\"\"\n    # \u6e05\u7406\u6240\u6709\u5b50ViewModels\n    for vm_attr in ['serial_vm', 'display_vm', 'control_vm', 'status_vm',\n                   'effector_vm', 'trajectory_vm', 'dynamics_vm', 'camera_vm',\n                   'motion_planning_vm', 'tools_vm']:\n        vm = getattr(self, vm_attr, None)\n        if vm and hasattr(vm, 'cleanup'):\n            try:\n                vm.cleanup()\n            except Exception as e:\n                pass\n\n    super().cleanup() \n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialViewModel","title":"SerialViewModel","text":"<pre><code>SerialViewModel(serial_service: SerialApplicationService, command_hub_service: CommandHubService, parent=None)\n</code></pre> <p>               Bases: <code>BaseViewModel</code></p> <p>\u4e32\u53e3\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u7eaf\u4fe1\u53f7\u8f6c\u53d1\u5c42\uff0c\u4e0d\u5305\u542b\u4e1a\u52a1\u903b\u8f91\uff0c\u8d1f\u8d23 UI \u4e0e\u4e32\u53e3\u670d\u52a1\u7684\u4ea4\u4e92\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>port_list_updated</code> <code>pyqtSignal</code> <p>\u7aef\u53e3\u5217\u8868\u66f4\u65b0\u4fe1\u53f7\uff0c\u643a\u5e26\u7aef\u53e3\u5217\u8868\u3002</p> <code>serial_service</code> <code>SerialApplicationService</code> <p>\u4e32\u53e3\u5e94\u7528\u670d\u52a1\u3002</p> <code>command_hub_service</code> <code>CommandHubService</code> <p>\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002</p> <p>\u521d\u59cb\u5316\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>serial_service</code> <code>SerialApplicationService</code> <p>\u4e32\u53e3\u5e94\u7528\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>command_hub_service</code> <code>CommandHubService</code> <p>\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>parent</code> <code>QObject</code> <p>\u7236\u5bf9\u8c61. Defaults to None.</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/serial_view_model.py</code> <pre><code>def __init__(self, serial_service: SerialApplicationService, command_hub_service: CommandHubService, parent=None):\n    \"\"\"\u521d\u59cb\u5316\u89c6\u56fe\u6a21\u578b\u3002\n\n    Args:\n        serial_service (SerialApplicationService): \u4e32\u53e3\u5e94\u7528\u670d\u52a1\u3002\n        command_hub_service (CommandHubService): \u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002\n        parent (QObject, optional): \u7236\u5bf9\u8c61. Defaults to None.\n    \"\"\"\n    super().__init__(parent)\n\n    self.serial_service = serial_service\n    self.command_hub_service = command_hub_service\n    self._connect_service_signals()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialViewModel.refresh_ports","title":"refresh_ports","text":"<pre><code>refresh_ports() -&gt; None\n</code></pre> <p>\u5237\u65b0\u7aef\u53e3\u5217\u8868\u547d\u4ee4 - \u76f4\u63a5\u8f6c\u53d1\u5230Service\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/serial_view_model.py</code> <pre><code>def refresh_ports(self) -&gt; None:\n    \"\"\"\u5237\u65b0\u7aef\u53e3\u5217\u8868\u547d\u4ee4 - \u76f4\u63a5\u8f6c\u53d1\u5230Service\u3002\"\"\"\n    self.serial_service.refresh_ports()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialViewModel.connect_serial","title":"connect_serial","text":"<pre><code>connect_serial(port: str, config: Dict[str, Any]) -&gt; None\n</code></pre> <p>\u8fde\u63a5\u4e32\u53e3\u547d\u4ee4 - \u76f4\u63a5\u8f6c\u53d1\u5230Service\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>port</code> <code>str</code> <p>\u7aef\u53e3\u540d\u79f0\u3002</p> \u5fc5\u9700 <code>config</code> <code>Dict[str, Any]</code> <p>\u914d\u7f6e\u53c2\u6570\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/serial_view_model.py</code> <pre><code>def connect_serial(self, port: str, config: Dict[str, Any]) -&gt; None:\n    \"\"\"\u8fde\u63a5\u4e32\u53e3\u547d\u4ee4 - \u76f4\u63a5\u8f6c\u53d1\u5230Service\u3002\n\n    Args:\n        port (str): \u7aef\u53e3\u540d\u79f0\u3002\n        config (Dict[str, Any]): \u914d\u7f6e\u53c2\u6570\u3002\n    \"\"\"\n    self.serial_service.connect_serial(port, config)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialViewModel.disconnect_serial","title":"disconnect_serial","text":"<pre><code>disconnect_serial() -&gt; None\n</code></pre> <p>\u65ad\u5f00\u8fde\u63a5\u547d\u4ee4 - \u76f4\u63a5\u8f6c\u53d1\u5230Service\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/serial_view_model.py</code> <pre><code>def disconnect_serial(self) -&gt; None:\n    \"\"\"\u65ad\u5f00\u8fde\u63a5\u547d\u4ee4 - \u76f4\u63a5\u8f6c\u53d1\u5230Service\u3002\"\"\"\n    self.serial_service.disconnect_serial()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialViewModel.get_available_ports","title":"get_available_ports","text":"<pre><code>get_available_ports() -&gt; List[str]\n</code></pre> <p>\u83b7\u53d6\u53ef\u7528\u7aef\u53e3\u5217\u8868 - \u59d4\u6258\u7ed9Service\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>List[str]: \u7aef\u53e3\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/serial_view_model.py</code> <pre><code>def get_available_ports(self) -&gt; List[str]:\n    \"\"\"\u83b7\u53d6\u53ef\u7528\u7aef\u53e3\u5217\u8868 - \u59d4\u6258\u7ed9Service\u3002\n\n    Returns:\n        List[str]: \u7aef\u53e3\u5217\u8868\u3002\n    \"\"\"\n    return self.serial_service.get_available_ports()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialViewModel.get_current_port","title":"get_current_port","text":"<pre><code>get_current_port() -&gt; Optional[str]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u7684\u7aef\u53e3 - \u59d4\u6258\u7ed9Service\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[str]</code> <p>Optional[str]: \u7aef\u53e3\u540d\u79f0\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/serial_view_model.py</code> <pre><code>def get_current_port(self) -&gt; Optional[str]:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u7684\u7aef\u53e3 - \u59d4\u6258\u7ed9Service\u3002\n\n    Returns:\n        Optional[str]: \u7aef\u53e3\u540d\u79f0\u3002\n    \"\"\"\n    return self.serial_service.get_current_port()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialViewModel.get_connection_status","title":"get_connection_status","text":"<pre><code>get_connection_status() -&gt; bool\n</code></pre> <p>\u83b7\u53d6\u8fde\u63a5\u72b6\u6001 - \u59d4\u6258\u7ed9Service\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u5df2\u8fde\u63a5\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/serial_view_model.py</code> <pre><code>def get_connection_status(self) -&gt; bool:\n    \"\"\"\u83b7\u53d6\u8fde\u63a5\u72b6\u6001 - \u59d4\u6258\u7ed9Service\u3002\n\n    Returns:\n        bool: \u662f\u5426\u5df2\u8fde\u63a5\u3002\n    \"\"\"\n    return self.serial_service.is_connected()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialViewModel.get_port_info","title":"get_port_info","text":"<pre><code>get_port_info(port_name: str) -&gt; Optional[Dict[str, str]]\n</code></pre> <p>\u83b7\u53d6\u7aef\u53e3\u4fe1\u606f - \u59d4\u6258\u7ed9Service\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>port_name</code> <code>str</code> <p>\u7aef\u53e3\u540d\u79f0\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[Dict[str, str]]</code> <p>Optional[Dict[str, str]]: \u7aef\u53e3\u4fe1\u606f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/serial_view_model.py</code> <pre><code>def get_port_info(self, port_name: str) -&gt; Optional[Dict[str, str]]:\n    \"\"\"\u83b7\u53d6\u7aef\u53e3\u4fe1\u606f - \u59d4\u6258\u7ed9Service\u3002\n\n    Args:\n        port_name (str): \u7aef\u53e3\u540d\u79f0\u3002\n\n    Returns:\n        Optional[Dict[str, str]]: \u7aef\u53e3\u4fe1\u606f\u3002\n    \"\"\"\n    return self.serial_service.get_port_info(port_name)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialViewModel.cleanup","title":"cleanup","text":"<pre><code>cleanup() -&gt; None\n</code></pre> <p>\u6e05\u7406\u89c6\u56fe\u6a21\u578b - \u65ad\u5f00\u4fe1\u53f7\u8fde\u63a5\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/serial_view_model.py</code> <pre><code>def cleanup(self) -&gt; None:\n    \"\"\"\u6e05\u7406\u89c6\u56fe\u6a21\u578b - \u65ad\u5f00\u4fe1\u53f7\u8fde\u63a5\u3002\"\"\"\n    self._disconnect_service_signals()\n    super().cleanup() \n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.DisplayViewModel","title":"DisplayViewModel","text":"<pre><code>DisplayViewModel(message_display: MessageDisplay, parent=None)\n</code></pre> <p>               Bases: <code>BaseViewModel</code></p> <p>\u663e\u793a\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u4f5c\u4e3a\u6d88\u606f\u663e\u793a\u7684\u4e2d\u5fc3\u5206\u53d1\u5668\uff0c\u5176\u4ed6\u670d\u52a1\u8c03\u7528\u5b83\u7684\u65b9\u6cd5\u6765\u663e\u793a\u6d88\u606f\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>message_display_signal</code> <code>pyqtSignal</code> <p>\u6d88\u606f\u663e\u793a\u4fe1\u53f7\uff0c\u643a\u5e26 (\u6d88\u606f\u5185\u5bb9, \u6d88\u606f\u7c7b\u578b)\u3002</p> <code>clear_requested</code> <code>pyqtSignal</code> <p>\u6e05\u9664\u6d88\u606f\u8bf7\u6c42\u4fe1\u53f7\u3002</p> <code>message_display</code> <code>MessageDisplay</code> <p>\u6d88\u606f\u663e\u793a\u670d\u52a1\u3002</p> <p>\u521d\u59cb\u5316\u663e\u793a\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>message_display</code> <code>MessageDisplay</code> <p>\u6d88\u606f\u663e\u793a\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>parent</code> <code>QObject</code> <p>\u7236\u5bf9\u8c61. Defaults to None.</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/display_view_model.py</code> <pre><code>def __init__(self, message_display: MessageDisplay, parent=None):\n    \"\"\"\u521d\u59cb\u5316\u663e\u793a\u89c6\u56fe\u6a21\u578b\u3002\n\n    Args:\n        message_display (MessageDisplay): \u6d88\u606f\u663e\u793a\u670d\u52a1\u3002\n        parent (QObject, optional): \u7236\u5bf9\u8c61. Defaults to None.\n    \"\"\"\n    super().__init__(parent)\n    self.message_display = message_display\n    self.message_display.message_display_signal.connect(self.message_display_signal.emit)\n    self.message_display.clear_requested.connect(self.clear_requested.emit)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.DisplayViewModel.clear_messages","title":"clear_messages","text":"<pre><code>clear_messages() -&gt; None\n</code></pre> <p>\u6e05\u9664\u6240\u6709\u6d88\u606f\u3002</p> <p>\u53d1\u9001\u6e05\u9664\u6d88\u606f\u4fe1\u53f7\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/display_view_model.py</code> <pre><code>def clear_messages(self) -&gt; None:\n    \"\"\"\u6e05\u9664\u6240\u6709\u6d88\u606f\u3002\n\n    \u53d1\u9001\u6e05\u9664\u6d88\u606f\u4fe1\u53f7\u3002\n    \"\"\"\n    # \u53d1\u9001\u6e05\u9664\u6d88\u606f\u4fe1\u53f7\n    self.clear_requested.emit()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.DisplayViewModel.cleanup","title":"cleanup","text":"<pre><code>cleanup() -&gt; None\n</code></pre> <p>\u6e05\u7406\u8d44\u6e90\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/display_view_model.py</code> <pre><code>def cleanup(self) -&gt; None:\n    \"\"\"\u6e05\u7406\u8d44\u6e90\u3002\"\"\"\n    super().cleanup() \n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.ControlViewModel","title":"ControlViewModel","text":"<pre><code>ControlViewModel(command_hub_service: CommandHubService, parent=None)\n</code></pre> <p>               Bases: <code>BaseViewModel</code></p> <p>\u63a7\u5236\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u8d1f\u8d23\u5904\u7406\u7528\u6237\u8f93\u5165\u7684\u63a7\u5236\u547d\u4ee4\uff0c\u5e76\u5206\u53d1\u5230\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>command_hub_service</code> <code>CommandHubService</code> <p>\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002</p> <p>\u521d\u59cb\u5316\u63a7\u5236\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>command_hub_service</code> <code>CommandHubService</code> <p>\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>parent</code> <code>QObject</code> <p>\u7236\u5bf9\u8c61. Defaults to None.</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/control_view_model.py</code> <pre><code>def __init__(self, command_hub_service: CommandHubService, parent=None):\n    \"\"\"\u521d\u59cb\u5316\u63a7\u5236\u89c6\u56fe\u6a21\u578b\u3002\n\n    Args:\n        command_hub_service (CommandHubService): \u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002\n        parent (QObject, optional): \u7236\u5bf9\u8c61. Defaults to None.\n    \"\"\"\n    super().__init__(parent)\n    self.command_hub_service = command_hub_service\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.ControlViewModel.send_command","title":"send_command","text":"<pre><code>send_command(config_dict: dict)\n</code></pre> <p>\u53d1\u9001\u63a7\u5236\u547d\u4ee4\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config_dict</code> <code>dict</code> <p>\u547d\u4ee4\u914d\u7f6e\u5b57\u5178\uff0c\u5305\u542b\u63a7\u5236\u53c2\u6570\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/control_view_model.py</code> <pre><code>def send_command(self, config_dict: dict):\n    \"\"\"\u53d1\u9001\u63a7\u5236\u547d\u4ee4\u3002\n\n    Args:\n        config_dict (dict): \u547d\u4ee4\u914d\u7f6e\u5b57\u5178\uff0c\u5305\u542b\u63a7\u5236\u53c2\u6570\u3002\n    \"\"\"\n    self.command_hub_service.command_distribution(config_dict)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.StatusViewModel","title":"StatusViewModel","text":"<pre><code>StatusViewModel(robot_state_service: RobotStateDomainService, parent=None)\n</code></pre> <p>               Bases: <code>BaseViewModel</code></p> <p>\u72b6\u6001\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u7ba1\u7406\u673a\u5668\u4eba\u72b6\u6001\u663e\u793a\uff0c\u8ba2\u9605 RobotStateDomainService \u7684\u72b6\u6001\u66f4\u65b0\uff0c\u4e0d\u518d\u81ea\u5df1\u7ef4\u62a4\u72b6\u6001\u3002</p> <p>\u804c\u8d23\uff1a 1. \u8ba2\u9605 RobotStateDomainService \u7684\u72b6\u6001\u66f4\u65b0 2. \u8f6c\u6362\u6570\u636e\u683c\u5f0f\uff08\u8f6c\u6362\u4e3a dict \u4f9b UI \u7ec4\u4ef6\u4f7f\u7528\uff09 3. \u53d1\u5c04\u4fe1\u53f7\u7ed9 UI \u7ec4\u4ef6</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>status_updated</code> <code>pyqtSignal</code> <p>\u72b6\u6001\u66f4\u65b0\u4fe1\u53f7\uff0c\u643a\u5e26\u72b6\u6001\u6570\u636e\u5b57\u5178\u3002</p> <code>robot_state_service</code> <code>RobotStateDomainService</code> <p>\u673a\u68b0\u81c2\u72b6\u6001\u670d\u52a1\u3002</p> <p>\u521d\u59cb\u5316\u72b6\u6001\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>robot_state_service</code> <code>RobotStateDomainService</code> <p>\u673a\u68b0\u81c2\u72b6\u6001\u670d\u52a1\uff08\u4f9d\u8d56\u6ce8\u5165\uff09\u3002</p> \u5fc5\u9700 <code>parent</code> <code>QObject</code> <p>\u7236\u5bf9\u8c61. Defaults to None.</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/status_view_model.py</code> <pre><code>def __init__(self, robot_state_service: RobotStateDomainService, parent=None):\n    \"\"\"\u521d\u59cb\u5316\u72b6\u6001\u89c6\u56fe\u6a21\u578b\u3002\n\n    Args:\n        robot_state_service (RobotStateDomainService): \u673a\u68b0\u81c2\u72b6\u6001\u670d\u52a1\uff08\u4f9d\u8d56\u6ce8\u5165\uff09\u3002\n        parent (QObject, optional): \u7236\u5bf9\u8c61. Defaults to None.\n    \"\"\"\n    super().__init__(parent)\n    self.robot_state_service = robot_state_service\n\n    # \u8ba2\u9605\u72b6\u6001\u670d\u52a1\u7684\u4fe1\u53f7\n    self.robot_state_service.state_updated.connect(self._on_state_updated)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.StatusViewModel.get_position_string","title":"get_position_string","text":"<pre><code>get_position_string() -&gt; str\n</code></pre> <p>\u83b7\u53d6\u4f4d\u7f6e\u4fe1\u606f\u7684\u5b57\u7b26\u4e32\u8868\u793a\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>str</code> <code>str</code> <p>\u4f4d\u7f6e\u5b57\u7b26\u4e32\uff0c\u5982 \"[0.50, -1.20, 0.30, 0.00, 0.00, 0.00]\"\u3002\u5982\u679c\u65e0\u6570\u636e\u8fd4\u56de \"--\"\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/status_view_model.py</code> <pre><code>def get_position_string(self) -&gt; str:\n    \"\"\"\u83b7\u53d6\u4f4d\u7f6e\u4fe1\u606f\u7684\u5b57\u7b26\u4e32\u8868\u793a\u3002\n\n    Returns:\n        str: \u4f4d\u7f6e\u5b57\u7b26\u4e32\uff0c\u5982 \"[0.50, -1.20, 0.30, 0.00, 0.00, 0.00]\"\u3002\u5982\u679c\u65e0\u6570\u636e\u8fd4\u56de \"--\"\u3002\n    \"\"\"\n    snapshot = self.robot_state_service.get_current_state()\n    if snapshot:\n        positions = snapshot.joint_angles\n        return f\"[{', '.join(f'{pos:.3f}' for pos in positions[:6])}]\"\n    return \"--\"\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.StatusViewModel.get_status_summary","title":"get_status_summary","text":"<pre><code>get_status_summary() -&gt; str\n</code></pre> <p>\u83b7\u53d6\u72b6\u6001\u6458\u8981\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>str</code> <code>str</code> <p>\u72b6\u6001\u6458\u8981\u5b57\u7b26\u4e32\uff0c\u5982 \"CMD:0x06 | MODE:0x08 | STA:0x01\"\u3002\u5982\u679c\u65e0\u6570\u636e\u8fd4\u56de \"\u65e0\u72b6\u6001\u6570\u636e\"\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/status_view_model.py</code> <pre><code>def get_status_summary(self) -&gt; str:\n    \"\"\"\u83b7\u53d6\u72b6\u6001\u6458\u8981\u3002\n\n    Returns:\n        str: \u72b6\u6001\u6458\u8981\u5b57\u7b26\u4e32\uff0c\u5982 \"CMD:0x06 | MODE:0x08 | STA:0x01\"\u3002\u5982\u679c\u65e0\u6570\u636e\u8fd4\u56de \"\u65e0\u72b6\u6001\u6570\u636e\"\u3002\n    \"\"\"\n    snapshot = self.robot_state_service.get_current_state()\n    if not snapshot:\n        return \"\u65e0\u72b6\u6001\u6570\u636e\"\n\n    summary = []\n    summary.append(f\"CMD:0x{snapshot.control:02X}\")\n    summary.append(f\"MODE:0x{snapshot.mode:02X}\")\n    summary.append(f\"STA:0x{snapshot.init_status:02X}\")\n\n    # \u68c0\u67e5\u9519\u8bef\n    if any(err != 0 for err in snapshot.errors):\n        summary.append(f\"ERR:\u6709\u9519\u8bef\")\n\n    return \" | \".join(summary)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.EffectorViewModel","title":"EffectorViewModel","text":"<pre><code>EffectorViewModel(command_hub_service: CommandHubService, parent=None)\n</code></pre> <p>               Bases: <code>BaseViewModel</code></p> <p>\u672b\u7aef\u6267\u884c\u5668\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u8d1f\u8d23\u5904\u7406\u672b\u7aef\u6267\u884c\u5668\uff08\u5982\u5939\u722a\u3001\u5438\u76d8\uff09\u7684\u63a7\u5236\u547d\u4ee4\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>command_hub_service</code> <code>CommandHubService</code> <p>\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002</p> <p>\u521d\u59cb\u5316\u672b\u7aef\u6267\u884c\u5668\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>command_hub_service</code> <code>CommandHubService</code> <p>\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>parent</code> <code>QObject</code> <p>\u7236\u5bf9\u8c61. Defaults to None.</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/effector_view_model.py</code> <pre><code>def __init__(self, command_hub_service: CommandHubService, parent=None):\n    \"\"\"\u521d\u59cb\u5316\u672b\u7aef\u6267\u884c\u5668\u89c6\u56fe\u6a21\u578b\u3002\n\n    Args:\n        command_hub_service (CommandHubService): \u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002\n        parent (QObject, optional): \u7236\u5bf9\u8c61. Defaults to None.\n    \"\"\"\n    super().__init__(parent)\n    self.command_hub_service = command_hub_service\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.EffectorViewModel.send_effector_command","title":"send_effector_command","text":"<pre><code>send_effector_command(config_dict: dict)\n</code></pre> <p>\u53d1\u9001\u672b\u7aef\u6267\u884c\u5668\u547d\u4ee4\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config_dict</code> <code>dict</code> <p>\u547d\u4ee4\u914d\u7f6e\u5b57\u5178\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/effector_view_model.py</code> <pre><code>def send_effector_command(self, config_dict: dict):\n    \"\"\"\u53d1\u9001\u672b\u7aef\u6267\u884c\u5668\u547d\u4ee4\u3002\n\n    Args:\n        config_dict (dict): \u547d\u4ee4\u914d\u7f6e\u5b57\u5178\u3002\n    \"\"\"\n    self.command_hub_service.command_distribution(config_dict)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TrajectoryViewModel","title":"TrajectoryViewModel","text":"<pre><code>TrajectoryViewModel(parent=None)\n</code></pre> <p>               Bases: <code>BaseViewModel</code></p> <p>\u8f68\u8ff9\u89c4\u5212\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u8d1f\u8d23\u8f68\u8ff9\u89c4\u5212\u76f8\u5173\u7684 UI \u4ea4\u4e92\u903b\u8f91\u3002</p> <p>\u521d\u59cb\u5316\u8f68\u8ff9\u89c4\u5212\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>parent</code> <code>QObject</code> <p>\u7236\u5bf9\u8c61. Defaults to None.</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/trajectory_view_model.py</code> <pre><code>def __init__(self, parent=None):\n    \"\"\"\u521d\u59cb\u5316\u8f68\u8ff9\u89c4\u5212\u89c6\u56fe\u6a21\u578b\u3002\n\n    Args:\n        parent (QObject, optional): \u7236\u5bf9\u8c61. Defaults to None.\n    \"\"\"\n    super().__init__(parent)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.DynamicsViewModel","title":"DynamicsViewModel","text":"<pre><code>DynamicsViewModel(command_hub_service: CommandHubService, robot_state_service: RobotStateDomainService, dynamic_service: DynamicDomainService, teach_record_service: TeachRecordDomainService, record_repository: RecordRepository, parent: Optional[object] = None)\n</code></pre> <p>               Bases: <code>BaseViewModel</code></p> <p>\u52a8\u529b\u5b66\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u8ba2\u9605 RobotStateDomainService\uff0c\u5b9e\u73b0\u529b\u77e9\u8865\u507f\u548c\u793a\u6559\u8bb0\u5f55\u3002</p> <p>\u804c\u8d23\uff1a 1. \u5904\u7406\u793a\u6559\u6a21\u5f0f\u5207\u6362 2. \u8ba2\u9605\u529b\u77e9\u8865\u507f\u8bf7\u6c42\uff08\u6570\u636e\u9a71\u52a8\uff09 3. \u8ba1\u7b97\u5e76\u53d1\u9001\u529b\u77e9\u8865\u507f 4. \u7ba1\u7406\u793a\u6559\u8bb0\u5f55\u7684\u5f55\u5236\u3001\u4fdd\u5b58\u3001\u64ad\u653e</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>recording_state_changed</code> <code>pyqtSignal</code> <p>\u8bb0\u5f55\u72b6\u6001\u53d8\u5316\u4fe1\u53f7\u3002</p> <code>record_list_updated</code> <code>pyqtSignal</code> <p>\u8bb0\u5f55\u5217\u8868\u66f4\u65b0\u4fe1\u53f7\u3002</p> <code>command_hub</code> <code>CommandHubService</code> <p>\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002</p> <code>robot_state</code> <code>RobotStateDomainService</code> <p>\u673a\u68b0\u81c2\u72b6\u6001\u670d\u52a1\u3002</p> <code>dynamic_service</code> <code>DynamicDomainService</code> <p>\u52a8\u529b\u5b66\u670d\u52a1\u3002</p> <code>teach_record_service</code> <code>TeachRecordDomainService</code> <p>\u793a\u6559\u8bb0\u5f55\u670d\u52a1\u3002</p> <code>record_repository</code> <code>RecordRepository</code> <p>\u8bb0\u5f55\u4ed3\u50a8\u3002</p> <p>\u521d\u59cb\u5316\u52a8\u529b\u5b66\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>command_hub_service</code> <code>CommandHubService</code> <p>\u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>robot_state_service</code> <code>RobotStateDomainService</code> <p>\u673a\u68b0\u81c2\u72b6\u6001\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>dynamic_service</code> <code>DynamicDomainService</code> <p>\u52a8\u529b\u5b66\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>teach_record_service</code> <code>TeachRecordDomainService</code> <p>\u793a\u6559\u8bb0\u5f55\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>record_repository</code> <code>RecordRepository</code> <p>\u8bb0\u5f55\u4ed3\u50a8\u3002</p> \u5fc5\u9700 <code>parent</code> <code>Optional[object]</code> <p>\u7236\u5bf9\u8c61\u3002</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code> <pre><code>def __init__(\n    self,\n    command_hub_service: CommandHubService,\n    robot_state_service: RobotStateDomainService,\n    dynamic_service: DynamicDomainService,\n    teach_record_service: TeachRecordDomainService,\n    record_repository: RecordRepository,\n    parent: Optional[object] = None):\n    \"\"\"\u521d\u59cb\u5316\u52a8\u529b\u5b66\u89c6\u56fe\u6a21\u578b\u3002\n\n    Args:\n        command_hub_service: \u547d\u4ee4\u4e2d\u5fc3\u670d\u52a1\u3002\n        robot_state_service: \u673a\u68b0\u81c2\u72b6\u6001\u670d\u52a1\u3002\n        dynamic_service: \u52a8\u529b\u5b66\u670d\u52a1\u3002\n        teach_record_service: \u793a\u6559\u8bb0\u5f55\u670d\u52a1\u3002\n        record_repository: \u8bb0\u5f55\u4ed3\u50a8\u3002\n        parent: \u7236\u5bf9\u8c61\u3002\n    \"\"\"\n    super().__init__(parent)\n    self.command_hub = command_hub_service\n    self.robot_state = robot_state_service\n    self.dynamic_service = dynamic_service\n    self.teach_record_service = teach_record_service\n    self.record_repository = record_repository\n\n    # \u8ba2\u9605\u529b\u77e9\u8865\u507f\u8bf7\u6c42\u4fe1\u53f7\uff08\u6570\u636e\u9a71\u52a8\uff0c\u4e0d\u662f\u5b9a\u65f6\u5668\uff09\n    self.robot_state.torque_compensation_requested.connect(\n        self._on_torque_compensation_requested\n    )\n\n    # \u8ba2\u9605\u8bb0\u5f55\u670d\u52a1\u7684\u4fe1\u53f7\n    self.teach_record_service.recording_state_changed.connect(\n        self.recording_state_changed.emit\n    )\n    self.teach_record_service.record_added.connect(\n        self._on_record_added\n    )\n    self.teach_record_service.record_deleted.connect(\n        self._on_record_deleted\n    )\n\n    # \u8fde\u63a5\u8bb0\u5f55\u5b9a\u65f6\u5668\u5230\u72b6\u6001\u66f4\u65b0\n    record_timer = self.teach_record_service.get_record_timer()\n    record_timer.timeout.connect(self._on_record_timer_timeout)\n\n    # \u52a0\u8f7d\u5df2\u5b58\u5728\u7684\u8bb0\u5f55\n    self._load_records_from_file()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.DynamicsViewModel.toggle_teaching_mode","title":"toggle_teaching_mode","text":"<pre><code>toggle_teaching_mode(command_dict: dict)\n</code></pre> <p>\u5207\u6362\u793a\u6559\u6a21\u5f0f\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>command_dict</code> <code>dict</code> <p>\u547d\u4ee4\u5b57\u5178\uff0c\u5305\u542b control \u548c mode\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code> <pre><code>def toggle_teaching_mode(self, command_dict: dict):\n    \"\"\"\u5207\u6362\u793a\u6559\u6a21\u5f0f\u3002\n\n    Args:\n        command_dict (dict): \u547d\u4ee4\u5b57\u5178\uff0c\u5305\u542b control \u548c mode\u3002\n    \"\"\"\n    # 1. \u53d1\u9001\u4e32\u53e3\u547d\u4ee4\n    self.command_hub.command_distribution(command_dict)\n\n    # 2. \u66f4\u65b0\u72b6\u6001\u670d\u52a1\u7684\u793a\u6559\u6a21\u5f0f\u6807\u5fd7\n    is_enable = (command_dict['control'] == 0x07)\n    self.robot_state.set_teaching_mode(is_enable)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.DynamicsViewModel.send_torque","title":"send_torque","text":"<pre><code>send_torque(torque_values: list)\n</code></pre> <p>\u53d1\u9001\u529b\u77e9\u63a7\u5236\u547d\u4ee4\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>torque_values</code> <code>list</code> <p>\u529b\u77e9\u503c\u5217\u8868\uff086\u4e2a\u5173\u8282\uff09\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code> <pre><code>def send_torque(self, torque_values: list):\n    \"\"\"\u53d1\u9001\u529b\u77e9\u63a7\u5236\u547d\u4ee4\u3002\n\n    Args:\n        torque_values (list): \u529b\u77e9\u503c\u5217\u8868\uff086\u4e2a\u5173\u8282\uff09\u3002\n    \"\"\"\n    command_dict = {\n        'control': 0x06,  # \u529b\u77e9\u63a7\u5236\n        'mode': 0x0A,     # \u5468\u671f\u529b\u77e9\u6a21\u5f0f\n        'torque': torque_values\n    }\n    self.command_hub.command_distribution(command_dict)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.DynamicsViewModel.toggle_recording","title":"toggle_recording","text":"<pre><code>toggle_recording()\n</code></pre> <p>\u5207\u6362\u8bb0\u5f55\u72b6\u6001\uff08\u5f00\u59cb/\u505c\u6b62\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code> <pre><code>def toggle_recording(self):\n    \"\"\"\u5207\u6362\u8bb0\u5f55\u72b6\u6001\uff08\u5f00\u59cb/\u505c\u6b62\uff09\u3002\"\"\"\n    if self.teach_record_service.is_recording():\n        # \u505c\u6b62\u8bb0\u5f55\n        record_name = self.teach_record_service.stop_recording()\n        if record_name:\n            # \u4fdd\u5b58\u5230\u6587\u4ef6\n            self._save_records_to_file()\n    else:\n        # \u5f00\u59cb\u8bb0\u5f55\n        self.teach_record_service.start_recording()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.DynamicsViewModel.delete_record","title":"delete_record","text":"<pre><code>delete_record(record_name: str) -&gt; bool\n</code></pre> <p>\u5220\u9664\u6307\u5b9a\u8bb0\u5f55\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>record_name</code> <code>str</code> <p>\u8bb0\u5f55\u540d\u79f0\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u5220\u9664\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code> <pre><code>def delete_record(self, record_name: str) -&gt; bool:\n    \"\"\"\u5220\u9664\u6307\u5b9a\u8bb0\u5f55\u3002\n\n    Args:\n        record_name (str): \u8bb0\u5f55\u540d\u79f0\u3002\n\n    Returns:\n        bool: \u662f\u5426\u5220\u9664\u6210\u529f\u3002\n    \"\"\"\n    success = self.teach_record_service.delete_record(record_name)\n    if success:\n        self._save_records_to_file()\n    return success\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.DynamicsViewModel.run_record","title":"run_record","text":"<pre><code>run_record(record_name: str)\n</code></pre> <p>\u8fd0\u884c\u6307\u5b9a\u8bb0\u5f55\uff08\u64ad\u653e\u793a\u6559\u8f68\u8ff9\uff09\u3002</p> <p>\u6d41\u7a0b\uff1a 1. \u83b7\u53d6\u793a\u6559\u8bb0\u5f55\u7684\u89d2\u5ea6\u5217\u8868 2. \u59d4\u6258\u7ed9 CommandHubService \u5904\u7406</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>record_name</code> <code>str</code> <p>\u8bb0\u5f55\u540d\u79f0\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code> <pre><code>def run_record(self, record_name: str):\n    \"\"\"\u8fd0\u884c\u6307\u5b9a\u8bb0\u5f55\uff08\u64ad\u653e\u793a\u6559\u8f68\u8ff9\uff09\u3002\n\n    \u6d41\u7a0b\uff1a\n    1. \u83b7\u53d6\u793a\u6559\u8bb0\u5f55\u7684\u89d2\u5ea6\u5217\u8868\n    2. \u59d4\u6258\u7ed9 CommandHubService \u5904\u7406\n\n    Args:\n        record_name (str): \u8bb0\u5f55\u540d\u79f0\u3002\n    \"\"\"\n    angles_list = self.teach_record_service.get_record(record_name)\n    if angles_list:\n        self.command_hub.run_teach_record(angles_list)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.DynamicsViewModel.reverse_record","title":"reverse_record","text":"<pre><code>reverse_record(record_name: str) -&gt; Optional[str]\n</code></pre> <p>\u53cd\u8f6c\u6307\u5b9a\u8bb0\u5f55\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>record_name</code> <code>str</code> <p>\u8bb0\u5f55\u540d\u79f0\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[str]</code> <p>Optional[str]: \u65b0\u8bb0\u5f55\u540d\u79f0\uff0c\u5931\u8d25\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code> <pre><code>def reverse_record(self, record_name: str) -&gt; Optional[str]:\n    \"\"\"\u53cd\u8f6c\u6307\u5b9a\u8bb0\u5f55\u3002\n\n    Args:\n        record_name (str): \u8bb0\u5f55\u540d\u79f0\u3002\n\n    Returns:\n        Optional[str]: \u65b0\u8bb0\u5f55\u540d\u79f0\uff0c\u5931\u8d25\u8fd4\u56de None\u3002\n    \"\"\"\n    new_name = self.teach_record_service.reverse_record(record_name)\n    if new_name:\n        self._save_records_to_file()\n    return new_name\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.DynamicsViewModel.get_record_names","title":"get_record_names","text":"<pre><code>get_record_names() -&gt; List[str]\n</code></pre> <p>\u83b7\u53d6\u6240\u6709\u8bb0\u5f55\u540d\u79f0\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>List[str]: \u8bb0\u5f55\u540d\u79f0\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code> <pre><code>def get_record_names(self) -&gt; List[str]:\n    \"\"\"\u83b7\u53d6\u6240\u6709\u8bb0\u5f55\u540d\u79f0\u3002\n\n    Returns:\n        List[str]: \u8bb0\u5f55\u540d\u79f0\u5217\u8868\u3002\n    \"\"\"\n    return self.teach_record_service.get_record_names()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.DynamicsViewModel.is_recording","title":"is_recording","text":"<pre><code>is_recording() -&gt; bool\n</code></pre> <p>\u67e5\u8be2\u662f\u5426\u6b63\u5728\u8bb0\u5f55\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u6b63\u5728\u8bb0\u5f55\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/dynamics_view_model.py</code> <pre><code>def is_recording(self) -&gt; bool:\n    \"\"\"\u67e5\u8be2\u662f\u5426\u6b63\u5728\u8bb0\u5f55\u3002\n\n    Returns:\n        bool: \u662f\u5426\u6b63\u5728\u8bb0\u5f55\u3002\n    \"\"\"\n    return self.teach_record_service.is_recording()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraViewModel","title":"CameraViewModel","text":"<pre><code>CameraViewModel(app_service: CameraApplicationService, parent=None)\n</code></pre> <p>               Bases: <code>BaseViewModel</code></p> <p>\u6444\u50cf\u5934\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u804c\u8d23\uff1a - \u8fde\u63a5 UI \u548c Application Service - \u7ba1\u7406\u56fe\u50cf\u663e\u793a\u72b6\u6001\uff08\u5b9a\u65f6\u5237\u65b0\uff09 - \u7ba1\u7406\u68c0\u6d4b\u72b6\u6001 - \u901a\u8fc7 Application Service \u83b7\u53d6\u56fe\u50cf\u548c\u68c0\u6d4b\u7ed3\u679c</p> <p>\u67b6\u6784\u539f\u5219\uff1a - \u53ea\u4f9d\u8d56 Application \u5c42\uff0c\u4e0d\u76f4\u63a5\u8bbf\u95ee Domain \u5c42 - \u6240\u6709 Domain \u5c42\u8c03\u7528\u901a\u8fc7 Application Service \u8f6c\u53d1</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>image_display_requested</code> <code>pyqtSignal</code> <p>\u56fe\u50cf\u663e\u793a\u8bf7\u6c42\u4fe1\u53f7\uff0c\u643a\u5e26 (image, image_type)\u3002</p> <code>status_updated</code> <code>pyqtSignal</code> <p>\u72b6\u6001\u6587\u672c\u66f4\u65b0\u4fe1\u53f7\u3002</p> <code>image_info_updated</code> <code>pyqtSignal</code> <p>\u56fe\u50cf\u4fe1\u606f\u66f4\u65b0\u4fe1\u53f7\u3002</p> <code>connection_status_changed</code> <code>pyqtSignal</code> <p>\u6444\u50cf\u5934\u8fde\u63a5\u72b6\u6001\u4fe1\u53f7\u3002</p> <code>button_states_changed</code> <code>pyqtSignal</code> <p>\u6309\u94ae\u72b6\u6001\u53d8\u66f4\u4fe1\u53f7\uff0c\u643a\u5e26 (color_active, depth_active)\u3002</p> <code>clear_display_requested</code> <code>pyqtSignal</code> <p>\u6e05\u9664\u663e\u793a\u8bf7\u6c42\u4fe1\u53f7\u3002</p> <code>detection_status_changed</code> <code>pyqtSignal</code> <p>\u68c0\u6d4b\u72b6\u6001\u53d8\u66f4\u4fe1\u53f7\u3002</p> <code>detection_result_updated</code> <code>pyqtSignal</code> <p>\u68c0\u6d4b\u7ed3\u679c\u66f4\u65b0\u4fe1\u53f7\u3002</p> <code>app_service</code> <code>CameraApplicationService</code> <p>\u6444\u50cf\u5934\u5e94\u7528\u670d\u52a1\u3002</p> <code>display_timer</code> <code>QTimer</code> <p>\u56fe\u50cf\u5237\u65b0\u5b9a\u65f6\u5668\u3002</p> <p>\u521d\u59cb\u5316\u6444\u50cf\u5934\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>app_service</code> <code>CameraApplicationService</code> <p>\u6444\u50cf\u5934\u5e94\u7528\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>parent</code> <code>QObject</code> <p>\u7236\u5bf9\u8c61. Defaults to None.</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/camera_view_model.py</code> <pre><code>def __init__(\n    self,\n    app_service: CameraApplicationService,\n    parent=None\n):\n    \"\"\"\u521d\u59cb\u5316\u6444\u50cf\u5934\u89c6\u56fe\u6a21\u578b\u3002\n\n    Args:\n        app_service (CameraApplicationService): \u6444\u50cf\u5934\u5e94\u7528\u670d\u52a1\u3002\n        parent (QObject, optional): \u7236\u5bf9\u8c61. Defaults to None.\n    \"\"\"\n    super().__init__(parent)\n    self.app_service = app_service\n\n    # \u663e\u793a\u72b6\u6001\n    self.current_display_mode = None  # None, 'color', 'depth'\n\n    # \u5b9a\u65f6\u5668\uff0830FPS\u5237\u65b0\u56fe\u50cf\uff09\n    self.display_timer = QTimer()\n    self.display_timer.timeout.connect(self._update_display)\n\n    # \u8fde\u63a5\u4fe1\u53f7\n    self._connect_signals()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraViewModel.connect_camera","title":"connect_camera","text":"<pre><code>connect_camera()\n</code></pre> <p>\u8fde\u63a5\u6444\u50cf\u5934\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/camera_view_model.py</code> <pre><code>def connect_camera(self):\n    \"\"\"\u8fde\u63a5\u6444\u50cf\u5934\u3002\"\"\"\n    self.app_service.connect_camera()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraViewModel.disconnect_camera","title":"disconnect_camera","text":"<pre><code>disconnect_camera()\n</code></pre> <p>\u65ad\u5f00\u6444\u50cf\u5934\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/camera_view_model.py</code> <pre><code>def disconnect_camera(self):\n    \"\"\"\u65ad\u5f00\u6444\u50cf\u5934\u3002\"\"\"\n    # \u5148\u505c\u6b62\u663e\u793a\n    if self.current_display_mode is not None:\n        self.stop_display()\n\n    # \u65ad\u5f00\u6444\u50cf\u5934\n    self.app_service.disconnect_camera()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraViewModel.start_color_display","title":"start_color_display","text":"<pre><code>start_color_display()\n</code></pre> <p>\u5f00\u59cb\u663e\u793a\u5f69\u8272\u56fe\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/camera_view_model.py</code> <pre><code>def start_color_display(self):\n    \"\"\"\u5f00\u59cb\u663e\u793a\u5f69\u8272\u56fe\u3002\"\"\"\n    # \u2705 \u901a\u8fc7Application\u5c42\u68c0\u67e5\u6444\u50cf\u5934\u662f\u5426\u8fde\u63a5\n    if not self.app_service.is_camera_connected():\n        self.status_updated.emit(\"\u8bf7\u5148\u8fde\u63a5\u6444\u50cf\u5934\")\n        return\n\n    # \u8bbe\u7f6e\u663e\u793a\u6a21\u5f0f\n    self.current_display_mode = 'color'\n\n    # \u542f\u52a8\u5b9a\u65f6\u5668\uff0833ms = ~30FPS\uff09\n    self.display_timer.start(33)\n\n    # \u66f4\u65b0\u72b6\u6001\n    self.status_updated.emit(\"\u663e\u793a\u5f69\u8272\u56fe\u50cf\")\n    self.button_states_changed.emit(True, False)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraViewModel.start_depth_display","title":"start_depth_display","text":"<pre><code>start_depth_display()\n</code></pre> <p>\u5f00\u59cb\u663e\u793a\u6df1\u5ea6\u56fe\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/camera_view_model.py</code> <pre><code>def start_depth_display(self):\n    \"\"\"\u5f00\u59cb\u663e\u793a\u6df1\u5ea6\u56fe\u3002\"\"\"\n    # \u2705 \u901a\u8fc7Application\u5c42\u68c0\u67e5\u6444\u50cf\u5934\u662f\u5426\u8fde\u63a5\n    if not self.app_service.is_camera_connected():\n        self.status_updated.emit(\"\u8bf7\u5148\u8fde\u63a5\u6444\u50cf\u5934\")\n        return\n\n    # \u8bbe\u7f6e\u663e\u793a\u6a21\u5f0f\n    self.current_display_mode = 'depth'\n\n    # \u542f\u52a8\u5b9a\u65f6\u5668\n    self.display_timer.start(33)\n\n    # \u66f4\u65b0\u72b6\u6001\n    self.status_updated.emit(\"\u663e\u793a\u6df1\u5ea6\u56fe\u50cf\")\n    self.button_states_changed.emit(False, True)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraViewModel.stop_display","title":"stop_display","text":"<pre><code>stop_display()\n</code></pre> <p>\u505c\u6b62\u663e\u793a\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/camera_view_model.py</code> <pre><code>def stop_display(self):\n    \"\"\"\u505c\u6b62\u663e\u793a\u3002\"\"\"\n    # \u505c\u6b62\u5b9a\u65f6\u5668\n    self.display_timer.stop()\n\n    # \u6e05\u9664\u663e\u793a\u6a21\u5f0f\n    self.current_display_mode = None\n\n    # \u6e05\u9664\u663e\u793a\n    self.clear_display_requested.emit()\n\n    # \u66f4\u65b0\u72b6\u6001\n    self.status_updated.emit(\"\u5df2\u505c\u6b62\u663e\u793a\")\n    self.button_states_changed.emit(False, False)\n    self.image_info_updated.emit({})\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraViewModel.start_detection","title":"start_detection","text":"<pre><code>start_detection()\n</code></pre> <p>\u5f00\u59cb\u68c0\u6d4b\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/camera_view_model.py</code> <pre><code>def start_detection(self):\n    \"\"\"\u5f00\u59cb\u68c0\u6d4b\u3002\"\"\"\n    self.app_service.start_detection()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraViewModel.stop_detection","title":"stop_detection","text":"<pre><code>stop_detection()\n</code></pre> <p>\u505c\u6b62\u68c0\u6d4b\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/camera_view_model.py</code> <pre><code>def stop_detection(self):\n    \"\"\"\u505c\u6b62\u68c0\u6d4b\u3002\"\"\"\n    self.app_service.stop_detection()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraViewModel.move_to_detected_part","title":"move_to_detected_part","text":"<pre><code>move_to_detected_part()\n</code></pre> <p>\u8fd0\u52a8\u5230\u68c0\u6d4b\u5230\u7684\u96f6\u4ef6\u4f4d\u7f6e\u3002</p> <p>\u804c\u8d23\uff1a\u4ec5\u8f6c\u53d1\u5230 Application \u5c42\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/camera_view_model.py</code> <pre><code>def move_to_detected_part(self):\n    \"\"\"\u8fd0\u52a8\u5230\u68c0\u6d4b\u5230\u7684\u96f6\u4ef6\u4f4d\u7f6e\u3002\n\n    \u804c\u8d23\uff1a\u4ec5\u8f6c\u53d1\u5230 Application \u5c42\u3002\n    \"\"\"\n    self.app_service.move_to_detected_part()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraViewModel.cleanup","title":"cleanup","text":"<pre><code>cleanup()\n</code></pre> <p>\u6e05\u7406\u8d44\u6e90\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/camera_view_model.py</code> <pre><code>def cleanup(self):\n    \"\"\"\u6e05\u7406\u8d44\u6e90\u3002\"\"\"\n    try:\n        # \u505c\u6b62\u68c0\u6d4b\uff08\u2705 \u901a\u8fc7Application\u5c42\uff09\n        if self.app_service.is_detection_running():\n            self.app_service.stop_detection()\n\n        # \u505c\u6b62\u663e\u793a\n        self.stop_display()\n\n        # \u65ad\u5f00\u6444\u50cf\u5934\uff08\u2705 \u901a\u8fc7Application\u5c42\uff09\n        if self.app_service.is_camera_connected():\n            self.app_service.disconnect_camera()\n\n    except Exception as e:\n        pass\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel","title":"MotionPlanningViewModel","text":"<pre><code>MotionPlanningViewModel(app_service: MotionPlanningApplicationService, dynamics_vm: DynamicsViewModel)\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u8fd0\u52a8\u89c4\u5212 ViewModel\u3002</p> <p>\u804c\u8d23\uff1a 1. \u8f6c\u53d1 UI \u547d\u4ee4\u5230 Application Service 2. \u8f6c\u53d1 Application Service \u4fe1\u53f7\u5230 UI \u7ec4\u4ef6 3. \u901a\u8fc7 DynamicsViewModel \u83b7\u53d6\u793a\u6559\u8bb0\u5f55\uff08\u907f\u514d\u91cd\u590d\u6ce8\u5165\uff09</p> <p>\u8bbe\u8ba1\u539f\u5219\uff1a - ViewModel \u53ea\u4f9d\u8d56 Application Service\uff0c\u4e0d\u76f4\u63a5\u8bbf\u95ee Domain \u6216 Infrastructure - \u6240\u6709\u4e1a\u52a1\u903b\u8f91\u5728 Application Service \u4e2d\u5c01\u88c5</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>plan_list_changed</code> <code>pyqtSignal</code> <p>\u65b9\u6848\u5217\u8868\u53d8\u66f4\u4fe1\u53f7\u3002</p> <code>current_plan_changed</code> <code>pyqtSignal</code> <p>\u5f53\u524d\u65b9\u6848\u53d8\u66f4\u4fe1\u53f7\uff0c\u643a\u5e26\u7d22\u5f15\u3002</p> <code>point_list_changed</code> <code>pyqtSignal</code> <p>\u8282\u70b9\u5217\u8868\u53d8\u66f4\u4fe1\u53f7\u3002</p> <code>current_position_received</code> <code>pyqtSignal</code> <p>\u5f53\u524d\u4f4d\u7f6e\u6570\u636e\u4fe1\u53f7\uff0c\u643a\u5e26\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\u3002</p> <code>trajectory_preview_signal</code> <code>pyqtSignal</code> <p>\u8f68\u8ff9\u9884\u89c8\u4fe1\u53f7\uff0c\u643a\u5e26 (\u8f68\u8ff9\u6570\u636e, \u4e0a\u4e0b\u6587)\u3002</p> <code>app_service</code> <code>MotionPlanningApplicationService</code> <p>\u8fd0\u52a8\u89c4\u5212\u5e94\u7528\u670d\u52a1\u3002</p> <code>dynamics_vm</code> <code>DynamicsViewModel</code> <p>\u52a8\u529b\u5b66 ViewModel\u3002</p> <p>\u521d\u59cb\u5316\u8fd0\u52a8\u89c4\u5212 ViewModel\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>app_service</code> <code>MotionPlanningApplicationService</code> <p>\u8fd0\u52a8\u89c4\u5212\u5e94\u7528\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>dynamics_vm</code> <code>DynamicsViewModel</code> <p>\u52a8\u529b\u5b66 ViewModel\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def __init__(\n    self, \n    app_service: MotionPlanningApplicationService,\n    dynamics_vm: DynamicsViewModel\n):\n    \"\"\"\u521d\u59cb\u5316\u8fd0\u52a8\u89c4\u5212 ViewModel\u3002\n\n    Args:\n        app_service (MotionPlanningApplicationService): \u8fd0\u52a8\u89c4\u5212\u5e94\u7528\u670d\u52a1\u3002\n        dynamics_vm (DynamicsViewModel): \u52a8\u529b\u5b66 ViewModel\u3002\n    \"\"\"\n    super().__init__()\n    self.app_service = app_service\n    self.dynamics_vm = dynamics_vm\n\n    # \u8fde\u63a5Application Service\u7684\u4fe1\u53f7\n    self.app_service.plan_list_changed.connect(self.plan_list_changed.emit)\n    self.app_service.current_plan_changed.connect(self.current_plan_changed.emit)\n    self.app_service.point_list_changed.connect(self.point_list_changed.emit)\n    self.app_service.current_position_received.connect(self.current_position_received.emit)\n    self.app_service.trajectory_preview_signal.connect(self.trajectory_preview_signal.emit)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.create_plan","title":"create_plan","text":"<pre><code>create_plan(name: str)\n</code></pre> <p>\u521b\u5efa\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>name</code> <code>str</code> <p>\u65b9\u6848\u540d\u79f0\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def create_plan(self, name: str):\n    \"\"\"\u521b\u5efa\u65b9\u6848\u3002\n\n    Args:\n        name (str): \u65b9\u6848\u540d\u79f0\u3002\n    \"\"\"\n    self.app_service.create_plan(name)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.delete_plan","title":"delete_plan","text":"<pre><code>delete_plan(index: int) -&gt; bool\n</code></pre> <p>\u5220\u9664\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u65b9\u6848\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u5220\u9664\u6210\u529f, False=\u5220\u9664\u5931\u8d25\uff08\u8fdd\u53cd\u4e1a\u52a1\u89c4\u5219\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def delete_plan(self, index: int) -&gt; bool:\n    \"\"\"\u5220\u9664\u65b9\u6848\u3002\n\n    Args:\n        index (int): \u65b9\u6848\u7d22\u5f15\u3002\n\n    Returns:\n        bool: True=\u5220\u9664\u6210\u529f, False=\u5220\u9664\u5931\u8d25\uff08\u8fdd\u53cd\u4e1a\u52a1\u89c4\u5219\uff09\u3002\n    \"\"\"\n    return self.app_service.delete_plan(index)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.switch_plan","title":"switch_plan","text":"<pre><code>switch_plan(index: int)\n</code></pre> <p>\u5207\u6362\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u65b9\u6848\u7d22\u5f15\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def switch_plan(self, index: int):\n    \"\"\"\u5207\u6362\u65b9\u6848\u3002\n\n    Args:\n        index (int): \u65b9\u6848\u7d22\u5f15\u3002\n    \"\"\"\n    self.app_service.switch_plan(index)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.rename_plan","title":"rename_plan","text":"<pre><code>rename_plan(index: int, new_name: str)\n</code></pre> <p>\u91cd\u547d\u540d\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u65b9\u6848\u7d22\u5f15\u3002</p> \u5fc5\u9700 <code>new_name</code> <code>str</code> <p>\u65b0\u540d\u79f0\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def rename_plan(self, index: int, new_name: str):\n    \"\"\"\u91cd\u547d\u540d\u65b9\u6848\u3002\n\n    Args:\n        index (int): \u65b9\u6848\u7d22\u5f15\u3002\n        new_name (str): \u65b0\u540d\u79f0\u3002\n    \"\"\"\n    self.app_service.rename_plan(index, new_name)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.get_plan_names","title":"get_plan_names","text":"<pre><code>get_plan_names() -&gt; List[str]\n</code></pre> <p>\u83b7\u53d6\u6240\u6709\u65b9\u6848\u540d\u79f0\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>List[str]: \u65b9\u6848\u540d\u79f0\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def get_plan_names(self) -&gt; List[str]:\n    \"\"\"\u83b7\u53d6\u6240\u6709\u65b9\u6848\u540d\u79f0\u3002\n\n    Returns:\n        List[str]: \u65b9\u6848\u540d\u79f0\u5217\u8868\u3002\n    \"\"\"\n    return self.app_service.domain_service.get_plan_names()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.get_current_plan_index","title":"get_current_plan_index","text":"<pre><code>get_current_plan_index() -&gt; int\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u65b9\u6848\u7d22\u5f15\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>int</code> <code>int</code> <p>\u5f53\u524d\u7d22\u5f15\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def get_current_plan_index(self) -&gt; int:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u65b9\u6848\u7d22\u5f15\u3002\n\n    Returns:\n        int: \u5f53\u524d\u7d22\u5f15\u3002\n    \"\"\"\n    return self.app_service.domain_service.get_current_index()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.get_plan_count","title":"get_plan_count","text":"<pre><code>get_plan_count() -&gt; int\n</code></pre> <p>\u83b7\u53d6\u65b9\u6848\u6570\u91cf\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>int</code> <code>int</code> <p>\u65b9\u6848\u6570\u91cf\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def get_plan_count(self) -&gt; int:\n    \"\"\"\u83b7\u53d6\u65b9\u6848\u6570\u91cf\u3002\n\n    Returns:\n        int: \u65b9\u6848\u6570\u91cf\u3002\n    \"\"\"\n    return self.app_service.domain_service.get_plan_count()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.add_point","title":"add_point","text":"<pre><code>add_point(point_data: dict)\n</code></pre> <p>\u6dfb\u52a0\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>point_data</code> <code>dict</code> <p>\u8282\u70b9\u6570\u636e\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def add_point(self, point_data: dict):\n    \"\"\"\u6dfb\u52a0\u8282\u70b9\u3002\n\n    Args:\n        point_data (dict): \u8282\u70b9\u6570\u636e\u3002\n    \"\"\"\n    self.app_service.add_point(point_data)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.delete_point","title":"delete_point","text":"<pre><code>delete_point(index: int)\n</code></pre> <p>\u5220\u9664\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def delete_point(self, index: int):\n    \"\"\"\u5220\u9664\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n    \"\"\"\n    self.app_service.delete_point(index)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.move_point_up","title":"move_point_up","text":"<pre><code>move_point_up(index: int)\n</code></pre> <p>\u4e0a\u79fb\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def move_point_up(self, index: int):\n    \"\"\"\u4e0a\u79fb\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n    \"\"\"\n    self.app_service.move_point_up(index)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.move_point_down","title":"move_point_down","text":"<pre><code>move_point_down(index: int)\n</code></pre> <p>\u4e0b\u79fb\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def move_point_down(self, index: int):\n    \"\"\"\u4e0b\u79fb\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n    \"\"\"\n    self.app_service.move_point_down(index)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.update_point","title":"update_point","text":"<pre><code>update_point(index: int, point_data: dict)\n</code></pre> <p>\u66f4\u65b0\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <code>point_data</code> <code>dict</code> <p>\u8282\u70b9\u6570\u636e\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def update_point(self, index: int, point_data: dict):\n    \"\"\"\u66f4\u65b0\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n        point_data (dict): \u8282\u70b9\u6570\u636e\u3002\n    \"\"\"\n    self.app_service.update_point(index, point_data)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.get_all_points","title":"get_all_points","text":"<pre><code>get_all_points() -&gt; List[dict]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u65b9\u6848\u7684\u6240\u6709\u8282\u70b9\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[dict]</code> <p>List[dict]: \u8282\u70b9\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def get_all_points(self) -&gt; List[dict]:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u65b9\u6848\u7684\u6240\u6709\u8282\u70b9\u3002\n\n    Returns:\n        List[dict]: \u8282\u70b9\u5217\u8868\u3002\n    \"\"\"\n    return self.app_service.domain_service.get_all_points()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.get_single_point","title":"get_single_point","text":"<pre><code>get_single_point(index: int) -&gt; dict\n</code></pre> <p>\u83b7\u53d6\u5355\u4e2a\u8282\u70b9\u6570\u636e\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>dict</code> <code>dict</code> <p>\u8282\u70b9\u6570\u636e\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def get_single_point(self, index: int) -&gt; dict:\n    \"\"\"\u83b7\u53d6\u5355\u4e2a\u8282\u70b9\u6570\u636e\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n\n    Returns:\n        dict: \u8282\u70b9\u6570\u636e\u3002\n    \"\"\"\n    return self.app_service.get_single_point(index)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.get_teach_record_names","title":"get_teach_record_names","text":"<pre><code>get_teach_record_names() -&gt; List[str]\n</code></pre> <p>\u83b7\u53d6\u6240\u6709\u793a\u6559\u8bb0\u5f55\u540d\u79f0\uff08\u59d4\u6258\u7ed9 DynamicsViewModel\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>List[str]: \u8bb0\u5f55\u540d\u79f0\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def get_teach_record_names(self) -&gt; List[str]:\n    \"\"\"\u83b7\u53d6\u6240\u6709\u793a\u6559\u8bb0\u5f55\u540d\u79f0\uff08\u59d4\u6258\u7ed9 DynamicsViewModel\uff09\u3002\n\n    Returns:\n        List[str]: \u8bb0\u5f55\u540d\u79f0\u5217\u8868\u3002\n    \"\"\"\n    return self.dynamics_vm.get_record_names()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.get_teach_record","title":"get_teach_record","text":"<pre><code>get_teach_record(name: str) -&gt; List[List[float]]\n</code></pre> <p>\u83b7\u53d6\u6307\u5b9a\u793a\u6559\u8bb0\u5f55\u7684\u6570\u636e\uff08\u59d4\u6258\u7ed9 DynamicsViewModel\uff09\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>name</code> <code>str</code> <p>\u8bb0\u5f55\u540d\u79f0\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[List[float]]</code> <p>List[List[float]]: \u8bb0\u5f55\u6570\u636e\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def get_teach_record(self, name: str) -&gt; List[List[float]]:\n    \"\"\"\u83b7\u53d6\u6307\u5b9a\u793a\u6559\u8bb0\u5f55\u7684\u6570\u636e\uff08\u59d4\u6258\u7ed9 DynamicsViewModel\uff09\u3002\n\n    Args:\n        name (str): \u8bb0\u5f55\u540d\u79f0\u3002\n\n    Returns:\n        List[List[float]]: \u8bb0\u5f55\u6570\u636e\u3002\n    \"\"\"\n    angles_list = self.dynamics_vm.teach_record_service.get_record(name)\n    return angles_list if angles_list else []\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.execute_single_point","title":"execute_single_point","text":"<pre><code>execute_single_point(index: int)\n</code></pre> <p>\u6267\u884c\u5355\u4e2a\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def execute_single_point(self, index: int):\n    \"\"\"\u6267\u884c\u5355\u4e2a\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n    \"\"\"\n    self.app_service.execute_single_point(index)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.execute_motion_plan","title":"execute_motion_plan","text":"<pre><code>execute_motion_plan()\n</code></pre> <p>\u6267\u884c\u6574\u4e2a\u8fd0\u52a8\u89c4\u5212\u65b9\u6848\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def execute_motion_plan(self):\n    \"\"\"\u6267\u884c\u6574\u4e2a\u8fd0\u52a8\u89c4\u5212\u65b9\u6848\u3002\"\"\"\n    self.app_service.execute_motion_plan()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.request_current_position","title":"request_current_position","text":"<pre><code>request_current_position()\n</code></pre> <p>\u8bf7\u6c42\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\uff08\u4ec5\u7528\u4e8eUI\u663e\u793a\uff09\u3002</p> <p>\u59d4\u6258\u7ed9 Application Service \u5904\u7406\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def request_current_position(self):\n    \"\"\"\u8bf7\u6c42\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\uff08\u4ec5\u7528\u4e8eUI\u663e\u793a\uff09\u3002\n\n    \u59d4\u6258\u7ed9 Application Service \u5904\u7406\u3002\n    \"\"\"\n    self.app_service.request_current_position()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.save_node_trajectory","title":"save_node_trajectory","text":"<pre><code>save_node_trajectory(node_index: int) -&gt; bool\n</code></pre> <p>\u4fdd\u5b58\u5355\u4e2a\u8282\u70b9\u7684\u8f68\u8ff9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>node_index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u51c6\u5907\u6210\u529f, False=\u51c6\u5907\u5931\u8d25\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def save_node_trajectory(self, node_index: int) -&gt; bool:\n    \"\"\"\u4fdd\u5b58\u5355\u4e2a\u8282\u70b9\u7684\u8f68\u8ff9\u3002\n\n    Args:\n        node_index (int): \u8282\u70b9\u7d22\u5f15\u3002\n\n    Returns:\n        bool: True=\u51c6\u5907\u6210\u529f, False=\u51c6\u5907\u5931\u8d25\u3002\n    \"\"\"\n    return self.app_service.save_node_trajectory(node_index)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.save_plan_trajectory","title":"save_plan_trajectory","text":"<pre><code>save_plan_trajectory() -&gt; bool\n</code></pre> <p>\u4fdd\u5b58\u6574\u4e2a\u65b9\u6848\u7684\u8f68\u8ff9\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u51c6\u5907\u6210\u529f, False=\u51c6\u5907\u5931\u8d25\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def save_plan_trajectory(self) -&gt; bool:\n    \"\"\"\u4fdd\u5b58\u6574\u4e2a\u65b9\u6848\u7684\u8f68\u8ff9\u3002\n\n    Returns:\n        bool: True=\u51c6\u5907\u6210\u529f, False=\u51c6\u5907\u5931\u8d25\u3002\n    \"\"\"\n    return self.app_service.save_plan_trajectory()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.preview_node_trajectory","title":"preview_node_trajectory","text":"<pre><code>preview_node_trajectory(node_index: int) -&gt; bool\n</code></pre> <p>\u9884\u89c8\u5355\u4e2a\u8282\u70b9\u7684\u8f68\u8ff9\u66f2\u7ebf\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>node_index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u51c6\u5907\u6210\u529f, False=\u51c6\u5907\u5931\u8d25\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def preview_node_trajectory(self, node_index: int) -&gt; bool:\n    \"\"\"\u9884\u89c8\u5355\u4e2a\u8282\u70b9\u7684\u8f68\u8ff9\u66f2\u7ebf\u3002\n\n    Args:\n        node_index (int): \u8282\u70b9\u7d22\u5f15\u3002\n\n    Returns:\n        bool: True=\u51c6\u5907\u6210\u529f, False=\u51c6\u5907\u5931\u8d25\u3002\n    \"\"\"\n    return self.app_service.preview_node_trajectory(node_index)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.preview_plan_trajectory","title":"preview_plan_trajectory","text":"<pre><code>preview_plan_trajectory() -&gt; bool\n</code></pre> <p>\u9884\u89c8\u6574\u4e2a\u65b9\u6848\u7684\u8f68\u8ff9\u66f2\u7ebf\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u51c6\u5907\u6210\u529f, False=\u51c6\u5907\u5931\u8d25\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def preview_plan_trajectory(self) -&gt; bool:\n    \"\"\"\u9884\u89c8\u6574\u4e2a\u65b9\u6848\u7684\u8f68\u8ff9\u66f2\u7ebf\u3002\n\n    Returns:\n        bool: True=\u51c6\u5907\u6210\u529f, False=\u51c6\u5907\u5931\u8d25\u3002\n    \"\"\"\n    return self.app_service.preview_plan_trajectory()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.load_local_trajectory","title":"load_local_trajectory","text":"<pre><code>load_local_trajectory(file_path: str) -&gt; bool\n</code></pre> <p>\u4ece plans \u76ee\u5f55\u52a0\u8f7d\u8f68\u8ff9\u6587\u4ef6\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>str</code> <p>\u8f68\u8ff9\u6587\u4ef6\u7684\u5b8c\u6574\u8def\u5f84\u6216\u6587\u4ef6\u540d\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u52a0\u8f7d\u6210\u529f, False=\u52a0\u8f7d\u5931\u8d25\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def load_local_trajectory(self, file_path: str) -&gt; bool:\n    \"\"\"\u4ece plans \u76ee\u5f55\u52a0\u8f7d\u8f68\u8ff9\u6587\u4ef6\u3002\n\n    Args:\n        file_path (str): \u8f68\u8ff9\u6587\u4ef6\u7684\u5b8c\u6574\u8def\u5f84\u6216\u6587\u4ef6\u540d\u3002\n\n    Returns:\n        bool: True=\u52a0\u8f7d\u6210\u529f, False=\u52a0\u8f7d\u5931\u8d25\u3002\n    \"\"\"\n    return self.app_service.load_local_trajectory(file_path)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningViewModel.get_local_trajectory_files","title":"get_local_trajectory_files","text":"<pre><code>get_local_trajectory_files() -&gt; List[str]\n</code></pre> <p>\u83b7\u53d6\u6240\u6709\u53ef\u7528\u7684\u672c\u5730\u8f68\u8ff9\u6587\u4ef6\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>List[str]: \u6587\u4ef6\u540d\u5217\u8868\uff08\u4e0d\u5e26\u6269\u5c55\u540d\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/motion_planning_view_model.py</code> <pre><code>def get_local_trajectory_files(self) -&gt; List[str]:\n    \"\"\"\u83b7\u53d6\u6240\u6709\u53ef\u7528\u7684\u672c\u5730\u8f68\u8ff9\u6587\u4ef6\u3002\n\n    Returns:\n        List[str]: \u6587\u4ef6\u540d\u5217\u8868\uff08\u4e0d\u5e26\u6269\u5c55\u540d\uff09\u3002\n    \"\"\"\n    return self.app_service.get_local_trajectory_files()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.ToolsViewModel","title":"ToolsViewModel","text":"<pre><code>ToolsViewModel(app_service: ToolsApplicationService)\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u5de5\u5177 ViewModel\u3002</p> <p>\u804c\u8d23\uff1a 1. \u8f6c\u53d1 UI \u7684\u8ba1\u7b97\u8bf7\u6c42\u5230 Application Service 2. \u8f6c\u53d1 Application Service \u7684\u7ed3\u679c\u4fe1\u53f7\u5230 UI 3. \u5904\u7406\u83b7\u53d6\u5f53\u524d\u4f4d\u7f6e\u548c\u9006\u8fd0\u52a8\u5b66\u8ba1\u7b97\u8bf7\u6c42</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>calculation_result</code> <code>pyqtSignal</code> <p>\u6b63\u8fd0\u52a8\u5b66\u7ed3\u679c\u4fe1\u53f7\uff0c\u643a\u5e26\u7ed3\u679c\u5b57\u5178\u3002</p> <code>current_angles_received</code> <code>pyqtSignal</code> <p>\u5f53\u524d\u5173\u8282\u89d2\u5ea6\u4fe1\u53f7\uff0c\u643a\u5e26\u89d2\u5ea6\u5217\u8868\u3002</p> <code>inverse_result</code> <code>pyqtSignal</code> <p>\u9006\u8fd0\u52a8\u5b66\u7ed3\u679c\u4fe1\u53f7\uff0c\u643a\u5e26\u7ed3\u679c\u5b57\u5178\u3002</p> <code>app_service</code> <code>ToolsApplicationService</code> <p>\u5de5\u5177\u5e94\u7528\u670d\u52a1\u3002</p> <p>\u521d\u59cb\u5316\u5de5\u5177 ViewModel\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>app_service</code> <code>ToolsApplicationService</code> <p>\u5de5\u5177\u5e94\u7528\u670d\u52a1\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/tools_view_model.py</code> <pre><code>def __init__(self, app_service: ToolsApplicationService):\n    \"\"\"\u521d\u59cb\u5316\u5de5\u5177 ViewModel\u3002\n\n    Args:\n        app_service (ToolsApplicationService): \u5de5\u5177\u5e94\u7528\u670d\u52a1\u3002\n    \"\"\"\n    super().__init__()\n    self.app_service = app_service\n\n    # \u8fde\u63a5Application Service\u7684\u4fe1\u53f7\n    self.app_service.calculation_result_signal.connect(\n        self.calculation_result.emit\n    )\n    self.app_service.current_angles_signal.connect(\n        self.current_angles_received.emit\n    )\n    self.app_service.inverse_result_signal.connect(\n        self.inverse_result.emit\n    )\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.ToolsViewModel.calculate_kinematics","title":"calculate_kinematics","text":"<pre><code>calculate_kinematics(joint_angles: List[float])\n</code></pre> <p>\u8bf7\u6c42\u8ba1\u7b97\u6b63\u8fd0\u52a8\u5b66\uff08\u8f6c\u53d1\u7ed9 Application Service\uff09\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>joint_angles</code> <code>List[float]</code> <p>6\u4e2a\u5173\u8282\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/tools_view_model.py</code> <pre><code>def calculate_kinematics(self, joint_angles: List[float]):\n    \"\"\"\u8bf7\u6c42\u8ba1\u7b97\u6b63\u8fd0\u52a8\u5b66\uff08\u8f6c\u53d1\u7ed9 Application Service\uff09\u3002\n\n    Args:\n        joint_angles (List[float]): 6\u4e2a\u5173\u8282\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002\n    \"\"\"\n    self.app_service.calculate_forward_kinematics(joint_angles)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.ToolsViewModel.get_current_position","title":"get_current_position","text":"<pre><code>get_current_position()\n</code></pre> <p>\u8bf7\u6c42\u83b7\u53d6\u5f53\u524d\u673a\u68b0\u81c2\u5173\u8282\u89d2\u5ea6\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/tools_view_model.py</code> <pre><code>def get_current_position(self):\n    \"\"\"\u8bf7\u6c42\u83b7\u53d6\u5f53\u524d\u673a\u68b0\u81c2\u5173\u8282\u89d2\u5ea6\u3002\"\"\"\n    self.app_service.get_current_joint_angles()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.ToolsViewModel.calculate_inverse_kinematics","title":"calculate_inverse_kinematics","text":"<pre><code>calculate_inverse_kinematics(rotation_matrix: List[List[float]], position: List[float], initial_theta: List[float] = None)\n</code></pre> <p>\u8bf7\u6c42\u8ba1\u7b97\u9006\u8fd0\u52a8\u5b66\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>rotation_matrix</code> <code>List[List[float]]</code> <p>3x3 \u65cb\u8f6c\u77e9\u9635\u3002</p> \u5fc5\u9700 <code>position</code> <code>List[float]</code> <p>[x, y, z] \u4f4d\u7f6e\uff08\u7c73\uff09\u3002</p> \u5fc5\u9700 <code>initial_theta</code> <code>List[float]</code> <p>\u521d\u59cb\u5173\u8282\u89d2\u5ea6. Defaults to None.</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/presentation/view_models/tools_view_model.py</code> <pre><code>def calculate_inverse_kinematics(self, rotation_matrix: List[List[float]], position: List[float], initial_theta: List[float] = None):\n    \"\"\"\u8bf7\u6c42\u8ba1\u7b97\u9006\u8fd0\u52a8\u5b66\u3002\n\n    Args:\n        rotation_matrix (List[List[float]]): 3x3 \u65cb\u8f6c\u77e9\u9635\u3002\n        position (List[float]): [x, y, z] \u4f4d\u7f6e\uff08\u7c73\uff09\u3002\n        initial_theta (List[float], optional): \u521d\u59cb\u5173\u8282\u89d2\u5ea6. Defaults to None.\n    \"\"\"\n    self.app_service.calculate_inverse_kinematics(rotation_matrix, position, initial_theta)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.DHParam","title":"DHParam  <code>dataclass</code>","text":"<pre><code>DHParam()\n</code></pre> <p>\u673a\u68b0\u81c2 DH \u53c2\u6570\u914d\u7f6e\u3002</p> <p>\u5b58\u50a8\u8fd0\u52a8\u5b66\u548c\u52a8\u529b\u5b66\u6240\u9700\u7684 DH \u53c2\u6570\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>kinematic_dh</code> <code>array</code> <p>\u8fd0\u52a8\u5b66 DH \u53c2\u6570\u8868\u3002</p> <code>dynamic_dh</code> <code>array</code> <p>\u52a8\u529b\u5b66 DH \u53c2\u6570\u8868\u3002</p> <p>\u521d\u59cb\u5316\u9ed8\u8ba4 DH \u53c2\u6570\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/value_objects/dh_param.py</code> <pre><code>def __init__(self):\n    \"\"\"\u521d\u59cb\u5316\u9ed8\u8ba4 DH \u53c2\u6570\u3002\"\"\"\n    self.kinematic_dh = np.array([\n        [0.0, 0.0, 0.0,  0.0],\n        [0.0, -pi/2, 0.0, -pi/2],\n        [0.425, pi, 0.0, 0.0],\n        [0.401, pi, 0.0856, pi/2],\n        [0.0, pi/2, 0.086, 0.0],\n        [0.0, -pi/2, 0.231, 0.0]  \n    ], dtype=float)\n\n    self.dynamic_dh = np.array([\n        [0.0, 0.0, 0.0, 0.0],\n        [0.0, -pi/2, 0.0, -pi/2],\n        [0.425, pi, 0.0, 0.0],\n        [0.401, pi, 0.0856, pi/2],\n        [0.0, pi/2, 0.086, 0.0],\n        [0.0, -pi/2, 0.0725, 0.0]\n    ])\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.DHParam.get_kinematic_dh","title":"get_kinematic_dh","text":"<pre><code>get_kinematic_dh() -&gt; np.ndarray\n</code></pre> <p>\u83b7\u53d6\u8fd0\u52a8\u5b66 DH \u53c2\u6570\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u8fd0\u52a8\u5b66 DH \u53c2\u6570\u77e9\u9635\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/value_objects/dh_param.py</code> <pre><code>def get_kinematic_dh(self) -&gt; np.ndarray:\n    \"\"\"\u83b7\u53d6\u8fd0\u52a8\u5b66 DH \u53c2\u6570\u3002\n\n    Returns:\n        np.ndarray: \u8fd0\u52a8\u5b66 DH \u53c2\u6570\u77e9\u9635\u3002\n    \"\"\"\n    return self.kinematic_dh\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.DHParam.get_dynamic_dh","title":"get_dynamic_dh","text":"<pre><code>get_dynamic_dh() -&gt; np.ndarray\n</code></pre> <p>\u83b7\u53d6\u52a8\u529b\u5b66 DH \u53c2\u6570\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u52a8\u529b\u5b66 DH \u53c2\u6570\u77e9\u9635\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/value_objects/dh_param.py</code> <pre><code>def get_dynamic_dh(self) -&gt; np.ndarray:\n    \"\"\"\u83b7\u53d6\u52a8\u529b\u5b66 DH \u53c2\u6570\u3002\n\n    Returns:\n        np.ndarray: \u52a8\u529b\u5b66 DH \u53c2\u6570\u77e9\u9635\u3002\n    \"\"\"\n    return self.dynamic_dh\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RobotStateSnapshot","title":"RobotStateSnapshot  <code>dataclass</code>","text":"<pre><code>RobotStateSnapshot(init_status: int, control: int, mode: int, joint_positions: Tuple[int, ...], joint_angles: Tuple[float, ...], joint_speeds: Tuple[int, ...], joint_torques: Tuple[int, ...], joint_status: Tuple[int, ...], double_encoder_interpolations: Tuple[int, ...], errors: Tuple[int, ...], effector_data: Any, timestamp: float)\n</code></pre> <p>\u673a\u68b0\u81c2\u72b6\u6001\u5feb\u7167 - \u4e0d\u53ef\u53d8\u6570\u636e\u8f7d\u4f53\u3002</p> <p>\u7279\u70b9\uff1a - frozen=True: \u4e0d\u53ef\u53d8\uff0c\u7ebf\u7a0b\u5b89\u5168 - \u5305\u542b\u5b8c\u6574\u7684\u673a\u68b0\u81c2\u72b6\u6001 - \u53ef\u4ee5\u4fdd\u5b58\u5386\u53f2\u5feb\u7167\u5e8f\u5217</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>init_status</code> <code>int</code> <p>\u521d\u59cb\u5316\u72b6\u6001\u3002</p> <code>control</code> <code>int</code> <p>\u5f53\u524d\u547d\u4ee4 0x06/0x07...\u3002</p> <code>mode</code> <code>int</code> <p>\u8fd0\u884c\u6a21\u5f0f 0x08/0x0A...\u3002</p> <code>joint_positions</code> <code>Tuple[int, ...]</code> <p>\u7f16\u7801\u5668\u4f4d\u7f6e\uff08\u539f\u59cb\u503c\uff0c6\u4e2a\u5173\u8282\uff09\u3002</p> <code>joint_angles</code> <code>Tuple[float, ...]</code> <p>\u5173\u8282\u89d2\u5ea6\uff08\u5f27\u5ea6\uff0c6\u4e2a\u5173\u8282\uff09\u3002</p> <code>joint_speeds</code> <code>Tuple[int, ...]</code> <p>\u5173\u8282\u901f\u5ea6\u3002</p> <code>joint_torques</code> <code>Tuple[int, ...]</code> <p>\u5173\u8282\u529b\u77e9\u3002</p> <code>joint_status</code> <code>Tuple[int, ...]</code> <p>\u5173\u8282\u72b6\u6001\u7801\u3002</p> <code>double_encoder_interpolations</code> <code>Tuple[int, ...]</code> <p>\u53cc\u7f16\u7801\u5668\u63d2\u503c\u3002</p> <code>errors</code> <code>Tuple[int, ...]</code> <p>\u9519\u8bef\u7801\u3002</p> <code>effector_data</code> <code>Any</code> <p>\u5939\u722a\u6570\u636e\u3002</p> <code>timestamp</code> <code>float</code> <p>\u63a5\u6536\u65f6\u95f4\u6233\u3002</p>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RobotStateSnapshot.from_decoded_message","title":"from_decoded_message  <code>classmethod</code>","text":"<pre><code>from_decoded_message(decoded_msg: Any) -&gt; RobotStateSnapshot\n</code></pre> <p>\u4ece\u89e3\u7801\u6d88\u606f\u521b\u5efa\u5feb\u7167\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>decoded_msg</code> <code>Any</code> <p>\u89e3\u7801\u540e\u7684\u6d88\u606f\u5bf9\u8c61\uff0c\u5e94\u5305\u542b positions(\u5f27\u5ea6), speeds, torques \u7b49\u5b57\u6bb5\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>RobotStateSnapshot</code> <code>RobotStateSnapshot</code> <p>\u521b\u5efa\u7684\u72b6\u6001\u5feb\u7167\u5b9e\u4f8b\u3002</p> Note <p>decoded_msg.positions \u5df2\u7ecf\u901a\u8fc7 position2radian \u8f6c\u6362\u4e3a\u5f27\u5ea6\u503c\uff0c \u6240\u4ee5 joint_angles \u76f4\u63a5\u4f7f\u7528\u8be5\u503c\u3002 joint_positions \u4f1a\u901a\u8fc7\u53cd\u5411\u8ba1\u7b97\u8fd8\u539f\u4e3a\u539f\u59cb\u7f16\u7801\u5668\u503c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/value_objects/robot_state_snapshot.py</code> <pre><code>@classmethod\ndef from_decoded_message(cls, decoded_msg: Any) -&gt; 'RobotStateSnapshot':\n    \"\"\"\u4ece\u89e3\u7801\u6d88\u606f\u521b\u5efa\u5feb\u7167\u3002\n\n    Args:\n        decoded_msg (Any): \u89e3\u7801\u540e\u7684\u6d88\u606f\u5bf9\u8c61\uff0c\u5e94\u5305\u542b positions(\u5f27\u5ea6), speeds, torques \u7b49\u5b57\u6bb5\u3002\n\n    Returns:\n        RobotStateSnapshot: \u521b\u5efa\u7684\u72b6\u6001\u5feb\u7167\u5b9e\u4f8b\u3002\n\n    Note:\n        decoded_msg.positions \u5df2\u7ecf\u901a\u8fc7 position2radian \u8f6c\u6362\u4e3a\u5f27\u5ea6\u503c\uff0c\n        \u6240\u4ee5 joint_angles \u76f4\u63a5\u4f7f\u7528\u8be5\u503c\u3002\n        joint_positions \u4f1a\u901a\u8fc7\u53cd\u5411\u8ba1\u7b97\u8fd8\u539f\u4e3a\u539f\u59cb\u7f16\u7801\u5668\u503c\u3002\n    \"\"\"        \n    robot_utils = RobotUtils()\n\n    # decoded_msg.positions \u5df2\u7ecf\u662f\u5f27\u5ea6\u503c\uff08\u7531MessageDecoder\u7684transform\u5b8c\u6210\uff09\n    # \u6240\u4ee5\u76f4\u63a5\u4f7f\u7528\uff0c\u4e0d\u9700\u8981\u518d\u6b21\u8f6c\u6362\n    angles = decoded_msg.positions  # \u5df2\u7ecf\u662f\u5f27\u5ea6\u503c\n\n    # \u53cd\u5411\u8ba1\u7b97\u539f\u59cb\u7f16\u7801\u5668\u4f4d\u7f6e\u503c\uff08\u7528\u4e8e\u4fdd\u5b58\u5b8c\u6574\u72b6\u6001\uff09\n    positions = robot_utils.radian2position(angles)\n\n    return cls(\n        init_status=decoded_msg.init_status,\n        control=decoded_msg.control,\n        mode=decoded_msg.mode,\n        joint_positions=tuple(positions),  # \u53cd\u5411\u8ba1\u7b97\u7684\u7f16\u7801\u5668\u503c\n        joint_angles=tuple(angles),        # \u76f4\u63a5\u4f7f\u7528\u89e3\u7801\u540e\u7684\u5f27\u5ea6\u503c\n        joint_speeds=tuple(decoded_msg.speeds),\n        joint_torques=tuple(decoded_msg.torques),\n        joint_status=tuple(decoded_msg.status),\n        double_encoder_interpolations=tuple(decoded_msg.double_encoder_interpolations),\n        errors=tuple(decoded_msg.errors),\n        effector_data=decoded_msg.effector_data,\n        timestamp=time.time()\n    )\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.HandEyeCalibrationConfig","title":"HandEyeCalibrationConfig  <code>dataclass</code>","text":"<pre><code>HandEyeCalibrationConfig(hand_eye_matrix: ndarray, camera_intrinsics: CameraIntrinsics, target_offset: TargetOffset, end_effector_adjustment: EndEffectorAdjustment)\n</code></pre> <p>\u624b\u773c\u6807\u5b9a\u5b8c\u6574\u914d\u7f6e\u3002</p> <p>\u8fd9\u662f\u4e00\u4e2a\u503c\u5bf9\u8c61\uff08Value Object\uff09\uff0c\u4e0d\u53ef\u53d8\u4e14\u65e0\u526f\u4f5c\u7528\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>hand_eye_matrix</code> <code>ndarray</code> <p>4x4 \u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002</p> <code>camera_intrinsics</code> <code>CameraIntrinsics</code> <p>\u76f8\u673a\u5185\u53c2\u3002</p> <code>target_offset</code> <code>TargetOffset</code> <p>\u76ee\u6807\u504f\u79fb\u91cf\u3002</p> <code>end_effector_adjustment</code> <code>EndEffectorAdjustment</code> <p>\u672b\u7aef\u59ff\u6001\u8c03\u6574\u3002</p>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.HandEyeCalibrationConfig.__post_init__","title":"__post_init__","text":"<pre><code>__post_init__()\n</code></pre> <p>\u9a8c\u8bc1\u6570\u636e\u5b8c\u6574\u6027\u3002</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ValueError</code> <p>\u5982\u679c\u624b\u773c\u6807\u5b9a\u77e9\u9635\u5f62\u72b6\u4e0d\u662f 4x4\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/value_objects/hand_eye_calibration_config.py</code> <pre><code>def __post_init__(self):\n    \"\"\"\u9a8c\u8bc1\u6570\u636e\u5b8c\u6574\u6027\u3002\n\n    Raises:\n        ValueError: \u5982\u679c\u624b\u773c\u6807\u5b9a\u77e9\u9635\u5f62\u72b6\u4e0d\u662f 4x4\u3002\n    \"\"\"\n    if self.hand_eye_matrix.shape != (4, 4):\n        raise ValueError(\"\u624b\u773c\u6807\u5b9a\u77e9\u9635\u5fc5\u987b\u662f 4x4 \u77e9\u9635\")\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraIntrinsics","title":"CameraIntrinsics  <code>dataclass</code>","text":"<pre><code>CameraIntrinsics(fx: float, fy: float, cx: float, cy: float)\n</code></pre> <p>\u76f8\u673a\u5185\u53c2\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>fx</code> <code>float</code> <p>x \u65b9\u5411\u7126\u8ddd\u3002</p> <code>fy</code> <code>float</code> <p>y \u65b9\u5411\u7126\u8ddd\u3002</p> <code>cx</code> <code>float</code> <p>\u5149\u5fc3 x \u5750\u6807\u3002</p> <code>cy</code> <code>float</code> <p>\u5149\u5fc3 y \u5750\u6807\u3002</p>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TargetOffset","title":"TargetOffset  <code>dataclass</code>","text":"<pre><code>TargetOffset(x: float, y: float, z: float)\n</code></pre> <p>\u76ee\u6807\u504f\u79fb\u91cf\uff08\u7c73\uff09\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>x</code> <code>float</code> <p>x \u65b9\u5411\u504f\u79fb\u3002</p> <code>y</code> <code>float</code> <p>y \u65b9\u5411\u504f\u79fb\u3002</p> <code>z</code> <code>float</code> <p>z \u65b9\u5411\u504f\u79fb\u3002</p>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TargetOffset.to_array","title":"to_array","text":"<pre><code>to_array() -&gt; np.ndarray\n</code></pre> <p>\u8f6c\u6362\u4e3a numpy \u6570\u7ec4\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: [x, y, z] \u6570\u7ec4\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/value_objects/hand_eye_calibration_config.py</code> <pre><code>def to_array(self) -&gt; np.ndarray:\n    \"\"\"\u8f6c\u6362\u4e3a numpy \u6570\u7ec4\u3002\n\n    Returns:\n        np.ndarray: [x, y, z] \u6570\u7ec4\u3002\n    \"\"\"\n    return np.array([self.x, self.y, self.z])\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.EndEffectorAdjustment","title":"EndEffectorAdjustment  <code>dataclass</code>","text":"<pre><code>EndEffectorAdjustment(z_rotation: float, y_rotation: float, x_rotation: float)\n</code></pre> <p>\u672b\u7aef\u59ff\u6001\u8c03\u6574\uff08\u5f27\u5ea6\uff09\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>z_rotation</code> <code>float</code> <p>\u7ed5 Z \u8f74\u65cb\u8f6c\u89d2\u5ea6\u3002</p> <code>y_rotation</code> <code>float</code> <p>\u7ed5 Y \u8f74\u65cb\u8f6c\u89d2\u5ea6\u3002</p> <code>x_rotation</code> <code>float</code> <p>\u7ed5 X \u8f74\u65cb\u8f6c\u89d2\u5ea6\u3002</p>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionOperationMode","title":"MotionOperationMode","text":"<p>               Bases: <code>Enum</code></p> <p>\u8fd0\u52a8\u64cd\u4f5c\u6a21\u5f0f\u679a\u4e3e\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>NONE</code> <p>\u65e0\u64cd\u4f5c\uff08\u4ec5\u83b7\u53d6\u4f4d\u7f6e\uff09\u3002</p> <code>EXECUTE</code> <p>\u6267\u884c\u8fd0\u52a8\u3002</p> <code>SAVE</code> <p>\u4fdd\u5b58\u8f68\u8ff9\u3002</p> <code>PREVIEW</code> <p>\u9884\u89c8\u8f68\u8ff9\uff08\u663e\u793a\u66f2\u7ebf\uff09\u3002</p>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.KinematicUtils","title":"KinematicUtils","text":"<p>\u8fd0\u52a8\u5b66\u5de5\u5177\u7c7b\u3002</p> <p>\u63d0\u4f9b\u57fa\u672c\u7684\u8fd0\u52a8\u5b66\u53d8\u6362\u548c\u89d2\u5ea6\u5904\u7406\u51fd\u6570\u3002</p>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.KinematicUtils.dh2rm","title":"dh2rm  <code>staticmethod</code>","text":"<pre><code>dh2rm(a: float, alpha: float, d: float, theta: float) -&gt; np.ndarray\n</code></pre> <p>\u6839\u636e DH \u53c2\u6570\u8ba1\u7b97\u53d8\u6362\u77e9\u9635\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>a</code> <code>float</code> <p>\u8fde\u6746\u957f\u5ea6\u3002</p> \u5fc5\u9700 <code>alpha</code> <code>float</code> <p>\u8fde\u6746\u626d\u8f6c\u89d2\u3002</p> \u5fc5\u9700 <code>d</code> <code>float</code> <p>\u8fde\u6746\u504f\u79fb\u3002</p> \u5fc5\u9700 <code>theta</code> <code>float</code> <p>\u5173\u8282\u89d2\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: 4x4 \u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/kinematic_utils.py</code> <pre><code>@staticmethod\ndef dh2rm(a: float, alpha: float, d: float, theta: float) -&gt; np.ndarray:\n    \"\"\"\u6839\u636e DH \u53c2\u6570\u8ba1\u7b97\u53d8\u6362\u77e9\u9635\u3002\n\n    Args:\n        a (float): \u8fde\u6746\u957f\u5ea6\u3002\n        alpha (float): \u8fde\u6746\u626d\u8f6c\u89d2\u3002\n        d (float): \u8fde\u6746\u504f\u79fb\u3002\n        theta (float): \u5173\u8282\u89d2\u3002\n\n    Returns:\n        np.ndarray: 4x4 \u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002\n    \"\"\"\n    c_theta = cos(theta)\n    s_theta = sin(theta)\n    c_alpha = cos(alpha)\n    s_alpha = sin(alpha)\n\n    return np.array([\n        [c_theta, -s_theta, 0, a],\n        [s_theta * c_alpha, c_theta * c_alpha, -s_alpha, -s_alpha * d],\n        [s_theta * s_alpha, c_theta * s_alpha, c_alpha, c_alpha * d],\n        [0, 0, 0, 1]\n    ], dtype=np.float64)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.KinematicUtils.rm2quat","title":"rm2quat  <code>staticmethod</code>","text":"<pre><code>rm2quat(rm: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u65cb\u8f6c\u77e9\u9635\u8f6c\u56db\u5143\u6570\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>rm</code> <code>ndarray</code> <p>3x3 \u65cb\u8f6c\u77e9\u9635\u6216 4x4 \u53d8\u6362\u77e9\u9635\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u56db\u5143\u6570 [x, y, z, w]\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/kinematic_utils.py</code> <pre><code>@staticmethod\ndef rm2quat(rm: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u65cb\u8f6c\u77e9\u9635\u8f6c\u56db\u5143\u6570\u3002\n\n    Args:\n        rm (np.ndarray): 3x3 \u65cb\u8f6c\u77e9\u9635\u6216 4x4 \u53d8\u6362\u77e9\u9635\u3002\n\n    Returns:\n        np.ndarray: \u56db\u5143\u6570 [x, y, z, w]\u3002\n    \"\"\"\n    # \u5982\u679c\u662f 4x4 \u77e9\u9635\uff0c\u63d0\u53d6 3x3 \u90e8\u5206\n    if rm.shape == (4, 4):\n        rm = rm[:3, :3]\n    return R.from_matrix(rm).as_quat()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.KinematicUtils.quat2rm","title":"quat2rm  <code>staticmethod</code>","text":"<pre><code>quat2rm(quat: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u56db\u5143\u6570\u8f6c\u65cb\u8f6c\u77e9\u9635\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>quat</code> <code>ndarray</code> <p>\u56db\u5143\u6570 [x, y, z, w]\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: 3x3 \u65cb\u8f6c\u77e9\u9635\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/kinematic_utils.py</code> <pre><code>@staticmethod\ndef quat2rm(quat: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u56db\u5143\u6570\u8f6c\u65cb\u8f6c\u77e9\u9635\u3002\n\n    Args:\n        quat (np.ndarray): \u56db\u5143\u6570 [x, y, z, w]\u3002\n\n    Returns:\n        np.ndarray: 3x3 \u65cb\u8f6c\u77e9\u9635\u3002\n    \"\"\"\n    return R.from_quat(quat).as_matrix()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.KinematicUtils.quat2euler","title":"quat2euler  <code>staticmethod</code>","text":"<pre><code>quat2euler(quat: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u56db\u5143\u6570\u8f6c\u6b27\u62c9\u89d2 (XYZ \u987a\u5e8f)\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>quat</code> <code>ndarray</code> <p>\u56db\u5143\u6570 [x, y, z, w]\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u6b27\u62c9\u89d2 [roll, pitch, yaw] (\u5f27\u5ea6)\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/kinematic_utils.py</code> <pre><code>@staticmethod\ndef quat2euler(quat: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u56db\u5143\u6570\u8f6c\u6b27\u62c9\u89d2 (XYZ \u987a\u5e8f)\u3002\n\n    Args:\n        quat (np.ndarray): \u56db\u5143\u6570 [x, y, z, w]\u3002\n\n    Returns:\n        np.ndarray: \u6b27\u62c9\u89d2 [roll, pitch, yaw] (\u5f27\u5ea6)\u3002\n    \"\"\"\n    return R.from_quat(quat).as_euler('xyz', degrees=False)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.KinematicUtils.euler2quat","title":"euler2quat  <code>staticmethod</code>","text":"<pre><code>euler2quat(euler: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u6b27\u62c9\u89d2\u8f6c\u56db\u5143\u6570 (XYZ \u987a\u5e8f)\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>euler</code> <code>ndarray</code> <p>\u6b27\u62c9\u89d2 [roll, pitch, yaw] (\u5f27\u5ea6)\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u56db\u5143\u6570 [x, y, z, w]\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/kinematic_utils.py</code> <pre><code>@staticmethod\ndef euler2quat(euler: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u6b27\u62c9\u89d2\u8f6c\u56db\u5143\u6570 (XYZ \u987a\u5e8f)\u3002\n\n    Args:\n        euler (np.ndarray): \u6b27\u62c9\u89d2 [roll, pitch, yaw] (\u5f27\u5ea6)\u3002\n\n    Returns:\n        np.ndarray: \u56db\u5143\u6570 [x, y, z, w]\u3002\n    \"\"\"\n    return R.from_euler('xyz', euler, degrees=False).as_quat()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.KinematicUtils.euler2rm","title":"euler2rm  <code>staticmethod</code>","text":"<pre><code>euler2rm(euler: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u6b27\u62c9\u89d2\u8f6c\u65cb\u8f6c\u77e9\u9635 (XYZ \u987a\u5e8f)\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>euler</code> <code>ndarray</code> <p>\u6b27\u62c9\u89d2 [roll, pitch, yaw] (\u5f27\u5ea6)\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: 3x3 \u65cb\u8f6c\u77e9\u9635\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/kinematic_utils.py</code> <pre><code>@staticmethod\ndef euler2rm(euler: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u6b27\u62c9\u89d2\u8f6c\u65cb\u8f6c\u77e9\u9635 (XYZ \u987a\u5e8f)\u3002\n\n    Args:\n        euler (np.ndarray): \u6b27\u62c9\u89d2 [roll, pitch, yaw] (\u5f27\u5ea6)\u3002\n\n    Returns:\n        np.ndarray: 3x3 \u65cb\u8f6c\u77e9\u9635\u3002\n    \"\"\"\n    return R.from_euler('xyz', euler, degrees=False).as_matrix()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.KinematicUtils.rm2euler","title":"rm2euler  <code>staticmethod</code>","text":"<pre><code>rm2euler(rm: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u65cb\u8f6c\u77e9\u9635\u8f6c\u6b27\u62c9\u89d2 (XYZ \u987a\u5e8f)\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>rm</code> <code>ndarray</code> <p>3x3 \u65cb\u8f6c\u77e9\u9635\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u6b27\u62c9\u89d2 [roll, pitch, yaw] (\u5f27\u5ea6)\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/kinematic_utils.py</code> <pre><code>@staticmethod\ndef rm2euler(rm: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u65cb\u8f6c\u77e9\u9635\u8f6c\u6b27\u62c9\u89d2 (XYZ \u987a\u5e8f)\u3002\n\n    Args:\n        rm (np.ndarray): 3x3 \u65cb\u8f6c\u77e9\u9635\u3002\n\n    Returns:\n        np.ndarray: \u6b27\u62c9\u89d2 [roll, pitch, yaw] (\u5f27\u5ea6)\u3002\n    \"\"\"\n    # \u5982\u679c\u662f 4x4 \u77e9\u9635\uff0c\u63d0\u53d6 3x3 \u90e8\u5206\n    if rm.shape == (4, 4):\n        rm = rm[:3, :3]\n    return R.from_matrix(rm).as_euler('xyz', degrees=False)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.KinematicUtils.normalize_angle","title":"normalize_angle  <code>staticmethod</code>","text":"<pre><code>normalize_angle(angle: float) -&gt; float\n</code></pre> <p>\u5c06\u89d2\u5ea6\u5f52\u4e00\u5316\u5230 [-pi, pi] \u8303\u56f4\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>angle</code> <code>float</code> <p>\u8f93\u5165\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>float</code> <code>float</code> <p>\u5f52\u4e00\u5316\u540e\u7684\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/kinematic_utils.py</code> <pre><code>@staticmethod\ndef normalize_angle(angle: float) -&gt; float:\n    \"\"\"\u5c06\u89d2\u5ea6\u5f52\u4e00\u5316\u5230 [-pi, pi] \u8303\u56f4\u3002\n\n    Args:\n        angle (float): \u8f93\u5165\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002\n\n    Returns:\n        float: \u5f52\u4e00\u5316\u540e\u7684\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002\n    \"\"\"\n    return (angle + pi) % (2 * pi) - pi\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MessageEncoder","title":"MessageEncoder","text":"<pre><code>MessageEncoder(config_path='controller/config/message_encoder_config.yaml')\n</code></pre> <p>\u6d88\u606f\u7f16\u7801\u5668\u3002</p> <p>\u57fa\u4e8e YAML \u914d\u7f6e\u6587\u4ef6\u52a8\u6001\u751f\u6210\u5341\u516d\u8fdb\u5236\u6d88\u606f\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>config</code> <code>dict</code> <p>\u52a0\u8f7d\u7684\u914d\u7f6e\u5b57\u5178\u3002</p> <code>robot_utils</code> <code>RobotUtils</code> <p>\u5de5\u5177\u7c7b\u5b9e\u4f8b\u3002</p> <code>formatters</code> <code>Dict[str, BaseFormatter]</code> <p>\u5df2\u6ce8\u518c\u7684\u683c\u5f0f\u5316\u5668\u5b57\u5178\u3002</p> <code>Message</code> <code>type</code> <p>\u52a8\u6001\u521b\u5efa\u7684\u6d88\u606f\u6570\u636e\u7c7b\u3002</p> <p>\u521d\u59cb\u5316\u6d88\u606f\u7f16\u7801\u5668\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config_path</code> <code>str</code> <p>\u914d\u7f6e\u6587\u4ef6\u8def\u5f84. Defaults to \"controller/config/message_encoder_config.yaml\".</p> <code>'controller/config/message_encoder_config.yaml'</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/message_encoder.py</code> <pre><code>def __init__(self, config_path = \"controller/config/message_encoder_config.yaml\"):\n    \"\"\"\u521d\u59cb\u5316\u6d88\u606f\u7f16\u7801\u5668\u3002\n\n    Args:\n        config_path (str, optional): \u914d\u7f6e\u6587\u4ef6\u8def\u5f84. Defaults to \"controller/config/message_encoder_config.yaml\".\n    \"\"\"\n    # \u4f7f\u7528 ROS2 \u5305\u8d44\u6e90\u7ba1\u7406\u65b9\u5f0f\u67e5\u627e\u914d\u7f6e\u6587\u4ef6\n    if _HAS_AMENT_INDEX:\n        try:\n            # ROS2 \u65b9\u5f0f\uff1a\u4ece share \u76ee\u5f55\u52a0\u8f7d\n            package_share_dir = get_package_share_directory('controller')\n            config_path = os.path.join(package_share_dir, 'config', 'message_encoder_config.yaml')\n        except Exception:\n            # \u5982\u679c\u5305\u672a\u5b89\u88c5\uff0c\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\uff08\u5f00\u53d1\u6a21\u5f0f\uff09\n            pass\n\n    with open(config_path, 'r', encoding='utf-8') as f:\n        self.config = yaml.safe_load(f)\n\n    self.robot_utils = RobotUtils()\n    self.formatters = self._register_formatters()\n    self.Message = self._create_message_class()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MessageEncoder.create_message","title":"create_message","text":"<pre><code>create_message(**kwargs: Any) -&gt; Any\n</code></pre> <p>\u521b\u5efa MessageOut \u5b9e\u4f8b\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>**kwargs</code> <code>Any</code> <p>\u6d88\u606f\u5b57\u6bb5\u503c\u3002</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Any</code> <code>Any</code> <p>\u6d88\u606f\u5bf9\u8c61 (MessageOut)\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/message_encoder.py</code> <pre><code>def create_message(self, **kwargs: Any) -&gt; Any:\n    \"\"\"\u521b\u5efa MessageOut \u5b9e\u4f8b\u3002\n\n    Args:\n        **kwargs: \u6d88\u606f\u5b57\u6bb5\u503c\u3002\n\n    Returns:\n        Any: \u6d88\u606f\u5bf9\u8c61 (MessageOut)\u3002\n    \"\"\"\n    return self.Message(**kwargs)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MessageEncoder.interpret_message","title":"interpret_message","text":"<pre><code>interpret_message(message: Any) -&gt; str\n</code></pre> <p>\u6839\u636e\u914d\u7f6e\u52a8\u6001\u5c06\u6d88\u606f\u5bf9\u8c61\u7f16\u7801\u4e3a\u5b57\u7b26\u4e32\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>message</code> <code>Any</code> <p>MessageOut \u5bf9\u8c61\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>str</code> <code>str</code> <p>\u7f16\u7801\u540e\u7684\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/message_encoder.py</code> <pre><code>def interpret_message(self, message: Any) -&gt; str:\n    \"\"\"\u6839\u636e\u914d\u7f6e\u52a8\u6001\u5c06\u6d88\u606f\u5bf9\u8c61\u7f16\u7801\u4e3a\u5b57\u7b26\u4e32\u3002\n\n    Args:\n        message (Any): MessageOut \u5bf9\u8c61\u3002\n\n    Returns:\n        str: \u7f16\u7801\u540e\u7684\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u3002\n    \"\"\"\n    protocol_config = self.config['protocol']\n    fields_config = self.config['message_formats']['message_out']['fields']\n\n    # 1. \u6dfb\u52a0\u534f\u8bae\u5934\n    command = protocol_config['header']\n\n    # 2. \u6309\u914d\u7f6e\u987a\u5e8f\u5904\u7406\u6bcf\u4e2a\u5b57\u6bb5\n    for field_name, field_config in fields_config.items():\n        field_value = getattr(message, field_name)\n        command += self._format_field(field_value, field_config)\n\n    # 3. \u8ba1\u7b97CRC\uff08\u5982\u679c\u542f\u7528\uff09\n    if protocol_config.get('crc_enabled', False):\n        crc = self.robot_utils.calculate_crc16(bytes.fromhex(command))\n        command += f\"{(crc &gt;&gt; 8) &amp; 0xFF:02X}{crc &amp; 0xFF:02X}\"\n\n    # 4. \u6dfb\u52a0\u534f\u8bae\u5c3e\n    command += protocol_config['footer']\n\n    return command\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MessageDecoder","title":"MessageDecoder","text":"<pre><code>MessageDecoder(config_path='controller/config/message_decoder_config.yaml')\n</code></pre> <p>\u6d88\u606f\u89e3\u7801\u5668\u3002</p> <p>\u57fa\u4e8e YAML \u914d\u7f6e\u6587\u4ef6\u52a8\u6001\u89e3\u6790\u5341\u516d\u8fdb\u5236\u6d88\u606f\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>config</code> <code>dict</code> <p>\u52a0\u8f7d\u7684\u914d\u7f6e\u5b57\u5178\u3002</p> <code>robot_utils</code> <code>RobotUtils</code> <p>\u5de5\u5177\u7c7b\u5b9e\u4f8b\u3002</p> <code>parsers</code> <code>Dict[str, BaseParser]</code> <p>\u5df2\u6ce8\u518c\u7684\u89e3\u6790\u5668\u5b57\u5178\u3002</p> <code>MessageIn</code> <code>type</code> <p>\u52a8\u6001\u521b\u5efa\u7684\u6d88\u606f\u6570\u636e\u7c7b\u3002</p> <p>\u521d\u59cb\u5316\u6d88\u606f\u89e3\u7801\u5668\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config_path</code> <code>str</code> <p>\u914d\u7f6e\u6587\u4ef6\u8def\u5f84. Defaults to \"controller/config/message_decoder_config.yaml\".</p> <code>'controller/config/message_decoder_config.yaml'</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/message_decoder.py</code> <pre><code>def __init__(self, config_path = \"controller/config/message_decoder_config.yaml\"):\n    \"\"\"\u521d\u59cb\u5316\u6d88\u606f\u89e3\u7801\u5668\u3002\n\n    Args:\n        config_path (str, optional): \u914d\u7f6e\u6587\u4ef6\u8def\u5f84. Defaults to \"controller/config/message_decoder_config.yaml\".\n    \"\"\"\n    # \u4f7f\u7528 ROS2 \u5305\u8d44\u6e90\u7ba1\u7406\u65b9\u5f0f\u67e5\u627e\u914d\u7f6e\u6587\u4ef6\n    if _HAS_AMENT_INDEX:\n        try:\n            # ROS2 \u65b9\u5f0f\uff1a\u4ece share \u76ee\u5f55\u52a0\u8f7d\n            package_share_dir = get_package_share_directory('controller')\n            config_path = os.path.join(package_share_dir, 'config', 'message_decoder_config.yaml')\n        except Exception:\n            # \u5982\u679c\u5305\u672a\u5b89\u88c5\uff0c\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\uff08\u5f00\u53d1\u6a21\u5f0f\uff09\n            pass\n\n    with open(config_path, 'r', encoding='utf-8') as f:\n        self.config = yaml.safe_load(f)\n\n    self.robot_utils = RobotUtils()\n    self.parsers = self._register_parsers()\n    self.MessageIn = self._create_message_class()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MessageDecoder.decode_message","title":"decode_message","text":"<pre><code>decode_message(hex_message: str) -&gt; Any\n</code></pre> <p>\u89e3\u7801\u5341\u516d\u8fdb\u5236\u6d88\u606f\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>hex_message</code> <code>str</code> <p>\u539f\u59cb\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Any</code> <code>Any</code> <p>\u89e3\u7801\u540e\u7684\u6d88\u606f\u5bf9\u8c61 (MessageIn)\u3002</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ValueError</code> <p>\u5982\u679c\u6d88\u606f\u683c\u5f0f\u9519\u8bef\u6216\u6821\u9a8c\u5931\u8d25\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/message_decoder.py</code> <pre><code>def decode_message(self, hex_message: str) -&gt; Any:\n    \"\"\"\u89e3\u7801\u5341\u516d\u8fdb\u5236\u6d88\u606f\u3002\n\n    Args:\n        hex_message (str): \u539f\u59cb\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u3002\n\n    Returns:\n        Any: \u89e3\u7801\u540e\u7684\u6d88\u606f\u5bf9\u8c61 (MessageIn)\u3002\n\n    Raises:\n        ValueError: \u5982\u679c\u6d88\u606f\u683c\u5f0f\u9519\u8bef\u6216\u6821\u9a8c\u5931\u8d25\u3002\n    \"\"\"\n    # \u79fb\u9664\u7a7a\u683c\u548c\u6362\u884c\u7b26\n    hex_message = hex_message.replace(' ', '').replace('\\n', '').replace('\\r', '')\n\n    # \u9a8c\u8bc1\u534f\u8bae\u5934\u548c\u5c3e\n    protocol_config = self.config['protocol']\n    header = protocol_config['header']\n    footer = protocol_config['footer']\n\n    if not hex_message.startswith(header):\n        raise ValueError(f\"Invalid header. Expected {header}, got {hex_message[:4]}\")\n\n    if not hex_message.endswith(footer):\n        raise ValueError(f\"Invalid footer. Expected {footer}, got {hex_message[-4:]}\")\n\n\n    # \u9a8c\u8bc1CRC\uff08\u5982\u679c\u542f\u7528\uff09\n    if protocol_config.get('crc_enabled', False):\n        crc_bytes = protocol_config.get('crc_bytes', 2) * 2  # \u8f6c\u6362\u4e3a\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u6570\n        message_without_crc = hex_message[:-len(footer)-crc_bytes]\n        received_crc = hex_message[-len(footer)-crc_bytes:-len(footer)]\n\n        calculated_crc = self.robot_utils.calculate_crc16(message_without_crc)\n        calculated_crc_hex = f\"{calculated_crc:04X}\"\n\n        if calculated_crc_hex != received_crc:\n            raise ValueError(f\"CRC\u6821\u9a8c\u5931\u8d25: \u63a5\u6536={received_crc}, \u8ba1\u7b97={calculated_crc_hex}\")\n\n    # \u89e3\u6790\u5404\u4e2a\u5b57\u6bb5\n    fields_config = self.config['message_formats']['message_in']['fields']\n    parsed_data = {}\n    current_pos = 0\n\n    for field_name, field_config in fields_config.items():\n        field_bytes = field_config['bytes']\n        hex_chars = field_bytes * 2  # \u6bcf\u4e2a\u5b57\u8282\u5bf9\u5e942\u4e2a\u5341\u516d\u8fdb\u5236\u5b57\u7b26\n\n        # \u7279\u6b8a\u5904\u7406CRC\u5b57\u6bb5\n        if field_name == 'crc':\n            if protocol_config.get('crc_enabled', False):\n                field_hex = hex_message[current_pos:current_pos + hex_chars]\n            else:\n                field_hex = \"\"\n        else:\n            field_hex = hex_message[current_pos:current_pos + hex_chars]\n\n        # \u89e3\u6790\u5b57\u6bb5\n        parsed_value = self._parse_field(field_hex, field_config)\n        parsed_data[field_name] = parsed_value\n\n        current_pos += hex_chars\n\n    return self.MessageIn(**parsed_data)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MessageDecoder.decode_message_detailed","title":"decode_message_detailed","text":"<pre><code>decode_message_detailed(hex_message: str) -&gt; Dict[str, Any]\n</code></pre> <p>\u89e3\u7801\u6d88\u606f\u5e76\u8fd4\u56de\u8be6\u7ec6\u4fe1\u606f\uff08\u5305\u62ec\u539f\u59cb\u5341\u516d\u8fdb\u5236\u503c\uff09\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>hex_message</code> <code>str</code> <p>\u539f\u59cb\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Dict[str, Any]</code> <p>Dict[str, Any]: \u5305\u542b\u8be6\u7ec6\u4fe1\u606f\u7684\u5b57\u5178\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/message_decoder.py</code> <pre><code>def decode_message_detailed(self, hex_message: str) -&gt; Dict[str, Any]:\n    \"\"\"\u89e3\u7801\u6d88\u606f\u5e76\u8fd4\u56de\u8be6\u7ec6\u4fe1\u606f\uff08\u5305\u62ec\u539f\u59cb\u5341\u516d\u8fdb\u5236\u503c\uff09\u3002\n\n    Args:\n        hex_message (str): \u539f\u59cb\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u3002\n\n    Returns:\n        Dict[str, Any]: \u5305\u542b\u8be6\u7ec6\u4fe1\u606f\u7684\u5b57\u5178\u3002\n    \"\"\"\n    message_in = self.decode_message(hex_message)\n\n    # \u521b\u5efa\u8be6\u7ec6\u4fe1\u606f\u5b57\u5178\n    detailed_info = {}\n    fields_config = self.config['message_formats']['message_in']['fields']\n\n    for field_name, _ in fields_config.items():\n        value = getattr(message_in, field_name)\n        detailed_info[field_name] = {\n            'value': value,\n            'description': fields_config[field_name].get('description', field_name)\n        }\n\n    return detailed_info\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RobotUtils","title":"RobotUtils","text":"<pre><code>RobotUtils()\n</code></pre> <p>\u673a\u5668\u4eba\u5de5\u5177\u7c7b\u3002</p> <p>\u63d0\u4f9b\u673a\u5668\u4eba\u76f8\u5173\u7684\u6570\u503c\u8f6c\u6362\u3001\u6821\u9a8c\u548c\u8ba1\u7b97\u7b49\u5de5\u5177\u65b9\u6cd5\u3002</p> <p>\u521d\u59cb\u5316\u673a\u5668\u4eba\u53c2\u6570\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/robot_utils.py</code> <pre><code>def __init__(self):\n    \"\"\"\u521d\u59cb\u5316\u673a\u5668\u4eba\u53c2\u6570\u3002\"\"\"\n    self.JOINT_OFFSETS = [79119, 369835, 83627, 392414, 507293, 456372]\n    self.RADIAN_TO_POS_SCALE_FACTOR = (2**19) / (2 * pi)  # \u5f27\u5ea6\u8f6c\u4f4d\u7f6e\u503c\u7684\u7cfb\u6570\n    self.POS_TO_RADIAN_SCALE_FACTOR = (2 * pi) / (2**19)  # \u4f4d\u7f6e\u503c\u8f6c\u5f27\u5ea6\u7684\u7cfb\u6570\n    self.init_radians = [0, -pi/2, 0, pi/2, 0, 0]\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RobotUtils.position2radian","title":"position2radian","text":"<pre><code>position2radian(position: list) -&gt; list\n</code></pre> <p>\u7f16\u7801\u5668\u4f4d\u7f6e\u503c\u8f6c\u6362\u4e3a\u5f27\u5ea6\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>position</code> <code>list</code> <p>\u7f16\u7801\u5668\u4f4d\u7f6e\u503c\u5217\u8868\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>list</code> <code>list</code> <p>\u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/robot_utils.py</code> <pre><code>def position2radian(self, position: list) -&gt; list:\n    \"\"\"\u7f16\u7801\u5668\u4f4d\u7f6e\u503c\u8f6c\u6362\u4e3a\u5f27\u5ea6\u3002\n\n    Args:\n        position (list): \u7f16\u7801\u5668\u4f4d\u7f6e\u503c\u5217\u8868\u3002\n\n    Returns:\n        list: \u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\u3002\n    \"\"\"\n    radians = self.init_radians.copy()\n    for i, pos in enumerate(position):\n        if isinstance(pos, str):\n            pos = int(pos)\n        radians[i] += (pos - self.JOINT_OFFSETS[i]) * self.POS_TO_RADIAN_SCALE_FACTOR\n    return radians\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RobotUtils.radian2position","title":"radian2position","text":"<pre><code>radian2position(radian: list) -&gt; list\n</code></pre> <p>\u5f27\u5ea6\u8f6c\u6362\u4e3a\u7f16\u7801\u5668\u4f4d\u7f6e\u503c\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>radian</code> <code>list</code> <p>\u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>list</code> <code>list</code> <p>\u7f16\u7801\u5668\u4f4d\u7f6e\u503c\u5217\u8868\uff0832\u4f4d\u6574\u6570\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/robot_utils.py</code> <pre><code>def radian2position(self, radian: list) -&gt; list:\n    \"\"\"\u5f27\u5ea6\u8f6c\u6362\u4e3a\u7f16\u7801\u5668\u4f4d\u7f6e\u503c\u3002\n\n    Args:\n        radian (list): \u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\u3002\n\n    Returns:\n        list: \u7f16\u7801\u5668\u4f4d\u7f6e\u503c\u5217\u8868\uff0832\u4f4d\u6574\u6570\uff09\u3002\n    \"\"\"\n    positions = []\n    for i, rad in enumerate(radian):\n        position = int((rad - self.init_radians[i]) * self.RADIAN_TO_POS_SCALE_FACTOR + self.JOINT_OFFSETS[i]) &amp; 0xFFFFFFFF\n        positions.append(position)\n    return positions\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RobotUtils.speed2position","title":"speed2position","text":"<pre><code>speed2position(speed: list) -&gt; list\n</code></pre> <p>\u901f\u5ea6\u503c\u8f6c\u6362\u4e3a\u4f4d\u7f6e\u589e\u91cf\u503c\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>speed</code> <code>list</code> <p>\u901f\u5ea6\u5217\u8868\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>list</code> <code>list</code> <p>\u5bf9\u5e94\u7684\u65f6\u95f4\u6b65\u957f\u5185\u7684\u4f4d\u7f6e\u589e\u91cf\u503c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/robot_utils.py</code> <pre><code>def speed2position(self, speed: list) -&gt; list:\n    \"\"\"\u901f\u5ea6\u503c\u8f6c\u6362\u4e3a\u4f4d\u7f6e\u589e\u91cf\u503c\u3002\n\n    Args:\n        speed (list): \u901f\u5ea6\u5217\u8868\u3002\n\n    Returns:\n        list: \u5bf9\u5e94\u7684\u65f6\u95f4\u6b65\u957f\u5185\u7684\u4f4d\u7f6e\u589e\u91cf\u503c\u3002\n    \"\"\"\n    return [int(position * self.RADIAN_TO_POS_SCALE_FACTOR) &amp; 0xFFFFFF for position in speed]\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RobotUtils.torque_transfer","title":"torque_transfer  <code>staticmethod</code>","text":"<pre><code>torque_transfer(torque: list) -&gt; list\n</code></pre> <p>\u529b\u77e9\u503c\u8f6c\u6362\u4e0e\u5f52\u4e00\u5316\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>torque</code> <code>list</code> <p>\u529b\u77e9\u503c\u5217\u8868\uff0c\u957f\u5ea6\u4e0d\u8d85\u8fc76\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>list</code> <code>list</code> <p>\u8f6c\u6362\u540e\u7684\u529b\u77e9\u503c\u5217\u8868\uff0816\u4f4d\u6574\u6570\uff09\u3002</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ValueError</code> <p>\u5982\u679c\u529b\u77e9\u5217\u8868\u957f\u5ea6\u8d85\u8fc76\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/robot_utils.py</code> <pre><code>@staticmethod\ndef torque_transfer(torque: list) -&gt; list:\n    \"\"\"\u529b\u77e9\u503c\u8f6c\u6362\u4e0e\u5f52\u4e00\u5316\u3002\n\n    Args:\n        torque (list): \u529b\u77e9\u503c\u5217\u8868\uff0c\u957f\u5ea6\u4e0d\u8d85\u8fc76\u3002\n\n    Returns:\n        list: \u8f6c\u6362\u540e\u7684\u529b\u77e9\u503c\u5217\u8868\uff0816\u4f4d\u6574\u6570\uff09\u3002\n\n    Raises:\n        ValueError: \u5982\u679c\u529b\u77e9\u5217\u8868\u957f\u5ea6\u8d85\u8fc76\u3002\n    \"\"\"\n    if len(torque) &gt; 6:\n        raise ValueError(\"\u529b\u77e9\u503c\u5217\u8868\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc76\")\n    transfer_torque = []\n    for t in torque[:3]:\n        t = min(max(t, -50), 50)\n        transfer_torque.append(int(t / 87 * 1000))\n    for t in torque[3:]:\n        t = min(max(t, -10), 10)\n        transfer_torque.append(int(t * 100))\n    return [int(t) &amp; 0xFFFF for t in transfer_torque]\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RobotUtils.effector2hex","title":"effector2hex  <code>staticmethod</code>","text":"<pre><code>effector2hex(effector_data: float) -&gt; list\n</code></pre> <p>\u672b\u7aef\u6267\u884c\u5668\u6570\u636e\u8f6c\u6362\u4e3a\u5341\u516d\u8fdb\u5236\u5b57\u8282\u5217\u8868\u3002</p> <p>\u5c06\u6d6e\u70b9\u6570\u62c6\u5206\u4e3a\u6574\u6570\u90e8\u5206\u548c\u5c0f\u6570\u90e8\u5206\uff0c\u5206\u522b\u8f6c\u6362\u4e3a 2 \u5b57\u8282\u7684\u5927\u7aef\u5e8f\u5341\u516d\u8fdb\u5236\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>effector_data</code> <code>float</code> <p>\u672b\u7aef\u6267\u884c\u5668\u6570\u636e\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>list</code> <code>list</code> <p>\u5305\u542b\u4e24\u4e2a\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u7684\u5217\u8868 [\u6574\u6570\u90e8\u5206hex, \u5c0f\u6570\u90e8\u5206hex]\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/robot_utils.py</code> <pre><code>@staticmethod\ndef effector2hex(effector_data: float) -&gt; list:\n    \"\"\"\u672b\u7aef\u6267\u884c\u5668\u6570\u636e\u8f6c\u6362\u4e3a\u5341\u516d\u8fdb\u5236\u5b57\u8282\u5217\u8868\u3002\n\n    \u5c06\u6d6e\u70b9\u6570\u62c6\u5206\u4e3a\u6574\u6570\u90e8\u5206\u548c\u5c0f\u6570\u90e8\u5206\uff0c\u5206\u522b\u8f6c\u6362\u4e3a 2 \u5b57\u8282\u7684\u5927\u7aef\u5e8f\u5341\u516d\u8fdb\u5236\u3002\n\n    Args:\n        effector_data (float): \u672b\u7aef\u6267\u884c\u5668\u6570\u636e\u3002\n\n    Returns:\n        list: \u5305\u542b\u4e24\u4e2a\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u7684\u5217\u8868 [\u6574\u6570\u90e8\u5206hex, \u5c0f\u6570\u90e8\u5206hex]\u3002\n    \"\"\"\n    effector_data = str(float(effector_data))\n    arr = effector_data.split('.')\n    return [int(arr[0]).to_bytes(2, 'big').hex(), int(arr[1]).to_bytes(2, 'big').hex()]\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RobotUtils.calculate_crc16","title":"calculate_crc16  <code>staticmethod</code>","text":"<pre><code>calculate_crc16(data) -&gt; int\n</code></pre> <p>\u8ba1\u7b97 CRC16 \u6821\u9a8c\u548c (CCITT)\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>Union[bytes, str]</code> <p>\u5b57\u8282\u6570\u7ec4\u6216\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>int</code> <code>int</code> <p>16\u4f4d\u6821\u9a8c\u548c\u3002\u5982\u679c\u8f93\u5165\u683c\u5f0f\u9519\u8bef\u8fd4\u56de False\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/robot_utils.py</code> <pre><code>@staticmethod\ndef calculate_crc16(data) -&gt; int:\n    \"\"\"\u8ba1\u7b97 CRC16 \u6821\u9a8c\u548c (CCITT)\u3002\n\n    Args:\n        data (Union[bytes, str]): \u5b57\u8282\u6570\u7ec4\u6216\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u3002\n\n    Returns:\n        int: 16\u4f4d\u6821\u9a8c\u548c\u3002\u5982\u679c\u8f93\u5165\u683c\u5f0f\u9519\u8bef\u8fd4\u56de False\u3002\n    \"\"\"\n    if isinstance(data, str):\n        try:\n            data = bytes.fromhex(data.strip())\n        except Exception as e:\n            return False\n\n    # \u8ba1\u7b97CRC16-CCITT\n    crc = 0xFFFF\n    for byte in data:\n        crc ^= (int(byte) &lt;&lt; 8)\n        for _ in range(8):\n            if crc &amp; 0x8000:\n                crc = (crc &lt;&lt; 1) ^ 0x1021\n            else:\n                crc = crc &lt;&lt; 1\n            crc &amp;= 0xFFFF\n\n    return crc\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.ImageDrawingUtils","title":"ImageDrawingUtils","text":"<p>\u56fe\u50cf\u7ed8\u5236\u5de5\u5177\u7c7b\u3002</p> <p>\u63d0\u4f9b\u9759\u6001\u65b9\u6cd5\u7528\u4e8e\u5728 OpenCV \u56fe\u50cf\u4e0a\u7ed8\u5236\u68c0\u6d4b\u7ed3\u679c\u548c\u8f85\u52a9\u56fe\u5f62\u3002</p>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.ImageDrawingUtils.draw_detection_result","title":"draw_detection_result  <code>staticmethod</code>","text":"<pre><code>draw_detection_result(image: ndarray, detection: Dict) -&gt; np.ndarray\n</code></pre> <p>\u5728\u56fe\u50cf\u4e0a\u7ed8\u5236\u68c0\u6d4b\u7ed3\u679c\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>image</code> <code>ndarray</code> <p>\u539f\u59cb\u56fe\u50cf\uff08BGR\uff09\u3002</p> \u5fc5\u9700 <code>detection</code> <code>Dict</code> <p>\u68c0\u6d4b\u7ed3\u679c\u5b57\u5178\uff0c\u5305\u542b\uff1a - head_center (Tuple[float, float]): \u5934\u90e8\u4e2d\u5fc3\u70b9 (x, y)\u3002 - central_center (Tuple[float, float]): \u4e2d\u592e\u4e2d\u5fc3\u70b9 (x, y)\u3002 - real_center (Tuple[float, float]): \u5b9e\u9645\u4e2d\u5fc3\u70b9 (x, y)\u3002 - angle (float): \u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002 - depth (float): central_center \u7684\u6df1\u5ea6\uff08\u7c73\uff09\u3002 - real_depth (float): real_center \u7684\u6df1\u5ea6\uff08\u7c73\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u7ed8\u5236\u540e\u7684\u56fe\u50cf\uff08\u65b0\u56fe\u50cf\uff0c\u4e0d\u4fee\u6539\u539f\u56fe\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/image_drawing_utils.py</code> <pre><code>@staticmethod\ndef draw_detection_result(image: np.ndarray, detection: Dict) -&gt; np.ndarray:\n    \"\"\"\u5728\u56fe\u50cf\u4e0a\u7ed8\u5236\u68c0\u6d4b\u7ed3\u679c\u3002\n\n    Args:\n        image (np.ndarray): \u539f\u59cb\u56fe\u50cf\uff08BGR\uff09\u3002\n        detection (Dict): \u68c0\u6d4b\u7ed3\u679c\u5b57\u5178\uff0c\u5305\u542b\uff1a\n            - head_center (Tuple[float, float]): \u5934\u90e8\u4e2d\u5fc3\u70b9 (x, y)\u3002\n            - central_center (Tuple[float, float]): \u4e2d\u592e\u4e2d\u5fc3\u70b9 (x, y)\u3002\n            - real_center (Tuple[float, float]): \u5b9e\u9645\u4e2d\u5fc3\u70b9 (x, y)\u3002\n            - angle (float): \u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002\n            - depth (float): central_center \u7684\u6df1\u5ea6\uff08\u7c73\uff09\u3002\n            - real_depth (float): real_center \u7684\u6df1\u5ea6\uff08\u7c73\uff09\u3002\n\n    Returns:\n        np.ndarray: \u7ed8\u5236\u540e\u7684\u56fe\u50cf\uff08\u65b0\u56fe\u50cf\uff0c\u4e0d\u4fee\u6539\u539f\u56fe\uff09\u3002\n    \"\"\"\n    if not detection:\n        return image\n\n    # \u590d\u5236\u56fe\u50cf\uff0c\u907f\u514d\u4fee\u6539\u539f\u56fe\n    result_image = image.copy()\n\n    try:\n        # \u63d0\u53d6\u68c0\u6d4b\u6570\u636e\n        head_center = detection.get('head_center')\n        central_center = detection.get('central_center')\n        real_center = detection.get('real_center')\n        angle = detection.get('angle', 0.0)\n        depth = detection.get('depth', 0.0)\n        real_depth = detection.get('real_depth', 0.0)\n\n        # \u8f6c\u6362\u4e3a\u6574\u6570\u5750\u6807\n        if head_center:\n            head_center = (int(head_center[0]), int(head_center[1]))\n            # \u7ed8\u5236head_center\uff08\u7ea2\u8272\u5706\u70b9\uff09\n            cv2.circle(result_image, head_center, 5, (0, 0, 255), -1)\n            # \u7ed8\u5236angle\u6587\u672c\n            cv2.putText(\n                result_image, \n                f\"angle: {angle:.2f}\", \n                (head_center[0], head_center[1] - 10), \n                cv2.FONT_HERSHEY_SIMPLEX, \n                0.5, \n                (0, 0, 255), \n                2\n            )\n\n        if central_center:\n            central_center = (int(central_center[0]), int(central_center[1]))\n            # \u7ed8\u5236central_center\uff08\u7eff\u8272\u5706\u70b9\uff09\n            cv2.circle(result_image, central_center, 5, (0, 255, 0), -1)\n            # \u7ed8\u5236depth\u6587\u672c\n            cv2.putText(\n                result_image, \n                f\"depth: {depth:.2f}\", \n                (central_center[0], central_center[1] - 10), \n                cv2.FONT_HERSHEY_SIMPLEX, \n                0.5, \n                (0, 255, 0), \n                2\n            )\n            # \u7ed8\u5236\u65b9\u5411\u7bad\u5934\n            ImageDrawingUtils.draw_direction_arrow(result_image, central_center, angle)\n\n        if real_center:\n            real_center = (int(real_center[0]), int(real_center[1]))\n            # \u7ed8\u5236real_center\uff08\u7ea2\u8272\u5706\u70b9\uff09\n            cv2.circle(result_image, real_center, 5, (0, 0, 255), -1)\n            # \u7ed8\u5236real_depth\u6587\u672c\n            cv2.putText(\n                result_image, \n                f\"real_depth: {real_depth:.2f}\", \n                (real_center[0], real_center[1] - 10), \n                cv2.FONT_HERSHEY_SIMPLEX, \n                0.5, \n                (0, 0, 255), \n                2\n            )\n\n    except Exception as e:\n        # \u5982\u679c\u7ed8\u5236\u5931\u8d25\uff0c\u8fd4\u56de\u539f\u56fe\n        return image\n\n    return result_image\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.ImageDrawingUtils.draw_direction_arrow","title":"draw_direction_arrow  <code>staticmethod</code>","text":"<pre><code>draw_direction_arrow(image: ndarray, center: Tuple[int, int], angle: float)\n</code></pre> <p>\u7ed8\u5236\u65b9\u5411\u7bad\u5934\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>image</code> <code>ndarray</code> <p>\u56fe\u50cf\uff08\u539f\u5730\u4fee\u6539\uff09\u3002</p> \u5fc5\u9700 <code>center</code> <code>Tuple[int, int]</code> <p>\u4e2d\u5fc3\u70b9\u5750\u6807 (x, y)\u3002</p> \u5fc5\u9700 <code>angle</code> <code>float</code> <p>\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09- \u76f4\u7740\u5411\u4e0a\u4e3a 0\uff0c\u987a\u65f6\u9488\u4e3a\u6b63\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/utils/image_drawing_utils.py</code> <pre><code>@staticmethod\ndef draw_direction_arrow(image: np.ndarray, center: Tuple[int, int], angle: float):\n    \"\"\"\u7ed8\u5236\u65b9\u5411\u7bad\u5934\u3002\n\n    Args:\n        image (np.ndarray): \u56fe\u50cf\uff08\u539f\u5730\u4fee\u6539\uff09\u3002\n        center (Tuple[int, int]): \u4e2d\u5fc3\u70b9\u5750\u6807 (x, y)\u3002\n        angle (float): \u89d2\u5ea6\uff08\u5f27\u5ea6\uff09- \u76f4\u7740\u5411\u4e0a\u4e3a 0\uff0c\u987a\u65f6\u9488\u4e3a\u6b63\u3002\n    \"\"\"\n    try:\n        # \u7bad\u5934\u53c2\u6570\n        arrow_length = 50  # \u7bad\u5934\u957f\u5ea6\uff08\u50cf\u7d20\uff09\n        arrow_color = (255, 0, 0)  # \u84dd\u8272\uff08BGR\u683c\u5f0f\uff09\n        arrow_thickness = 3\n\n        # \u8ba1\u7b97\u7bad\u5934\u7ec8\u70b9\n        # \u89d2\u5ea6\u7cfb\u7edf\uff1a\u76f4\u7740\u5411\u4e0a\u4e3a0\uff0c\u987a\u65f6\u9488\u4e3a\u6b63\n        # \u5411\u4e0a\u65b9\u5411\u4e3a (0, -1)\uff0c\u56e0\u4e3a\u56fe\u50cf\u5750\u6807\u7cfbY\u8f74\u5411\u4e0b\n        end_x = center[0] + arrow_length * math.sin(angle)\n        end_y = center[1] - arrow_length * math.cos(angle)\n        end_point = (int(end_x), int(end_y))\n\n        # \u7ed8\u5236\u7bad\u5934\n        cv2.arrowedLine(\n            image, \n            center, \n            end_point, \n            arrow_color, \n            arrow_thickness, \n            tipLength=0.3\n        )\n\n    except Exception as e:\n        pass\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.KinematicDomainService","title":"KinematicDomainService","text":"<pre><code>KinematicDomainService()\n</code></pre> <p>\u8fd0\u52a8\u5b66\u9886\u57df\u670d\u52a1\u3002</p> <p>\u63d0\u4f9b\u673a\u68b0\u81c2\u6b63\u9006\u8fd0\u52a8\u5b66\u89e3\u7b97\u529f\u80fd\uff0c\u5305\u62ecDH\u53c2\u6570\u7ba1\u7406\u3001\u5750\u6807\u53d8\u6362\u77e9\u9635\u8ba1\u7b97\u7b49\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>dh_param</code> <code>DHParam</code> <p>\u673a\u68b0\u81c2 DH \u53c2\u6570\u5bf9\u8c61\u3002</p> <code>kinematic_dh</code> <code>ndarray</code> <p>\u8fd0\u52a8\u5b66 DH \u53c2\u6570\u77e9\u9635\u3002</p> <code>kinematic_utils</code> <code>KinematicUtils</code> <p>\u8fd0\u52a8\u5b66\u5de5\u5177\u7c7b\u5b9e\u4f8b\u3002</p> <code>gripper2base</code> <code>ndarray</code> <p>\u5f53\u524d\u672b\u7aef\u5230\u57fa\u5ea7\u7684\u53d8\u6362\u77e9\u9635\u3002</p> <p>\u521d\u59cb\u5316\u8fd0\u52a8\u5b66\u670d\u52a1\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/kinematic_domain_service.py</code> <pre><code>def __init__(self):\n    \"\"\"\u521d\u59cb\u5316\u8fd0\u52a8\u5b66\u670d\u52a1\u3002\"\"\"\n    self.dh_param = DHParam()\n    self.kinematic_dh = self.dh_param.get_kinematic_dh()\n    self.kinematic_utils = KinematicUtils()\n    self.gripper2base = self.get_gripper2base(self.kinematic_dh[:, 3])\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.KinematicDomainService.get_kinematic_dh","title":"get_kinematic_dh","text":"<pre><code>get_kinematic_dh() -&gt; np.ndarray\n</code></pre> <p>\u83b7\u53d6\u8fd0\u52a8\u5b66 DH \u53c2\u6570\u77e9\u9635\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: DH \u53c2\u6570\u77e9\u9635\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/kinematic_domain_service.py</code> <pre><code>def get_kinematic_dh(self) -&gt; np.ndarray:\n    \"\"\"\u83b7\u53d6\u8fd0\u52a8\u5b66 DH \u53c2\u6570\u77e9\u9635\u3002\n\n    Returns:\n        np.ndarray: DH \u53c2\u6570\u77e9\u9635\u3002\n    \"\"\"\n    return self.kinematic_dh\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.KinematicDomainService.get_gripper2base","title":"get_gripper2base","text":"<pre><code>get_gripper2base(theta_list: list[float] | ndarray = None) -&gt; tuple[np.ndarray, np.ndarray]\n</code></pre> <p>\u8ba1\u7b97\u672b\u7aef\u6267\u884c\u5668\u76f8\u5bf9\u4e8e\u57fa\u5ea7\u7684\u4f4d\u59ff\uff08\u56db\u5143\u6570 + \u4f4d\u7f6e\uff09\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>theta_list</code> <code>list[float] | ndarray</code> <p>\u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\u3002\u5982\u679c\u4e0d\u4f20\u5219\u4f7f\u7528\u5f53\u524d\u5185\u90e8\u72b6\u6001\u3002</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>tuple</code> <code>tuple[ndarray, ndarray]</code> <p>(quat, pos) - quat (np.ndarray): \u59ff\u6001\u56db\u5143\u6570 [x, y, z, w]\u3002 - pos (np.ndarray): \u4f4d\u7f6e\u5750\u6807 [x, y, z]\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/kinematic_domain_service.py</code> <pre><code>def get_gripper2base(self, theta_list: list[float] | np.ndarray = None) -&gt; tuple[np.ndarray, np.ndarray]:\n    \"\"\"\u8ba1\u7b97\u672b\u7aef\u6267\u884c\u5668\u76f8\u5bf9\u4e8e\u57fa\u5ea7\u7684\u4f4d\u59ff\uff08\u56db\u5143\u6570 + \u4f4d\u7f6e\uff09\u3002\n\n    Args:\n        theta_list (list[float] | np.ndarray, optional): \u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\u3002\u5982\u679c\u4e0d\u4f20\u5219\u4f7f\u7528\u5f53\u524d\u5185\u90e8\u72b6\u6001\u3002\n\n    Returns:\n        tuple: (quat, pos)\n            - quat (np.ndarray): \u59ff\u6001\u56db\u5143\u6570 [x, y, z, w]\u3002\n            - pos (np.ndarray): \u4f4d\u7f6e\u5750\u6807 [x, y, z]\u3002\n    \"\"\"\n    if theta_list is not None:\n        self.kinematic_dh[:, 3] = theta_list\n        rm_list = []\n        for dh in self.kinematic_dh:\n            rm_list.append(self.kinematic_utils.dh2rm(*dh))\n        self.gripper2base = reduce(lambda x, y: x @ y, rm_list, np.eye(4))\n    quat = R.from_matrix(self.gripper2base[:3, :3]).as_quat()\n    return quat, self.gripper2base[:3, 3]\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.KinematicDomainService.get_gripper2base_rm","title":"get_gripper2base_rm","text":"<pre><code>get_gripper2base_rm(theta_list: list[float]) -&gt; np.ndarray\n</code></pre> <p>\u83b7\u53d6\u672b\u7aef\u6267\u884c\u5668\u76f8\u5bf9\u4e8e\u57fa\u5ea7\u7684\u53d8\u6362\u77e9\u9635\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>theta_list</code> <code>list[float]</code> <p>\u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: 4x4 \u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/kinematic_domain_service.py</code> <pre><code>def get_gripper2base_rm(self, theta_list: list[float]) -&gt; np.ndarray:\n    \"\"\"\u83b7\u53d6\u672b\u7aef\u6267\u884c\u5668\u76f8\u5bf9\u4e8e\u57fa\u5ea7\u7684\u53d8\u6362\u77e9\u9635\u3002\n\n    Args:\n        theta_list (list[float]): \u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\u3002\n\n    Returns:\n        np.ndarray: 4x4 \u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002\n    \"\"\"\n    self.kinematic_dh[:, 3] = theta_list\n    rm_list = []\n    for dh in self.kinematic_dh:\n        rm_list.append(self.kinematic_utils.dh2rm(*dh))\n    self.gripper2base = reduce(lambda x, y: x @ y, rm_list, np.eye(4))\n    return self.gripper2base\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.KinematicDomainService.inverse_kinematic","title":"inverse_kinematic","text":"<pre><code>inverse_kinematic(rm: ndarray, pos: ndarray, initial_theta: list[float] | None = None) -&gt; list[float]\n</code></pre> <p>\u673a\u68b0\u81c2\u9006\u8fd0\u52a8\u5b66\u6c42\u89e3\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>rm</code> <code>ndarray</code> <p>\u76ee\u6807\u59ff\u6001\u65cb\u8f6c\u77e9\u9635 (3x3)\u3002</p> \u5fc5\u9700 <code>pos</code> <code>ndarray</code> <p>\u76ee\u6807\u4f4d\u7f6e\u5750\u6807 [x, y, z]\u3002</p> \u5fc5\u9700 <code>initial_theta</code> <code>list[float] | None</code> <p>\u521d\u59cb\u5173\u8282\u89d2\u5ea6\u731c\u6d4b\u503c\uff0c\u7528\u4e8e\u9009\u62e9\u6700\u4f18\u89e3\u3002</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>list[float]</code> <p>list[float]: \u6700\u4f18\u5173\u8282\u89d2\u5ea6\u89e3\uff08\u5f27\u5ea6\uff09\u3002</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ValueError</code> <p>\u5982\u679c\u672a\u627e\u5230\u6709\u6548\u7684\u9006\u8fd0\u52a8\u5b66\u89e3\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/kinematic_domain_service.py</code> <pre><code>def inverse_kinematic(self, rm: np.ndarray, pos: np.ndarray, initial_theta: list[float] | None = None) -&gt; list[float]:\n    \"\"\"\u673a\u68b0\u81c2\u9006\u8fd0\u52a8\u5b66\u6c42\u89e3\u3002\n\n    Args:\n        rm (np.ndarray): \u76ee\u6807\u59ff\u6001\u65cb\u8f6c\u77e9\u9635 (3x3)\u3002\n        pos (np.ndarray): \u76ee\u6807\u4f4d\u7f6e\u5750\u6807 [x, y, z]\u3002\n        initial_theta (list[float] | None, optional): \u521d\u59cb\u5173\u8282\u89d2\u5ea6\u731c\u6d4b\u503c\uff0c\u7528\u4e8e\u9009\u62e9\u6700\u4f18\u89e3\u3002\n\n    Returns:\n        list[float]: \u6700\u4f18\u5173\u8282\u89d2\u5ea6\u89e3\uff08\u5f27\u5ea6\uff09\u3002\n\n    Raises:\n        ValueError: \u5982\u679c\u672a\u627e\u5230\u6709\u6548\u7684\u9006\u8fd0\u52a8\u5b66\u89e3\u3002\n    \"\"\"\n    if not initial_theta:\n        initial_theta = self.kinematic_dh[:, 3]\n    valid_solutions = []\n    # rotation matrix\n    nx, ny, nz = rm[:, 0]\n    ox, oy, oz = rm[:, 1]\n    ax, ay, az = rm[:, 2]\n    px, py, pz = pos\n\n    # DH\u53c2\u6570\n    a3 = 0.425 \n    a4 = 0.401 \n    d4 = 0.0856 \n    d5 = 0.086 \n    d6 = 0.231\n\n    # \u6dfb\u52a0\u5947\u5f02\u6027\u5224\u65ad\n    if abs(ax**2 + ay**2 - d4**2) &lt; 1e-6:\n        return valid_solutions\n\n    # theta1\u8ba1\u7b97\n    m = ay * d6 - py\n    n = ax * d6 - px\n    try:\n        delta = m**2 + n**2 - d4**2\n\n        if delta &lt; 0:\n            return valid_solutions\n\n        theta1_0 = atan2(m, n) - atan2(-d4, sqrt(m**2 + n**2 - d4**2))\n        theta1_1 = atan2(m, n) - atan2(-d4, -sqrt(m**2 + n**2 - d4**2))\n        theta1_candidate = [theta1_0, theta1_1]\n\n    except Exception as e:\n        return valid_solutions\n\n    # theta5\n    for i, theta1 in enumerate(theta1_candidate):\n        s1 = sin(theta1)\n        c1 = cos(theta1)\n        # \u4fee\u6539theta5\u7684\u8ba1\u7b97\u65b9\u5f0f\n        cos_theta5 = -s1 * ax + c1 * ay\n        if abs(cos_theta5) &gt; 1:\n            cos_theta5 = 1 if cos_theta5 &gt; 0 else -1\n\n        theta5_val = acos(cos_theta5)\n        theta5_candidate = [theta5_val, -theta5_val]\n\n        for j, theta5 in enumerate(theta5_candidate):\n            s5 = sin(theta5)\n            c5 = cos(theta5)\n\n            # theta6\n            if abs(s5) &lt; 1e-6:\n                # \u8155\u90e8\u5947\u5f02\u6027\n                theta6 = initial_theta[5]\n            else:\n                m1 = -s1 * nx + c1 * ny\n                n1 = -s1 * ox + c1 * oy\n                theta6 = atan2(-n1 / s5, m1 / s5)\n\n            # theta3\n            s6 = sin(theta6)\n            c6 = cos(theta6)\n            m2 = d5 * (s6 * (nx * c1 + ny * s1) + c6 * (ox * c1 + oy * s1)) - d6 * (ax * c1 + ay * s1) + px * c1 + py * s1\n            n2 = d5 * (oz * c6 + nz * s6) + pz - az * d6\n\n            # \u8ba1\u7b97\u5230\u5173\u82823\u7684\u8ddd\u79bb\n            r = sqrt(m2**2 + n2**2)\n\n            if r &gt; (a3 + a4) * 1.2 or r &lt; abs(a3 - a4) * 0.8:  # \u8fdb\u4e00\u6b65\u653e\u5bbd\u5de5\u4f5c\u7a7a\u95f4\u9650\u5236\n                continue\n            temp = (m2**2 + n2**2 - a3**2 - a4**2) / (2 * a3 * a4)\n            if abs(temp) &gt; 1:\n                temp = 1 if temp &gt; 0 else -1\n            theta3_candidate = [acos(temp), -acos(temp)]\n\n            for k, theta3 in enumerate(theta3_candidate):\n                # theta2\n                s3 = sin(theta3)\n                c3 = cos(theta3)\n                # \u4fee\u6539theta2\u7684\u8ba1\u7b97\u65b9\u5f0f\n                k1 = a3 + a4 * c3\n                k2 = a4 * s3\n                s2 = (k1 * n2 - k2 * m2) / (k1**2 + k2**2)\n                c2 = (k1 * m2 + k2 * n2) / (k1**2 + k2**2)\n                theta2 = -atan2(s2, c2)\n\n                # theta4\n                if abs(s5) &lt; 1e-6:\n                    # \u5728\u8155\u90e8\u5947\u5f02\u6027\u65f6\uff0c\u4f7f\u7528\u66f4\u7a33\u5b9a\u7684\u8ba1\u7b97\u65b9\u5f0f\n                    if initial_theta is not None:\n                        theta4_candidate = [initial_theta[3]]\n                    else:\n                        theta4_candidate = [initial_theta[3]]\n                else:\n                    T01 = self.kinematic_utils.dh2rm(self.kinematic_dh[0, 0], self.kinematic_dh[0, 1], self.kinematic_dh[0, 2], theta1)\n                    T12 = self.kinematic_utils.dh2rm(self.kinematic_dh[1, 0], self.kinematic_dh[1, 1], self.kinematic_dh[1, 2], theta2)\n                    T23 = self.kinematic_utils.dh2rm(self.kinematic_dh[2, 0], self.kinematic_dh[2, 1], self.kinematic_dh[2, 2], theta3)\n                    R03 = (T01 @ T12 @ T23)[:3, :3]\n                    R36 = R03.T @ rm\n                    theta4 = atan2(R36[1, 2], R36[0, 2])\n                    theta4_candidate = [-theta4, pi - theta4]\n                for theta4 in theta4_candidate:\n                    candidate = [theta1, theta2, theta3, theta4, theta5, theta6]\n                    if self.verify_solution(candidate, (px, py, pz)):\n                        valid_solutions.append(candidate)\n\n    if not valid_solutions:\n        raise ValueError(\"No valid solutions found\")\n    valid_solutions = [\n        [self.kinematic_utils.normalize_angle(a) for a in sol] for sol in valid_solutions\n    ]\n\n    norm_initial_theta = [self.kinematic_utils.normalize_angle(a) for a in initial_theta]\n    final_solution = min(valid_solutions, key=lambda sol: np.linalg.norm(np.array(sol) - np.array(norm_initial_theta)))\n\n    gap = [n - i for n, i in zip(norm_initial_theta, initial_theta)]\n    final_solution = [f - g for f, g in zip(final_solution, gap)]\n\n    return final_solution\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.KinematicDomainService.verify_solution","title":"verify_solution","text":"<pre><code>verify_solution(theta_list: list[float], target_pos: ndarray) -&gt; bool\n</code></pre> <p>\u9a8c\u8bc1\u9006\u8fd0\u52a8\u5b66\u89e3\u7684\u51c6\u786e\u6027\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>theta_list</code> <code>list[float]</code> <p>\u5f85\u9a8c\u8bc1\u7684\u5173\u8282\u89d2\u5ea6\u89e3\u3002</p> \u5fc5\u9700 <code>target_pos</code> <code>ndarray</code> <p>\u76ee\u6807\u4f4d\u7f6e\u5750\u6807\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u5982\u679c\u6b63\u89e3\u4f4d\u7f6e\u4e0e\u76ee\u6807\u4f4d\u7f6e\u8bef\u5dee\u5c0f\u4e8e 1e-5 \u5219\u8fd4\u56de True\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/kinematic_domain_service.py</code> <pre><code>def verify_solution(self, theta_list: list[float], target_pos: np.ndarray) -&gt; bool:\n    \"\"\"\u9a8c\u8bc1\u9006\u8fd0\u52a8\u5b66\u89e3\u7684\u51c6\u786e\u6027\u3002\n\n    Args:\n        theta_list (list[float]): \u5f85\u9a8c\u8bc1\u7684\u5173\u8282\u89d2\u5ea6\u89e3\u3002\n        target_pos (np.ndarray): \u76ee\u6807\u4f4d\u7f6e\u5750\u6807\u3002\n\n    Returns:\n        bool: \u5982\u679c\u6b63\u89e3\u4f4d\u7f6e\u4e0e\u76ee\u6807\u4f4d\u7f6e\u8bef\u5dee\u5c0f\u4e8e 1e-5 \u5219\u8fd4\u56de True\u3002\n    \"\"\"\n    self.get_gripper2base(theta_list)\n    current_pos = self.gripper2base[:3, 3]\n    error = np.linalg.norm(current_pos - target_pos)\n\n    return error &lt; 1e-5 \n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.DynamicDomainService","title":"DynamicDomainService","text":"<pre><code>DynamicDomainService()\n</code></pre> <p>\u52a8\u529b\u5b66\u9886\u57df\u670d\u52a1 - \u8ba1\u7b97\u91cd\u529b\u8865\u507f\u529b\u77e9\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>link_masses</code> <code>list[float]</code> <p>\u8fde\u6746\u8d28\u91cf\u5217\u8868 (kg)\u3002</p> <code>dh_matrix</code> <code>list</code> <p>\u52a8\u529b\u5b66 DH \u53c2\u6570\u77e9\u9635\u3002</p> <code>link_com_positions</code> <code>list[ndarray]</code> <p>\u8fde\u6746\u8d28\u5fc3\u5728\u672c\u4f53\u5750\u6807\u7cfb\u4e0b\u7684\u4f4d\u7f6e (m)\u3002</p> <code>g_vector</code> <code>ndarray</code> <p>\u91cd\u529b\u5411\u91cf (m/s\u00b2)\u3002</p> <code>n</code> <code>int</code> <p>\u5173\u8282\u6570\u91cf\u3002</p> <code>compensation_factor_front</code> <code>float</code> <p>\u524d3\u4e2a\u5173\u8282\u7684\u8865\u507f\u7cfb\u6570\u3002</p> <code>compensation_factor_rear</code> <code>float</code> <p>\u540e3\u4e2a\u5173\u8282\u7684\u8865\u507f\u7cfb\u6570\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/dynamic_domain_service.py</code> <pre><code>def __init__(self):\n    # \u8fde\u6746\u8d28\u91cf (kg)\n    self.link_masses = [4.64, 10.755, 3.925, 1.24, 1.24, 1.546]\n\n    # \u4f7f\u7528\u52a8\u529b\u5b66DH\u53c2\u6570\n    dh_param = DHParam()\n    self.dh_matrix = dh_param.get_dynamic_dh()\n\n    # \u8fde\u6746\u8d28\u5fc3\u5728\u672c\u4f53\u5750\u6807\u7cfb\u4e0b\u7684\u4f4d\u7f6e (m)\n    self.link_com_positions = [\n        np.array([0, 0, 0]),\n        np.array([0.2125, 0, 0.134]),\n        np.array([0.1818, 0, 0]),\n        np.array([0, 0, 0]),\n        np.array([0, 0, 0]),\n        np.array([0, 0, 0.05])\n    ]\n\n    # \u91cd\u529b\u5411\u91cf (m/s\u00b2)\n    self.g_vector = np.array([0, 0, -9.81])\n\n    # \u5173\u8282\u6570\u91cf\n    self.n = 6\n\n    # \u8865\u507f\u7cfb\u6570\uff08\u6839\u636e\u5b9e\u9645\u673a\u68b0\u81c2\u8c03\u6574\uff09\n    self.compensation_factor_front = 0.35  # \u524d3\u4e2a\u5173\u8282\n    self.compensation_factor_rear = 0.25   # \u540e3\u4e2a\u5173\u8282\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.DynamicDomainService.compute_gravity_compensation","title":"compute_gravity_compensation","text":"<pre><code>compute_gravity_compensation(joint_angles: list[float]) -&gt; list[float]\n</code></pre> <p>\u8ba1\u7b97\u91cd\u529b\u8865\u507f\u529b\u77e9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>joint_angles</code> <code>list[float]</code> <p>\u5f53\u524d\u5173\u8282\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\uff0c6\u7ef4\u6570\u7ec4\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>list[float]</code> <p>List[float]: \u6bcf\u4e2a\u5173\u8282\u7684\u91cd\u529b\u8865\u507f\u529b\u77e9\uff08Nm\uff09\uff0c6\u7ef4\u6570\u7ec4\u3002</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ValueError</code> <p>\u5982\u679c joint_angles \u7684\u957f\u5ea6\u4e0d\u7b49\u4e8e 6\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/dynamic_domain_service.py</code> <pre><code>def compute_gravity_compensation(self, joint_angles: list[float]) -&gt; list[float]:\n    \"\"\"\u8ba1\u7b97\u91cd\u529b\u8865\u507f\u529b\u77e9\u3002\n\n    Args:\n        joint_angles (list[float]): \u5f53\u524d\u5173\u8282\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\uff0c6\u7ef4\u6570\u7ec4\u3002\n\n    Returns:\n        List[float]: \u6bcf\u4e2a\u5173\u8282\u7684\u91cd\u529b\u8865\u507f\u529b\u77e9\uff08Nm\uff09\uff0c6\u7ef4\u6570\u7ec4\u3002\n\n    Raises:\n        ValueError: \u5982\u679c joint_angles \u7684\u957f\u5ea6\u4e0d\u7b49\u4e8e 6\u3002\n    \"\"\"\n    if len(joint_angles) != 6:\n        raise ValueError(\"\u5173\u8282\u89d2\u5ea6\u5fc5\u987b\u662f6\u7ef4\u6570\u7ec4\")\n\n    q = np.array(joint_angles, dtype=float)\n    tau_g = np.zeros(self.n)  # \u521d\u59cb\u5316\u8865\u507f\u529b\u77e9\n\n    # \u5bf9\u6bcf\u4e2a\u5173\u8282\u8ba1\u7b97\u91cd\u529b\u8865\u507f\u529b\u77e9\n    for i in range(self.n):\n        # \u5bf9\u6bcf\u4e2a\u540e\u7eed\u8fde\u6746\uff08\u542b\u81ea\u8eab\uff09\u7d2f\u52a0\u529b\u77e9\u8d21\u732e\n        for j in range(i, self.n):\n            # 1. \u8ba1\u7b97\u7b2cj\u8fde\u6746\u8d28\u5fc3\u5728\u57fa\u5750\u6807\u7cfb\u4e0b\u7684\u4f4d\u7f6e\n            com_base = self._get_link_com_in_base(q, j)\n\n            # 2. \u8ba1\u7b97\u8be5\u8d28\u5fc3\u5bf9\u7b2ci\u5173\u8282\u7684\u96c5\u53ef\u6bd4\u5217\n            jacobian_col = self._get_jacobian_column(q, j, com_base, i)\n\n            # 3. \u8ba1\u7b97\u91cd\u529b\u5bf9\u8be5\u5173\u8282\u7684\u529b\u77e9\u8d21\u732e\n            tau_g[i] += self.link_masses[j] * self.g_vector.dot(jacobian_col)\n\n    # \u5e94\u7528\u8865\u507f\u7cfb\u6570\uff08\u6839\u636e\u5b9e\u9645\u673a\u68b0\u81c2\u8c03\u6574\uff09\n    tau_g[:3] *= self.compensation_factor_front\n    tau_g[3:] *= self.compensation_factor_rear\n\n    # \u8fd4\u56de\u8d1f\u503c\uff08\u56e0\u4e3a\u662f\u8865\u507f\u529b\u77e9\uff09\n    return (-tau_g).tolist()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MessageDomainService","title":"MessageDomainService","text":"<pre><code>MessageDomainService(message_encoder: MessageEncoder, message_decoder: MessageDecoder)\n</code></pre> <p>\u6d88\u606f\u9886\u57df\u670d\u52a1\u3002</p> <p>\u8d1f\u8d23\u6d88\u606f\u7684\u7f16\u7801\u548c\u89e3\u7801\uff0c\u4f5c\u4e3a MessageEncoder \u548c MessageDecoder \u7684\u95e8\u9762\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>message_encoder</code> <code>MessageEncoder</code> <p>\u6d88\u606f\u7f16\u7801\u5668\u3002</p> <code>message_decoder</code> <code>MessageDecoder</code> <p>\u6d88\u606f\u89e3\u7801\u5668\u3002</p> <p>\u521d\u59cb\u5316\u6d88\u606f\u9886\u57df\u670d\u52a1\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>message_encoder</code> <code>MessageEncoder</code> <p>\u6ce8\u5165\u7684\u6d88\u606f\u7f16\u7801\u5668\u3002</p> \u5fc5\u9700 <code>message_decoder</code> <code>MessageDecoder</code> <p>\u6ce8\u5165\u7684\u6d88\u606f\u89e3\u7801\u5668\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/message_domain_service.py</code> <pre><code>def __init__(self, message_encoder: MessageEncoder, message_decoder: MessageDecoder):\n    \"\"\"\u521d\u59cb\u5316\u6d88\u606f\u9886\u57df\u670d\u52a1\u3002\n\n    Args:\n        message_encoder (MessageEncoder): \u6ce8\u5165\u7684\u6d88\u606f\u7f16\u7801\u5668\u3002\n        message_decoder (MessageDecoder): \u6ce8\u5165\u7684\u6d88\u606f\u89e3\u7801\u5668\u3002\n    \"\"\"\n    self.message_encoder = message_encoder\n    self.message_decoder = message_decoder\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MessageDomainService.encode_message","title":"encode_message","text":"<pre><code>encode_message(**message: Any) -&gt; str\n</code></pre> <p>\u7f16\u7801\u6d88\u606f\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>**message</code> <code>Any</code> <p>\u6d88\u606f\u5b57\u6bb5\u952e\u503c\u5bf9\u3002</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>str</code> <code>str</code> <p>\u7f16\u7801\u540e\u7684\u5341\u516d\u8fdb\u5236\u6d88\u606f\u5b57\u7b26\u4e32\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/message_domain_service.py</code> <pre><code>def encode_message(self, **message: Any) -&gt; str:\n    \"\"\"\u7f16\u7801\u6d88\u606f\u3002\n\n    Args:\n        **message: \u6d88\u606f\u5b57\u6bb5\u952e\u503c\u5bf9\u3002\n\n    Returns:\n        str: \u7f16\u7801\u540e\u7684\u5341\u516d\u8fdb\u5236\u6d88\u606f\u5b57\u7b26\u4e32\u3002\n    \"\"\"\n    m = self.message_encoder.create_message(**message)\n    return self.message_encoder.interpret_message(m)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MessageDomainService.decode_message","title":"decode_message","text":"<pre><code>decode_message(message: str) -&gt; Any\n</code></pre> <p>\u89e3\u7801\u6d88\u606f\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>message</code> <code>str</code> <p>\u5341\u516d\u8fdb\u5236\u6d88\u606f\u5b57\u7b26\u4e32\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Any</code> <code>Any</code> <p>\u89e3\u7801\u540e\u7684\u6d88\u606f\u5bf9\u8c61 (MessageIn)\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/message_domain_service.py</code> <pre><code>def decode_message(self, message: str) -&gt; Any:\n    \"\"\"\u89e3\u7801\u6d88\u606f\u3002\n\n    Args:\n        message (str): \u5341\u516d\u8fdb\u5236\u6d88\u606f\u5b57\u7b26\u4e32\u3002\n\n    Returns:\n        Any: \u89e3\u7801\u540e\u7684\u6d88\u606f\u5bf9\u8c61 (MessageIn)\u3002\n    \"\"\"\n    return self.message_decoder.decode_message(message)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SCurve","title":"SCurve","text":"<pre><code>SCurve(v_max=[pi / 4] * 6, acc_max=[pi / 8] * 6, t_j=0.5)\n</code></pre> <p>S\u66f2\u7ebf\u901f\u5ea6\u89c4\u5212\u7b97\u6cd5\u3002</p> <p>\u5b9e\u73b0\u57fa\u4e8e\u52a0\u52a0\u901f\u5ea6(Jerk)\u9650\u5236\u7684S\u578b\u901f\u5ea6\u66f2\u7ebf\u89c4\u5212\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>v_max</code> <code>ndarray</code> <p>\u6700\u5927\u901f\u5ea6\u9650\u5236\u3002</p> <code>acc_max</code> <code>ndarray</code> <p>\u6700\u5927\u52a0\u901f\u5ea6\u9650\u5236\u3002</p> <code>t_j</code> <code>float</code> <p>\u52a0\u52a0\u51cf\u901f\u6bb5\u65f6\u95f4\u3002</p> <p>\u521d\u59cb\u5316 S \u66f2\u7ebf\u89c4\u5212\u5668\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>v_max</code> <code>list[float]</code> <p>\u6700\u5927\u901f\u5ea6. Defaults to [pi/4]*6.</p> <code>[pi / 4] * 6</code> <code>acc_max</code> <code>list[float]</code> <p>\u6700\u5927\u52a0\u901f\u5ea6. Defaults to [pi/8]*6.</p> <code>[pi / 8] * 6</code> <code>t_j</code> <code>float</code> <p>Jerk \u65f6\u95f4\u53c2\u6570. Defaults to 0.5.</p> <code>0.5</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/trajectory_domain_service.py</code> <pre><code>def __init__(self, v_max=[pi/4] * 6, acc_max=[pi/8] * 6, t_j=0.5):\n    \"\"\"\u521d\u59cb\u5316 S \u66f2\u7ebf\u89c4\u5212\u5668\u3002\n\n    Args:\n        v_max (list[float], optional): \u6700\u5927\u901f\u5ea6. Defaults to [pi/4]*6.\n        acc_max (list[float], optional): \u6700\u5927\u52a0\u901f\u5ea6. Defaults to [pi/8]*6.\n        t_j (float, optional): Jerk \u65f6\u95f4\u53c2\u6570. Defaults to 0.5.\n    \"\"\"\n    self.v_max = np.array(v_max)\n    self.acc_max = np.array(acc_max)\n    self.t_j = t_j\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SCurve.solve_cubic_numeric","title":"solve_cubic_numeric  <code>staticmethod</code>","text":"<pre><code>solve_cubic_numeric(a, b, c, d, tol=1e-08)\n</code></pre> <p>\u6c42\u89e3\u4e09\u6b21\u65b9\u7a0b\u5b9e\u6839\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/trajectory_domain_service.py</code> <pre><code>@staticmethod\ndef solve_cubic_numeric(a, b, c, d, tol = 1e-8):\n    \"\"\"\u6c42\u89e3\u4e09\u6b21\u65b9\u7a0b\u5b9e\u6839\u3002\"\"\"\n    roots = np.roots([a, b, c, d])\n    real_mask = np.isclose(roots.imag, 0, atol=tol)\n    real_roots = roots[real_mask].real\n\n    return real_roots\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SCurve.solve_quadratic","title":"solve_quadratic  <code>staticmethod</code>","text":"<pre><code>solve_quadratic(a, b, c, tol=1e-08)\n</code></pre> <p>\u6c42\u89e3\u4e8c\u6b21\u65b9\u7a0b\u5b9e\u6839\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/trajectory_domain_service.py</code> <pre><code>@staticmethod\ndef solve_quadratic(a, b, c, tol=1e-8):\n    \"\"\"\u6c42\u89e3\u4e8c\u6b21\u65b9\u7a0b\u5b9e\u6839\u3002\"\"\"\n    coeffs = [a, b, c]\n    roots = np.roots(coeffs)\n    real_mask = np.isclose(roots.imag, 0, atol=tol)\n    real_roots = roots[real_mask].real\n\n    return real_roots\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SCurve.base_method","title":"base_method  <code>staticmethod</code>","text":"<pre><code>base_method(t: float, jerk: float, a_start: float, v_start: float, s_start: float) -&gt; tuple[float, float, float]\n</code></pre> <p>\u57fa\u7840\u8fd0\u52a8\u5b66\u65b9\u7a0b\u8ba1\u7b97\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>tuple</code> <code>tuple[float, float, float]</code> <p>(a, v, s) \u5f53\u524d\u65f6\u523b\u7684\u52a0\u901f\u5ea6\u3001\u901f\u5ea6\u3001\u4f4d\u79fb\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/trajectory_domain_service.py</code> <pre><code>@staticmethod\ndef base_method(t: float, jerk: float, a_start: float, v_start: float, s_start: float) -&gt; tuple[float, float, float]:\n    \"\"\"\u57fa\u7840\u8fd0\u52a8\u5b66\u65b9\u7a0b\u8ba1\u7b97\u3002\n\n    Returns:\n        tuple: (a, v, s) \u5f53\u524d\u65f6\u523b\u7684\u52a0\u901f\u5ea6\u3001\u901f\u5ea6\u3001\u4f4d\u79fb\u3002\n    \"\"\"\n    a = jerk * t + a_start\n    v = jerk * t**2 / 2 + a_start * t + v_start\n    s = jerk * t**3 / 6 + a_start * t**2 / 2 + v_start * t + s_start\n    return a, v, s\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SCurve.planning","title":"planning","text":"<pre><code>planning(start_angles: list[float], target_angles: list[float], v_start: list[float] = [0] * 6, dt: float = 0.01) -&gt; tuple[np.ndarray, np.ndarray, np.ndarray, np.ndarray]\n</code></pre> <p>\u89c4\u5212\u4ece\u8d77\u70b9\u5230\u7ec8\u70b9\u7684S\u66f2\u7ebf\u8f68\u8ff9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>start_angles</code> <code>list[float]</code> <p>\u8d77\u70b9\u89d2\u5ea6\u3002</p> \u5fc5\u9700 <code>target_angles</code> <code>list[float]</code> <p>\u7ec8\u70b9\u89d2\u5ea6\u3002</p> \u5fc5\u9700 <code>v_start</code> <code>list[float]</code> <p>\u8d77\u59cb\u901f\u5ea6. Defaults to [0]*6.</p> <code>[0] * 6</code> <code>dt</code> <code>float</code> <p>\u65f6\u95f4\u6b65\u957f. Defaults to 0.01.</p> <code>0.01</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>tuple</code> <code>tuple[ndarray, ndarray, ndarray, ndarray]</code> <p>(times, accelerations, velocities, positions) \u89c4\u5212\u7ed3\u679c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/trajectory_domain_service.py</code> <pre><code>def planning(self, start_angles: list[float], target_angles: list[float], v_start: list[float] = [0] * 6, dt: float = 0.01) -&gt; tuple[np.ndarray, np.ndarray, np.ndarray, np.ndarray]:\n    \"\"\"\u89c4\u5212\u4ece\u8d77\u70b9\u5230\u7ec8\u70b9\u7684S\u66f2\u7ebf\u8f68\u8ff9\u3002\n\n    Args:\n        start_angles (list[float]): \u8d77\u70b9\u89d2\u5ea6\u3002\n        target_angles (list[float]): \u7ec8\u70b9\u89d2\u5ea6\u3002\n        v_start (list[float], optional): \u8d77\u59cb\u901f\u5ea6. Defaults to [0]*6.\n        dt (float, optional): \u65f6\u95f4\u6b65\u957f. Defaults to 0.01.\n\n    Returns:\n        tuple: (times, accelerations, velocities, positions) \u89c4\u5212\u7ed3\u679c\u3002\n    \"\"\"\n    start_angles = np.array(start_angles)\n    target_angles = np.array(target_angles)\n    displacements = target_angles - start_angles\n    abs_displacements = np.abs(displacements)\n    if np.all(abs_displacements &lt; 1e-6):\n        num_samples = 1\n        times = np.array([0.0])\n        velocities = np.zeros((num_samples, 6))\n        accelerations = np.zeros((num_samples, 6))\n        positions = np.copy(start_angles).reshape((num_samples, 6))\n        # \u4fdd\u6301\u4e0e\u5176\u4ed6\u8fd4\u56de\u8def\u5f84\u4e00\u81f4\u7684\u987a\u5e8f\uff1atimes, accelerations, velocities, positions\n        return times, accelerations, velocities, positions\n    max_displacement_idx = np.argmax(abs_displacements)\n    max_displacement = abs_displacements[max_displacement_idx]\n    a_max = self.acc_max[max_displacement_idx]\n    v_max = self.v_max[max_displacement_idx]\n    max_v_start = v_start[max_displacement_idx]\n    jerk = a_max / self.t_j\n    s_1, list_t_1, list_a_1, list_v_1, list_s_1 = self.get_boundary_1(jerk, 0, max_v_start, 0, v_max, a_max)\n    s_2, t_2 = self.get_boundary_2(jerk, 0, max_v_start, 0)\n    if s_1 &lt; max_displacement:\n        t_acc_1, t_acc_2, t_acc_3, t_dec_1, t_dec_2, t_dec_3 = list_t_1\n        a_acc_1, a_acc_2, a_acc_3, a_dec_1, a_dec_2, a_dec_3 = list_a_1\n        v_acc_1, v_acc_2, v_acc_3, v_dec_1, v_dec_2, v_dec_3 = list_v_1\n        s_acc_1, s_acc_2, s_acc_3, s_dec_1, s_dec_2, s_dec_3 = list_s_1\n        s_const = max_displacement - s_1\n        t_const = s_const / v_max\n        target_time = sum(list_t_1) + t_const\n        param_arr = np.array([\n            [0, 0, 0, 0, 0],\n            [t_acc_1, jerk, 0, max_v_start, 0],\n            [t_acc_1 + t_acc_2, 0, a_acc_1, v_acc_1, s_acc_1],\n            [t_acc_1 + t_acc_2 + t_acc_3, -jerk, a_acc_2, v_acc_2, s_acc_2],\n            [t_acc_1 + t_acc_2 + t_acc_3 + t_const, 0, a_acc_3, v_acc_3, s_acc_3],\n            [t_acc_1 + t_acc_2 + t_acc_3 + t_const + t_dec_1, -jerk, a_acc_3, v_acc_3, s_acc_3 + s_const],\n            [t_acc_1 + t_acc_2 + t_acc_3 + t_const + t_dec_1 + t_dec_2, 0, a_dec_1, v_dec_1, s_dec_1 + s_const],\n            [t_acc_1 + t_acc_2 + t_acc_3 + t_const + t_dec_1 + t_dec_2 + t_dec_3, jerk, a_dec_2, v_dec_2, s_dec_2 + s_const],\n        ])\n        times, accelerations, velocities, positions = self.get_result(param_arr, target_time, dt, max_displacement_idx)\n        accelerations, velocities, positions = self.scale_result(accelerations, \n                                                                 velocities,\n                                                                 positions,\n                                                                 max_displacement_idx, \n                                                                 displacements, \n                                                                 abs_displacements,\n                                                                 start_angles, \n                                                                 target_angles)\n        return times, accelerations, velocities, positions\n\n    elif s_2 &gt; max_displacement:\n        t0 = max_v_start / jerk\n        a = 2 * jerk\n        b = jerk * t0 / 2\n        c = 4 * max_v_start - jerk * t0**2 / 2\n        d = -max_displacement\n        t_j = self.solve_cubic_numeric(a, b, c, d)\n        t_j = t_j[(t_j &gt; 0) &amp; (t_j &lt; self.t_j)][0]\n        s_acc_5, list_t_3, list_a_3, list_v_3, list_s_3 = self.get_stage_3(jerk, 0, max_v_start, 0, t_j, t0)\n        t_acc_1, t_acc_2, t_dec_1, t_dec_2, t_dec_3 = list_t_3\n        a_acc_1, a_acc_2, a_dec_1, a_dec_2, a_dec_3 = list_a_3\n        v_acc_1, v_acc_2, v_dec_1, v_dec_2, v_dec_3 = list_v_3\n        s_acc_1, s_acc_2, s_dec_1, s_dec_2, s_dec_3 = list_s_3\n        target_time = sum(list_t_3)\n        param_arr = np.array([\n            [0, 0, 0, 0, 0],\n            [t_acc_1, jerk, 0, max_v_start, 0],\n            [t_acc_1 + t_acc_2, -jerk, a_acc_1, v_acc_1, s_acc_1],\n            [t_acc_1 + t_acc_2 + t_dec_1, -jerk, a_acc_2, v_acc_2, s_acc_2],\n            [t_acc_1 + t_acc_2 + t_dec_1 + t_dec_2, 0, a_dec_1, v_dec_1, s_dec_1],\n            [t_acc_1 + t_acc_2 + t_dec_1 + t_dec_2 + t_dec_3, jerk, a_dec_2, v_dec_2, s_dec_2],\n        ])\n        times, accelerations, velocities, positions = self.get_result(param_arr, target_time, dt, max_displacement_idx)\n        accelerations, velocities, positions = self.scale_result(accelerations, \n                                                                 velocities,\n                                                                 positions,\n                                                                 max_displacement_idx, \n                                                                 displacements, \n                                                                 abs_displacements,\n                                                                 start_angles, \n                                                                 target_angles)\n        return times, accelerations, velocities, positions\n    else:\n        a_acc_1, v_acc_1, s_acc_1 = self.base_method(self.t_j, jerk, 0, max_v_start, 0)\n        t0 = max_v_start / a_acc_1\n        s_t0 = a_max * t0**2 / 2 + jerk * self.t_j ** 2 * t0 / 2\n        s_dec_3 = jerk * self.t_j ** 3 / 6\n        delta_s = max_displacement - s_t0 - s_dec_3 - s_acc_1\n        a = a_max / 2\n        b = 3 / 2 * a_max * self.t_j + max_v_start\n        c = 5 / 6 * a_max * self.t_j ** 2 + max_v_start * self.t_j - delta_s / 2 \n        t_k = self.solve_quadratic(a, b, c)\n        t_k = t_k[(4 * self.t_j + 2 * t_k + t0 &gt; t_2) &amp; (4 * self.t_j + 2 * t_k + t0 &lt; sum(list_t_1))][0]\n        s_dec_4, list_t_2, list_a_2, list_v_2, list_s_2 = self.get_stage_2(jerk, 0, max_v_start, 0, t_k, t0)\n        t_acc_1, t_acc_2, t_acc_3, t_dec_1, t_dec_2, t_dec_3, t_dec_4 = list_t_2\n        a_acc_1, a_acc_2, a_acc_3, a_dec_1, a_dec_2, a_dec_3, a_dec_4 = list_a_2\n        v_acc_1, v_acc_2, v_acc_3, v_dec_1, v_dec_2, v_dec_3, v_dec_4 = list_v_2\n        s_acc_1, s_acc_2, s_acc_3, s_dec_1, s_dec_2, s_dec_3, s_dec_4 = list_s_2\n\n        target_time = sum(list_t_2)\n        param_arr = np.array([\n            [0, 0, 0, 0, 0],\n            [t_acc_1, jerk, 0, max_v_start, 0],\n            [t_acc_1 + t_acc_2, 0, a_acc_1, v_acc_1, s_acc_1],\n            [t_acc_1 + t_acc_2 + t_acc_3, -jerk, a_acc_2, v_acc_2, s_acc_2],\n            [t_acc_1 + t_acc_2 + t_acc_3 + t_dec_1, -jerk, a_acc_3, v_acc_3, s_acc_3],\n            [t_acc_1 + t_acc_2 + t_acc_3 + t_dec_1 + t_dec_2, 0, a_dec_1, v_dec_1, s_dec_1],\n            [t_acc_1 + t_acc_2 + t_acc_3 + t_dec_1 + t_dec_2 + t_dec_3, 0, a_dec_2, v_dec_2, s_dec_2],\n            [t_acc_1 + t_acc_2 + t_acc_3 + t_dec_1 + t_dec_2 + t_dec_3 + t_dec_4, jerk, a_dec_3, v_dec_3, s_dec_3],\n        ])\n        times, accelerations, velocities, positions = self.get_result(param_arr, target_time, dt, max_displacement_idx)\n        accelerations, velocities, positions = self.scale_result(accelerations, \n                                                        velocities,\n                                                        positions,\n                                                        max_displacement_idx, \n                                                        displacements, \n                                                        abs_displacements,\n                                                        start_angles, \n                                                        target_angles)\n        return times, accelerations, velocities, positions\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SmoothDomainService","title":"SmoothDomainService","text":"<pre><code>SmoothDomainService()\n</code></pre> <p>\u8f68\u8ff9\u5e73\u6ed1\u670d\u52a1\u3002</p> <p>\u63d0\u4f9b\u591a\u79cd\u5e73\u6ed1\u7b97\u6cd5\uff1a 1. Cubic Spline + Savitzky-Golay \u6ee4\u6ce2\uff08\u9ed8\u8ba4\uff0c\u65e7\u7248\uff09 2. TOPPRA \u65f6\u95f4\u53c2\u6570\u5316\u5e73\u6ed1\uff08\u53ef\u9009\uff0c\u65e7\u7248\u6d4b\u8bd5\u65b9\u6cd5\uff09</p> <p>\u9002\u7528\u573a\u666f\uff1a - \u793a\u6559\u8f68\u8ff9\u64ad\u653e - \u591a\u70b9\u8f68\u8ff9\u89c4\u5212 - \u4efb\u4f55\u9700\u8981\u8f68\u8ff9\u5e73\u6ed1\u7684\u573a\u666f</p> <p>\u521d\u59cb\u5316\u5e73\u6ed1\u670d\u52a1\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/smooth_domain_service.py</code> <pre><code>def __init__(self):\n    \"\"\"\u521d\u59cb\u5316\u5e73\u6ed1\u670d\u52a1\u3002\"\"\"\n    pass\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SmoothDomainService.smooth_trajectory","title":"smooth_trajectory","text":"<pre><code>smooth_trajectory(angles_list: List[List[float]], method: str = 'spline_savgol', **kwargs: Any) -&gt; List[List[float]]\n</code></pre> <p>\u5e73\u6ed1\u8f68\u8ff9\uff08\u7edf\u4e00\u63a5\u53e3\uff09\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>angles_list</code> <code>List[List[float]]</code> <p>\u539f\u59cb\u8f68\u8ff9 [[\u03b81,...,\u03b86], ...]\u3002</p> \u5fc5\u9700 <code>method</code> <code>str</code> <p>\u5e73\u6ed1\u65b9\u6cd5 (\"spline_savgol\" \u6216 \"toppra\"). Defaults to \"spline_savgol\".</p> <code>'spline_savgol'</code> <code>**kwargs</code> <code>Any</code> <p>\u5404\u7b97\u6cd5\u7684\u7279\u5b9a\u53c2\u6570\u3002</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[List[float]]</code> <p>List[List[float]]: \u5e73\u6ed1\u540e\u7684\u8f68\u8ff9\u70b9\u5217\u8868\u3002</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ValueError</code> <p>\u5982\u679c\u6307\u5b9a\u4e86\u672a\u77e5\u7684\u5e73\u6ed1\u65b9\u6cd5\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/smooth_domain_service.py</code> <pre><code>def smooth_trajectory(\n    self, \n    angles_list: List[List[float]], \n    method: str = \"spline_savgol\",\n    **kwargs: Any\n) -&gt; List[List[float]]:\n    \"\"\"\u5e73\u6ed1\u8f68\u8ff9\uff08\u7edf\u4e00\u63a5\u53e3\uff09\u3002\n\n    Args:\n        angles_list (List[List[float]]): \u539f\u59cb\u8f68\u8ff9 [[\u03b81,...,\u03b86], ...]\u3002\n        method (str, optional): \u5e73\u6ed1\u65b9\u6cd5 (\"spline_savgol\" \u6216 \"toppra\"). Defaults to \"spline_savgol\".\n        **kwargs: \u5404\u7b97\u6cd5\u7684\u7279\u5b9a\u53c2\u6570\u3002\n\n    Returns:\n        List[List[float]]: \u5e73\u6ed1\u540e\u7684\u8f68\u8ff9\u70b9\u5217\u8868\u3002\n\n    Raises:\n        ValueError: \u5982\u679c\u6307\u5b9a\u4e86\u672a\u77e5\u7684\u5e73\u6ed1\u65b9\u6cd5\u3002\n    \"\"\"\n    if method == \"spline_savgol\":\n        return self.spline_then_savgol(angles_list, **kwargs)\n    elif method == \"toppra\":\n        return self.toppra_smooth(angles_list, **kwargs)\n    else:\n        raise ValueError(f\"\u672a\u77e5\u7684\u5e73\u6ed1\u65b9\u6cd5: {method}\")\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SmoothDomainService.spline_then_savgol","title":"spline_then_savgol","text":"<pre><code>spline_then_savgol(angles_list: List[List[float]], upsample: int = 5, sg_window: int = 211, sg_poly: int = 3) -&gt; List[List[float]]\n</code></pre> <p>Cubic Spline + Savitzky-Golay \u6ee4\u6ce2\uff08\u53c2\u8003\u65e7\u7248\uff09\u3002</p> <p>\u6d41\u7a0b\uff1a 1. Savitzky-Golay \u5e73\u6ed1\u539f\u59cb\u6570\u636e 2. Cubic Spline \u4e0a\u91c7\u6837\u63d2\u503c 3. \u91cd\u91c7\u6837\u56de\u539f\u59cb\u70b9\u6570 4. \u518d\u6b21 Savitzky-Golay \u5e73\u6ed1</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>angles_list</code> <code>List[List[float]]</code> <p>\u539f\u59cb\u8f68\u8ff9 N\u00d76\u3002</p> \u5fc5\u9700 <code>upsample</code> <code>int</code> <p>\u4e0a\u91c7\u6837\u500d\u6570. Defaults to 5.</p> <code>5</code> <code>sg_window</code> <code>int</code> <p>Savgol \u6ee4\u6ce2\u7a97\u53e3\uff08\u5fc5\u987b\u662f\u5947\u6570\uff09. Defaults to 211.</p> <code>211</code> <code>sg_poly</code> <code>int</code> <p>Savgol \u591a\u9879\u5f0f\u9636\u6570. Defaults to 3.</p> <code>3</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[List[float]]</code> <p>List[List[float]]: \u5e73\u6ed1\u540e\u7684\u8f68\u8ff9\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/smooth_domain_service.py</code> <pre><code>def spline_then_savgol(\n    self,\n    angles_list: List[List[float]],\n    upsample: int = 5,\n    sg_window: int = 211,\n    sg_poly: int = 3\n) -&gt; List[List[float]]:\n    \"\"\"Cubic Spline + Savitzky-Golay \u6ee4\u6ce2\uff08\u53c2\u8003\u65e7\u7248\uff09\u3002\n\n    \u6d41\u7a0b\uff1a\n    1. Savitzky-Golay \u5e73\u6ed1\u539f\u59cb\u6570\u636e\n    2. Cubic Spline \u4e0a\u91c7\u6837\u63d2\u503c\n    3. \u91cd\u91c7\u6837\u56de\u539f\u59cb\u70b9\u6570\n    4. \u518d\u6b21 Savitzky-Golay \u5e73\u6ed1\n\n    Args:\n        angles_list (List[List[float]]): \u539f\u59cb\u8f68\u8ff9 N\u00d76\u3002\n        upsample (int, optional): \u4e0a\u91c7\u6837\u500d\u6570. Defaults to 5.\n        sg_window (int, optional): Savgol \u6ee4\u6ce2\u7a97\u53e3\uff08\u5fc5\u987b\u662f\u5947\u6570\uff09. Defaults to 211.\n        sg_poly (int, optional): Savgol \u591a\u9879\u5f0f\u9636\u6570. Defaults to 3.\n\n    Returns:\n        List[List[float]]: \u5e73\u6ed1\u540e\u7684\u8f68\u8ff9\u5217\u8868\u3002\n    \"\"\"\n    arr = np.asarray(angles_list, dtype=float)\n    N, D = arr.shape\n\n    # \u786e\u4fdd\u7a97\u53e3\u5927\u5c0f\u4e0d\u8d85\u8fc7\u6570\u636e\u70b9\u6570\n    sg_window = min(sg_window, N if N % 2 == 1 else N - 1)\n    if sg_window &lt; sg_poly + 2:\n        sg_window = sg_poly + 2\n        if sg_window % 2 == 0:\n            sg_window += 1\n\n    # 1. Savitzky\u2013Golay\u5e73\u6ed1\uff08\u5148\u5e73\u6ed1\uff09\n    smoothed = savgol_filter(\n        arr,\n        window_length=sg_window,\n        polyorder=sg_poly,\n        axis=0\n    )\n\n    # 2. \u4e09\u6b21\u6837\u6761\u63d2\u503c\uff08\u518d\u63d2\u503c\uff09\n    t = np.arange(N)\n    t_new = np.linspace(0, N - 1, N * upsample)\n    interp = np.empty((len(t_new), D), dtype=float)\n\n    for j in range(D):\n        cs = CubicSpline(t, smoothed[:, j])\n        interp[:, j] = cs(t_new)\n\n    # 3. \u91cd\u91c7\u6837\u56de\u539f\u59cb\u70b9\u6570\n    indices = np.linspace(0, len(t_new) - 1, N).astype(int)\n    resampled = interp[indices, :]\n\n    # 4. \u518d\u6b21\u5e73\u6ed1\n    resampled = savgol_filter(\n        resampled,\n        window_length=sg_window,\n        polyorder=sg_poly,\n        axis=0\n    )\n\n    return resampled.tolist()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SmoothDomainService.toppra_smooth","title":"toppra_smooth","text":"<pre><code>toppra_smooth(waypoints: ndarray, v_max: ndarray | float, a_max: ndarray | float, dt: float = 0.01, grid_n: int = 800) -&gt; List[List[float]]\n</code></pre> <p>\u4f7f\u7528 TOPPRA \u8fdb\u884c\u5e73\u6ed1\u5904\u7406\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>waypoints</code> <code>ndarray</code> <p>\u8def\u5f84\u70b9 (N, dof)\u3002</p> \u5fc5\u9700 <code>v_max</code> <code>ndarray | float</code> <p>\u6700\u5927\u901f\u5ea6\u3002</p> \u5fc5\u9700 <code>a_max</code> <code>ndarray | float</code> <p>\u6700\u5927\u52a0\u901f\u5ea6\u3002</p> \u5fc5\u9700 <code>dt</code> <code>float</code> <p>\u65f6\u95f4\u6b65\u957f. Defaults to 0.01.</p> <code>0.01</code> <code>grid_n</code> <code>int</code> <p>\u7f51\u683c\u6570. Defaults to 800.</p> <code>800</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>list</code> <code>List[List[float]]</code> <p>\u5e73\u6ed1\u540e\u7684\u5173\u8282\u4f4d\u7f6e\u5217\u8868\u3002</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ValueError</code> <p>\u53c2\u6570\u9519\u8bef\u3002</p> <code>RuntimeError</code> <p>\u6c42\u89e3\u5931\u8d25\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/smooth_domain_service.py</code> <pre><code>def toppra_smooth(self,\n    waypoints: np.ndarray,\n    v_max: np.ndarray | float,\n    a_max: np.ndarray | float,\n    dt: float = 0.01,\n    grid_n: int = 800\n) -&gt; List[List[float]]:\n    \"\"\"\u4f7f\u7528 TOPPRA \u8fdb\u884c\u5e73\u6ed1\u5904\u7406\u3002\n\n    Args:\n        waypoints (np.ndarray): \u8def\u5f84\u70b9 (N, dof)\u3002\n        v_max (np.ndarray | float): \u6700\u5927\u901f\u5ea6\u3002\n        a_max (np.ndarray | float): \u6700\u5927\u52a0\u901f\u5ea6\u3002\n        dt (float, optional): \u65f6\u95f4\u6b65\u957f. Defaults to 0.01.\n        grid_n (int, optional): \u7f51\u683c\u6570. Defaults to 800.\n\n    Returns:\n        list: \u5e73\u6ed1\u540e\u7684\u5173\u8282\u4f4d\u7f6e\u5217\u8868\u3002\n\n    Raises:\n        ValueError: \u53c2\u6570\u9519\u8bef\u3002\n        RuntimeError: \u6c42\u89e3\u5931\u8d25\u3002\n    \"\"\"\n    waypoints = np.asarray(waypoints, dtype=float)\n    if waypoints.ndim != 2 or waypoints.shape[1] != 6 or waypoints.shape[0] &lt; 2:\n        raise ValueError(\"waypoints \u5fc5\u987b\u662f (N,6) \u4e14 N&gt;=2\")\n\n    dof = waypoints.shape[1]\n\n    # 1) \u51e0\u4f55\u8def\u5f84\uff1a\u7528\u6837\u6761\u5728\u8def\u5f84\u53c2\u6570 s\u2208[0,1] \u4e0a\u63d2\u503c\n    breaks = np.linspace(0.0, 1.0, waypoints.shape[0])\n    path = ta.SplineInterpolator(breaks, waypoints)  # \u5b98\u65b9\u793a\u4f8b\u540c\u6b3e API\n\n    # 2) \u901f\u5ea6/\u52a0\u901f\u5ea6\u7ea6\u675f\uff08\u4e0a\u4e0b\u754c\u683c\u5f0f\uff09\n    v_max = np.full(dof, float(v_max)) if np.isscalar(v_max) else np.asarray(v_max, dtype=float)\n    a_max = np.full(dof, float(a_max)) if np.isscalar(a_max) else np.asarray(a_max, dtype=float)\n    if v_max.shape != (dof,) or a_max.shape != (dof,):\n        raise ValueError(\"v_max/a_max \u9700\u4e3a\u6807\u91cf\u6216 shape=(6,)\")\n\n    v_bounds = np.column_stack((-np.abs(v_max), np.abs(v_max)))  # (2,6) -&gt; [v_min; v_max]\n    a_bounds = np.column_stack((-np.abs(a_max), np.abs(a_max)))  # (2,6) -&gt; [a_min; a_max]\n\n    pc_vel = constraint.JointVelocityConstraint(v_bounds)\n    pc_acc = constraint.JointAccelerationConstraint(a_bounds)\n\n    # 3) TOPPRA \u4e3b\u7b97\u6cd5 + \u5e38\u7528\u53c2\u6570\u5316\u5668\uff08\u5e38\u7528\u4e14\u6ee1\u8db3\u8fb9\u754c/\u7ea6\u675f\uff09\n    gridpoints = np.linspace(0, path.duration, int(grid_n))\n    instance = algo.TOPPRA([pc_vel, pc_acc], path, gridpoints=gridpoints, parametrizer=\"ParametrizeConstAccel\")\n\n    # 4) \u6c42\u89e3\u65f6\u95f4\u53c2\u6570\u5316\uff0c\u5f97\u5230\u53ef\u6309\u65f6\u95f4\u91c7\u6837\u7684 jnt_traj\n    jnt_traj = instance.compute_trajectory(sd_start=0.0, sd_end=0.0)\n    if jnt_traj is None:\n        raise RuntimeError(\"TOPPRA \u6c42\u89e3\u5931\u8d25\uff1a\u7ed9\u5b9a\u7ea6\u675f\u4e0b\u4e0d\u53ef\u884c\uff0c\u6216\u8def\u5f84\u5f02\u5e38\u3002\")\n\n    # 5) \u6309 dt \u91c7\u6837\n    T = float(jnt_traj.duration)\n    M = max(2, int(np.ceil(T / dt)) + 1)\n    t = np.linspace(0.0, T, M)\n\n    q   = jnt_traj.eval(t)\n    qd  = jnt_traj.evald(t)\n    qdd = jnt_traj.evaldd(t)\n    return q.tolist()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SmoothDomainService.remove_redundant_points","title":"remove_redundant_points","text":"<pre><code>remove_redundant_points(q_teach: List[List[float]], eps: float = 0.0001) -&gt; List[List[float]]\n</code></pre> <p>\u6539\u8fdb\u7248\u53bb\u9664\u91cd\u590d\u70b9\uff1a\u4fdd\u7559\u201c\u4efb\u610f\u4e00\u4e2a\u5173\u8282\u89d2\u53d8\u5316\u8d85\u8fc7\u9608\u503c\u201d\u7684\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>q_teach</code> <code>List[List[float]]</code> <p>\u793a\u6559\u70b9\u5217\u8868\u3002</p> \u5fc5\u9700 <code>eps</code> <code>float</code> <p>\u53d8\u5316\u9608\u503c. Defaults to 1e-4.</p> <code>0.0001</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[List[float]]</code> <p>List[List[float]]: \u53bb\u91cd\u540e\u7684\u70b9\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/smooth_domain_service.py</code> <pre><code>def remove_redundant_points(self, q_teach: List[List[float]], eps: float = 1e-4) -&gt; List[List[float]]:\n    \"\"\"\u6539\u8fdb\u7248\u53bb\u9664\u91cd\u590d\u70b9\uff1a\u4fdd\u7559\u201c\u4efb\u610f\u4e00\u4e2a\u5173\u8282\u89d2\u53d8\u5316\u8d85\u8fc7\u9608\u503c\u201d\u7684\u70b9\u3002\n\n    Args:\n        q_teach (List[List[float]]): \u793a\u6559\u70b9\u5217\u8868\u3002\n        eps (float, optional): \u53d8\u5316\u9608\u503c. Defaults to 1e-4.\n\n    Returns:\n        List[List[float]]: \u53bb\u91cd\u540e\u7684\u70b9\u5217\u8868\u3002\n    \"\"\"\n    q_teach = np.asarray(q_teach, dtype=float)\n    dq = np.abs(np.diff(q_teach, axis=0))  # \u76f8\u90bb\u5173\u8282\u89d2\u7edd\u5bf9\u5dee\n    moving_mask = np.any(dq &gt; eps, axis=1)  # \u53ea\u8981\u4efb\u610f\u4e00\u8f74\u52a8\u4e86\u5c31\u8ba4\u4e3a\u5728\u52a8\n    mask = np.hstack([[True], moving_mask])  # \u4fdd\u7559\u7b2c\u4e00\u4e2a\u70b9\n    return q_teach[mask].tolist()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SmoothDomainService.resample_equal_arclen","title":"resample_equal_arclen","text":"<pre><code>resample_equal_arclen(q_points: List[List[float]], step: float = 0.002) -&gt; List[List[float]]\n</code></pre> <p>\u6309\u5f27\u957f\u91cd\u91c7\u6837\uff0c\u4f7f\u8def\u5f84\u5728\u5173\u8282\u7a7a\u95f4\u4e2d\u5206\u5e03\u5747\u5300\u3002</p> <p>\u539f\u7406\uff1a - \u8ba1\u7b97\u76f8\u90bb\u70b9\u7684\u6b27\u6c0f\u8ddd\u79bb\uff08\u5f27\u957f\uff09 - \u5c06\u5f27\u957f\u79ef\u5206\u5f97\u5230\u7d2f\u8ba1s - \u5bf9s\u5747\u5300\u53d6\u6837\u540e\uff0c\u7528\u63d2\u503c\u51fd\u6570\u751f\u6210\u65b0\u70b9</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>q_points</code> <code>List[List[float]]</code> <p>\u539f\u59cb\u70b9\u5217\u8868\u3002</p> \u5fc5\u9700 <code>step</code> <code>float</code> <p>\u91cd\u91c7\u6837\u6b65\u957f. Defaults to 0.002.</p> <code>0.002</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[List[float]]</code> <p>List[List[float]]: \u91cd\u91c7\u6837\u540e\u7684\u70b9\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/smooth_domain_service.py</code> <pre><code>def resample_equal_arclen(self, q_points: List[List[float]], step: float = 0.002) -&gt; List[List[float]]:\n    \"\"\"\u6309\u5f27\u957f\u91cd\u91c7\u6837\uff0c\u4f7f\u8def\u5f84\u5728\u5173\u8282\u7a7a\u95f4\u4e2d\u5206\u5e03\u5747\u5300\u3002\n\n    \u539f\u7406\uff1a\n    - \u8ba1\u7b97\u76f8\u90bb\u70b9\u7684\u6b27\u6c0f\u8ddd\u79bb\uff08\u5f27\u957f\uff09\n    - \u5c06\u5f27\u957f\u79ef\u5206\u5f97\u5230\u7d2f\u8ba1s\n    - \u5bf9s\u5747\u5300\u53d6\u6837\u540e\uff0c\u7528\u63d2\u503c\u51fd\u6570\u751f\u6210\u65b0\u70b9\n\n    Args:\n        q_points (List[List[float]]): \u539f\u59cb\u70b9\u5217\u8868\u3002\n        step (float, optional): \u91cd\u91c7\u6837\u6b65\u957f. Defaults to 0.002.\n\n    Returns:\n        List[List[float]]: \u91cd\u91c7\u6837\u540e\u7684\u70b9\u5217\u8868\u3002\n    \"\"\"\n    q_points = np.asarray(q_points, dtype=float)\n\n    # \u8ba1\u7b97\u76f8\u90bb\u70b9\u5dee\u503c\u4e0e\u957f\u5ea6\uff08\u5373\u5f27\u957f\u589e\u91cf\uff09\n    diffs = np.diff(q_points, axis=0)\n    ds = np.linalg.norm(diffs, axis=1)\n\n    # \u7d2f\u8ba1\u5f27\u957f s[0]=0, s[-1]=\u603b\u5f27\u957f\n    s = np.hstack([[0], np.cumsum(ds)])\n    s_total = s[-1]\n\n\n    # \u5982\u679c\u8def\u5f84\u51e0\u4e4e\u6ca1\u6709\u957f\u5ea6\uff08\u6240\u6709\u70b9\u90fd\u76f8\u540c\uff09\n    if s_total &lt; 1e-8:\n        # \u76f4\u63a5\u8fd4\u56de\u91cd\u590d\u7684\u540c\u4e00\u4e2a\u70b9\n        return np.repeat(q_points[0:1], 2, axis=0)\n\n    num_points = int(np.ceil(s_total / max(step, 1e-12))) + 1\n    num_points = max(2, num_points)\n    # \u5747\u5300\u53d6\u6837 num_points \u4e2a\u5f27\u957f\u70b9\n    s_uniform = np.linspace(0, s_total, num_points)\n\n    # \u6784\u9020\u5f27\u957f\u5230\u5173\u8282\u89d2\u7684\u63d2\u503c\u51fd\u6570\uff08\u6bcf\u4e2a\u7ef4\u5ea6\u81ea\u52a8\u63d2\u503c\uff09\n    kind = 'cubic' if q_points.shape[0] &gt;= 4 else 'linear'\n    interp_fun = interp1d(s, q_points, axis=0, kind=kind)\n\n    # \u6839\u636e\u5747\u5300\u5f27\u957f\u53d6\u6837\uff0c\u751f\u6210\u91cd\u91c7\u6837\u8f68\u8ff9\n    q_eq = interp_fun(s_uniform)\n\n    return q_eq.tolist()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SmoothDomainService.affine_align_to_fixed_ends","title":"affine_align_to_fixed_ends","text":"<pre><code>affine_align_to_fixed_ends(q_eq: List[List[float]], q_start_req: ndarray, q_end_req: ndarray) -&gt; List[List[float]]\n</code></pre> <p>\u5bf9\u5f27\u957f\u91cd\u91c7\u6837\u540e\u7684\u8f68\u8ff9\u505a\u4eff\u5c04\u53d8\u6362\uff08\u7ebf\u6027\u7f29\u653e+\u5e73\u79fb\uff09\uff0c\u4f7f\u8f68\u8ff9\u7684\u9996\u5c3e\u70b9\u7cbe\u786e\u5bf9\u9f50\u5230\u6307\u5b9a\u7684\u8d77\u70b9\u548c\u7ec8\u70b9\u3002</p> <p>\u6570\u5b66\u5f62\u5f0f\uff1a q_aligned = q_start_req + (q_eq - q0) * scale \u5176\u4e2d scale = (q_end_req - q_start_req) / (q1 - q0)</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>q_eq</code> <code>List[List[float]]</code> <p>\u91cd\u91c7\u6837\u540e\u7684\u8f68\u8ff9\u3002</p> \u5fc5\u9700 <code>q_start_req</code> <code>ndarray</code> <p>\u8981\u6c42\u7684\u8d77\u70b9\u3002</p> \u5fc5\u9700 <code>q_end_req</code> <code>ndarray</code> <p>\u8981\u6c42\u7684\u7ec8\u70b9\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[List[float]]</code> <p>List[List[float]]: \u5bf9\u9f50\u540e\u7684\u8f68\u8ff9\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/smooth_domain_service.py</code> <pre><code>def affine_align_to_fixed_ends(\n    self,\n    q_eq: List[List[float]],\n    q_start_req: np.ndarray,\n    q_end_req: np.ndarray,\n) -&gt; List[List[float]]:\n    \"\"\"\u5bf9\u5f27\u957f\u91cd\u91c7\u6837\u540e\u7684\u8f68\u8ff9\u505a\u4eff\u5c04\u53d8\u6362\uff08\u7ebf\u6027\u7f29\u653e+\u5e73\u79fb\uff09\uff0c\u4f7f\u8f68\u8ff9\u7684\u9996\u5c3e\u70b9\u7cbe\u786e\u5bf9\u9f50\u5230\u6307\u5b9a\u7684\u8d77\u70b9\u548c\u7ec8\u70b9\u3002\n\n    \u6570\u5b66\u5f62\u5f0f\uff1a\n    q_aligned = q_start_req + (q_eq - q0) * scale\n    \u5176\u4e2d scale = (q_end_req - q_start_req) / (q1 - q0)\n\n    Args:\n        q_eq (List[List[float]]): \u91cd\u91c7\u6837\u540e\u7684\u8f68\u8ff9\u3002\n        q_start_req (np.ndarray): \u8981\u6c42\u7684\u8d77\u70b9\u3002\n        q_end_req (np.ndarray): \u8981\u6c42\u7684\u7ec8\u70b9\u3002\n\n    Returns:\n        List[List[float]]: \u5bf9\u9f50\u540e\u7684\u8f68\u8ff9\u3002\n    \"\"\"\n    q_eq = np.asarray(q_eq, dtype=float)\n    q_start_req = np.asarray(q_start_req, dtype=float)\n    q_end_req = np.asarray(q_end_req, dtype=float)\n\n    # \u83b7\u53d6\u539f\u8f68\u8ff9\u7684\u9996\u5c3e\u70b9\n    q0, q1 = q_eq[0], q_eq[-1]\n\n    # \u9632\u6b62\u96640\uff1a\u82e5\u67d0\u4e2a\u5173\u8282\u8d77\u7ec8\u89d2\u5ea6\u76f8\u540c\uff0c\u5219\u5f3a\u5236\u9664\u6570\u4e0d\u4e3a0\n    denom = (q1 - q0)\n    denom[np.abs(denom) &lt; 1e-9] = 1e-9\n\n    # \u6bcf\u4e2a\u5173\u8282\u5355\u72ec\u8ba1\u7b97\u7f29\u653e\u6bd4\u4f8b\n    scale = (q_end_req - q_start_req) / denom\n\n    # \u4eff\u5c04\u53d8\u6362\uff08\u7ebf\u6027\u7f29\u653e + \u5e73\u79fb\uff09\n    q_aligned = q_start_req + (q_eq - q0) * scale\n\n    # \u786e\u4fdd\u8fb9\u754c\u7cbe\u786e\u5339\u914d\n    q_aligned[0] = q_start_req\n    q_aligned[-1] = q_end_req\n\n    return q_aligned.tolist()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SmoothDomainService.teach_smooth","title":"teach_smooth","text":"<pre><code>teach_smooth(q_teach: List[List[float]], q_start_req: ndarray, q_end_req: ndarray, step: float = 0.002, eps: float = 1e-06) -&gt; List[List[float]]\n</code></pre> <p>\u793a\u6559\u8f68\u8ff9\u6574\u4f53\u5e73\u6ed1\u5904\u7406\u3002</p> <p>\u6d41\u7a0b\uff1a 1. \u53bb\u9664\u505c\u987f/\u91cd\u590d\u70b9 2. \u6309\u5f27\u957f\u91cd\u91c7\u6837\uff08\u7a7a\u95f4\u5747\u5300\uff09 3. \u4eff\u5c04\u7f29\u653e\u548c\u5e73\u79fb\u5bf9\u9f50\u6307\u5b9a\u7684\u8d77\u70b9/\u7ec8\u70b9</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>q_teach</code> <code>List[List[float]]</code> <p>\u539f\u59cb\u793a\u6559\u8f68\u8ff9\u3002</p> \u5fc5\u9700 <code>q_start_req</code> <code>ndarray</code> <p>\u8981\u6c42\u7684\u8d77\u70b9\u3002</p> \u5fc5\u9700 <code>q_end_req</code> <code>ndarray</code> <p>\u8981\u6c42\u7684\u7ec8\u70b9\u3002</p> \u5fc5\u9700 <code>step</code> <code>float</code> <p>\u91cd\u91c7\u6837\u6b65\u957f. Defaults to 0.002.</p> <code>0.002</code> <code>eps</code> <code>float</code> <p>\u53bb\u91cd\u9608\u503c. Defaults to 1e-6.</p> <code>1e-06</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[List[float]]</code> <p>List[List[float]]: \u6700\u7ec8\u5e73\u6ed1\u8f68\u8ff9\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/smooth_domain_service.py</code> <pre><code>def teach_smooth(\n    self,\n    q_teach: List[List[float]],\n    q_start_req: np.ndarray,\n    q_end_req: np.ndarray,\n    step: float = 0.002,\n    eps: float = 1e-6,\n) -&gt; List[List[float]]:\n    \"\"\"\u793a\u6559\u8f68\u8ff9\u6574\u4f53\u5e73\u6ed1\u5904\u7406\u3002\n\n    \u6d41\u7a0b\uff1a\n    1. \u53bb\u9664\u505c\u987f/\u91cd\u590d\u70b9\n    2. \u6309\u5f27\u957f\u91cd\u91c7\u6837\uff08\u7a7a\u95f4\u5747\u5300\uff09\n    3. \u4eff\u5c04\u7f29\u653e\u548c\u5e73\u79fb\u5bf9\u9f50\u6307\u5b9a\u7684\u8d77\u70b9/\u7ec8\u70b9\n\n    Args:\n        q_teach (List[List[float]]): \u539f\u59cb\u793a\u6559\u8f68\u8ff9\u3002\n        q_start_req (np.ndarray): \u8981\u6c42\u7684\u8d77\u70b9\u3002\n        q_end_req (np.ndarray): \u8981\u6c42\u7684\u7ec8\u70b9\u3002\n        step (float, optional): \u91cd\u91c7\u6837\u6b65\u957f. Defaults to 0.002.\n        eps (float, optional): \u53bb\u91cd\u9608\u503c. Defaults to 1e-6.\n\n    Returns:\n        List[List[float]]: \u6700\u7ec8\u5e73\u6ed1\u8f68\u8ff9\u3002\n    \"\"\"\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.LinearMotionDomainService","title":"LinearMotionDomainService","text":"<pre><code>LinearMotionDomainService(v_max=[pi / 4] * 6, a_max=[pi / 8] * 6, j_max=[pi / 16] * 6, dt=0.01)\n</code></pre> <p>\u76f4\u7ebf\u8fd0\u52a8\u89c4\u5212\u670d\u52a1\u3002</p> <p>\u63d0\u4f9b\u7a7a\u95f4\u76f4\u7ebf\u63d2\u503c\u8fd0\u52a8\u89c4\u5212\u529f\u80fd\uff0c\u652f\u6301\u6307\u5b9a\u8d77\u70b9\u7ec8\u70b9\u6216\u6307\u5b9a\u65b9\u5411\u8ddd\u79bb\u7684\u89c4\u5212\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>v_max</code> <code>ndarray</code> <p>\u5404\u5173\u8282\u6700\u5927\u901f\u5ea6\u3002</p> <code>a_max</code> <code>ndarray</code> <p>\u5404\u5173\u8282\u6700\u5927\u52a0\u901f\u5ea6\u3002</p> <code>j_max</code> <code>ndarray</code> <p>\u5404\u5173\u8282\u6700\u5927\u52a0\u52a0\u901f\u5ea6\u3002</p> <code>dt</code> <code>float</code> <p>\u65f6\u95f4\u6b65\u957f\u3002</p> <code>kinematic_solver</code> <code>KinematicDomainService</code> <p>\u8fd0\u52a8\u5b66\u6c42\u89e3\u5668\u3002</p> <p>\u521d\u59cb\u5316\u76f4\u7ebf\u8fd0\u52a8\u670d\u52a1\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>v_max</code> <code>list[float]</code> <p>\u6700\u5927\u901f\u5ea6\u5217\u8868. Defaults to [pi/4]*6.</p> <code>[pi / 4] * 6</code> <code>a_max</code> <code>list[float]</code> <p>\u6700\u5927\u52a0\u901f\u5ea6\u5217\u8868. Defaults to [pi/8]*6.</p> <code>[pi / 8] * 6</code> <code>j_max</code> <code>list[float]</code> <p>\u6700\u5927\u52a0\u52a0\u901f\u5ea6\u5217\u8868. Defaults to [pi/16]*6.</p> <code>[pi / 16] * 6</code> <code>dt</code> <code>float</code> <p>\u65f6\u95f4\u6b65\u957f. Defaults to 0.01.</p> <code>0.01</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/linear_motion_domain_service.py</code> <pre><code>def __init__(self, v_max=[pi/4] * 6, a_max=[pi/8] * 6, j_max=[pi/16] * 6, dt=0.01):\n    \"\"\"\u521d\u59cb\u5316\u76f4\u7ebf\u8fd0\u52a8\u670d\u52a1\u3002\n\n    Args:\n        v_max (list[float], optional): \u6700\u5927\u901f\u5ea6\u5217\u8868. Defaults to [pi/4]*6.\n        a_max (list[float], optional): \u6700\u5927\u52a0\u901f\u5ea6\u5217\u8868. Defaults to [pi/8]*6.\n        j_max (list[float], optional): \u6700\u5927\u52a0\u52a0\u901f\u5ea6\u5217\u8868. Defaults to [pi/16]*6.\n        dt (float, optional): \u65f6\u95f4\u6b65\u957f. Defaults to 0.01.\n    \"\"\"\n    self.v_max = np.asarray(v_max,dtype=float)\n    self.a_max = np.asarray(a_max,dtype=float)\n    self.j_max = np.asarray(j_max,dtype=float)\n    self.dt = float(dt)\n    self.kinematic_solver = KinematicDomainService()\n    self.nearest_position = []\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.LinearMotionDomainService.clamp","title":"clamp","text":"<pre><code>clamp(x, low, high)\n</code></pre> <p>\u9650\u5236\u6570\u503c\u8303\u56f4\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/linear_motion_domain_service.py</code> <pre><code>def clamp(self, x, low, high):\n    \"\"\"\u9650\u5236\u6570\u503c\u8303\u56f4\u3002\"\"\"\n    return max(low, min(x, high))\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.LinearMotionDomainService.linear_motion","title":"linear_motion","text":"<pre><code>linear_motion(start_position: list[float], end_position: list[float]) -&gt; tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]\n</code></pre> <p>\u89c4\u5212\u4e24\u70b9\u95f4\u7684\u76f4\u7ebf\u8fd0\u52a8\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>start_position</code> <code>list[float]</code> <p>\u8d77\u70b9\u5173\u8282\u89d2\u5ea6\u3002</p> \u5fc5\u9700 <code>end_position</code> <code>list[float]</code> <p>\u7ec8\u70b9\u5173\u8282\u89d2\u5ea6\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>tuple</code> <code>tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]</code> <p>(t_list, positions, qd, qdd) \u8f68\u8ff9\u6570\u636e\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/linear_motion_domain_service.py</code> <pre><code>def linear_motion(self, start_position: list[float], end_position: list[float]) -&gt; tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]:\n    \"\"\"\u89c4\u5212\u4e24\u70b9\u95f4\u7684\u76f4\u7ebf\u8fd0\u52a8\u3002\n\n    Args:\n        start_position (list[float]): \u8d77\u70b9\u5173\u8282\u89d2\u5ea6\u3002\n        end_position (list[float]): \u7ec8\u70b9\u5173\u8282\u89d2\u5ea6\u3002\n\n    Returns:\n        tuple: (t_list, positions, qd, qdd) \u8f68\u8ff9\u6570\u636e\u3002\n    \"\"\"\n    self.nearest_position = start_position\n    start_quat, start_pos = self.kinematic_solver.get_gripper2base(start_position)\n    end_quat, end_pos = self.kinematic_solver.get_gripper2base(end_position)\n    quat_list, pos_list, n_seg = self.sampling(start_quat, start_pos, end_quat, end_pos)\n    t_list, positions, qd, qdd = self.smooth(quat_list, pos_list, n_seg)\n    return t_list, positions, qd, qdd\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.LinearMotionDomainService.linear_motion_z_axis","title":"linear_motion_z_axis","text":"<pre><code>linear_motion_z_axis(start_position: list[float], distance: float, direction: list[float], ds: float = 0.002, include_end: bool = True) -&gt; tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]\n</code></pre> <p>\u6cbf\u6307\u5b9a\u65b9\u5411\u77e2\u91cf\u8fdb\u884c\u76f4\u7ebf\u8fd0\u52a8\u89c4\u5212\u3002</p> <p>\u6ce8\u610f\uff1a\u6b64\u6a21\u5f0f\u4e0b\u672b\u7aef\u59ff\u6001\u4fdd\u6301\u4e0d\u53d8\uff0c\u4ec5\u4f4d\u7f6e\u53d1\u751f\u4f4d\u79fb\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>start_position</code> <code>list[float]</code> <p>\u8d77\u70b9\u5173\u8282\u89d2\u5ea6\u3002</p> \u5fc5\u9700 <code>distance</code> <code>float</code> <p>\u79fb\u52a8\u8ddd\u79bb (m)\u3002</p> \u5fc5\u9700 <code>direction</code> <code>list[float]</code> <p>\u65b9\u5411\u77e2\u91cf [x, y, z]\u3002</p> \u5fc5\u9700 <code>ds</code> <code>float</code> <p>\u7a7a\u95f4\u91c7\u6837\u6b65\u957f. Defaults to 0.002.</p> <code>0.002</code> <code>include_end</code> <code>bool</code> <p>\u662f\u5426\u5305\u542b\u7ec8\u70b9. Defaults to True.</p> <code>True</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>tuple</code> <code>tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]</code> <p>(t_list, positions, qd, qdd) \u8f68\u8ff9\u6570\u636e\u3002</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ValueError</code> <p>\u5982\u679c\u65b9\u5411\u5411\u91cf\u6a21\u957f\u8fc7\u5c0f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/linear_motion_domain_service.py</code> <pre><code>def linear_motion_z_axis(self, start_position: list[float], distance: float, direction: list[float], ds: float = 0.002, include_end: bool = True) -&gt; tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]:\n    \"\"\"\u6cbf\u6307\u5b9a\u65b9\u5411\u77e2\u91cf\u8fdb\u884c\u76f4\u7ebf\u8fd0\u52a8\u89c4\u5212\u3002\n\n    \u6ce8\u610f\uff1a\u6b64\u6a21\u5f0f\u4e0b\u672b\u7aef\u59ff\u6001\u4fdd\u6301\u4e0d\u53d8\uff0c\u4ec5\u4f4d\u7f6e\u53d1\u751f\u4f4d\u79fb\u3002\n\n    Args:\n        start_position (list[float]): \u8d77\u70b9\u5173\u8282\u89d2\u5ea6\u3002\n        distance (float): \u79fb\u52a8\u8ddd\u79bb (m)\u3002\n        direction (list[float]): \u65b9\u5411\u77e2\u91cf [x, y, z]\u3002\n        ds (float, optional): \u7a7a\u95f4\u91c7\u6837\u6b65\u957f. Defaults to 0.002.\n        include_end (bool, optional): \u662f\u5426\u5305\u542b\u7ec8\u70b9. Defaults to True.\n\n    Returns:\n        tuple: (t_list, positions, qd, qdd) \u8f68\u8ff9\u6570\u636e\u3002\n\n    Raises:\n        ValueError: \u5982\u679c\u65b9\u5411\u5411\u91cf\u6a21\u957f\u8fc7\u5c0f\u3002\n    \"\"\"\n    self.nearest_position = start_position\n    start_quat, start_pos = self.kinematic_solver.get_gripper2base(start_position)\n    # todo: \u6309\u7167distance\u8ba1\u7b97\u7ec8\u70b9\u4f4d\u7f6e\n    p0 = np.asarray(start_pos, dtype=float).reshape(3)\n    q0 = self._q_normalize(start_quat)\n\n    direction = np.asarray(direction, dtype=float)\n    norm = np.linalg.norm(direction)\n    if norm &lt; 1e-9:\n        raise ValueError(\"Direction vector is zero or too small\")\n    direction = direction / norm\n\n    # \u9700\u8981\u7684\u6bb5\u6570\uff08\u4fdd\u8bc1\u6bcf\u6b65\u4e0d\u8d85\u8fc7 ds\uff09\n    L = abs(float(distance))\n    if L &lt; 1e-12:\n        t = np.array([0.0, 1.0]) if include_end else np.array([0.0])\n    else:\n        n_seg = max(1, int(np.ceil(L / ds)))\n        t = np.linspace(0.0, 1.0, n_seg + 1 if include_end else n_seg)\n\n    # \u76f4\u7ebf\u65b9\u5411\uff1axiangliang\n    d = direction * float(distance)\n\n    # \u4f4d\u7f6e\u7ebf\u6027\u91c7\u6837\uff1b\u59ff\u6001\u4fdd\u6301\u4e0d\u53d8\n    pos_list = p0[None, :] + t[:, None] * d[None, :]\n    quat_list = np.repeat(q0[None, :], len(t), axis=0)\n\n    t_list, positions, qd, qdd = self.smooth(quat_list, pos_list, n_seg)\n\n    return t_list, positions, qd, qdd\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.LinearMotionDomainService.sampling","title":"sampling","text":"<pre><code>sampling(start_quat: ndarray, start_pos: ndarray, end_quat: ndarray, end_pos: ndarray, sampling_dis: float = 0.002, include_end: bool = True) -&gt; tuple[np.ndarray, np.ndarray, int]\n</code></pre> <p>\u5bf9\u8d77\u70b9\u548c\u7ec8\u70b9\u8fdb\u884c\u7a7a\u95f4\u7ebf\u6027\u63d2\u503c\u91c7\u6837\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>start_quat</code> <code>ndarray</code> <p>\u8d77\u70b9\u56db\u5143\u6570\u3002</p> \u5fc5\u9700 <code>start_pos</code> <code>ndarray</code> <p>\u8d77\u70b9\u4f4d\u7f6e\u3002</p> \u5fc5\u9700 <code>end_quat</code> <code>ndarray</code> <p>\u7ec8\u70b9\u56db\u5143\u6570\u3002</p> \u5fc5\u9700 <code>end_pos</code> <code>ndarray</code> <p>\u7ec8\u70b9\u4f4d\u7f6e\u3002</p> \u5fc5\u9700 <code>sampling_dis</code> <code>float</code> <p>\u91c7\u6837\u95f4\u8ddd. Defaults to 0.002.</p> <code>0.002</code> <code>include_end</code> <code>bool</code> <p>\u662f\u5426\u5305\u542b\u7ec8\u70b9. Defaults to True.</p> <code>True</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>tuple</code> <code>tuple[ndarray, ndarray, int]</code> <p>(quat_list, pos_list, n_seg)</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/linear_motion_domain_service.py</code> <pre><code>def sampling(self, start_quat: np.ndarray, start_pos: np.ndarray, end_quat: np.ndarray, end_pos: np.ndarray, sampling_dis: float = 0.002, include_end: bool = True) -&gt; tuple[np.ndarray, np.ndarray, int]:\n    \"\"\"\u5bf9\u8d77\u70b9\u548c\u7ec8\u70b9\u8fdb\u884c\u7a7a\u95f4\u7ebf\u6027\u63d2\u503c\u91c7\u6837\u3002\n\n    Args:\n        start_quat (np.ndarray): \u8d77\u70b9\u56db\u5143\u6570\u3002\n        start_pos (np.ndarray): \u8d77\u70b9\u4f4d\u7f6e\u3002\n        end_quat (np.ndarray): \u7ec8\u70b9\u56db\u5143\u6570\u3002\n        end_pos (np.ndarray): \u7ec8\u70b9\u4f4d\u7f6e\u3002\n        sampling_dis (float, optional): \u91c7\u6837\u95f4\u8ddd. Defaults to 0.002.\n        include_end (bool, optional): \u662f\u5426\u5305\u542b\u7ec8\u70b9. Defaults to True.\n\n    Returns:\n        tuple: (quat_list, pos_list, n_seg)\n    \"\"\"\n    quat_list = []\n    pos_list = []\n    # todo: \u6309\u7167\u8d77\u59cb\u56db\u5143\u6570+\u4f4d\u7f6e\u548c\u7ec8\u70b9\u56db\u5143\u6570+\u4f4d\u7f6e\u4ee5\u53ca\u91c7\u6837\u95f4\u96940.02m\uff0c\u8fdb\u884c\u91c7\u6837\n    p0=start_pos\n    p1=end_pos\n    p0 = np.asarray(p0, dtype=float).reshape(3)\n    p1 = np.asarray(p1, dtype=float).reshape(3)\n\n    # \u517c\u5bb9\u4e24\u79cd\u56db\u5143\u6570\u987a\u5e8f\uff1a\u82e5\u6700\u540e\u4e00\u9879\u7edd\u5bf9\u503c\u6700\u5927\uff0c\u89c6\u4e3a [x,y,z,w]\uff0c\u8f6c\u6210 [w,x,y,z]\n    q0=start_quat\n    q1=end_quat\n    q0 = np.asarray(q0, dtype=float).reshape(4)\n    q1 = np.asarray(q1, dtype=float).reshape(4)\n    # if np.argmax(np.abs(q0)) == 3:  # \u53ef\u80fd\u662f [x,y,z,w]\n    #     q0 = np.roll(q0, 1)\n    # if np.argmax(np.abs(q1)) == 3:\n    #     q1 = np.roll(q1, 1)\n\n    # \u8ba1\u7b97\u9700\u8981\u7684\u91c7\u6837\u70b9\u6570\n    L = np.linalg.norm(p1 - p0)\n    if L &lt; 1e-9:\n        t = np.array([0.0, 1.0]) if include_end else np.array([0.0])\n    else:\n        n_seg = max(1, int(np.ceil(L / float(sampling_dis))))\n        t = np.linspace(0.0, 1.0, n_seg + 1 if include_end else n_seg)\n\n    # \u4f4d\u7f6e\u7ebf\u6027\u63d2\u503c\n    pos_list = (p0[None, :] + (p1 - p0)[None, :] * t[:, None])\n\n    # \u59ff\u6001 SLERP\n    quat_list = np.vstack([self._q_slerp(q0, q1, ti) for ti in t])\n\n\n    return quat_list, pos_list, n_seg\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.LinearMotionDomainService.smooth","title":"smooth","text":"<pre><code>smooth(quat_list: ndarray, pos_list: ndarray, n_seg: int) -&gt; tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]\n</code></pre> <p>\u5bf9\u91c7\u6837\u70b9\u5e8f\u5217\u8fdb\u884c\u9006\u8fd0\u52a8\u5b66\u6c42\u89e3\u548c\u65f6\u95f4\u53c2\u6570\u5316\u5e73\u6ed1\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>quat_list</code> <code>ndarray</code> <p>\u56db\u5143\u6570\u5e8f\u5217\u3002</p> \u5fc5\u9700 <code>pos_list</code> <code>ndarray</code> <p>\u4f4d\u7f6e\u5e8f\u5217\u3002</p> \u5fc5\u9700 <code>n_seg</code> <code>int</code> <p>\u5206\u6bb5\u6570\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>tuple</code> <code>tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]</code> <p>(t_list, positions, qd, qdd)</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/linear_motion_domain_service.py</code> <pre><code>def smooth(self, quat_list: np.ndarray, pos_list: np.ndarray, n_seg: int) -&gt; tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]:\n    \"\"\"\u5bf9\u91c7\u6837\u70b9\u5e8f\u5217\u8fdb\u884c\u9006\u8fd0\u52a8\u5b66\u6c42\u89e3\u548c\u65f6\u95f4\u53c2\u6570\u5316\u5e73\u6ed1\u3002\n\n    Args:\n        quat_list (np.ndarray): \u56db\u5143\u6570\u5e8f\u5217\u3002\n        pos_list (np.ndarray): \u4f4d\u7f6e\u5e8f\u5217\u3002\n        n_seg (int): \u5206\u6bb5\u6570\u3002\n\n    Returns:\n        tuple: (t_list, positions, qd, qdd) \n    \"\"\"\n    positions = []\n    for quat, pos in zip(quat_list, pos_list):\n        position = self.inverse_kinematic(quat, pos)\n        positions.append(position)\n    positions = np.array(positions)\n    # todo: \u57fa\u4e8e\u8fd9\u4e2apositions\u5217\u8868\uff0c\u89c4\u5212rucking smooth\n\n    q_wp = self.ensure_2d_array(positions)\n    grid_n = self.clamp(6*n_seg,300,3000)    \n    t_list, positions, qd, qdd= self.toppra_time_parameterize(q_wp, self.v_max, self.a_max, self.dt, grid_n)\n    return t_list, positions, qd, qdd\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.LinearMotionDomainService.inverse_kinematic","title":"inverse_kinematic","text":"<pre><code>inverse_kinematic(quat, pos)\n</code></pre> <p>\u5355\u70b9\u9006\u8fd0\u52a8\u5b66\u6c42\u89e3\uff08\u5229\u7528\u4e0a\u4e00\u4f4d\u7f6e\u4f5c\u4e3a\u521d\u503c\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/linear_motion_domain_service.py</code> <pre><code>def inverse_kinematic(self, quat, pos):\n    \"\"\"\u5355\u70b9\u9006\u8fd0\u52a8\u5b66\u6c42\u89e3\uff08\u5229\u7528\u4e0a\u4e00\u4f4d\u7f6e\u4f5c\u4e3a\u521d\u503c\uff09\u3002\"\"\"\n    rm = R.from_quat(quat).as_matrix()\n    inverse_position = self.kinematic_solver.inverse_kinematic(rm, pos, initial_theta=self.nearest_position)\n    self.nearest_position = inverse_position\n    return inverse_position\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.LinearMotionDomainService.wrap_to_pi","title":"wrap_to_pi","text":"<pre><code>wrap_to_pi(q: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u5c06\u89d2\u5ea6\u5305\u88f9\u5230 (-pi, pi]\uff0c\u907f\u514d 2\u03c0 \u8df3\u53d8\u5f71\u54cd\u8ba1\u7b97\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/linear_motion_domain_service.py</code> <pre><code>def wrap_to_pi(self,q: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u5c06\u89d2\u5ea6\u5305\u88f9\u5230 (-pi, pi]\uff0c\u907f\u514d 2\u03c0 \u8df3\u53d8\u5f71\u54cd\u8ba1\u7b97\u3002\"\"\"\n    return (q + np.pi) % (2 * np.pi) - np.pi\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.LinearMotionDomainService.ensure_2d_array","title":"ensure_2d_array","text":"<pre><code>ensure_2d_array(arr: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u5c06\u8f93\u5165\u8f6c\u6362\u4e3a\u4e8c\u7ef4\u6570\u7ec4 (N, dof) \u5e76\u505a\u57fa\u672c\u6821\u9a8c\u3002</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ValueError</code> <p>\u5f53\u8def\u6807\u6570\u5c11\u4e8e 2\uff08\u7f3a\u5c11\u8d77\u70b9\u6216\u7ec8\u70b9\uff09\u65f6\u629b\u51fa\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/linear_motion_domain_service.py</code> <pre><code>def ensure_2d_array(self,arr: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\n    \u5c06\u8f93\u5165\u8f6c\u6362\u4e3a\u4e8c\u7ef4\u6570\u7ec4 (N, dof) \u5e76\u505a\u57fa\u672c\u6821\u9a8c\u3002\n\n    Raises:\n        ValueError: \u5f53\u8def\u6807\u6570\u5c11\u4e8e 2\uff08\u7f3a\u5c11\u8d77\u70b9\u6216\u7ec8\u70b9\uff09\u65f6\u629b\u51fa\u3002\n    \"\"\"\n    q = np.asarray(arr, dtype=float)\n    if q.ndim == 1:\n        q = q[None, :]\n    if not (q.ndim == 2 and q.shape[0] &gt;= 2):\n        raise ValueError(\"Q_waypoints \u81f3\u5c11\u9700\u8981\u4e24\u4e2a\u70b9\uff08\u8d77\u70b9\u4e0e\u7ec8\u70b9\uff09\u4e14\u7ef4\u5ea6\u4e3a (N, dof)\u3002\")\n    return q\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.LinearMotionDomainService.toppra_time_parameterize","title":"toppra_time_parameterize","text":"<pre><code>toppra_time_parameterize(waypoints: ndarray, v_max: ndarray | float, a_max: ndarray | float, dt: float = 0.01, grid_n: int = 800) -&gt; tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]\n</code></pre> <p>\u4f7f\u7528 TOPPRA \u8fdb\u884c\u65f6\u95f4\u53c2\u6570\u5316\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>waypoints</code> <code>ndarray</code> <p>\u8def\u5f84\u70b9 (N, dof)\u3002</p> \u5fc5\u9700 <code>v_max</code> <code>ndarray | float</code> <p>\u6700\u5927\u901f\u5ea6\u3002</p> \u5fc5\u9700 <code>a_max</code> <code>ndarray | float</code> <p>\u6700\u5927\u52a0\u901f\u5ea6\u3002</p> \u5fc5\u9700 <code>dt</code> <code>float</code> <p>\u65f6\u95f4\u6b65\u957f. Defaults to 0.01.</p> <code>0.01</code> <code>grid_n</code> <code>int</code> <p>\u7f51\u683c\u70b9\u6570. Defaults to 800.</p> <code>800</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>tuple</code> <code>tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]</code> <p>(t, q, qd, qdd).</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ValueError</code> <p>\u5982\u679c\u53c2\u6570\u5f62\u72b6\u4e0d\u6b63\u786e\u3002</p> <code>RuntimeError</code> <p>\u5982\u679c\u6c42\u89e3\u5931\u8d25\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/linear_motion_domain_service.py</code> <pre><code>def toppra_time_parameterize(self,\nwaypoints: np.ndarray,\nv_max: np.ndarray | float,\na_max: np.ndarray | float,\ndt: float = 0.01,\ngrid_n: int = 800\n) -&gt; tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]:\n    \"\"\"\u4f7f\u7528 TOPPRA \u8fdb\u884c\u65f6\u95f4\u53c2\u6570\u5316\u3002\n\n    Args:\n        waypoints (np.ndarray): \u8def\u5f84\u70b9 (N, dof)\u3002\n        v_max (np.ndarray | float): \u6700\u5927\u901f\u5ea6\u3002\n        a_max (np.ndarray | float): \u6700\u5927\u52a0\u901f\u5ea6\u3002\n        dt (float, optional): \u65f6\u95f4\u6b65\u957f. Defaults to 0.01.\n        grid_n (int, optional): \u7f51\u683c\u70b9\u6570. Defaults to 800.\n\n    Returns:\n        tuple: (t, q, qd, qdd).\n\n    Raises:\n        ValueError: \u5982\u679c\u53c2\u6570\u5f62\u72b6\u4e0d\u6b63\u786e\u3002\n        RuntimeError: \u5982\u679c\u6c42\u89e3\u5931\u8d25\u3002\n    \"\"\"\n    waypoints = np.asarray(waypoints, dtype=float)\n    if waypoints.ndim != 2 or waypoints.shape[1] != 6 or waypoints.shape[0] &lt; 2:\n        raise ValueError(\"waypoints \u5fc5\u987b\u662f (N,6) \u4e14 N&gt;=2\")\n\n    dof = waypoints.shape[1]\n\n    # 1) \u51e0\u4f55\u8def\u5f84\uff1a\u7528\u6837\u6761\u5728\u8def\u5f84\u53c2\u6570 s\u2208[0,1] \u4e0a\u63d2\u503c\n    breaks = np.linspace(0.0, 1.0, waypoints.shape[0])\n    path = ta.SplineInterpolator(breaks, waypoints)  # \u5b98\u65b9\u793a\u4f8b\u540c\u6b3e API\n\n    # 2) \u901f\u5ea6/\u52a0\u901f\u5ea6\u7ea6\u675f\uff08\u4e0a\u4e0b\u754c\u683c\u5f0f\uff09\n    v_max = np.full(dof, float(v_max)) if np.isscalar(v_max) else np.asarray(v_max, dtype=float)\n    a_max = np.full(dof, float(a_max)) if np.isscalar(a_max) else np.asarray(a_max, dtype=float)\n    if v_max.shape != (dof,) or a_max.shape != (dof,):\n        raise ValueError(\"v_max/a_max \u9700\u4e3a\u6807\u91cf\u6216 shape=(6,)\")\n\n    v_bounds = np.column_stack((-np.abs(v_max), np.abs(v_max)))  # (2,6) -&gt; [v_min; v_max]\n    a_bounds = np.column_stack((-np.abs(a_max), np.abs(a_max)))  # (2,6) -&gt; [a_min; a_max]\n\n    pc_vel = constraint.JointVelocityConstraint(v_bounds)\n    pc_acc = constraint.JointAccelerationConstraint(a_bounds)\n\n    # 3) TOPPRA \u4e3b\u7b97\u6cd5 + \u5e38\u7528\u53c2\u6570\u5316\u5668\uff08\u5e38\u7528\u4e14\u6ee1\u8db3\u8fb9\u754c/\u7ea6\u675f\uff09\n    gridpoints = np.linspace(0, path.duration, int(grid_n))\n    instance = algo.TOPPRA([pc_vel, pc_acc], path, gridpoints=gridpoints, parametrizer=\"ParametrizeConstAccel\")\n\n    # 4) \u6c42\u89e3\u65f6\u95f4\u53c2\u6570\u5316\uff0c\u5f97\u5230\u53ef\u6309\u65f6\u95f4\u91c7\u6837\u7684 jnt_traj\n    jnt_traj = instance.compute_trajectory(sd_start=0.0, sd_end=0.0)\n    if jnt_traj is None:\n        raise RuntimeError(\"TOPPRA \u6c42\u89e3\u5931\u8d25\uff1a\u7ed9\u5b9a\u7ea6\u675f\u4e0b\u4e0d\u53ef\u884c\uff0c\u6216\u8def\u5f84\u5f02\u5e38\u3002\")\n\n    # 5) \u6309 dt \u91c7\u6837\n    T = float(jnt_traj.duration)\n    M = max(2, int(np.ceil(T / dt)) + 1)\n    t = np.linspace(0.0, T, M)\n\n    q   = jnt_traj.eval(t)\n    qd  = jnt_traj.evald(t)\n    qdd = jnt_traj.evaldd(t)\n    return t.tolist(), q.tolist(), qd.tolist(), qdd.tolist()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CurveMotionDomainService","title":"CurveMotionDomainService","text":"<pre><code>CurveMotionDomainService(kinematic_solver: KinematicDomainService, v_max=[pi / 4] * 6, a_max=[pi / 8] * 6, j_max=[pi / 16] * 6, dt=0.01)\n</code></pre> <p>\u66f2\u7ebf\u8fd0\u52a8\u89c4\u5212\u670d\u52a1\u3002</p> <p>\u63d0\u4f9b\u57fa\u4e8e\u5f27\u957f\u53c2\u6570\u5316\u7684\u7a7a\u95f4\u66f2\u7ebf\u89c4\u5212\u3001\u59ff\u6001\u5e73\u6ed1\u63d2\u503c\u4ee5\u53ca\u57fa\u4e8e TOPPRA \u7684\u65f6\u95f4\u53c2\u6570\u5316\u529f\u80fd\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>v_max</code> <code>ndarray</code> <p>\u5404\u5173\u8282\u6700\u5927\u901f\u5ea6 (rad/s)\u3002</p> <code>a_max</code> <code>ndarray</code> <p>\u5404\u5173\u8282\u6700\u5927\u52a0\u901f\u5ea6 (rad/s\u00b2)\u3002</p> <code>j_max</code> <code>ndarray</code> <p>\u5404\u5173\u8282\u6700\u5927\u52a0\u52a0\u901f\u5ea6 (rad/s\u00b3)\u3002</p> <code>dt</code> <code>float</code> <p>\u65f6\u95f4\u6b65\u957f (s)\u3002</p> <code>kinematic_solver</code> <code>KinematicDomainService</code> <p>\u8fd0\u52a8\u5b66\u6c42\u89e3\u5668\u5b9e\u4f8b\u3002</p> <p>\u521d\u59cb\u5316\u66f2\u7ebf\u8fd0\u52a8\u670d\u52a1\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>kinematic_solver</code> <code>KinematicDomainService</code> <p>\u8fd0\u52a8\u5b66\u6c42\u89e3\u5668\u670d\u52a1\u5b9e\u4f8b\u3002</p> \u5fc5\u9700 <code>v_max</code> <code>list[float]</code> <p>\u6700\u5927\u901f\u5ea6\u5217\u8868. Defaults to [pi/4]*6.</p> <code>[pi / 4] * 6</code> <code>a_max</code> <code>list[float]</code> <p>\u6700\u5927\u52a0\u901f\u5ea6\u5217\u8868. Defaults to [pi/8]*6.</p> <code>[pi / 8] * 6</code> <code>j_max</code> <code>list[float]</code> <p>\u6700\u5927\u52a0\u52a0\u901f\u5ea6\u5217\u8868. Defaults to [pi/16]*6.</p> <code>[pi / 16] * 6</code> <code>dt</code> <code>float</code> <p>\u91c7\u6837\u65f6\u95f4\u6b65\u957f. Defaults to 0.01.</p> <code>0.01</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code> <pre><code>def __init__(\n    self, \n    kinematic_solver: KinematicDomainService,\n    v_max=[pi / 4] * 6, \n    a_max=[pi / 8] * 6, \n    j_max=[pi / 16] * 6, \n    dt=0.01,\n):\n    \"\"\"\u521d\u59cb\u5316\u66f2\u7ebf\u8fd0\u52a8\u670d\u52a1\u3002\n\n    Args:\n        kinematic_solver: \u8fd0\u52a8\u5b66\u6c42\u89e3\u5668\u670d\u52a1\u5b9e\u4f8b\u3002\n        v_max (list[float], optional): \u6700\u5927\u901f\u5ea6\u5217\u8868. Defaults to [pi/4]*6.\n        a_max (list[float], optional): \u6700\u5927\u52a0\u901f\u5ea6\u5217\u8868. Defaults to [pi/8]*6.\n        j_max (list[float], optional): \u6700\u5927\u52a0\u52a0\u901f\u5ea6\u5217\u8868. Defaults to [pi/16]*6.\n        dt (float, optional): \u91c7\u6837\u65f6\u95f4\u6b65\u957f. Defaults to 0.01.\n    \"\"\"\n    self.v_max = np.asarray(v_max, dtype=float)\n    self.a_max = np.asarray(a_max, dtype=float)\n    self.j_max = np.asarray(j_max, dtype=float)\n    self.dt = float(dt)\n    self.kinematic_solver = kinematic_solver\n    self.nearest_position = None\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CurveMotionDomainService.clamp","title":"clamp","text":"<pre><code>clamp(x, low, high)\n</code></pre> <p>\u5c06\u503c x \u9650\u5236\u5728 [low, high] \u533a\u95f4\u5185\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code> <pre><code>def clamp(self, x, low, high):\n    \"\"\"\u5c06\u503c x \u9650\u5236\u5728 [low, high] \u533a\u95f4\u5185\u3002\"\"\"\n    return max(low, min(x, high))\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CurveMotionDomainService.curve_motion","title":"curve_motion","text":"<pre><code>curve_motion(pos_fun, u0: float, u1: float, start_position: list[float], end_position: list[float] | None, ds: float = 0.002, include_end: bool = True, orientation_mode: str = 'slerp', tool_axis: str = 'z', up_hint: ndarray = np.array([0, 0, 1.0])) -&gt; tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]\n</code></pre> <p>\u6267\u884c\u66f2\u7ebf\u8fd0\u52a8\u89c4\u5212\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>pos_fun</code> <code>callable</code> <p>\u4f4d\u7f6e\u51fd\u6570\uff0c\u63a5\u53d7\u53c2\u6570 u \u8fd4\u56de (3,) \u5750\u6807\u3002</p> \u5fc5\u9700 <code>u0</code> <code>float</code> <p>\u53c2\u6570\u8d77\u59cb\u503c\u3002</p> \u5fc5\u9700 <code>u1</code> <code>float</code> <p>\u53c2\u6570\u7ec8\u6b62\u503c\u3002</p> \u5fc5\u9700 <code>start_position</code> <code>list[float]</code> <p>\u8d77\u70b9\u5173\u8282\u89d2\u5ea6\u3002</p> \u5fc5\u9700 <code>end_position</code> <code>list[float] | None</code> <p>\u7ec8\u70b9\u5173\u8282\u89d2\u5ea6\u3002</p> \u5fc5\u9700 <code>ds</code> <code>float</code> <p>\u91c7\u6837\u5f27\u957f\u6b65\u957f. Defaults to 0.002.</p> <code>0.002</code> <code>include_end</code> <code>bool</code> <p>\u662f\u5426\u5305\u542b\u7ec8\u70b9. Defaults to True.</p> <code>True</code> <code>orientation_mode</code> <code>str</code> <p>\u59ff\u6001\u63d2\u503c\u6a21\u5f0f ('fixed'|'slerp'|'tangent'). Defaults to \"slerp\".</p> <code>'slerp'</code> <code>tool_axis</code> <code>str</code> <p>\u5de5\u5177\u8f74\u65b9\u5411 ('x'|'y'|'z'). Defaults to \"z\".</p> <code>'z'</code> <code>up_hint</code> <code>ndarray</code> <p>\u5411\u4e0a\u5411\u91cf\u63d0\u793a\uff0c\u7528\u4e8e\u5207\u5411\u8ddf\u968f\u6a21\u5f0f. Defaults to [0, 0, 1.0].</p> <code>array([0, 0, 1.0])</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>tuple</code> <code>tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]</code> <p>(t_list, positions, qd, qdd) - t_list: \u65f6\u95f4\u6233\u5217\u8868 - positions: \u5173\u8282\u89d2\u5ea6\u8f68\u8ff9\u5217\u8868 - qd: \u5173\u8282\u901f\u5ea6\u8f68\u8ff9\u5217\u8868 - qdd: \u5173\u8282\u52a0\u901f\u5ea6\u8f68\u8ff9\u5217\u8868</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ValueError</code> <p>\u5982\u679c orientation_mode \u65e0\u6548\u6216 slerp \u6a21\u5f0f\u4e0b\u672a\u63d0\u4f9b end_position\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code> <pre><code>def curve_motion(\n        self,\n        pos_fun,  # callable u -&gt; (3,)\n        u0: float,\n        u1: float,\n        start_position: list[float],\n        end_position: list[float] | None,\n        ds: float = 0.002,\n        include_end: bool = True,\n        orientation_mode: str = \"slerp\",\n        tool_axis: str = \"z\",\n        up_hint: np.ndarray = np.array([0, 0, 1.0])\n) -&gt; tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]:\n    \"\"\"\u6267\u884c\u66f2\u7ebf\u8fd0\u52a8\u89c4\u5212\u3002\n\n    Args:\n        pos_fun (callable): \u4f4d\u7f6e\u51fd\u6570\uff0c\u63a5\u53d7\u53c2\u6570 u \u8fd4\u56de (3,) \u5750\u6807\u3002\n        u0 (float): \u53c2\u6570\u8d77\u59cb\u503c\u3002\n        u1 (float): \u53c2\u6570\u7ec8\u6b62\u503c\u3002\n        start_position (list[float]): \u8d77\u70b9\u5173\u8282\u89d2\u5ea6\u3002\n        end_position (list[float] | None): \u7ec8\u70b9\u5173\u8282\u89d2\u5ea6\u3002\n        ds (float, optional): \u91c7\u6837\u5f27\u957f\u6b65\u957f. Defaults to 0.002.\n        include_end (bool, optional): \u662f\u5426\u5305\u542b\u7ec8\u70b9. Defaults to True.\n        orientation_mode (str, optional): \u59ff\u6001\u63d2\u503c\u6a21\u5f0f ('fixed'|'slerp'|'tangent'). Defaults to \"slerp\".\n        tool_axis (str, optional): \u5de5\u5177\u8f74\u65b9\u5411 ('x'|'y'|'z'). Defaults to \"z\".\n        up_hint (np.ndarray, optional): \u5411\u4e0a\u5411\u91cf\u63d0\u793a\uff0c\u7528\u4e8e\u5207\u5411\u8ddf\u968f\u6a21\u5f0f. Defaults to [0, 0, 1.0].\n\n    Returns:\n        tuple: (t_list, positions, qd, qdd)\n            - t_list: \u65f6\u95f4\u6233\u5217\u8868\n            - positions: \u5173\u8282\u89d2\u5ea6\u8f68\u8ff9\u5217\u8868\n            - qd: \u5173\u8282\u901f\u5ea6\u8f68\u8ff9\u5217\u8868\n            - qdd: \u5173\u8282\u52a0\u901f\u5ea6\u8f68\u8ff9\u5217\u8868\n\n    Raises:\n        ValueError: \u5982\u679c orientation_mode \u65e0\u6548\u6216 slerp \u6a21\u5f0f\u4e0b\u672a\u63d0\u4f9b end_position\u3002\n    \"\"\"\n    # \u8d77\u70b9\u59ff\u6001\u6765\u81ea\u8d77\u70b9\u5173\u8282\u89d2\u7684\u6b63\u89e3\n    start_quat, start_pos_fk = self.kinematic_solver.get_gripper2base(start_position)\n    # 1) \u7b49\u5f27\u957f\u91c7\u6837\n    pos_list, u_eq, n_seg = self.sample_parametric_equal_arclen(pos_fun, u0, u1, ds, include_end)\n\n    # 2) \u59ff\u6001\u751f\u6210\n    if orientation_mode == \"fixed\":\n        quat_list = np.repeat(self._q_normalize(start_quat)[None, :], len(pos_list), axis=0)\n\n    elif orientation_mode == \"slerp\":\n        if end_position is None:\n            raise ValueError(\"slerp \u6a21\u5f0f\u9700\u8981\u63d0\u4f9b end_position \u4ee5\u786e\u5b9a\u7ec8\u6b62\u59ff\u6001\u3002\")\n        end_quat, _ = self.kinematic_solver.get_gripper2base(end_position)\n        q0 = self._q_normalize(start_quat)\n        q1 = self._q_normalize(end_quat)\n        tau = np.linspace(0, 1, len(pos_list))\n        quat_list = np.vstack([self._q_slerp(q0, q1, ti) for ti in tau])\n\n    elif orientation_mode == \"tangent\":\n        quat_list = self._quat_follow_tangent(pos_list, tool_axis=tool_axis, up_hint=up_hint)\n    else:\n        raise ValueError(\"orientation_mode \u5fc5\u987b\u662f {'fixed','slerp','tangent'}\")\n\n    # 3) \u539f\u6709\u5e73\u6ed1/IK/TOPPRA \u7ba1\u7ebf\u590d\u7528\n    t_list, positions, qd, qdd = self.smooth(quat_list, pos_list, n_seg)\n    return t_list, positions, qd, qdd\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CurveMotionDomainService.make_pos_fun_spline","title":"make_pos_fun_spline","text":"<pre><code>make_pos_fun_spline(start_position: list[float], end_position: list[float], mid_points: list, bc_type: str = 'natural') -&gt; tuple[callable, np.ndarray]\n</code></pre> <p>\u6784\u9020\u57fa\u4e8e\u4e09\u6b21\u6837\u6761\u7684\u4f4d\u7f6e\u51fd\u6570\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>start_position</code> <code>list[float]</code> <p>\u8d77\u70b9\u5173\u8282\u89d2\u5ea6\u3002</p> \u5fc5\u9700 <code>end_position</code> <code>list[float]</code> <p>\u7ec8\u70b9\u5173\u8282\u89d2\u5ea6\u3002</p> \u5fc5\u9700 <code>mid_points</code> <code>list</code> <p>\u4e2d\u95f4\u70b9\u5750\u6807\u5217\u8868 (N, 3)\u3002</p> \u5fc5\u9700 <code>bc_type</code> <code>str</code> <p>\u8fb9\u754c\u6761\u4ef6\u7c7b\u578b. Defaults to \"natural\".</p> <code>'natural'</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>tuple</code> <code>tuple[callable, ndarray]</code> <p>(pos_fun, s) - pos_fun: \u4f4d\u7f6e\u51fd\u6570 callable - s: \u7d2f\u79ef\u5f26\u957f\u6570\u7ec4</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ValueError</code> <p>\u5982\u679c\u70b9\u96c6\u5f62\u72b6\u4e0d\u6b63\u786e\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code> <pre><code>def make_pos_fun_spline(\n    self, \n    start_position: list[float],\n    end_position: list[float],\n    mid_points: list, \n    bc_type: str = \"natural\") -&gt; tuple[callable, np.ndarray]:\n    \"\"\"\u6784\u9020\u57fa\u4e8e\u4e09\u6b21\u6837\u6761\u7684\u4f4d\u7f6e\u51fd\u6570\u3002\n\n    Args:\n        start_position (list[float]): \u8d77\u70b9\u5173\u8282\u89d2\u5ea6\u3002\n        end_position (list[float]): \u7ec8\u70b9\u5173\u8282\u89d2\u5ea6\u3002\n        mid_points (list): \u4e2d\u95f4\u70b9\u5750\u6807\u5217\u8868 (N, 3)\u3002\n        bc_type (str, optional): \u8fb9\u754c\u6761\u4ef6\u7c7b\u578b. Defaults to \"natural\".\n\n    Returns:\n        tuple: (pos_fun, s)\n            - pos_fun: \u4f4d\u7f6e\u51fd\u6570 callable\n            - s: \u7d2f\u79ef\u5f26\u957f\u6570\u7ec4\n\n    Raises:\n        ValueError: \u5982\u679c\u70b9\u96c6\u5f62\u72b6\u4e0d\u6b63\u786e\u3002\n    \"\"\"\n    _, start_pos = self.kinematic_solver.get_gripper2base(start_position)\n    _, end_pos = self.kinematic_solver.get_gripper2base(end_position)\n    points = np.vstack([start_pos, mid_points, end_pos])\n    P = np.asarray(points, dtype=float)\n    if P.ndim != 2 or P.shape[0] &lt; 2 or P.shape[1] not in (2, 3):\n        raise ValueError(\"points \u5f62\u72b6\u5fc5\u987b\u662f (N,3) \u6216 (N,2)\uff0c\u4e14 N&gt;=2\")\n    if P.shape[1] == 2:\n        P = np.hstack([P, np.zeros((P.shape[0], 1))])  # 2D \u81ea\u52a8\u8865 z=0\n\n    # --- \u5f26\u957f\u53c2\u6570\u5316\uff0c\u907f\u514d\u53c2\u6570\u62e5\u6324 ---\n    d = np.linalg.norm(np.diff(P, axis=0), axis=1)\n    s = np.concatenate([[0.0], np.cumsum(d)])\n    if s[-1] == 0:\n        raise ValueError(\"\u6240\u6709\u70b9\u91cd\u5408\uff0c\u65e0\u6cd5\u6784\u9020\u66f2\u7ebf\")\n    t = s / s[-1]  # \u5f52\u4e00\u5316\u5230 [0,1]\n\n    # \u5206\u522b\u6784\u9020 x,y,z \u7684\u6837\u6761\n    cs_x = CubicSpline(t, P[:, 0], bc_type=bc_type)\n    cs_y = CubicSpline(t, P[:, 1], bc_type=bc_type)\n    cs_z = CubicSpline(t, P[:, 2], bc_type=bc_type)\n\n    def _eval(u):\n        u = np.asarray(u, dtype=float)\n        # \u53ef\u9009\uff1a\u5939\u7d27\u5230 [0,1]\uff0c\u907f\u514d\u6570\u503c\u8d8a\u754c\n        u = np.clip(u, 0.0, 1.0)\n        X = np.stack([cs_x(u), cs_y(u), cs_z(u)], axis=-1)  # (..., 3)\n        if X.ndim == 1:  # \u6807\u91cf u -&gt; (3,)\n            return X\n        return X  # \u6570\u7ec4 u -&gt; (M,3)\n\n    return _eval, s\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CurveMotionDomainService.sample_parametric_equal_arclen","title":"sample_parametric_equal_arclen","text":"<pre><code>sample_parametric_equal_arclen(pos_fun, u0: float, u1: float, ds: float = 0.002, include_end: bool = True, dense: int = 4000) -&gt; tuple[np.ndarray, np.ndarray, int]\n</code></pre> <p>\u5bf9\u53c2\u6570\u66f2\u7ebf r(u) \u505a\u7b49\u5f27\u957f\u91c7\u6837\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>pos_fun</code> <code>callable</code> <p>\u53c2\u6570\u66f2\u7ebf\u51fd\u6570 r(u)\u3002</p> \u5fc5\u9700 <code>u0</code> <code>float</code> <p>\u53c2\u6570\u8d77\u59cb\u503c\u3002</p> \u5fc5\u9700 <code>u1</code> <code>float</code> <p>\u53c2\u6570\u7ec8\u6b62\u503c\u3002</p> \u5fc5\u9700 <code>ds</code> <code>float</code> <p>\u76ee\u6807\u5f27\u957f\u91c7\u6837\u95f4\u9694. Defaults to 0.002.</p> <code>0.002</code> <code>include_end</code> <code>bool</code> <p>\u7ed3\u679c\u662f\u5426\u5fc5\u987b\u5305\u542b\u7ec8\u70b9. Defaults to True.</p> <code>True</code> <code>dense</code> <code>int</code> <p>\u521d\u59cb\u5bc6\u91c7\u6837\u7684\u70b9\u6570. Defaults to 4000.</p> <code>4000</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>tuple</code> <code>tuple[ndarray, ndarray, int]</code> <p>(pos_list, u_eq, n_seg) - pos_list: \u7b49\u5f27\u957f\u91c7\u6837\u540e\u7684\u5750\u6807\u5217\u8868 (M, 3) - u_eq: \u5bf9\u5e94\u7684\u53c2\u6570\u503c\u5217\u8868 (M,) - n_seg: \u5206\u6bb5\u6570</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code> <pre><code>def sample_parametric_equal_arclen(\n        self,\n        pos_fun,  # callable: u -&gt; (3,) numpy array\n        u0: float,\n        u1: float,\n        ds: float = 0.002,\n        include_end: bool = True,\n        dense: int = 4000\n) -&gt; tuple[np.ndarray, np.ndarray, int]:\n    \"\"\"\u5bf9\u53c2\u6570\u66f2\u7ebf r(u) \u505a\u7b49\u5f27\u957f\u91c7\u6837\u3002\n\n    Args:\n        pos_fun (callable): \u53c2\u6570\u66f2\u7ebf\u51fd\u6570 r(u)\u3002\n        u0 (float): \u53c2\u6570\u8d77\u59cb\u503c\u3002\n        u1 (float): \u53c2\u6570\u7ec8\u6b62\u503c\u3002\n        ds (float, optional): \u76ee\u6807\u5f27\u957f\u91c7\u6837\u95f4\u9694. Defaults to 0.002.\n        include_end (bool, optional): \u7ed3\u679c\u662f\u5426\u5fc5\u987b\u5305\u542b\u7ec8\u70b9. Defaults to True.\n        dense (int, optional): \u521d\u59cb\u5bc6\u91c7\u6837\u7684\u70b9\u6570. Defaults to 4000.\n\n    Returns:\n        tuple: (pos_list, u_eq, n_seg)\n            - pos_list: \u7b49\u5f27\u957f\u91c7\u6837\u540e\u7684\u5750\u6807\u5217\u8868 (M, 3)\n            - u_eq: \u5bf9\u5e94\u7684\u53c2\u6570\u503c\u5217\u8868 (M,)\n            - n_seg: \u5206\u6bb5\u6570\n    \"\"\"\n    # 1) \u5148\u5728\u53c2\u6570\u4e0a\u505a\u5747\u5300\u5bc6\u91c7\u6837\uff0c\u4f30\u7b97\u5f27\u957f\n    u_dense = np.linspace(u0, u1, max(1000, int(abs(u1 - u0) * dense)))\n    XYZ = np.vstack([np.asarray(pos_fun(ui), dtype=float).reshape(3) for ui in u_dense])\n    seg = np.linalg.norm(np.diff(XYZ, axis=0), axis=1)\n    s_cum = np.concatenate([[0.0], np.cumsum(seg)])\n    L = float(s_cum[-1])\n    if L &lt; 1e-12:\n        # \u9000\u5316\uff1a\u51e0\u4e4e\u96f6\u957f\n        pos_list = XYZ[[0, -1], :] if include_end else XYZ[[0], :]\n        u_eq = np.array([u_dense[0], u_dense[-1]]) if include_end else np.array([u_dense[0]])\n        return pos_list, u_eq, 0.0\n\n    # 2) \u5f27\u957f -&gt; u \u7684\u53cd\u67e5\uff0c\u7528\u63d2\u503c\u8fd1\u4f3c\n    s2u = interp1d(s_cum, u_dense, kind=\"linear\", bounds_error=False, fill_value=(u_dense[0], u_dense[-1]))\n\n    # 3) \u76ee\u6807\u7b49\u5f27\u957f\u5e8f\u5217\n    n_seg = max(1, int(np.ceil(L / ds)))\n    s_target = np.linspace(0.0, L, n_seg + 1 if include_end else n_seg)\n    u_eq = s2u(s_target)\n\n    # 4) \u5f97\u5230\u7b49\u5f27\u957f\u4f4d\u7f6e\n    pos_list = np.vstack([np.asarray(pos_fun(ui), dtype=float).reshape(3) for ui in u_eq])\n    return pos_list, u_eq, n_seg\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CurveMotionDomainService.wrap_to_pi","title":"wrap_to_pi","text":"<pre><code>wrap_to_pi(q: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u5c06\u89d2\u5ea6\u5305\u88f9\u5230 (-pi, pi]\uff0c\u907f\u514d 2\u03c0 \u8df3\u53d8\u5f71\u54cd\u8ba1\u7b97\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code> <pre><code>def wrap_to_pi(self, q: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u5c06\u89d2\u5ea6\u5305\u88f9\u5230 (-pi, pi]\uff0c\u907f\u514d 2\u03c0 \u8df3\u53d8\u5f71\u54cd\u8ba1\u7b97\u3002\"\"\"\n    return (q + np.pi) % (2 * np.pi) - np.pi\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CurveMotionDomainService.ensure_2d_array","title":"ensure_2d_array","text":"<pre><code>ensure_2d_array(arr: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u5c06\u8f93\u5165\u8f6c\u6362\u4e3a\u4e8c\u7ef4\u6570\u7ec4 (N, dof) \u5e76\u505a\u57fa\u672c\u6821\u9a8c\u3002</p>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CurveMotionDomainService.ensure_2d_array--raises","title":"Raises","text":"<p>ValueError     \u5f53\u8def\u6807\u6570\u5c11\u4e8e 2\uff08\u7f3a\u5c11\u8d77\u70b9\u6216\u7ec8\u70b9\uff09\u65f6\u629b\u51fa\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code> <pre><code>def ensure_2d_array(self, arr: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\n    \u5c06\u8f93\u5165\u8f6c\u6362\u4e3a\u4e8c\u7ef4\u6570\u7ec4 (N, dof) \u5e76\u505a\u57fa\u672c\u6821\u9a8c\u3002\n\n    Raises\n    ------\n    ValueError\n        \u5f53\u8def\u6807\u6570\u5c11\u4e8e 2\uff08\u7f3a\u5c11\u8d77\u70b9\u6216\u7ec8\u70b9\uff09\u65f6\u629b\u51fa\u3002\n    \"\"\"\n    q = np.asarray(arr, dtype=float)\n    if q.ndim == 1:\n        q = q[None, :]\n    if not (q.ndim == 2 and q.shape[0] &gt;= 2):\n        raise ValueError(\"Q_waypoints \u81f3\u5c11\u9700\u8981\u4e24\u4e2a\u70b9\uff08\u8d77\u70b9\u4e0e\u7ec8\u70b9\uff09\u4e14\u7ef4\u5ea6\u4e3a (N, dof)\u3002\")\n    return q\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CurveMotionDomainService.toppra_time_parameterize","title":"toppra_time_parameterize","text":"<pre><code>toppra_time_parameterize(waypoints: ndarray, v_max: ndarray | float, a_max: ndarray | float, dt: float = 0.01, grid_n: int = 400) -&gt; tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]\n</code></pre> <p>\u4f7f\u7528 TOPPRA \u5bf9\u8def\u5f84\u8fdb\u884c\u65f6\u95f4\u53c2\u6570\u5316\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>waypoints</code> <code>ndarray</code> <p>\u8def\u5f84\u70b9\u6570\u7ec4 (N, dof)\u3002</p> \u5fc5\u9700 <code>v_max</code> <code>ndarray | float</code> <p>\u6700\u5927\u901f\u5ea6\u7ea6\u675f\u3002</p> \u5fc5\u9700 <code>a_max</code> <code>ndarray | float</code> <p>\u6700\u5927\u52a0\u901f\u5ea6\u7ea6\u675f\u3002</p> \u5fc5\u9700 <code>dt</code> <code>float</code> <p>\u8f93\u51fa\u8f68\u8ff9\u7684\u65f6\u95f4\u6b65\u957f. Defaults to 0.01.</p> <code>0.01</code> <code>grid_n</code> <code>int</code> <p>TOPPRA \u79bb\u6563\u5316\u7f51\u683c\u70b9\u6570. Defaults to 400.</p> <code>400</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>tuple</code> <code>tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]</code> <p>(t, q, qd, qdd) - t: \u65f6\u95f4\u6233\u5217\u8868 - q: \u5173\u8282\u4f4d\u7f6e\u5217\u8868 - qd: \u5173\u8282\u901f\u5ea6\u5217\u8868 - qdd: \u5173\u8282\u52a0\u901f\u5ea6\u5217\u8868</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ValueError</code> <p>\u5982\u679c waypoints \u7ef4\u5ea6\u4e0d\u6b63\u786e\u6216\u7ea6\u675f\u683c\u5f0f\u9519\u8bef\u3002</p> <code>RuntimeError</code> <p>\u5982\u679c TOPPRA \u6c42\u89e3\u5931\u8d25\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/curve_motion.py</code> <pre><code>def toppra_time_parameterize(self,\n                             waypoints: np.ndarray,\n                             v_max: np.ndarray | float,\n                             a_max: np.ndarray | float,\n                             dt: float = 0.01,\n                             grid_n: int = 400,\n                             ) -&gt; tuple[list[float], list[list[float]], list[list[float]], list[list[float]]]:\n    \"\"\"\u4f7f\u7528 TOPPRA \u5bf9\u8def\u5f84\u8fdb\u884c\u65f6\u95f4\u53c2\u6570\u5316\u3002\n\n    Args:\n        waypoints (np.ndarray): \u8def\u5f84\u70b9\u6570\u7ec4 (N, dof)\u3002\n        v_max (np.ndarray | float): \u6700\u5927\u901f\u5ea6\u7ea6\u675f\u3002\n        a_max (np.ndarray | float): \u6700\u5927\u52a0\u901f\u5ea6\u7ea6\u675f\u3002\n        dt (float, optional): \u8f93\u51fa\u8f68\u8ff9\u7684\u65f6\u95f4\u6b65\u957f. Defaults to 0.01.\n        grid_n (int, optional): TOPPRA \u79bb\u6563\u5316\u7f51\u683c\u70b9\u6570. Defaults to 400.\n\n    Returns:\n        tuple: (t, q, qd, qdd)\n            - t: \u65f6\u95f4\u6233\u5217\u8868\n            - q: \u5173\u8282\u4f4d\u7f6e\u5217\u8868\n            - qd: \u5173\u8282\u901f\u5ea6\u5217\u8868\n            - qdd: \u5173\u8282\u52a0\u901f\u5ea6\u5217\u8868\n\n    Raises:\n        ValueError: \u5982\u679c waypoints \u7ef4\u5ea6\u4e0d\u6b63\u786e\u6216\u7ea6\u675f\u683c\u5f0f\u9519\u8bef\u3002\n        RuntimeError: \u5982\u679c TOPPRA \u6c42\u89e3\u5931\u8d25\u3002\n    \"\"\"\n    waypoints = np.asarray(waypoints, dtype=float)\n    if waypoints.ndim != 2 or waypoints.shape[1] != 6 or waypoints.shape[0] &lt; 2:\n        raise ValueError(\"waypoints \u5fc5\u987b\u662f (N,6) \u4e14 N&gt;=2\")\n\n    dof = waypoints.shape[1]\n\n    # 1) \u51e0\u4f55\u8def\u5f84\uff1a\u7528\u6837\u6761\u5728\u8def\u5f84\u53c2\u6570 s\u2208[0,1] \u4e0a\u63d2\u503c\n    breaks = np.linspace(0.0, 1.0, waypoints.shape[0])\n    path = ta.SplineInterpolator(breaks, waypoints)  # \u5b98\u65b9\u793a\u4f8b\u540c\u6b3e API\n\n    # 2) \u901f\u5ea6/\u52a0\u901f\u5ea6\u7ea6\u675f\uff08\u4e0a\u4e0b\u754c\u683c\u5f0f\uff09\n    v_max = np.full(dof, float(v_max)) if np.isscalar(v_max) else np.asarray(v_max, dtype=float)\n    a_max = np.full(dof, float(a_max)) if np.isscalar(a_max) else np.asarray(a_max, dtype=float)\n    if v_max.shape != (dof,) or a_max.shape != (dof,):\n        raise ValueError(\"v_max/a_max \u9700\u4e3a\u6807\u91cf\u6216 shape=(6,)\")\n\n    v_bounds = np.column_stack((-np.abs(v_max), np.abs(v_max)))  # (2,6) -&gt; [v_min; v_max]\n    a_bounds = np.column_stack((-np.abs(a_max), np.abs(a_max)))  # (2,6) -&gt; [a_min; a_max]\n\n    pc_vel = constraint.JointVelocityConstraint(v_bounds)\n    pc_acc = constraint.JointAccelerationConstraint(a_bounds)\n\n    # 3) TOPPRA \u4e3b\u7b97\u6cd5 + \u5e38\u7528\u53c2\u6570\u5316\u5668\uff08\u5e38\u7528\u4e14\u6ee1\u8db3\u8fb9\u754c/\u7ea6\u675f\uff09\n    gridpoints = np.linspace(0, path.duration, int(grid_n))\n    instance = algo.TOPPRA([pc_vel, pc_acc], path, gridpoints=gridpoints, parametrizer=\"ParametrizeConstAccel\")\n\n    # 4) \u6c42\u89e3\u65f6\u95f4\u53c2\u6570\u5316\uff0c\u5f97\u5230\u53ef\u6309\u65f6\u95f4\u91c7\u6837\u7684 jnt_traj\n    jnt_traj = instance.compute_trajectory(sd_start=0.0, sd_end=0.0)\n    if jnt_traj is None:\n        raise RuntimeError(\"TOPPRA \u6c42\u89e3\u5931\u8d25\uff1a\u7ed9\u5b9a\u7ea6\u675f\u4e0b\u4e0d\u53ef\u884c\uff0c\u6216\u8def\u5f84\u5f02\u5e38\u3002\")\n\n    # 5) \u6309 dt \u91c7\u6837\n    T = float(jnt_traj.duration)\n    M = max(2, int(np.ceil(T / dt)) + 1)\n    t = np.linspace(0.0, T, M)\n\n    q = jnt_traj.eval(t)\n    qd = jnt_traj.evald(t)\n    qdd = jnt_traj.evaldd(t)\n    return t.tolist(), q.tolist(), qd.tolist(), qdd.tolist()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialDomainService","title":"SerialDomainService","text":"<pre><code>SerialDomainService()\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u4e32\u53e3\u9886\u57df\u670d\u52a1 - \u7ba1\u7406\u4e32\u53e3\u8fde\u63a5\u7684\u6838\u5fc3\u4e1a\u52a1\u903b\u8f91</p> <p>\u521d\u59cb\u5316\u4e32\u53e3\u9886\u57df\u670d\u52a1</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code> <pre><code>def __init__(self):\n    \"\"\"\u521d\u59cb\u5316\u4e32\u53e3\u9886\u57df\u670d\u52a1\"\"\"\n    super().__init__()\n\n    # \u4e32\u53e3\u76f8\u5173\u5bf9\u8c61\n    self.serial_adapter = SerialAdapter()\n    self.serial_reader: Optional[SerialReader] = None\n    self.serial_writer: Optional[SerialWriter] = None\n\n    # \u7ebf\u7a0b\u7ba1\u7406\n    self.reader_thread: Optional[SerialReaderThread] = None\n    self.writer_thread: Optional[SerialWriterThread] = None\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialDomainService.scan_available_ports","title":"scan_available_ports","text":"<pre><code>scan_available_ports() -&gt; List[str]\n</code></pre> <p>\u626b\u63cf\u53ef\u7528\u7aef\u53e3\u5217\u8868</p> \u8fd4\u56de <p>List[str]: \u53ef\u7528\u7aef\u53e3\u540d\u79f0\u5217\u8868</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code> <pre><code>def scan_available_ports(self) -&gt; List[str]:\n    \"\"\"\n    \u626b\u63cf\u53ef\u7528\u7aef\u53e3\u5217\u8868\n\n    \u8fd4\u56de:\n        List[str]: \u53ef\u7528\u7aef\u53e3\u540d\u79f0\u5217\u8868\n    \"\"\"\n    try:\n        return PortScanner.scan_ports()\n    except Exception as e:\n        raise Exception(f\"\u626b\u63cf\u7aef\u53e3\u5931\u8d25: {str(e)}\")\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialDomainService.get_port_info","title":"get_port_info","text":"<pre><code>get_port_info(port_name: str) -&gt; Optional[Dict[str, str]]\n</code></pre> <p>\u83b7\u53d6\u6307\u5b9a\u7aef\u53e3\u4fe1\u606f</p> \u53c2\u6570 <p>port_name: \u7aef\u53e3\u540d\u79f0</p> \u8fd4\u56de <p>Optional[Dict[str, str]]: \u7aef\u53e3\u4fe1\u606f\u5b57\u5178\uff0c\u5931\u8d25\u65f6\u8fd4\u56deNone</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code> <pre><code>def get_port_info(self, port_name: str) -&gt; Optional[Dict[str, str]]:\n    \"\"\"\n    \u83b7\u53d6\u6307\u5b9a\u7aef\u53e3\u4fe1\u606f\n\n    \u53c2\u6570:\n        port_name: \u7aef\u53e3\u540d\u79f0\n\n    \u8fd4\u56de:\n        Optional[Dict[str, str]]: \u7aef\u53e3\u4fe1\u606f\u5b57\u5178\uff0c\u5931\u8d25\u65f6\u8fd4\u56deNone\n    \"\"\"\n    try:\n        return PortScanner.get_port_info(port_name)\n    except Exception as e:\n        raise Exception(f\"\u83b7\u53d6\u7aef\u53e3\u4fe1\u606f\u5931\u8d25: {str(e)}\")\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialDomainService.get_current_port","title":"get_current_port","text":"<pre><code>get_current_port() -&gt; Optional[str]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u7684\u7aef\u53e3\u540d\u79f0</p> \u8fd4\u56de <p>Optional[str]: \u7aef\u53e3\u540d\u79f0\uff0c\u672a\u8fde\u63a5\u65f6\u8fd4\u56deNone</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code> <pre><code>def get_current_port(self) -&gt; Optional[str]:\n    \"\"\"\n    \u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u7684\u7aef\u53e3\u540d\u79f0\n\n    \u8fd4\u56de:\n        Optional[str]: \u7aef\u53e3\u540d\u79f0\uff0c\u672a\u8fde\u63a5\u65f6\u8fd4\u56deNone\n    \"\"\"\n    return self.serial_adapter.get_port_name()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialDomainService.is_connected","title":"is_connected","text":"<pre><code>is_connected() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u4e32\u53e3\u662f\u5426\u5df2\u8fde\u63a5</p> \u8fd4\u56de <p>bool: \u662f\u5426\u5df2\u8fde\u63a5</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code> <pre><code>def is_connected(self) -&gt; bool:\n    \"\"\"\n    \u68c0\u67e5\u4e32\u53e3\u662f\u5426\u5df2\u8fde\u63a5\n\n    \u8fd4\u56de:\n        bool: \u662f\u5426\u5df2\u8fde\u63a5\n    \"\"\"\n    return self.serial_adapter.is_connected()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialDomainService.connect_port","title":"connect_port","text":"<pre><code>connect_port(port: str, config: Dict[str, Any]) -&gt; bool\n</code></pre> <p>\u8fde\u63a5\u4e32\u53e3</p> \u53c2\u6570 <p>port: \u4e32\u53e3\u540d\u79f0 config: \u4e32\u53e3\u914d\u7f6e\u53c2\u6570</p> \u8fd4\u56de <p>bool: \u8fde\u63a5\u662f\u5426\u6210\u529f</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code> <pre><code>def connect_port(self, port: str, config: Dict[str, Any]) -&gt; bool:\n    \"\"\"\n    \u8fde\u63a5\u4e32\u53e3\n\n    \u53c2\u6570:\n        port: \u4e32\u53e3\u540d\u79f0\n        config: \u4e32\u53e3\u914d\u7f6e\u53c2\u6570\n\n    \u8fd4\u56de:\n        bool: \u8fde\u63a5\u662f\u5426\u6210\u529f\n    \"\"\"\n    try:\n        # \u5982\u679c\u5df2\u8fde\u63a5\uff0c\u5148\u65ad\u5f00\n        if self.is_connected():\n            self.disconnect_port()\n\n        # \u5c1d\u8bd5\u8fde\u63a5\u4e32\u53e3\n        if not self.serial_adapter.connect(port, config):\n            raise Exception(f\"\u8fde\u63a5\u7aef\u53e3 {port} \u5931\u8d25\")\n\n        # \u83b7\u53d6\u4e32\u53e3\u5bf9\u8c61\n        serial_port = self.serial_adapter.get_serial_port()\n        if not serial_port:\n            raise Exception(\"\u83b7\u53d6\u4e32\u53e3\u5bf9\u8c61\u5931\u8d25\")\n\n        # \u521b\u5efa\u8bfb\u5199\u5668\n        self.serial_reader = SerialReader(serial_port)\n        self.serial_writer = SerialWriter(serial_port)\n\n        # \u8fde\u63a5Infrastructure\u5c42\u4fe1\u53f7\u5230Domain\u5c42\n        self._connect_infrastructure_signals()\n\n        # \u542f\u52a8\u7ebf\u7a0b\n        self._start_threads()\n\n        # \u53d1\u9001\u8fde\u63a5\u6210\u529f\u4fe1\u53f7\n        self.connection_status_changed.emit(True)\n        return True\n\n    except Exception as e:\n        self.disconnect_port()\n        raise Exception(f\"\u8fde\u63a5\u5931\u8d25: {str(e)}\")\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialDomainService.disconnect_port","title":"disconnect_port","text":"<pre><code>disconnect_port() -&gt; bool\n</code></pre> <p>\u65ad\u5f00\u4e32\u53e3\u8fde\u63a5</p> \u8fd4\u56de <p>bool: \u65ad\u5f00\u662f\u5426\u6210\u529f</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code> <pre><code>def disconnect_port(self) -&gt; bool:\n    \"\"\"\n    \u65ad\u5f00\u4e32\u53e3\u8fde\u63a5\n\n    \u8fd4\u56de:\n        bool: \u65ad\u5f00\u662f\u5426\u6210\u529f\n    \"\"\"\n    try:\n        # \u505c\u6b62\u7ebf\u7a0b\n        self._stop_threads()\n\n        # \u65ad\u5f00\u4fe1\u53f7\u8fde\u63a5\n        self._disconnect_infrastructure_signals()\n\n        # \u505c\u6b62\u8bfb\u5199\u5668\n        if self.serial_reader:\n            self.serial_reader.stop()\n            self.serial_reader = None\n\n        if self.serial_writer:\n            self.serial_writer.stop()\n            self.serial_writer = None\n\n        # \u65ad\u5f00\u9002\u914d\u5668\u8fde\u63a5\n        success = self.serial_adapter.disconnect()\n\n        # \u53d1\u9001\u65ad\u5f00\u8fde\u63a5\u4fe1\u53f7\n        self.connection_status_changed.emit(False)\n        return success\n\n    except Exception as e:\n        raise Exception(f\"\u65ad\u5f00\u8fde\u63a5\u5931\u8d25: {str(e)}\")\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialDomainService.send_data","title":"send_data","text":"<pre><code>send_data(data: str) -&gt; bool\n</code></pre> <p>\u53d1\u9001\u6570\u636e</p> \u53c2\u6570 <p>data: \u8981\u53d1\u9001\u7684\u6570\u636e</p> \u8fd4\u56de <p>bool: \u662f\u5426\u6210\u529f\u6dfb\u52a0\u5230\u53d1\u9001\u961f\u5217</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code> <pre><code>def send_data(self, data: str) -&gt; bool:\n    \"\"\"\n    \u53d1\u9001\u6570\u636e\n\n    \u53c2\u6570:\n        data: \u8981\u53d1\u9001\u7684\u6570\u636e\n\n    \u8fd4\u56de:\n        bool: \u662f\u5426\u6210\u529f\u6dfb\u52a0\u5230\u53d1\u9001\u961f\u5217\n    \"\"\"\n    if self.serial_writer and self.is_connected():\n        self.serial_writer.add_to_queue(data)\n        return True\n    else:\n        raise Exception(\"\u4e32\u53e3\u672a\u8fde\u63a5\uff0c\u65e0\u6cd5\u53d1\u9001\u6570\u636e\")\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialDomainService.cleanup","title":"cleanup","text":"<pre><code>cleanup() -&gt; None\n</code></pre> <p>\u6e05\u7406\u8d44\u6e90</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/communication/serial_domain_service.py</code> <pre><code>def cleanup(self) -&gt; None:\n    \"\"\"\u6e05\u7406\u8d44\u6e90\"\"\"\n    try:\n        self.disconnect_port()\n    except Exception:\n        pass  # \u5ffd\u7565\u6e05\u7406\u65f6\u7684\u5f02\u5e38\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionRunner","title":"MotionRunner","text":"<pre><code>MotionRunner(serial_domain_service: SerialDomainService, message_domain_service: MessageDomainService)\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u8fd0\u52a8\u6267\u884c\u5668\u3002</p> <p>\u8d1f\u8d23\u6309\u65f6\u95f4\u6b65\u957f\u5b9a\u65f6\u53d1\u9001\u8fd0\u52a8\u548c\u5939\u722a\u6307\u4ee4\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>motion_msg_signal</code> <code>pyqtSignal</code> <p>\u8fd0\u52a8\u6d88\u606f\u53d1\u9001\u4fe1\u53f7\uff0c\u643a\u5e26 (\u6d88\u606f\u5185\u5bb9, \u7c7b\u578b)\u3002</p> <code>serial_domain_service</code> <p>\u4e32\u53e3\u9886\u57df\u670d\u52a1\u3002</p> <code>message_domain_service</code> <p>\u6d88\u606f\u9886\u57df\u670d\u52a1\u3002</p> <code>data_list</code> <code>list</code> <p>\u5f85\u53d1\u9001\u7684\u6570\u636e\u5217\u8868\u3002</p> <code>data_index</code> <code>int</code> <p>\u5f53\u524d\u53d1\u9001\u7d22\u5f15\u3002</p> <code>timer</code> <code>QTimer</code> <p>\u5b9a\u65f6\u5668\u3002</p> <p>\u521d\u59cb\u5316\u8fd0\u52a8\u6267\u884c\u5668\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_runner.py</code> <pre><code>def __init__(\n    self, \n    serial_domain_service: SerialDomainService, \n    message_domain_service: MessageDomainService):\n    \"\"\"\u521d\u59cb\u5316\u8fd0\u52a8\u6267\u884c\u5668\u3002\"\"\"\n    super().__init__()\n    self.serial_domain_service = serial_domain_service\n    self.message_domain_service = message_domain_service\n    self.data_list = []\n    self.data_index = 0\n    self.timer = QTimer()\n    self.timer.setInterval(10)\n    self.timer.timeout.connect(self.motion_timeout)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionRunner.add_motion_data","title":"add_motion_data","text":"<pre><code>add_motion_data(positions)\n</code></pre> <p>\u6dfb\u52a0\u8fd0\u52a8\u6570\u636e\u70b9\u5e8f\u5217\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>positions</code> <code>list | ndarray</code> <p>\u5173\u8282\u89d2\u5ea6\u5217\u8868\u5e8f\u5217\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_runner.py</code> <pre><code>def add_motion_data(self, positions):\n    \"\"\"\u6dfb\u52a0\u8fd0\u52a8\u6570\u636e\u70b9\u5e8f\u5217\u3002\n\n    Args:\n        positions (list | np.ndarray): \u5173\u8282\u89d2\u5ea6\u5217\u8868\u5e8f\u5217\u3002\n    \"\"\"\n    for position in positions:\n        msg_dict = {\n            'control': 0x06,\n            'mode': 0x08,\n            'joint_angles': list(position)\n        }\n        message = self.message_domain_service.encode_message(**msg_dict)\n        self.data_list.append(message)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionRunner.add_gripper_data","title":"add_gripper_data","text":"<pre><code>add_gripper_data(effector_mode, effector_data, pre_delay=0.0, post_delay=1.0)\n</code></pre> <p>\u6dfb\u52a0\u5939\u722a\u547d\u4ee4\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>effector_mode</code> <code>int</code> <p>\u5939\u722a\u6a21\u5f0f\u3002</p> \u5fc5\u9700 <code>effector_data</code> <code>float</code> <p>\u5939\u722a\u53c2\u6570\u3002</p> \u5fc5\u9700 <code>pre_delay</code> <code>float</code> <p>\u524d\u7f6e\u7b49\u5f85\u65f6\u95f4\uff08\u79d2\uff09. Defaults to 0.0.</p> <code>0.0</code> <code>post_delay</code> <code>float</code> <p>\u540e\u7f6e\u7b49\u5f85\u65f6\u95f4\uff08\u79d2\uff09. Defaults to 1.0.</p> <code>1.0</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_runner.py</code> <pre><code>def add_gripper_data(self, effector_mode, effector_data, pre_delay=0.0, post_delay=1.0):\n    \"\"\"\u6dfb\u52a0\u5939\u722a\u547d\u4ee4\u3002\n\n    Args:\n        effector_mode (int): \u5939\u722a\u6a21\u5f0f\u3002\n        effector_data (float): \u5939\u722a\u53c2\u6570\u3002\n        pre_delay (float, optional): \u524d\u7f6e\u7b49\u5f85\u65f6\u95f4\uff08\u79d2\uff09. Defaults to 0.0.\n        post_delay (float, optional): \u540e\u7f6e\u7b49\u5f85\u65f6\u95f4\uff08\u79d2\uff09. Defaults to 1.0.\n    \"\"\"\n    # \u6dfb\u52a0\u524d\u7f6e\u5ef6\u8fdf\uff08\u5982\u679c&gt;0\uff09\n    if pre_delay &gt; 0:\n        self.data_list.append(DelayCommand(delay_s=pre_delay))\n\n    # \u6dfb\u52a0\u5939\u722a\u547d\u4ee4\n    msg_dict = {\n        'control': 0x00,\n        'mode': 0x08,\n        'effector_mode': effector_mode,\n        'effector_data': effector_data\n    }\n    message = self.message_domain_service.encode_message(**msg_dict)\n    self.data_list.append(message)\n\n    # \u6dfb\u52a0\u540e\u7f6e\u5ef6\u8fdf\uff08\u5982\u679c&gt;0\uff09\n    if post_delay &gt; 0:\n        self.data_list.append(DelayCommand(delay_s=post_delay))\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionRunner.start_motion","title":"start_motion","text":"<pre><code>start_motion()\n</code></pre> <p>\u5f00\u59cb\u6267\u884c\u8fd0\u52a8\u5e8f\u5217\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_runner.py</code> <pre><code>def start_motion(self):\n    \"\"\"\u5f00\u59cb\u6267\u884c\u8fd0\u52a8\u5e8f\u5217\u3002\"\"\"\n    self.data_index = 0\n    self.timer.start()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionRunner.stop_motion","title":"stop_motion","text":"<pre><code>stop_motion()\n</code></pre> <p>\u505c\u6b62\u6267\u884c\u8fd0\u52a8\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_runner.py</code> <pre><code>def stop_motion(self):\n    \"\"\"\u505c\u6b62\u6267\u884c\u8fd0\u52a8\u3002\"\"\"\n    self.data_index = 0\n    self.timer.stop()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionRunner.clear_data","title":"clear_data","text":"<pre><code>clear_data()\n</code></pre> <p>\u6e05\u7a7a\u6240\u6709\u5f85\u53d1\u9001\u6570\u636e\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_runner.py</code> <pre><code>def clear_data(self):\n    \"\"\"\u6e05\u7a7a\u6240\u6709\u5f85\u53d1\u9001\u6570\u636e\u3002\"\"\"\n    self.data_index = 0\n    self.data_list = []\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionRunner.motion_timeout","title":"motion_timeout","text":"<pre><code>motion_timeout()\n</code></pre> <p>\u5b9a\u65f6\u5668\u56de\u8c03\u51fd\u6570\uff0c\u8d1f\u8d23\u5355\u6b65\u53d1\u9001\u6216\u5ef6\u8fdf\u7b49\u5f85\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_runner.py</code> <pre><code>def motion_timeout(self):\n    \"\"\"\u5b9a\u65f6\u5668\u56de\u8c03\u51fd\u6570\uff0c\u8d1f\u8d23\u5355\u6b65\u53d1\u9001\u6216\u5ef6\u8fdf\u7b49\u5f85\u3002\"\"\"\n    if self.data_index &gt;= len(self.data_list):\n        self.timer.stop()\n        return\n    current_item = self.data_list[self.data_index]\n    if hasattr(current_item, 'is_delay'):\n        time.sleep(current_item.delay_s)\n    else:\n        self.serial_domain_service.send_data(current_item)\n        self.motion_msg_signal.emit(current_item, \"\u53d1\u9001\")\n    self.data_index += 1\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionConstructor","title":"MotionConstructor","text":"<pre><code>MotionConstructor(motion_runner: MotionRunner, trajectory_planner: TrajectoryPlanningService)\n</code></pre> <p>\u8fd0\u52a8\u6784\u9020\u5668 - \u9886\u57df\u670d\u52a1\u3002</p> <p>\u804c\u8d23\uff1a 1. \u7ba1\u7406\u64cd\u4f5c\u72b6\u6001\uff08\u6267\u884c/\u4fdd\u5b58/\u9884\u89c8\uff09 2. \u534f\u8c03 TrajectoryPlanningService\uff08\u89c4\u5212\uff09 3. \u534f\u8c03 MotionRunner\uff08\u6267\u884c\uff09</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>motion_runner</code> <code>MotionRunner</code> <p>\u8fd0\u52a8\u6267\u884c\u5668\u3002</p> <code>trajectory_planner</code> <code>TrajectoryPlanningService</code> <p>\u8f68\u8ff9\u89c4\u5212\u670d\u52a1\u3002</p> <p>\u521d\u59cb\u5316\u8fd0\u52a8\u6784\u9020\u5668\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>motion_runner</code> <code>MotionRunner</code> <p>\u8fd0\u52a8\u6267\u884c\u5668\u3002</p> \u5fc5\u9700 <code>trajectory_planner</code> <code>TrajectoryPlanningService</code> <p>\u8f68\u8ff9\u89c4\u5212\u670d\u52a1\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_constructor.py</code> <pre><code>def __init__(\n    self, \n    motion_runner: MotionRunner,\n    trajectory_planner: TrajectoryPlanningService\n):\n    \"\"\"\u521d\u59cb\u5316\u8fd0\u52a8\u6784\u9020\u5668\u3002\n\n    Args:\n        motion_runner (MotionRunner): \u8fd0\u52a8\u6267\u884c\u5668\u3002\n        trajectory_planner (TrajectoryPlanningService): \u8f68\u8ff9\u89c4\u5212\u670d\u52a1\u3002\n    \"\"\"\n    self.motion_runner = motion_runner\n    self.trajectory_planner = trajectory_planner\n\n    # \u7edf\u4e00\u7684\u64cd\u4f5c\u72b6\u6001\n    self._operation_mode = MotionOperationMode.NONE\n    self._pending_tasks = []\n    self._operation_context = {}\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionConstructor.prepare_operation","title":"prepare_operation","text":"<pre><code>prepare_operation(mode: MotionOperationMode, tasks: List[Dict], context: Dict = None)\n</code></pre> <p>\u51c6\u5907\u64cd\u4f5c\uff08\u7edf\u4e00\u5165\u53e3\uff09\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>mode</code> <code>MotionOperationMode</code> <p>\u64cd\u4f5c\u6a21\u5f0f\u3002 - EXECUTE: \u6267\u884c\u8fd0\u52a8 - SAVE: \u4fdd\u5b58\u8f68\u8ff9 - PREVIEW: \u9884\u89c8\u8f68\u8ff9</p> \u5fc5\u9700 <code>tasks</code> <code>List[Dict]</code> <p>\u4efb\u52a1\u5217\u8868\u3002</p> \u5fc5\u9700 <code>context</code> <code>Dict</code> <p>\u64cd\u4f5c\u4e0a\u4e0b\u6587\u3002 - EXECUTE: {} - SAVE: {\"filename\": \"xxx\", \"type\": \"node|plan\"} - PREVIEW: {\"type\": \"node|plan\", \"node_index\": 0}</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_constructor.py</code> <pre><code>def prepare_operation(\n    self,\n    mode: MotionOperationMode,\n    tasks: List[Dict],\n    context: Dict = None\n):\n    \"\"\"\u51c6\u5907\u64cd\u4f5c\uff08\u7edf\u4e00\u5165\u53e3\uff09\u3002\n\n    Args:\n        mode (MotionOperationMode): \u64cd\u4f5c\u6a21\u5f0f\u3002\n            - EXECUTE: \u6267\u884c\u8fd0\u52a8\n            - SAVE: \u4fdd\u5b58\u8f68\u8ff9\n            - PREVIEW: \u9884\u89c8\u8f68\u8ff9\n        tasks (List[Dict]): \u4efb\u52a1\u5217\u8868\u3002\n        context (Dict, optional): \u64cd\u4f5c\u4e0a\u4e0b\u6587\u3002\n            - EXECUTE: {}\n            - SAVE: {\"filename\": \"xxx\", \"type\": \"node|plan\"}\n            - PREVIEW: {\"type\": \"node|plan\", \"node_index\": 0}\n    \"\"\"\n    self._operation_mode = mode\n    self._pending_tasks = tasks.copy()\n    self._operation_context = context or {}\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionConstructor.has_pending_operation","title":"has_pending_operation","text":"<pre><code>has_pending_operation() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u662f\u5426\u6709\u5f85\u5904\u7406\u7684\u64cd\u4f5c\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u6709\u5f85\u5904\u7406\u7684\u64cd\u4f5c, False=\u65e0\u64cd\u4f5c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_constructor.py</code> <pre><code>def has_pending_operation(self) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u662f\u5426\u6709\u5f85\u5904\u7406\u7684\u64cd\u4f5c\u3002\n\n    Returns:\n        bool: True=\u6709\u5f85\u5904\u7406\u7684\u64cd\u4f5c, False=\u65e0\u64cd\u4f5c\u3002\n    \"\"\"\n    return self._operation_mode != MotionOperationMode.NONE\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionConstructor.get_operation_mode","title":"get_operation_mode","text":"<pre><code>get_operation_mode() -&gt; MotionOperationMode\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u64cd\u4f5c\u6a21\u5f0f\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>MotionOperationMode</code> <code>MotionOperationMode</code> <p>\u5f53\u524d\u64cd\u4f5c\u6a21\u5f0f\u679a\u4e3e\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_constructor.py</code> <pre><code>def get_operation_mode(self) -&gt; MotionOperationMode:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u64cd\u4f5c\u6a21\u5f0f\u3002\n\n    Returns:\n        MotionOperationMode: \u5f53\u524d\u64cd\u4f5c\u6a21\u5f0f\u679a\u4e3e\u3002\n    \"\"\"\n    return self._operation_mode\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionConstructor.get_pending_tasks","title":"get_pending_tasks","text":"<pre><code>get_pending_tasks() -&gt; List[Dict]\n</code></pre> <p>\u83b7\u53d6\u5f85\u5904\u7406\u7684\u4efb\u52a1\u5217\u8868\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[Dict]</code> <p>List[Dict]: \u4efb\u52a1\u5217\u8868\u7684\u526f\u672c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_constructor.py</code> <pre><code>def get_pending_tasks(self) -&gt; List[Dict]:\n    \"\"\"\u83b7\u53d6\u5f85\u5904\u7406\u7684\u4efb\u52a1\u5217\u8868\u3002\n\n    Returns:\n        List[Dict]: \u4efb\u52a1\u5217\u8868\u7684\u526f\u672c\u3002\n    \"\"\"\n    return self._pending_tasks.copy()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionConstructor.get_operation_context","title":"get_operation_context","text":"<pre><code>get_operation_context() -&gt; Dict\n</code></pre> <p>\u83b7\u53d6\u64cd\u4f5c\u4e0a\u4e0b\u6587\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Dict</code> <code>Dict</code> <p>\u4e0a\u4e0b\u6587\u5b57\u5178\u7684\u526f\u672c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_constructor.py</code> <pre><code>def get_operation_context(self) -&gt; Dict:\n    \"\"\"\u83b7\u53d6\u64cd\u4f5c\u4e0a\u4e0b\u6587\u3002\n\n    Returns:\n        Dict: \u4e0a\u4e0b\u6587\u5b57\u5178\u7684\u526f\u672c\u3002\n    \"\"\"\n    return self._operation_context.copy()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionConstructor.clear_operation","title":"clear_operation","text":"<pre><code>clear_operation()\n</code></pre> <p>\u6e05\u9664\u64cd\u4f5c\u72b6\u6001\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_constructor.py</code> <pre><code>def clear_operation(self):\n    \"\"\"\u6e05\u9664\u64cd\u4f5c\u72b6\u6001\u3002\"\"\"\n    self._operation_mode = MotionOperationMode.NONE\n    self._pending_tasks.clear()\n    self._operation_context.clear()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionConstructor.execute_motion","title":"execute_motion","text":"<pre><code>execute_motion(start_position: List[float])\n</code></pre> <p>\u6267\u884c\u8fd0\u52a8\uff08\u4ec5\u7528\u4e8eEXECUTE\u6a21\u5f0f\uff09\u3002</p> <p>\u6d41\u7a0b\uff1a 1. \u6309\u4efb\u52a1\u987a\u5e8f\u89c4\u5212\u6bcf\u4e2a\u4efb\u52a1 2. \u6309\u987a\u5e8f\u6dfb\u52a0\u8fd0\u52a8\u6570\u636e\u548c\u5939\u722a\u547d\u4ee4 3. \u6e05\u9664\u72b6\u6001</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>start_position</code> <code>List[float]</code> <p>\u8d77\u59cb\u4f4d\u7f6e\uff08\u5f53\u524d\u5173\u8282\u89d2\u5ea6\uff09\u3002</p> \u5fc5\u9700 <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>RuntimeError</code> <p>\u5982\u679c\u5f53\u524d\u6a21\u5f0f\u4e0d\u662fEXECUTE\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/motion_constructor.py</code> <pre><code>def execute_motion(self, start_position: List[float]):\n    \"\"\"\u6267\u884c\u8fd0\u52a8\uff08\u4ec5\u7528\u4e8eEXECUTE\u6a21\u5f0f\uff09\u3002\n\n    \u6d41\u7a0b\uff1a\n    1. \u6309\u4efb\u52a1\u987a\u5e8f\u89c4\u5212\u6bcf\u4e2a\u4efb\u52a1\n    2. \u6309\u987a\u5e8f\u6dfb\u52a0\u8fd0\u52a8\u6570\u636e\u548c\u5939\u722a\u547d\u4ee4\n    3. \u6e05\u9664\u72b6\u6001\n\n    Args:\n        start_position (List[float]): \u8d77\u59cb\u4f4d\u7f6e\uff08\u5f53\u524d\u5173\u8282\u89d2\u5ea6\uff09\u3002\n\n    Raises:\n        RuntimeError: \u5982\u679c\u5f53\u524d\u6a21\u5f0f\u4e0d\u662fEXECUTE\u3002\n    \"\"\"\n    if self._operation_mode != MotionOperationMode.EXECUTE:\n        raise RuntimeError(f\"\u5f53\u524d\u6a21\u5f0f\u4e0d\u662fEXECUTE: {self._operation_mode}\")\n\n    if not self._pending_tasks:\n        return\n\n    # \u6267\u884c\n    self.motion_runner.clear_data()\n\n    # \u6309\u987a\u5e8f\u5904\u7406\u6bcf\u4e2a\u4efb\u52a1\uff0c\u4fdd\u6301\u539f\u6709\u987a\u5e8f\n    current_position = start_position\n\n    for task in self._pending_tasks:\n        if task[\"type\"] == \"gripper\":\n            # \u5939\u722a\u4efb\u52a1\uff1a\u76f4\u63a5\u6dfb\u52a0\u5939\u722a\u547d\u4ee4\uff08\u5e26\u5ef6\u8fdf\uff09\n            effector_mode = task[\"effector_mode\"]\n            effector_data = task[\"effector_data\"]\n            pre_delay = task.get(\"pre_delay\", 0.0)\n            post_delay = task.get(\"post_delay\", 1.0)\n            self.motion_runner.add_gripper_data(\n                effector_mode, \n                effector_data,\n                pre_delay=pre_delay,\n                post_delay=post_delay\n            )\n        else:\n            # \u8fd0\u52a8\u4efb\u52a1\uff1a\u89c4\u5212\u8f68\u8ff9\u5e76\u6dfb\u52a0\n            positions, end_position = self.trajectory_planner._plan_single_task(\n                task, \n                current_position\n            )\n            # \u6ce8\u610f\uff1apositions \u53ef\u80fd\u662f numpy \u6570\u7ec4\uff0c\u4e0d\u80fd\u76f4\u63a5\u7528 if positions\n            if len(positions) &gt; 0:\n                self.motion_runner.add_motion_data(positions)\n                current_position = end_position\n\n    self.motion_runner.start_motion()\n\n    # \u6e05\u7406\n    self.clear_operation()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TrajectoryPlanningService","title":"TrajectoryPlanningService","text":"<pre><code>TrajectoryPlanningService(s_curve: SCurve, smooth_service: SmoothDomainService, linear_motion_service: LinearMotionDomainService, curve_motion_service: CurveMotionDomainService)\n</code></pre> <p>\u8f68\u8ff9\u89c4\u5212\u670d\u52a1 - \u9886\u57df\u670d\u52a1\u3002</p> <p>\u804c\u8d23\uff1a 1. \u6839\u636e\u4efb\u52a1\u7c7b\u578b\u89c4\u5212\u8f68\u8ff9\u70b9\u5e8f\u5217 2. \u7ef4\u62a4\u4f4d\u7f6e\u72b6\u6001\uff08\u8d77\u70b9-&gt;\u7ec8\u70b9\uff09 3. \u8fd4\u56de\u7eaf\u6570\u636e\uff0c\u4e0d\u6267\u884c\u4efb\u4f55\u526f\u4f5c\u7528</p> <p>\u6838\u5fc3\u539f\u5219\uff1a\u7eaf\u51fd\u6570\uff0c\u53ef\u6d4b\u8bd5\uff0c\u53ef\u590d\u7528</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>s_curve</code> <code>SCurve</code> <p>S\u66f2\u7ebf\u7b97\u6cd5\u670d\u52a1\u3002</p> <code>smooth_service</code> <code>SmoothDomainService</code> <p>\u5e73\u6ed1\u7b97\u6cd5\u670d\u52a1\u3002</p> <code>linear_motion_service</code> <code>LinearMotionDomainService</code> <p>\u76f4\u7ebf\u8fd0\u52a8\u670d\u52a1\u3002</p> <code>curve_motion_service</code> <code>CurveMotionDomainService</code> <p>\u66f2\u7ebf\u8fd0\u52a8\u670d\u52a1\u3002</p> <p>\u521d\u59cb\u5316\u8f68\u8ff9\u89c4\u5212\u670d\u52a1\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>s_curve</code> <code>SCurve</code> <p>S\u66f2\u7ebf\u7b97\u6cd5\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>smooth_service</code> <code>SmoothDomainService</code> <p>\u5e73\u6ed1\u7b97\u6cd5\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>linear_motion_service</code> <code>LinearMotionDomainService</code> <p>\u76f4\u7ebf\u8fd0\u52a8\u670d\u52a1\u3002</p> \u5fc5\u9700 <code>curve_motion_service</code> <code>CurveMotionDomainService</code> <p>\u66f2\u7ebf\u8fd0\u52a8\u670d\u52a1\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/trajectory_planning_service.py</code> <pre><code>def __init__(\n    self,\n    s_curve: SCurve,\n    smooth_service: SmoothDomainService,\n    linear_motion_service: LinearMotionDomainService,\n    curve_motion_service: CurveMotionDomainService\n):\n    \"\"\"\u521d\u59cb\u5316\u8f68\u8ff9\u89c4\u5212\u670d\u52a1\u3002\n\n    Args:\n        s_curve (SCurve): S\u66f2\u7ebf\u7b97\u6cd5\u670d\u52a1\u3002\n        smooth_service (SmoothDomainService): \u5e73\u6ed1\u7b97\u6cd5\u670d\u52a1\u3002\n        linear_motion_service (LinearMotionDomainService): \u76f4\u7ebf\u8fd0\u52a8\u670d\u52a1\u3002\n        curve_motion_service (CurveMotionDomainService): \u66f2\u7ebf\u8fd0\u52a8\u670d\u52a1\u3002\n    \"\"\"\n    self.s_curve = s_curve\n    self.smooth_service = smooth_service\n    self.linear_motion_service = linear_motion_service\n    self.curve_motion_service = curve_motion_service\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TrajectoryPlanningService.plan_task_sequence","title":"plan_task_sequence","text":"<pre><code>plan_task_sequence(tasks: List[Dict], start_position: List[float]) -&gt; List[List[float]]\n</code></pre> <p>\u89c4\u5212\u4efb\u52a1\u5e8f\u5217\uff08\u4ec5\u8fd4\u56de\u4f4d\u7f6e\uff09\u3002</p> <p>\u7528\u4e8e\uff1a\u6267\u884c\u8fd0\u52a8\u3001\u4fdd\u5b58\u8f68\u8ff9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>tasks</code> <code>List[Dict]</code> <p>\u4efb\u52a1\u5217\u8868\u3002</p> \u5fc5\u9700 <code>start_position</code> <code>List[float]</code> <p>\u8d77\u59cb\u4f4d\u7f6e\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[List[float]]</code> <p>List[List[float]]: \u8f68\u8ff9\u70b9\u5e8f\u5217 [[q1,...,q6], ...]\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/trajectory_planning_service.py</code> <pre><code>def plan_task_sequence(\n    self,\n    tasks: List[Dict],\n    start_position: List[float]\n) -&gt; List[List[float]]:\n    \"\"\"\u89c4\u5212\u4efb\u52a1\u5e8f\u5217\uff08\u4ec5\u8fd4\u56de\u4f4d\u7f6e\uff09\u3002\n\n    \u7528\u4e8e\uff1a\u6267\u884c\u8fd0\u52a8\u3001\u4fdd\u5b58\u8f68\u8ff9\u3002\n\n    Args:\n        tasks (List[Dict]): \u4efb\u52a1\u5217\u8868\u3002\n        start_position (List[float]): \u8d77\u59cb\u4f4d\u7f6e\u3002\n\n    Returns:\n        List[List[float]]: \u8f68\u8ff9\u70b9\u5e8f\u5217 [[q1,...,q6], ...]\u3002\n    \"\"\"\n    all_positions = []\n    current_position = start_position\n\n    for task in tasks:\n        positions, end_position = self._plan_single_task(task, current_position)\n        all_positions.extend(positions)\n        current_position = end_position\n\n    return all_positions\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TrajectoryPlanningService.plan_task_sequence_with_derivatives","title":"plan_task_sequence_with_derivatives","text":"<pre><code>plan_task_sequence_with_derivatives(tasks: List[Dict], start_position: List[float]) -&gt; Dict\n</code></pre> <p>\u89c4\u5212\u4efb\u52a1\u5e8f\u5217\uff08\u8fd4\u56de\u4f4d\u7f6e\u3001\u901f\u5ea6\u3001\u52a0\u901f\u5ea6\u3001\u65f6\u95f4\uff09\u3002</p> <p>\u7528\u4e8e\uff1a\u9884\u89c8\u8f68\u8ff9\u66f2\u7ebf\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>tasks</code> <code>List[Dict]</code> <p>\u4efb\u52a1\u5217\u8868\u3002</p> \u5fc5\u9700 <code>start_position</code> <code>List[float]</code> <p>\u8d77\u59cb\u4f4d\u7f6e\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Dict</code> <code>Dict</code> <p>\u5305\u542b\u4ee5\u4e0b\u952e\u7684\u5b57\u5178: - time: [t0, t1, ...] - positions: [[q1,...,q6], ...] - velocities: [[qd1,...,qd6], ...] - accelerations: [[qdd1,...,qdd6], ...]</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/motion/trajectory_planning_service.py</code> <pre><code>def plan_task_sequence_with_derivatives(\n    self,\n    tasks: List[Dict],\n    start_position: List[float]\n) -&gt; Dict:\n    \"\"\"\u89c4\u5212\u4efb\u52a1\u5e8f\u5217\uff08\u8fd4\u56de\u4f4d\u7f6e\u3001\u901f\u5ea6\u3001\u52a0\u901f\u5ea6\u3001\u65f6\u95f4\uff09\u3002\n\n    \u7528\u4e8e\uff1a\u9884\u89c8\u8f68\u8ff9\u66f2\u7ebf\u3002\n\n    Args:\n        tasks (List[Dict]): \u4efb\u52a1\u5217\u8868\u3002\n        start_position (List[float]): \u8d77\u59cb\u4f4d\u7f6e\u3002\n\n    Returns:\n        Dict: \u5305\u542b\u4ee5\u4e0b\u952e\u7684\u5b57\u5178:\n            - time: [t0, t1, ...]\n            - positions: [[q1,...,q6], ...]\n            - velocities: [[qd1,...,qd6], ...]\n            - accelerations: [[qdd1,...,qdd6], ...]\n    \"\"\"\n    all_time = []\n    all_positions = []\n    all_velocities = []\n    all_accelerations = []\n\n    current_position = start_position\n    current_time = 0.0\n\n    for task in tasks:\n        result = self._plan_single_task_full(task, current_position)\n\n        # \u5408\u5e76\u6570\u636e\uff08\u65f6\u95f4\u7d2f\u52a0\uff09\n        all_time.extend([t + current_time for t in result[\"time\"]])\n        all_positions.extend(result[\"positions\"])\n        all_velocities.extend(result[\"velocities\"])\n        all_accelerations.extend(result[\"accelerations\"])\n\n        # \u66f4\u65b0\u72b6\u6001\n        if len(result[\"positions\"]) &gt; 0:\n            current_position = result[\"positions\"][-1]\n            if len(result[\"time\"]) &gt; 0:\n                current_time = all_time[-1]\n\n    return {\n        \"time\": all_time,\n        \"positions\": all_positions,\n        \"velocities\": all_velocities,\n        \"accelerations\": all_accelerations\n    }\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RobotStateDomainService","title":"RobotStateDomainService","text":"<pre><code>RobotStateDomainService()\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u673a\u68b0\u81c2\u72b6\u6001\u9886\u57df\u670d\u52a1 - \u5355\u4e00\u6570\u636e\u6e90\u3002</p> <p>\u804c\u8d23\uff1a 1. \u7ef4\u62a4\u5f53\u524d\u673a\u68b0\u81c2\u72b6\u6001\uff08\u6700\u65b0\u5feb\u7167\uff09 2. \u7ef4\u62a4\u5386\u53f2\u72b6\u6001\u7f13\u51b2\uff08\u6ed1\u52a8\u7a97\u53e3\uff09 3. \u8ba1\u7b97\u9759\u6469\u64e6\u8865\u507f\uff08\u57fa\u4e8e\u5386\u53f2\u6570\u636e\uff09 4. \u53d1\u5c04\u4fe1\u53f7\u901a\u77e5\u8ba2\u9605\u8005</p> <p>\u8bbe\u8ba1\u539f\u5219\uff1a - Single Source of Truth: \u6240\u6709\u72b6\u6001\u53ea\u5728\u8fd9\u91cc\u7ef4\u62a4 - Pub-Sub Pattern: \u652f\u6301\u591a\u4e2a\u8ba2\u9605\u8005 - Thread Safe: \u4f7f\u7528\u9501\u4fdd\u62a4\u53ef\u53d8\u6570\u636e</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>state_updated</code> <code>pyqtSignal</code> <p>\u72b6\u6001\u66f4\u65b0\u4fe1\u53f7\uff0c\u643a\u5e26 RobotStateSnapshot\u3002</p> <code>angles_changed</code> <code>pyqtSignal</code> <p>\u89d2\u5ea6\u663e\u8457\u53d8\u5316\u4fe1\u53f7\uff0c\u643a\u5e26 [\u03b81, \u03b82, ..., \u03b86] \u5217\u8868\u3002</p> <code>torque_compensation_requested</code> <code>pyqtSignal</code> <p>\u529b\u77e9\u8865\u507f\u8bf7\u6c42\u4fe1\u53f7\uff0c\u643a\u5e26\u5f53\u524d\u89d2\u5ea6\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/robot_state_domain_service.py</code> <pre><code>def __init__(self):\n    super().__init__()\n\n    # \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    # \u72b6\u6001\u5b58\u50a8\n    # \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n    # \u5f53\u524d\u72b6\u6001\uff08\u6700\u65b0\u5feb\u7167\uff09\n    self._current_state: Optional[RobotStateSnapshot] = None\n\n    # \u5386\u53f2\u7f13\u51b2\uff08\u6ed1\u52a8\u7a97\u53e3\uff0c\u7528\u4e8e\u9759\u6469\u64e6\u8ba1\u7b97\uff09\n    self._position_history = deque(maxlen=20)\n\n    # \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    # \u9759\u6469\u64e6\u8ba1\u7b97\u76f8\u5173\uff08\u7528\u4e8e\u793a\u6559\u6a21\u5f0f\uff09\n    # \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n    # \u9759\u6469\u64e6\u72b6\u6001\uff08\u6bcf\u4e2a\u5173\u8282\uff1a0=\u9759\u6b62, 1=\u8fd0\u52a8\uff09\n    self._friction_state = [0] * 6\n\n    # \u9759\u6469\u64e6\u8865\u507f\u503c\uff08Nm\uff09\n    self._friction_compensation = [0.0] * 6\n\n    # \u9759\u6469\u64e6\u914d\u7f6e\uff08\u9608\u503c\uff09\n    self._friction_config = [4, 0, 3, 0.5, 0.5, 0.5]\n\n    # \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n    # \u5176\u4ed6\u72b6\u6001\n    # \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n    # \u793a\u6559\u6a21\u5f0f\u6807\u5fd7\n    self._teaching_mode = False\n\n    # \u7ebf\u7a0b\u9501\uff08\u4fdd\u62a4\u53ef\u53d8\u6570\u636e\uff09\n    self._lock = threading.RLock()\n\n    # \u6700\u540e\u66f4\u65b0\u65f6\u95f4\n    self._last_update_time = 0.0\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RobotStateDomainService.update_state","title":"update_state","text":"<pre><code>update_state(decoded_message)\n</code></pre> <p>\u66f4\u65b0\u673a\u68b0\u81c2\u72b6\u6001\uff08\u6838\u5fc3\u65b9\u6cd5\uff09\u3002</p> <p>\u7531 MessageResponseService \u8c03\u7528\uff0c\u6bcf\u6b21\u63a5\u6536\u5230\u4e32\u53e3\u6570\u636e\u5e76\u89e3\u7801\u540e\u8c03\u7528\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>decoded_message</code> <code>Any</code> <p>\u89e3\u7801\u540e\u7684\u6d88\u606f\u5bf9\u8c61\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/robot_state_domain_service.py</code> <pre><code>def update_state(self, decoded_message):\n    \"\"\"\u66f4\u65b0\u673a\u68b0\u81c2\u72b6\u6001\uff08\u6838\u5fc3\u65b9\u6cd5\uff09\u3002\n\n    \u7531 MessageResponseService \u8c03\u7528\uff0c\u6bcf\u6b21\u63a5\u6536\u5230\u4e32\u53e3\u6570\u636e\u5e76\u89e3\u7801\u540e\u8c03\u7528\u3002\n\n    Args:\n        decoded_message (Any): \u89e3\u7801\u540e\u7684\u6d88\u606f\u5bf9\u8c61\u3002\n    \"\"\"\n    new_snapshot = RobotStateSnapshot.from_decoded_message(decoded_message)\n    old_snapshot = self._current_state\n    self._current_state = new_snapshot\n    self._last_update_time = new_snapshot.timestamp\n\n    with self._lock:\n        self._position_history.append({\n            'timestamp': new_snapshot.timestamp,\n            'angles': list(new_snapshot.joint_angles),\n            'positions': list(new_snapshot.joint_positions)\n        })\n\n        if self._teaching_mode and len(self._position_history) &gt;= 20:\n            self._calculate_friction_compensation()\n\n    self.state_updated.emit(new_snapshot)\n\n    if old_snapshot and self._angles_changed_significantly(old_snapshot, new_snapshot):\n        self.angles_changed.emit(list(new_snapshot.joint_angles))\n\n    if new_snapshot.mode == 0x0A:\n        if self._teaching_mode and new_snapshot.control in [0x06, 0x07]:\n            from math import pi\n            init_offset = [0.0, -pi/2, 0.0, pi/2, 0.0, 0.0]\n            adjusted_angles = [\n                a - offset \n                for a, offset in zip(new_snapshot.joint_angles, init_offset)\n            ]\n            self.torque_compensation_requested.emit(adjusted_angles)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RobotStateDomainService.get_current_state","title":"get_current_state","text":"<pre><code>get_current_state() -&gt; Optional[RobotStateSnapshot]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u72b6\u6001\u5feb\u7167\uff08\u4e0d\u53ef\u53d8\uff0c\u7ebf\u7a0b\u5b89\u5168\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[RobotStateSnapshot]</code> <p>Optional[RobotStateSnapshot]: \u5f53\u524d\u72b6\u6001\u5feb\u7167\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/robot_state_domain_service.py</code> <pre><code>def get_current_state(self) -&gt; Optional[RobotStateSnapshot]:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u72b6\u6001\u5feb\u7167\uff08\u4e0d\u53ef\u53d8\uff0c\u7ebf\u7a0b\u5b89\u5168\uff09\u3002\n\n    Returns:\n        Optional[RobotStateSnapshot]: \u5f53\u524d\u72b6\u6001\u5feb\u7167\u3002\n    \"\"\"\n    return self._current_state\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RobotStateDomainService.get_current_angles","title":"get_current_angles","text":"<pre><code>get_current_angles() -&gt; List[float]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u5173\u8282\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[float]</code> <p>List[float]: 6\u4e2a\u5173\u8282\u7684\u89d2\u5ea6\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/robot_state_domain_service.py</code> <pre><code>def get_current_angles(self) -&gt; List[float]:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u5173\u8282\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002\n\n    Returns:\n        List[float]: 6\u4e2a\u5173\u8282\u7684\u89d2\u5ea6\u5217\u8868\u3002\n    \"\"\"\n    if self._current_state:\n        return list(self._current_state.joint_angles)\n    return [0.0] * 6\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RobotStateDomainService.get_current_positions","title":"get_current_positions","text":"<pre><code>get_current_positions() -&gt; List[int]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u5173\u8282\u4f4d\u7f6e\uff08\u7f16\u7801\u5668\u503c\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[int]</code> <p>List[int]: 6\u4e2a\u5173\u8282\u7684\u7f16\u7801\u5668\u4f4d\u7f6e\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/robot_state_domain_service.py</code> <pre><code>def get_current_positions(self) -&gt; List[int]:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u5173\u8282\u4f4d\u7f6e\uff08\u7f16\u7801\u5668\u503c\uff09\u3002\n\n    Returns:\n        List[int]: 6\u4e2a\u5173\u8282\u7684\u7f16\u7801\u5668\u4f4d\u7f6e\u5217\u8868\u3002\n    \"\"\"\n    if self._current_state:\n        return list(self._current_state.joint_positions)\n    return [0] * 6\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RobotStateDomainService.get_position_history","title":"get_position_history","text":"<pre><code>get_position_history(count: int = 20) -&gt; List[Dict]\n</code></pre> <p>\u83b7\u53d6\u5386\u53f2\u4f4d\u7f6e\u6570\u636e\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>count</code> <code>int</code> <p>\u83b7\u53d6\u7684\u8bb0\u5f55\u6570\u91cf. Defaults to 20.</p> <code>20</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[Dict]</code> <p>List[Dict]: \u5386\u53f2\u4f4d\u7f6e\u6570\u636e\u5217\u8868\uff0c\u6bcf\u4e2a\u5143\u7d20\u5305\u542b timestamp, angles, positions\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/robot_state_domain_service.py</code> <pre><code>def get_position_history(self, count: int = 20) -&gt; List[Dict]:\n    \"\"\"\u83b7\u53d6\u5386\u53f2\u4f4d\u7f6e\u6570\u636e\u3002\n\n    Args:\n        count (int, optional): \u83b7\u53d6\u7684\u8bb0\u5f55\u6570\u91cf. Defaults to 20.\n\n    Returns:\n        List[Dict]: \u5386\u53f2\u4f4d\u7f6e\u6570\u636e\u5217\u8868\uff0c\u6bcf\u4e2a\u5143\u7d20\u5305\u542b timestamp, angles, positions\u3002\n    \"\"\"\n    with self._lock:\n        return list(self._position_history)[-count:]\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RobotStateDomainService.get_friction_compensation","title":"get_friction_compensation","text":"<pre><code>get_friction_compensation() -&gt; List[float]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u9759\u6469\u64e6\u8865\u507f\u503c\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[float]</code> <p>List[float]: 6\u4e2a\u5173\u8282\u7684\u9759\u6469\u64e6\u8865\u507f\u503c\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/robot_state_domain_service.py</code> <pre><code>def get_friction_compensation(self) -&gt; List[float]:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u9759\u6469\u64e6\u8865\u507f\u503c\u3002\n\n    Returns:\n        List[float]: 6\u4e2a\u5173\u8282\u7684\u9759\u6469\u64e6\u8865\u507f\u503c\u5217\u8868\u3002\n    \"\"\"\n    with self._lock:\n        return self._friction_compensation.copy()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RobotStateDomainService.set_teaching_mode","title":"set_teaching_mode","text":"<pre><code>set_teaching_mode(enabled: bool)\n</code></pre> <p>\u8bbe\u7f6e\u793a\u6559\u6a21\u5f0f\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>enabled</code> <code>bool</code> <p>True=\u5f00\u542f, False=\u5173\u95ed\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/robot_state_domain_service.py</code> <pre><code>def set_teaching_mode(self, enabled: bool):\n    \"\"\"\u8bbe\u7f6e\u793a\u6559\u6a21\u5f0f\u3002\n\n    Args:\n        enabled (bool): True=\u5f00\u542f, False=\u5173\u95ed\u3002\n    \"\"\"\n    self._teaching_mode = enabled\n    if enabled:\n        # \u5f00\u542f\u793a\u6559\u65f6\uff0c\u6e05\u7a7a\u5386\u53f2\n        with self._lock:\n            self._position_history.clear()\n            self._friction_state = [0] * 6\n            self._friction_compensation = [0.0] * 6\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RobotStateDomainService.set_friction_config","title":"set_friction_config","text":"<pre><code>set_friction_config(config: List[float])\n</code></pre> <p>\u8bbe\u7f6e\u9759\u6469\u64e6\u914d\u7f6e\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config</code> <code>List[float]</code> <p>6\u4e2a\u5173\u8282\u7684\u9759\u6469\u64e6\u9608\u503c\u5217\u8868\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/robot_state_domain_service.py</code> <pre><code>def set_friction_config(self, config: List[float]):\n    \"\"\"\u8bbe\u7f6e\u9759\u6469\u64e6\u914d\u7f6e\u3002\n\n    Args:\n        config (List[float]): 6\u4e2a\u5173\u8282\u7684\u9759\u6469\u64e6\u9608\u503c\u5217\u8868\u3002\n    \"\"\"\n    if len(config) == 6:\n        self._friction_config = config\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RobotStateDomainService.clear_history","title":"clear_history","text":"<pre><code>clear_history()\n</code></pre> <p>\u6e05\u7a7a\u5386\u53f2\u6570\u636e\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/robot_state_domain_service.py</code> <pre><code>def clear_history(self):\n    \"\"\"\u6e05\u7a7a\u5386\u53f2\u6570\u636e\u3002\"\"\"\n    with self._lock:\n        self._position_history.clear()\n        self._friction_state = [0] * 6\n        self._friction_compensation = [0.0] * 6\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TeachRecordDomainService","title":"TeachRecordDomainService","text":"<pre><code>TeachRecordDomainService()\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u793a\u6559\u8bb0\u5f55\u9886\u57df\u670d\u52a1 - Domain\u5c42\u3002</p> <p>\u804c\u8d23\uff1a 1. \u7ba1\u7406\u793a\u6559\u8bb0\u5f55\u6570\u636e\uff08\u5185\u5b58\u4e2d\uff09 2. \u63a7\u5236\u8bb0\u5f55\u7684\u5f00\u59cb/\u505c\u6b62 3. \u63d0\u4f9b\u8bb0\u5f55\u7684\u589e\u5220\u6539\u67e5\u64cd\u4f5c 4. \u751f\u6210\u8bb0\u5f55\u540d\u79f0</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>recording_state_changed</code> <code>pyqtSignal</code> <p>\u8bb0\u5f55\u72b6\u6001\u53d8\u5316\u4fe1\u53f7\uff0c\u643a\u5e26\u662f\u5426\u6b63\u5728\u8bb0\u5f55\u3002</p> <code>record_added</code> <code>pyqtSignal</code> <p>\u8bb0\u5f55\u6dfb\u52a0\u4fe1\u53f7\uff0c\u643a\u5e26\u65b0\u589e\u7684\u8bb0\u5f55\u540d\u79f0\u3002</p> <code>record_deleted</code> <code>pyqtSignal</code> <p>\u8bb0\u5f55\u5220\u9664\u4fe1\u53f7\uff0c\u643a\u5e26\u5220\u9664\u7684\u8bb0\u5f55\u540d\u79f0\u3002</p> <p>\u521d\u59cb\u5316\u793a\u6559\u8bb0\u5f55\u670d\u52a1\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def __init__(self):\n    \"\"\"\u521d\u59cb\u5316\u793a\u6559\u8bb0\u5f55\u670d\u52a1\u3002\"\"\"\n    super().__init__()\n\n    # \u8bb0\u5f55\u6570\u636e {\u8bb0\u5f55\u540d: \u89d2\u5ea6\u5217\u8868}\n    self._records: Dict[str, List[List[float]]] = {}\n\n    # \u5f53\u524d\u8bb0\u5f55\u72b6\u6001\n    self._is_recording = False\n    self._current_record_angles: List[List[float]] = []\n    self._record_counter = 0\n\n    # \u8bb0\u5f55\u5b9a\u65f6\u5668\uff0810ms\u95f4\u9694\uff0c100Hz\u91c7\u6837\u7387\uff09\n    self._record_timer = QTimer()\n    self._record_timer.setInterval(10)\n    self._record_timer.timeout.connect(self._on_record_timer_timeout)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TeachRecordDomainService.start_recording","title":"start_recording","text":"<pre><code>start_recording()\n</code></pre> <p>\u5f00\u59cb\u8bb0\u5f55\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def start_recording(self):\n    \"\"\"\u5f00\u59cb\u8bb0\u5f55\u3002\"\"\"\n    if not self._is_recording:\n        self._is_recording = True\n        self._current_record_angles = []\n        self._record_counter = 0\n        self._record_timer.start()\n        self.recording_state_changed.emit(True)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TeachRecordDomainService.stop_recording","title":"stop_recording","text":"<pre><code>stop_recording() -&gt; Optional[str]\n</code></pre> <p>\u505c\u6b62\u8bb0\u5f55\u5e76\u4fdd\u5b58\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[str]</code> <p>Optional[str]: \u65b0\u751f\u6210\u7684\u8bb0\u5f55\u540d\u79f0\uff0c\u5982\u679c\u6ca1\u6709\u6570\u636e\u5219\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def stop_recording(self) -&gt; Optional[str]:\n    \"\"\"\u505c\u6b62\u8bb0\u5f55\u5e76\u4fdd\u5b58\u3002\n\n    Returns:\n        Optional[str]: \u65b0\u751f\u6210\u7684\u8bb0\u5f55\u540d\u79f0\uff0c\u5982\u679c\u6ca1\u6709\u6570\u636e\u5219\u8fd4\u56de None\u3002\n    \"\"\"\n    if self._is_recording:\n        self._is_recording = False\n        self._record_timer.stop()\n        self.recording_state_changed.emit(False)\n\n        # \u4fdd\u5b58\u5f53\u524d\u8bb0\u5f55\n        if self._current_record_angles:\n            record_name = self._generate_record_name()\n            self._records[record_name] = self._current_record_angles.copy()\n            self.record_added.emit(record_name)\n            return record_name\n        else:\n            return None\n    return None\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TeachRecordDomainService.is_recording","title":"is_recording","text":"<pre><code>is_recording() -&gt; bool\n</code></pre> <p>\u67e5\u8be2\u662f\u5426\u6b63\u5728\u8bb0\u5f55\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u6b63\u5728\u8bb0\u5f55\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def is_recording(self) -&gt; bool:\n    \"\"\"\u67e5\u8be2\u662f\u5426\u6b63\u5728\u8bb0\u5f55\u3002\n\n    Returns:\n        bool: \u662f\u5426\u6b63\u5728\u8bb0\u5f55\u3002\n    \"\"\"\n    return self._is_recording\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TeachRecordDomainService.add_angle_to_current_record","title":"add_angle_to_current_record","text":"<pre><code>add_angle_to_current_record(angles: List[float])\n</code></pre> <p>\u6dfb\u52a0\u89d2\u5ea6\u5230\u5f53\u524d\u8bb0\u5f55\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>angles</code> <code>List[float]</code> <p>6\u7ef4\u5173\u8282\u89d2\u5ea6\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def add_angle_to_current_record(self, angles: List[float]):\n    \"\"\"\u6dfb\u52a0\u89d2\u5ea6\u5230\u5f53\u524d\u8bb0\u5f55\u3002\n\n    Args:\n        angles (List[float]): 6\u7ef4\u5173\u8282\u89d2\u5ea6\u3002\n    \"\"\"\n    if self._is_recording and len(angles) == 6:\n        self._current_record_angles.append(angles.copy())\n        self._record_counter += 1\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TeachRecordDomainService.get_record_timer","title":"get_record_timer","text":"<pre><code>get_record_timer() -&gt; QTimer\n</code></pre> <p>\u83b7\u53d6\u8bb0\u5f55\u5b9a\u65f6\u5668\uff08\u7528\u4e8e\u5916\u90e8\u8fde\u63a5\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>QTimer</code> <code>QTimer</code> <p>\u8bb0\u5f55\u5b9a\u65f6\u5668\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def get_record_timer(self) -&gt; QTimer:\n    \"\"\"\u83b7\u53d6\u8bb0\u5f55\u5b9a\u65f6\u5668\uff08\u7528\u4e8e\u5916\u90e8\u8fde\u63a5\uff09\u3002\n\n    Returns:\n        QTimer: \u8bb0\u5f55\u5b9a\u65f6\u5668\u3002\n    \"\"\"\n    return self._record_timer\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TeachRecordDomainService.get_all_records","title":"get_all_records","text":"<pre><code>get_all_records() -&gt; Dict[str, List[List[float]]]\n</code></pre> <p>\u83b7\u53d6\u6240\u6709\u8bb0\u5f55\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Dict[str, List[List[float]]]</code> <p>Dict[str, List[List[float]]]: \u6240\u6709\u8bb0\u5f55\u5b57\u5178\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def get_all_records(self) -&gt; Dict[str, List[List[float]]]:\n    \"\"\"\u83b7\u53d6\u6240\u6709\u8bb0\u5f55\u3002\n\n    Returns:\n        Dict[str, List[List[float]]]: \u6240\u6709\u8bb0\u5f55\u5b57\u5178\u3002\n    \"\"\"\n    return self._records.copy()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TeachRecordDomainService.get_record_names","title":"get_record_names","text":"<pre><code>get_record_names() -&gt; List[str]\n</code></pre> <p>\u83b7\u53d6\u6240\u6709\u8bb0\u5f55\u540d\u79f0\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>List[str]: \u8bb0\u5f55\u540d\u79f0\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def get_record_names(self) -&gt; List[str]:\n    \"\"\"\u83b7\u53d6\u6240\u6709\u8bb0\u5f55\u540d\u79f0\u3002\n\n    Returns:\n        List[str]: \u8bb0\u5f55\u540d\u79f0\u5217\u8868\u3002\n    \"\"\"\n    return list(self._records.keys())\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TeachRecordDomainService.get_record","title":"get_record","text":"<pre><code>get_record(name: str) -&gt; Optional[List[List[float]]]\n</code></pre> <p>\u83b7\u53d6\u6307\u5b9a\u8bb0\u5f55\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>name</code> <code>str</code> <p>\u8bb0\u5f55\u540d\u79f0\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[List[List[float]]]</code> <p>Optional[List[List[float]]]: \u89d2\u5ea6\u5217\u8868\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def get_record(self, name: str) -&gt; Optional[List[List[float]]]:\n    \"\"\"\u83b7\u53d6\u6307\u5b9a\u8bb0\u5f55\u3002\n\n    Args:\n        name (str): \u8bb0\u5f55\u540d\u79f0\u3002\n\n    Returns:\n        Optional[List[List[float]]]: \u89d2\u5ea6\u5217\u8868\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u8fd4\u56de None\u3002\n    \"\"\"\n    return self._records.get(name)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TeachRecordDomainService.delete_record","title":"delete_record","text":"<pre><code>delete_record(name: str) -&gt; bool\n</code></pre> <p>\u5220\u9664\u6307\u5b9a\u8bb0\u5f55\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>name</code> <code>str</code> <p>\u8bb0\u5f55\u540d\u79f0\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u5220\u9664\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def delete_record(self, name: str) -&gt; bool:\n    \"\"\"\u5220\u9664\u6307\u5b9a\u8bb0\u5f55\u3002\n\n    Args:\n        name (str): \u8bb0\u5f55\u540d\u79f0\u3002\n\n    Returns:\n        bool: \u662f\u5426\u5220\u9664\u6210\u529f\u3002\n    \"\"\"\n    if name in self._records:\n        del self._records[name]\n        self.record_deleted.emit(name)\n        return True\n    return False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TeachRecordDomainService.reverse_record","title":"reverse_record","text":"<pre><code>reverse_record(name: str) -&gt; Optional[str]\n</code></pre> <p>\u53cd\u8f6c\u6307\u5b9a\u8bb0\u5f55\u5e76\u53e6\u5b58\u4e3a\u65b0\u8bb0\u5f55\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>name</code> <code>str</code> <p>\u539f\u8bb0\u5f55\u540d\u79f0\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[str]</code> <p>Optional[str]: \u65b0\u8bb0\u5f55\u540d\u79f0\uff0c\u5982\u679c\u5931\u8d25\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def reverse_record(self, name: str) -&gt; Optional[str]:\n    \"\"\"\u53cd\u8f6c\u6307\u5b9a\u8bb0\u5f55\u5e76\u53e6\u5b58\u4e3a\u65b0\u8bb0\u5f55\u3002\n\n    Args:\n        name (str): \u539f\u8bb0\u5f55\u540d\u79f0\u3002\n\n    Returns:\n        Optional[str]: \u65b0\u8bb0\u5f55\u540d\u79f0\uff0c\u5982\u679c\u5931\u8d25\u8fd4\u56de None\u3002\n    \"\"\"\n    if name not in self._records:\n        return None\n\n    try:\n        # \u53cd\u8f6c\u89d2\u5ea6\u5e8f\u5217\n        original_list = self._records[name]\n        reversed_list = list(reversed(original_list))\n\n        # \u751f\u6210\u65b0\u540d\u79f0\uff1a\u539f\u540d-\u53cd\u8f6c\uff08\u5982\u5df2\u5b58\u5728\u5219\u8ffd\u52a0\u5e8f\u53f7\uff09\n        base_name = f\"{name}-\u53cd\u8f6c\"\n        new_name = base_name\n        suffix = 2\n        while new_name in self._records:\n            new_name = f\"{base_name}-{suffix}\"\n            suffix += 1\n\n        # \u4fdd\u5b58\u65b0\u8bb0\u5f55\n        self._records[new_name] = reversed_list\n        self.record_added.emit(new_name)\n        return new_name\n    except Exception as e:\n        return None\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TeachRecordDomainService.load_records","title":"load_records","text":"<pre><code>load_records(records: Dict[str, List[List[float]]])\n</code></pre> <p>\u52a0\u8f7d\u8bb0\u5f55\u6570\u636e\uff08\u4eceRepository\uff09\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>records</code> <code>Dict[str, List[List[float]]]</code> <p>\u8bb0\u5f55\u6570\u636e\u5b57\u5178\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def load_records(self, records: Dict[str, List[List[float]]]):\n    \"\"\"\u52a0\u8f7d\u8bb0\u5f55\u6570\u636e\uff08\u4eceRepository\uff09\u3002\n\n    Args:\n        records (Dict[str, List[List[float]]]): \u8bb0\u5f55\u6570\u636e\u5b57\u5178\u3002\n    \"\"\"\n    self._records = records.copy()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TeachRecordDomainService.clear_all_records","title":"clear_all_records","text":"<pre><code>clear_all_records()\n</code></pre> <p>\u6e05\u7a7a\u6240\u6709\u8bb0\u5f55\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/state/teach_record_domain_service.py</code> <pre><code>def clear_all_records(self):\n    \"\"\"\u6e05\u7a7a\u6240\u6709\u8bb0\u5f55\u3002\"\"\"\n    self._records.clear()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningDomainService","title":"MotionPlanningDomainService","text":"<pre><code>MotionPlanningDomainService()\n</code></pre> <p>\u8fd0\u52a8\u89c4\u5212Domain\u670d\u52a1\u3002</p> <p>\u804c\u8d23\uff1a 1. \u7ba1\u7406\u591a\u4e2a\u65b9\u6848\uff08\u5185\u5b58\uff09 2. \u7ef4\u62a4\u5f53\u524d\u6fc0\u6d3b\u7684\u65b9\u6848 3. \u63d0\u4f9b\u65b9\u6848\u548c\u8282\u70b9\u7684\u589e\u5220\u6539\u67e5 4. \u5b9e\u65bd\u4e1a\u52a1\u89c4\u5219</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>_plans</code> <code>List[MotionPlan]</code> <p>\u65b9\u6848\u5217\u8868\u3002</p> <code>_current_index</code> <code>int</code> <p>\u5f53\u524d\u6fc0\u6d3b\u65b9\u6848\u7684\u7d22\u5f15\u3002</p> <p>\u521d\u59cb\u5316\u670d\u52a1\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def __init__(self):\n    \"\"\"\u521d\u59cb\u5316\u670d\u52a1\u3002\"\"\"\n    self._plans: List[MotionPlan] = []\n    self._current_index: int = -1\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningDomainService.initialize","title":"initialize","text":"<pre><code>initialize(plans: List[MotionPlan], current_index: int)\n</code></pre> <p>\u521d\u59cb\u5316\u6570\u636e\uff08\u4eceRepository\u52a0\u8f7d\u540e\u8c03\u7528\uff09\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>plans</code> <code>List[MotionPlan]</code> <p>\u65b9\u6848\u5217\u8868\u3002</p> \u5fc5\u9700 <code>current_index</code> <code>int</code> <p>\u5f53\u524d\u65b9\u6848\u7d22\u5f15\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def initialize(self, plans: List[MotionPlan], current_index: int):\n    \"\"\"\u521d\u59cb\u5316\u6570\u636e\uff08\u4eceRepository\u52a0\u8f7d\u540e\u8c03\u7528\uff09\u3002\n\n    Args:\n        plans (List[MotionPlan]): \u65b9\u6848\u5217\u8868\u3002\n        current_index (int): \u5f53\u524d\u65b9\u6848\u7d22\u5f15\u3002\n    \"\"\"\n    self._plans = plans\n    self._current_index = current_index if plans else -1\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningDomainService.get_all_plans","title":"get_all_plans","text":"<pre><code>get_all_plans() -&gt; List[MotionPlan]\n</code></pre> <p>\u83b7\u53d6\u6240\u6709\u65b9\u6848\uff08\u7528\u4e8e\u6301\u4e45\u5316\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[MotionPlan]</code> <p>List[MotionPlan]: \u65b9\u6848\u5217\u8868\u7684\u526f\u672c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def get_all_plans(self) -&gt; List[MotionPlan]:\n    \"\"\"\u83b7\u53d6\u6240\u6709\u65b9\u6848\uff08\u7528\u4e8e\u6301\u4e45\u5316\uff09\u3002\n\n    Returns:\n        List[MotionPlan]: \u65b9\u6848\u5217\u8868\u7684\u526f\u672c\u3002\n    \"\"\"\n    return self._plans.copy()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningDomainService.create_plan","title":"create_plan","text":"<pre><code>create_plan(name: str) -&gt; int\n</code></pre> <p>\u521b\u5efa\u65b9\u6848\uff0c\u8fd4\u56de\u7d22\u5f15\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>name</code> <code>str</code> <p>\u65b9\u6848\u540d\u79f0\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>int</code> <code>int</code> <p>\u65b0\u521b\u5efa\u65b9\u6848\u7684\u7d22\u5f15\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def create_plan(self, name: str) -&gt; int:\n    \"\"\"\u521b\u5efa\u65b9\u6848\uff0c\u8fd4\u56de\u7d22\u5f15\u3002\n\n    Args:\n        name (str): \u65b9\u6848\u540d\u79f0\u3002\n\n    Returns:\n        int: \u65b0\u521b\u5efa\u65b9\u6848\u7684\u7d22\u5f15\u3002\n    \"\"\"\n    plan = MotionPlan(name=name)\n    self._plans.append(plan)\n    self._current_index = len(self._plans) - 1\n    return self._current_index\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningDomainService.get_plan_names","title":"get_plan_names","text":"<pre><code>get_plan_names() -&gt; List[str]\n</code></pre> <p>\u83b7\u53d6\u6240\u6709\u65b9\u6848\u540d\u79f0\uff08\u7528\u4e8e\u4e0b\u62c9\u6846\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>List[str]: \u65b9\u6848\u540d\u79f0\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def get_plan_names(self) -&gt; List[str]:\n    \"\"\"\u83b7\u53d6\u6240\u6709\u65b9\u6848\u540d\u79f0\uff08\u7528\u4e8e\u4e0b\u62c9\u6846\uff09\u3002\n\n    Returns:\n        List[str]: \u65b9\u6848\u540d\u79f0\u5217\u8868\u3002\n    \"\"\"\n    return [plan.name for plan in self._plans]\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningDomainService.get_current_index","title":"get_current_index","text":"<pre><code>get_current_index() -&gt; int\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u65b9\u6848\u7d22\u5f15\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>int</code> <code>int</code> <p>\u5f53\u524d\u7d22\u5f15\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def get_current_index(self) -&gt; int:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u65b9\u6848\u7d22\u5f15\u3002\n\n    Returns:\n        int: \u5f53\u524d\u7d22\u5f15\u3002\n    \"\"\"\n    return self._current_index\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningDomainService.set_current_index","title":"set_current_index","text":"<pre><code>set_current_index(index: int) -&gt; bool\n</code></pre> <p>\u5207\u6362\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u76ee\u6807\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u5207\u6362\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def set_current_index(self, index: int) -&gt; bool:\n    \"\"\"\u5207\u6362\u65b9\u6848\u3002\n\n    Args:\n        index (int): \u76ee\u6807\u7d22\u5f15\u3002\n\n    Returns:\n        bool: \u662f\u5426\u5207\u6362\u6210\u529f\u3002\n    \"\"\"\n    if 0 &lt;= index &lt; len(self._plans):\n        self._current_index = index\n        return True\n    return False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningDomainService.delete_plan","title":"delete_plan","text":"<pre><code>delete_plan(index: int) -&gt; bool\n</code></pre> <p>\u5220\u9664\u65b9\u6848\u3002</p> <p>\u4e1a\u52a1\u89c4\u5219\uff1a\u81f3\u5c11\u4fdd\u7559\u4e00\u4e2a\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u65b9\u6848\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u5220\u9664\u6210\u529f, False=\u5220\u9664\u5931\u8d25\uff08\u8fdd\u53cd\u4e1a\u52a1\u89c4\u5219\u6216\u7d22\u5f15\u65e0\u6548\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def delete_plan(self, index: int) -&gt; bool:\n    \"\"\"\u5220\u9664\u65b9\u6848\u3002\n\n    \u4e1a\u52a1\u89c4\u5219\uff1a\u81f3\u5c11\u4fdd\u7559\u4e00\u4e2a\u65b9\u6848\u3002\n\n    Args:\n        index (int): \u65b9\u6848\u7d22\u5f15\u3002\n\n    Returns:\n        bool: True=\u5220\u9664\u6210\u529f, False=\u5220\u9664\u5931\u8d25\uff08\u8fdd\u53cd\u4e1a\u52a1\u89c4\u5219\u6216\u7d22\u5f15\u65e0\u6548\uff09\u3002\n    \"\"\"\n    # \u4e1a\u52a1\u89c4\u5219\uff1a\u81f3\u5c11\u4fdd\u7559\u4e00\u4e2a\u65b9\u6848\n    if len(self._plans) &lt;= 1:\n        return False\n\n    if 0 &lt;= index &lt; len(self._plans):\n        self._plans.pop(index)\n        # \u8c03\u6574\u5f53\u524d\u7d22\u5f15\n        if self._current_index &gt;= len(self._plans):\n            self._current_index = max(0, len(self._plans) - 1)\n        if len(self._plans) == 0:\n            self._current_index = -1\n        return True\n    return False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningDomainService.can_delete_plan","title":"can_delete_plan","text":"<pre><code>can_delete_plan() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u662f\u5426\u53ef\u4ee5\u5220\u9664\u65b9\u6848\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u53ef\u4ee5\u5220\u9664, False=\u4e0d\u80fd\u5220\u9664\uff08\u53ea\u6709\u4e00\u4e2a\u65b9\u6848\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def can_delete_plan(self) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u662f\u5426\u53ef\u4ee5\u5220\u9664\u65b9\u6848\u3002\n\n    Returns:\n        bool: True=\u53ef\u4ee5\u5220\u9664, False=\u4e0d\u80fd\u5220\u9664\uff08\u53ea\u6709\u4e00\u4e2a\u65b9\u6848\uff09\u3002\n    \"\"\"\n    return len(self._plans) &gt; 1\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningDomainService.rename_plan","title":"rename_plan","text":"<pre><code>rename_plan(index: int, new_name: str) -&gt; bool\n</code></pre> <p>\u91cd\u547d\u540d\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u65b9\u6848\u7d22\u5f15\u3002</p> \u5fc5\u9700 <code>new_name</code> <code>str</code> <p>\u65b0\u540d\u79f0\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def rename_plan(self, index: int, new_name: str) -&gt; bool:\n    \"\"\"\u91cd\u547d\u540d\u65b9\u6848\u3002\n\n    Args:\n        index (int): \u65b9\u6848\u7d22\u5f15\u3002\n        new_name (str): \u65b0\u540d\u79f0\u3002\n\n    Returns:\n        bool: \u662f\u5426\u6210\u529f\u3002\n    \"\"\"\n    if 0 &lt;= index &lt; len(self._plans):\n        self._plans[index].name = new_name\n        return True\n    return False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningDomainService.get_current_plan","title":"get_current_plan","text":"<pre><code>get_current_plan() -&gt; Optional[MotionPlan]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u65b9\u6848\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[MotionPlan]</code> <p>Optional[MotionPlan]: \u5f53\u524d\u65b9\u6848\u5bf9\u8c61\uff0c\u65e0\u65b9\u6848\u65f6\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def get_current_plan(self) -&gt; Optional[MotionPlan]:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u65b9\u6848\u3002\n\n    Returns:\n        Optional[MotionPlan]: \u5f53\u524d\u65b9\u6848\u5bf9\u8c61\uff0c\u65e0\u65b9\u6848\u65f6\u8fd4\u56de None\u3002\n    \"\"\"\n    if 0 &lt;= self._current_index &lt; len(self._plans):\n        return self._plans[self._current_index]\n    return None\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningDomainService.get_plan_count","title":"get_plan_count","text":"<pre><code>get_plan_count() -&gt; int\n</code></pre> <p>\u83b7\u53d6\u65b9\u6848\u6570\u91cf\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>int</code> <code>int</code> <p>\u65b9\u6848\u6570\u91cf\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def get_plan_count(self) -&gt; int:\n    \"\"\"\u83b7\u53d6\u65b9\u6848\u6570\u91cf\u3002\n\n    Returns:\n        int: \u65b9\u6848\u6570\u91cf\u3002\n    \"\"\"\n    return len(self._plans)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningDomainService.add_point","title":"add_point","text":"<pre><code>add_point(point_data: dict)\n</code></pre> <p>\u6dfb\u52a0\u8282\u70b9\u5230\u5f53\u524d\u65b9\u6848\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>point_data</code> <code>dict</code> <p>\u8282\u70b9\u6570\u636e\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def add_point(self, point_data: dict):\n    \"\"\"\u6dfb\u52a0\u8282\u70b9\u5230\u5f53\u524d\u65b9\u6848\u3002\n\n    Args:\n        point_data (dict): \u8282\u70b9\u6570\u636e\u3002\n    \"\"\"\n    plan = self.get_current_plan()\n    if plan:\n        plan.add_point(point_data)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningDomainService.remove_point","title":"remove_point","text":"<pre><code>remove_point(index: int)\n</code></pre> <p>\u5220\u9664\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def remove_point(self, index: int):\n    \"\"\"\u5220\u9664\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n    \"\"\"\n    plan = self.get_current_plan()\n    if plan:\n        plan.remove_point(index)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningDomainService.move_point_up","title":"move_point_up","text":"<pre><code>move_point_up(index: int) -&gt; bool\n</code></pre> <p>\u4e0a\u79fb\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def move_point_up(self, index: int) -&gt; bool:\n    \"\"\"\u4e0a\u79fb\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n\n    Returns:\n        bool: \u662f\u5426\u6210\u529f\u3002\n    \"\"\"\n    plan = self.get_current_plan()\n    return plan.move_point_up(index) if plan else False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningDomainService.move_point_down","title":"move_point_down","text":"<pre><code>move_point_down(index: int) -&gt; bool\n</code></pre> <p>\u4e0b\u79fb\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def move_point_down(self, index: int) -&gt; bool:\n    \"\"\"\u4e0b\u79fb\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n\n    Returns:\n        bool: \u662f\u5426\u6210\u529f\u3002\n    \"\"\"\n    plan = self.get_current_plan()\n    return plan.move_point_down(index) if plan else False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningDomainService.update_point","title":"update_point","text":"<pre><code>update_point(index: int, point_data: dict)\n</code></pre> <p>\u66f4\u65b0\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <code>point_data</code> <code>dict</code> <p>\u65b0\u6570\u636e\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def update_point(self, index: int, point_data: dict):\n    \"\"\"\u66f4\u65b0\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n        point_data (dict): \u65b0\u6570\u636e\u3002\n    \"\"\"\n    plan = self.get_current_plan()\n    if plan:\n        plan.update_point(index, point_data)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanningDomainService.get_all_points","title":"get_all_points","text":"<pre><code>get_all_points() -&gt; List[dict]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u65b9\u6848\u7684\u6240\u6709\u8282\u70b9\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[dict]</code> <p>List[dict]: \u8282\u70b9\u5217\u8868\u7684\u526f\u672c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/planning/motion_planning_domain_service.py</code> <pre><code>def get_all_points(self) -&gt; List[dict]:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u65b9\u6848\u7684\u6240\u6709\u8282\u70b9\u3002\n\n    Returns:\n        List[dict]: \u8282\u70b9\u5217\u8868\u7684\u526f\u672c\u3002\n    \"\"\"\n    plan = self.get_current_plan()\n    return plan.points.copy() if plan else []\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraDomainService","title":"CameraDomainService","text":"<pre><code>CameraDomainService()\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u6444\u50cf\u5934\u9886\u57df\u670d\u52a1\u3002</p> <p>\u804c\u8d23\uff1a - \u7ba1\u7406 ROS2 \u6444\u50cf\u5934\u8ba2\u9605\u8282\u70b9\u7684\u751f\u547d\u5468\u671f - \u7ef4\u62a4\u6700\u65b0\u7684\u5f69\u8272/\u6df1\u5ea6\u56fe\u50cf\u6570\u636e\uff08\u7ebf\u7a0b\u5b89\u5168\uff09 - \u53d1\u5c04\u56fe\u50cf\u63a5\u6536\u4fe1\u53f7 - \u6df1\u5ea6\u56fe\u53ef\u89c6\u5316\u5904\u7406</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>color_image_received</code> <code>pyqtSignal</code> <p>\u5f69\u8272\u56fe\u50cf\u63a5\u6536\u4fe1\u53f7\uff0c\u643a\u5e26\u56fe\u50cf\u6570\u636e (np.ndarray)\u3002</p> <code>depth_image_received</code> <code>pyqtSignal</code> <p>\u6df1\u5ea6\u56fe\u50cf\u63a5\u6536\u4fe1\u53f7\uff0c\u643a\u5e26\u56fe\u50cf\u6570\u636e (np.ndarray)\u3002</p> <code>connection_status_changed</code> <code>pyqtSignal</code> <p>\u8fde\u63a5\u72b6\u6001\u53d8\u66f4\u4fe1\u53f7\uff0c\u643a\u5e26 (connected, message)\u3002</p> <code>error_occurred</code> <code>pyqtSignal</code> <p>\u9519\u8bef\u4fe1\u53f7\uff0c\u643a\u5e26\u9519\u8bef\u4fe1\u606f\u3002</p> <p>\u521d\u59cb\u5316\u6444\u50cf\u5934\u9886\u57df\u670d\u52a1\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code> <pre><code>def __init__(self):\n    \"\"\"\u521d\u59cb\u5316\u6444\u50cf\u5934\u9886\u57df\u670d\u52a1\u3002\"\"\"\n    super().__init__()\n\n    # ROS\u8282\u70b9\u548c\u6267\u884c\u5668\n    self.color_subscriber = None\n    self.depth_subscriber = None\n    self.ros_executor = None\n    self.ros_thread = None\n\n    # cv_bridge\n    self.bridge = CvBridge()\n\n    # \u56fe\u50cf\u6570\u636e\u5b58\u50a8\uff08\u7ebf\u7a0b\u5b89\u5168\uff09\n    self.latest_color_image = None\n    self.latest_depth_image = None\n    self.color_image_lock = threading.Lock()\n    self.depth_image_lock = threading.Lock()\n\n    # \u8fde\u63a5\u72b6\u6001\n    self.is_connected = False\n    self.color_connected = False  # \u5f69\u8272\u6d41\u662f\u5426\u6709\u6570\u636e\n    self.depth_connected = False  # \u6df1\u5ea6\u6d41\u662f\u5426\u6709\u6570\u636e\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraDomainService.connect","title":"connect","text":"<pre><code>connect() -&gt; bool\n</code></pre> <p>\u8fde\u63a5\u6444\u50cf\u5934\uff08\u542f\u52a8 ROS \u8ba2\u9605\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u8fde\u63a5\u6210\u529f\u8fd4\u56de True\uff0c\u5931\u8d25\u8fd4\u56de False\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code> <pre><code>def connect(self) -&gt; bool:\n    \"\"\"\u8fde\u63a5\u6444\u50cf\u5934\uff08\u542f\u52a8 ROS \u8ba2\u9605\uff09\u3002\n\n    Returns:\n        bool: \u8fde\u63a5\u6210\u529f\u8fd4\u56de True\uff0c\u5931\u8d25\u8fd4\u56de False\u3002\n    \"\"\"\n    try:\n        if self.is_connected:\n            return True\n\n        # \u68c0\u67e5\u5e76\u521d\u59cb\u5316ROS\uff08\u7075\u6d3b\u7b56\u7565\uff0c\u53c2\u8003\u65e7\u7248\uff09\n        if not rclpy.ok():\n            try:\n                rclpy.init()\n            except RuntimeError as e:\n                # ROS\u5df2\u7ecf\u521d\u59cb\u5316\u4f46\u72b6\u6001\u5f02\u5e38\n                self.error_occurred.emit(f\"ROS\u72b6\u6001\u5f02\u5e38: {str(e)}\")\n                return False\n\n        # \u521b\u5efa\u8ba2\u9605\u8282\u70b9\n        self.color_subscriber = ColorImageSubscriber(self._on_color_image_received)\n        self.depth_subscriber = DepthImageSubscriber(self._on_depth_image_received)\n\n        # \u521b\u5efaexecutor\n        self.ros_executor = MultiThreadedExecutor()\n        self.ros_executor.add_node(self.color_subscriber)\n        self.ros_executor.add_node(self.depth_subscriber)\n\n        # \u5728\u72ec\u7acb\u7ebf\u7a0b\u8fd0\u884cexecutor\n        self.ros_thread = threading.Thread(target=self._ros_spin_worker, daemon=True)\n        self.ros_thread.start()\n\n        self.is_connected = True\n        self.connection_status_changed.emit(True, \"\u6444\u50cf\u5934\u8fde\u63a5\u6210\u529f\")\n        return True\n\n    except Exception as e:\n        self.error_occurred.emit(f\"\u8fde\u63a5\u6444\u50cf\u5934\u5931\u8d25: {str(e)}\")\n        return False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraDomainService.disconnect","title":"disconnect","text":"<pre><code>disconnect() -&gt; bool\n</code></pre> <p>\u65ad\u5f00\u6444\u50cf\u5934\uff08\u5173\u95ed ROS \u8ba2\u9605\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u65ad\u5f00\u6210\u529f\u8fd4\u56de True\uff0c\u5931\u8d25\u8fd4\u56de False\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code> <pre><code>def disconnect(self) -&gt; bool:\n    \"\"\"\u65ad\u5f00\u6444\u50cf\u5934\uff08\u5173\u95ed ROS \u8ba2\u9605\uff09\u3002\n\n    Returns:\n        bool: \u65ad\u5f00\u6210\u529f\u8fd4\u56de True\uff0c\u5931\u8d25\u8fd4\u56de False\u3002\n    \"\"\"\n    try:\n        if not self.is_connected:\n            return True\n\n        self.is_connected = False\n        self.color_connected = False\n        self.depth_connected = False\n\n        # \u505c\u6b62executor\uff08\u53ea\u5f71\u54cd\u6444\u50cf\u5934\u8282\u70b9\uff09\n        if self.ros_executor:\n            self.ros_executor.shutdown()\n\n        # \u9500\u6bc1\u8282\u70b9\n        if self.color_subscriber:\n            self.color_subscriber.destroy_node()\n            self.color_subscriber = None\n        if self.depth_subscriber:\n            self.depth_subscriber.destroy_node()\n            self.depth_subscriber = None\n\n        # \u7b49\u5f85\u7ebf\u7a0b\u7ed3\u675f\n        if self.ros_thread and self.ros_thread.is_alive():\n            self.ros_thread.join(timeout=1.0)\n\n        self.ros_executor = None\n        self.ros_thread = None\n\n        # \u6e05\u7a7a\u56fe\u50cf\u6570\u636e\n        with self.color_image_lock:\n            self.latest_color_image = None\n        with self.depth_image_lock:\n            self.latest_depth_image = None\n\n        self.connection_status_changed.emit(False, \"\u6444\u50cf\u5934\u5df2\u65ad\u5f00\")\n        return True\n\n    except Exception as e:\n        self.error_occurred.emit(f\"\u65ad\u5f00\u6444\u50cf\u5934\u5931\u8d25: {str(e)}\")\n        return False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraDomainService.get_latest_color_image","title":"get_latest_color_image","text":"<pre><code>get_latest_color_image() -&gt; Optional[np.ndarray]\n</code></pre> <p>\u83b7\u53d6\u6700\u65b0\u5f69\u8272\u56fe\u50cf\uff08\u7ebf\u7a0b\u5b89\u5168\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[ndarray]</code> <p>Optional[np.ndarray]: \u56fe\u50cf\u6570\u636e\uff0c\u65e0\u6570\u636e\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code> <pre><code>def get_latest_color_image(self) -&gt; Optional[np.ndarray]:\n    \"\"\"\u83b7\u53d6\u6700\u65b0\u5f69\u8272\u56fe\u50cf\uff08\u7ebf\u7a0b\u5b89\u5168\uff09\u3002\n\n    Returns:\n        Optional[np.ndarray]: \u56fe\u50cf\u6570\u636e\uff0c\u65e0\u6570\u636e\u8fd4\u56de None\u3002\n    \"\"\"\n    with self.color_image_lock:\n        return self.latest_color_image.copy() if self.latest_color_image is not None else None\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraDomainService.get_latest_depth_image","title":"get_latest_depth_image","text":"<pre><code>get_latest_depth_image() -&gt; Optional[np.ndarray]\n</code></pre> <p>\u83b7\u53d6\u6700\u65b0\u6df1\u5ea6\u56fe\u50cf\uff08\u7ebf\u7a0b\u5b89\u5168\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[ndarray]</code> <p>Optional[np.ndarray]: \u56fe\u50cf\u6570\u636e\uff0c\u65e0\u6570\u636e\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code> <pre><code>def get_latest_depth_image(self) -&gt; Optional[np.ndarray]:\n    \"\"\"\u83b7\u53d6\u6700\u65b0\u6df1\u5ea6\u56fe\u50cf\uff08\u7ebf\u7a0b\u5b89\u5168\uff09\u3002\n\n    Returns:\n        Optional[np.ndarray]: \u56fe\u50cf\u6570\u636e\uff0c\u65e0\u6570\u636e\u8fd4\u56de None\u3002\n    \"\"\"\n    with self.depth_image_lock:\n        return self.latest_depth_image.copy() if self.latest_depth_image is not None else None\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraDomainService.is_color_available","title":"is_color_available","text":"<pre><code>is_color_available() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u5f69\u8272\u56fe\u50cf\u662f\u5426\u53ef\u7528\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u53ef\u7528\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code> <pre><code>def is_color_available(self) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u5f69\u8272\u56fe\u50cf\u662f\u5426\u53ef\u7528\u3002\n\n    Returns:\n        bool: \u662f\u5426\u53ef\u7528\u3002\n    \"\"\"\n    return self.color_connected and self.latest_color_image is not None\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraDomainService.is_depth_available","title":"is_depth_available","text":"<pre><code>is_depth_available() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u6df1\u5ea6\u56fe\u50cf\u662f\u5426\u53ef\u7528\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u53ef\u7528\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code> <pre><code>def is_depth_available(self) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u6df1\u5ea6\u56fe\u50cf\u662f\u5426\u53ef\u7528\u3002\n\n    Returns:\n        bool: \u662f\u5426\u53ef\u7528\u3002\n    \"\"\"\n    return self.depth_connected and self.latest_depth_image is not None\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.CameraDomainService.visualize_depth_image","title":"visualize_depth_image","text":"<pre><code>visualize_depth_image(depth_image: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u6df1\u5ea6\u56fe\u53ef\u89c6\u5316\u4e3a\u4f2a\u5f69\u8272\u56fe\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>depth_image</code> <code>ndarray</code> <p>\u539f\u59cb\u6df1\u5ea6\u56fe\uff0816\u4f4d\u621632\u4f4d\u6d6e\u70b9\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u4f2a\u5f69\u8272\u6df1\u5ea6\u56fe\uff08BGR, uint8\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/camera_domain_service.py</code> <pre><code>def visualize_depth_image(self, depth_image: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u6df1\u5ea6\u56fe\u53ef\u89c6\u5316\u4e3a\u4f2a\u5f69\u8272\u56fe\u3002\n\n    Args:\n        depth_image (np.ndarray): \u539f\u59cb\u6df1\u5ea6\u56fe\uff0816\u4f4d\u621632\u4f4d\u6d6e\u70b9\uff09\u3002\n\n    Returns:\n        np.ndarray: \u4f2a\u5f69\u8272\u6df1\u5ea6\u56fe\uff08BGR, uint8\uff09\u3002\n    \"\"\"\n    try:\n        # \u8fc7\u6ee4\u65e0\u6548\u503c\uff08depth &lt;= 0 \u6216 nan\uff09\n        valid_mask = (depth_image &gt; 0) &amp; np.isfinite(depth_image)\n\n        if not np.any(valid_mask):\n            # \u5982\u679c\u6ca1\u6709\u6709\u6548\u6570\u636e\uff0c\u8fd4\u56de\u9ed1\u8272\u56fe\u50cf\n            depth_display = np.zeros_like(depth_image, dtype=np.uint8)\n        else:\n            # \u5f52\u4e00\u5316\u5230 0-255\n            min_val = np.min(depth_image[valid_mask])\n            max_val = np.max(depth_image[valid_mask])\n\n            if max_val - min_val &lt; 1e-6:\n                depth_display = np.zeros_like(depth_image, dtype=np.uint8)\n            else:\n                norm = (depth_image - min_val) / (max_val - min_val)\n                norm[~valid_mask] = 0\n                depth_display = (norm * 255).astype(np.uint8)\n\n        # \u5e94\u7528\u4f2a\u5f69\u8272\u6620\u5c04\n        depth_colormap = cv2.applyColorMap(depth_display, cv2.COLORMAP_JET)\n        return depth_colormap\n\n    except Exception as e:\n        # \u5982\u679c\u53ef\u89c6\u5316\u5931\u8d25\uff0c\u8fd4\u56de\u9ed1\u8272\u56fe\u50cf\n        height, width = depth_image.shape[:2]\n        return np.zeros((height, width, 3), dtype=np.uint8)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RecognitionDomainService","title":"RecognitionDomainService","text":"<pre><code>RecognitionDomainService()\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u96f6\u4ef6\u8bc6\u522b\u9886\u57df\u670d\u52a1\u3002</p> <p>\u804c\u8d23\uff1a - \u8ba2\u9605 recognition_result ROS \u8bdd\u9898 - \u7ef4\u62a4\u6700\u65b0\u68c0\u6d4b\u7ed3\u679c\uff08\u7ebf\u7a0b\u5b89\u5168\uff09 - \u72ec\u7acb\u4e8e\u6444\u50cf\u5934\u670d\u52a1\u8fd0\u884c - \u53d1\u5c04\u68c0\u6d4b\u7ed3\u679c\u4fe1\u53f7</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>detection_result_received</code> <code>pyqtSignal</code> <p>\u68c0\u6d4b\u7ed3\u679c\u63a5\u6536\u4fe1\u53f7\uff0c\u643a\u5e26\u7ed3\u679c\u5b57\u5178\u3002</p> <code>detection_status_changed</code> <code>pyqtSignal</code> <p>\u68c0\u6d4b\u72b6\u6001\u53d8\u66f4\u4fe1\u53f7\uff0c\u643a\u5e26 (is_running, message)\u3002</p> <code>error_occurred</code> <code>pyqtSignal</code> <p>\u9519\u8bef\u4fe1\u53f7\uff0c\u643a\u5e26\u9519\u8bef\u4fe1\u606f\u3002</p> <p>\u521d\u59cb\u5316\u96f6\u4ef6\u8bc6\u522b\u9886\u57df\u670d\u52a1\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/recognition_domain_service.py</code> <pre><code>def __init__(self):\n    \"\"\"\u521d\u59cb\u5316\u96f6\u4ef6\u8bc6\u522b\u9886\u57df\u670d\u52a1\u3002\"\"\"\n    super().__init__()\n\n    # ROS\u8282\u70b9\u548c\u6267\u884c\u5668\n    self.detection_subscriber = None\n    self.ros_executor = None\n    self.ros_thread = None\n\n    # \u68c0\u6d4b\u7ed3\u679c\u5b58\u50a8\uff08\u7ebf\u7a0b\u5b89\u5168\uff09\n    self.latest_detection_result = {}\n    self.detection_lock = threading.Lock()\n\n    # \u8fd0\u884c\u72b6\u6001\n    self.is_running = False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RecognitionDomainService.start_detection","title":"start_detection","text":"<pre><code>start_detection() -&gt; bool\n</code></pre> <p>\u5f00\u59cb\u68c0\u6d4b\uff08\u542f\u52a8 ROS \u8ba2\u9605\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u542f\u52a8\u6210\u529f\u8fd4\u56de True\uff0c\u5931\u8d25\u8fd4\u56de False\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/recognition_domain_service.py</code> <pre><code>def start_detection(self) -&gt; bool:\n    \"\"\"\u5f00\u59cb\u68c0\u6d4b\uff08\u542f\u52a8 ROS \u8ba2\u9605\uff09\u3002\n\n    Returns:\n        bool: \u542f\u52a8\u6210\u529f\u8fd4\u56de True\uff0c\u5931\u8d25\u8fd4\u56de False\u3002\n    \"\"\"\n    try:\n        if self.is_running:\n            return True\n\n        # \u68c0\u67e5\u5e76\u521d\u59cb\u5316ROS\uff08\u7075\u6d3b\u7b56\u7565\uff0c\u53c2\u8003\u65e7\u7248\uff09\n        if not rclpy.ok():\n            try:\n                rclpy.init()\n            except RuntimeError as e:\n                # ROS\u5df2\u7ecf\u521d\u59cb\u5316\u4f46\u72b6\u6001\u5f02\u5e38\n                self.error_occurred.emit(f\"ROS\u72b6\u6001\u5f02\u5e38: {str(e)}\")\n                return False\n            except Exception as e:\n                self.error_occurred.emit(f\"ROS\u521d\u59cb\u5316\u5931\u8d25: {str(e)}\")\n                return False\n\n        # \u521b\u5efa\u8ba2\u9605\u8282\u70b9\n        self.detection_subscriber = DetectionSubscriberNode(self._on_detection_received)\n\n        # \u521b\u5efaexecutor\n        self.ros_executor = SingleThreadedExecutor()\n        self.ros_executor.add_node(self.detection_subscriber)\n\n        # \u5728\u72ec\u7acb\u7ebf\u7a0b\u8fd0\u884cexecutor\n        self.ros_thread = threading.Thread(target=self._ros_spin_worker, daemon=True)\n        self.ros_thread.start()\n\n        self.is_running = True\n        self.detection_status_changed.emit(True, \"\u5f00\u59cb\u96f6\u4ef6\u8bc6\u522b\")\n        return True\n\n    except Exception as e:\n        self.error_occurred.emit(f\"\u542f\u52a8\u68c0\u6d4b\u5931\u8d25: {str(e)}\")\n        return False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RecognitionDomainService.stop_detection","title":"stop_detection","text":"<pre><code>stop_detection() -&gt; bool\n</code></pre> <p>\u505c\u6b62\u68c0\u6d4b\uff08\u5173\u95ed ROS \u8ba2\u9605\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u505c\u6b62\u6210\u529f\u8fd4\u56de True\uff0c\u5931\u8d25\u8fd4\u56de False\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/recognition_domain_service.py</code> <pre><code>def stop_detection(self) -&gt; bool:\n    \"\"\"\u505c\u6b62\u68c0\u6d4b\uff08\u5173\u95ed ROS \u8ba2\u9605\uff09\u3002\n\n    Returns:\n        bool: \u505c\u6b62\u6210\u529f\u8fd4\u56de True\uff0c\u5931\u8d25\u8fd4\u56de False\u3002\n    \"\"\"\n    try:\n        if not self.is_running:\n            return True\n\n        self.is_running = False\n\n        # \u505c\u6b62executor\uff08\u53ea\u5f71\u54cd\u68c0\u6d4b\u8282\u70b9\uff09\n        if self.ros_executor:\n            self.ros_executor.shutdown()\n\n        # \u9500\u6bc1\u8282\u70b9\n        if self.detection_subscriber:\n            self.detection_subscriber.destroy_node()\n            self.detection_subscriber = None\n\n        # \u7b49\u5f85\u7ebf\u7a0b\u7ed3\u675f\n        if self.ros_thread and self.ros_thread.is_alive():\n            self.ros_thread.join(timeout=1.0)\n\n        self.ros_executor = None\n        self.ros_thread = None\n\n        # \u6e05\u7a7a\u68c0\u6d4b\u7ed3\u679c\n        with self.detection_lock:\n            self.latest_detection_result = {}\n\n        self.detection_status_changed.emit(False, \"\u505c\u6b62\u96f6\u4ef6\u8bc6\u522b\")\n        return True\n\n    except Exception as e:\n        self.error_occurred.emit(f\"\u505c\u6b62\u68c0\u6d4b\u5931\u8d25: {str(e)}\")\n        return False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RecognitionDomainService.get_latest_result","title":"get_latest_result","text":"<pre><code>get_latest_result() -&gt; Optional[Dict]\n</code></pre> <p>\u83b7\u53d6\u6700\u65b0\u68c0\u6d4b\u7ed3\u679c\uff08\u7ebf\u7a0b\u5b89\u5168\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[Dict]</code> <p>Optional[Dict]: \u68c0\u6d4b\u7ed3\u679c\u5b57\u5178\uff0c\u65e0\u7ed3\u679c\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/recognition_domain_service.py</code> <pre><code>def get_latest_result(self) -&gt; Optional[Dict]:\n    \"\"\"\u83b7\u53d6\u6700\u65b0\u68c0\u6d4b\u7ed3\u679c\uff08\u7ebf\u7a0b\u5b89\u5168\uff09\u3002\n\n    Returns:\n        Optional[Dict]: \u68c0\u6d4b\u7ed3\u679c\u5b57\u5178\uff0c\u65e0\u7ed3\u679c\u8fd4\u56de None\u3002\n    \"\"\"\n    with self.detection_lock:\n        if self.latest_detection_result:\n            return copy.deepcopy(self.latest_detection_result)\n        return None\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RecognitionDomainService.is_detection_running","title":"is_detection_running","text":"<pre><code>is_detection_running() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u68c0\u6d4b\u662f\u5426\u6b63\u5728\u8fd0\u884c\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u6b63\u5728\u8fd0\u884c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/recognition_domain_service.py</code> <pre><code>def is_detection_running(self) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u68c0\u6d4b\u662f\u5426\u6b63\u5728\u8fd0\u884c\u3002\n\n    Returns:\n        bool: \u662f\u5426\u6b63\u5728\u8fd0\u884c\u3002\n    \"\"\"\n    return self.is_running\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RecognitionDomainService.clear_result","title":"clear_result","text":"<pre><code>clear_result()\n</code></pre> <p>\u6e05\u9664\u68c0\u6d4b\u7ed3\u679c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/vision/recognition_domain_service.py</code> <pre><code>def clear_result(self):\n    \"\"\"\u6e05\u9664\u68c0\u6d4b\u7ed3\u679c\u3002\"\"\"\n    with self.detection_lock:\n        self.latest_detection_result = {}\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.HandEyeTransformDomainService","title":"HandEyeTransformDomainService","text":"<pre><code>HandEyeTransformDomainService(config: HandEyeCalibrationConfig, kinematic_service: KinematicDomainService)\n</code></pre> <p>\u624b\u773c\u6807\u5b9a\u53d8\u6362\u670d\u52a1\u3002</p> <p>\u804c\u8d23\uff1a 1. \u50cf\u7d20\u5750\u6807 \u2192 \u76f8\u673a\u5750\u6807\u7cfb 2. \u76f8\u673a\u5750\u6807\u7cfb \u2192 \u57fa\u5750\u6807\u7cfb 3. \u8ba1\u7b97\u76ee\u6807\u4f4d\u59ff\uff08\u5305\u542b\u504f\u79fb\u548c\u59ff\u6001\u8c03\u6574\uff09 4. \u63d0\u4f9b\u9006\u8fd0\u52a8\u5b66\u6c42\u89e3</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>config</code> <code>HandEyeCalibrationConfig</code> <p>\u624b\u773c\u6807\u5b9a\u914d\u7f6e\u3002</p> <code>kinematic_service</code> <code>KinematicDomainService</code> <p>\u8fd0\u52a8\u5b66\u670d\u52a1\u5b9e\u4f8b\u3002</p> <p>\u521d\u59cb\u5316\u624b\u773c\u6807\u5b9a\u53d8\u6362\u670d\u52a1\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config</code> <code>HandEyeCalibrationConfig</code> <p>\u624b\u773c\u6807\u5b9a\u914d\u7f6e\uff08\u901a\u8fc7DI\u6ce8\u5165\uff09\u3002</p> \u5fc5\u9700 <code>kinematic_service</code> <code>KinematicDomainService</code> <p>\u8fd0\u52a8\u5b66\u670d\u52a1\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/hand_eye_transform_domain_service.py</code> <pre><code>def __init__(\n    self,\n    config: HandEyeCalibrationConfig,\n    kinematic_service: KinematicDomainService\n):\n    \"\"\"\u521d\u59cb\u5316\u624b\u773c\u6807\u5b9a\u53d8\u6362\u670d\u52a1\u3002\n\n    Args:\n        config: \u624b\u773c\u6807\u5b9a\u914d\u7f6e\uff08\u901a\u8fc7DI\u6ce8\u5165\uff09\u3002\n        kinematic_service: \u8fd0\u52a8\u5b66\u670d\u52a1\u3002\n    \"\"\"\n    self.config = config\n    self.kinematic_service = kinematic_service\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.HandEyeTransformDomainService.calculate_target_joint_angles","title":"calculate_target_joint_angles","text":"<pre><code>calculate_target_joint_angles(central_center: List[float], depth: float, real_center: List[float], real_depth: float, angle: float, current_joint_angles: List[float]) -&gt; Optional[List[float]]\n</code></pre> <p>\u8ba1\u7b97\u8fd0\u52a8\u5230\u96f6\u4ef6\u4f4d\u7f6e\u6240\u9700\u7684\u76ee\u6807\u5173\u8282\u89d2\u5ea6\u3002</p> <p>\u5b8c\u6574\u6d41\u7a0b\uff1a 1. \u50cf\u7d20\u5750\u6807 \u2192 \u76f8\u673a\u5750\u6807\u7cfb 2. \u6b63\u8fd0\u52a8\u5b66\uff1a\u5f53\u524d\u5173\u8282\u89d2\u5ea6 \u2192 \u672b\u7aef\u4f4d\u59ff 3. \u76f8\u673a\u5750\u6807\u7cfb \u2192 \u57fa\u5750\u6807\u7cfb 4. \u8ba1\u7b97\u96f6\u4ef6\u65b9\u5411 + \u504f\u79fb\u91cf 5. \u9006\u8fd0\u52a8\u5b66\uff1a\u76ee\u6807\u4f4d\u59ff \u2192 \u76ee\u6807\u5173\u8282\u89d2\u5ea6</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>central_center</code> <code>List[float]</code> <p>\u4e2d\u5fc3\u70b9\u50cf\u7d20\u5750\u6807 [u, v]\u3002</p> \u5fc5\u9700 <code>depth</code> <code>float</code> <p>\u4e2d\u5fc3\u70b9\u6df1\u5ea6 (mm)\u3002</p> \u5fc5\u9700 <code>real_center</code> <code>List[float]</code> <p>\u5b9e\u9645\u4e2d\u5fc3\u70b9\u50cf\u7d20\u5750\u6807 [u, v]\u3002</p> \u5fc5\u9700 <code>real_depth</code> <code>float</code> <p>\u5b9e\u9645\u4e2d\u5fc3\u70b9\u6df1\u5ea6 (mm)\u3002</p> \u5fc5\u9700 <code>angle</code> <code>float</code> <p>\u96f6\u4ef6\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002</p> \u5fc5\u9700 <code>current_joint_angles</code> <code>List[float]</code> <p>\u5f53\u524d\u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[List[float]]</code> <p>Optional[List[float]]: \u76ee\u6807\u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\uff0c\u5982\u679c\u65e0\u89e3\u5219\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/hand_eye_transform_domain_service.py</code> <pre><code>def calculate_target_joint_angles(\n    self,\n    central_center: List[float],      # [u, v] \u50cf\u7d20\u5750\u6807\n    depth: float,                     # \u6df1\u5ea6 (mm)\n    real_center: List[float],         # \u5b9e\u9645\u4e2d\u5fc3\u70b9 [u, v]\n    real_depth: float,                # \u5b9e\u9645\u6df1\u5ea6 (mm)\n    angle: float,                     # \u96f6\u4ef6\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\n    current_joint_angles: List[float] # \u5f53\u524d\u5173\u8282\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\n) -&gt; Optional[List[float]]:\n    \"\"\"\u8ba1\u7b97\u8fd0\u52a8\u5230\u96f6\u4ef6\u4f4d\u7f6e\u6240\u9700\u7684\u76ee\u6807\u5173\u8282\u89d2\u5ea6\u3002\n\n    \u5b8c\u6574\u6d41\u7a0b\uff1a\n    1. \u50cf\u7d20\u5750\u6807 \u2192 \u76f8\u673a\u5750\u6807\u7cfb\n    2. \u6b63\u8fd0\u52a8\u5b66\uff1a\u5f53\u524d\u5173\u8282\u89d2\u5ea6 \u2192 \u672b\u7aef\u4f4d\u59ff\n    3. \u76f8\u673a\u5750\u6807\u7cfb \u2192 \u57fa\u5750\u6807\u7cfb\n    4. \u8ba1\u7b97\u96f6\u4ef6\u65b9\u5411 + \u504f\u79fb\u91cf\n    5. \u9006\u8fd0\u52a8\u5b66\uff1a\u76ee\u6807\u4f4d\u59ff \u2192 \u76ee\u6807\u5173\u8282\u89d2\u5ea6\n\n    Args:\n        central_center (List[float]): \u4e2d\u5fc3\u70b9\u50cf\u7d20\u5750\u6807 [u, v]\u3002\n        depth (float): \u4e2d\u5fc3\u70b9\u6df1\u5ea6 (mm)\u3002\n        real_center (List[float]): \u5b9e\u9645\u4e2d\u5fc3\u70b9\u50cf\u7d20\u5750\u6807 [u, v]\u3002\n        real_depth (float): \u5b9e\u9645\u4e2d\u5fc3\u70b9\u6df1\u5ea6 (mm)\u3002\n        angle (float): \u96f6\u4ef6\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002\n        current_joint_angles (List[float]): \u5f53\u524d\u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\u3002\n\n    Returns:\n        Optional[List[float]]: \u76ee\u6807\u5173\u8282\u89d2\u5ea6\u5217\u8868\uff08\u5f27\u5ea6\uff09\uff0c\u5982\u679c\u65e0\u89e3\u5219\u8fd4\u56de None\u3002\n    \"\"\"\n    # \u83b7\u53d6\u914d\u7f6e\u53c2\u6570\n    intrinsics = self.config.camera_intrinsics\n\n    # 1. \u50cf\u7d20\u5750\u6807 \u2192 \u76f8\u673a\u5750\u6807\u7cfb\uff08\u9f50\u6b21\u5750\u6807\uff09\n    px1, py1, pz1 = central_center[0], central_center[1], depth\n    px2, py2, pz2 = real_center[0], real_center[1], real_depth\n\n    # \u6df1\u5ea6\u5355\u4f4d\u8f6c\u6362\uff1amm \u2192 m\n    pz1 *= 0.001\n    pz2 *= 0.001\n\n    # \u4f7f\u7528\u9488\u5b54\u76f8\u673a\u6a21\u578b\n    px1 = (px1 - intrinsics.cx) * pz1 / intrinsics.fx\n    py1 = (py1 - intrinsics.cy) * pz1 / intrinsics.fy\n    px2 = (px2 - intrinsics.cx) * pz2 / intrinsics.fx\n    py2 = (py2 - intrinsics.cy) * pz2 / intrinsics.fy\n\n    p1_cam = np.array([px1, py1, pz1, 1])\n    p2_cam = np.array([px2, py2, pz2, 1])\n\n    # 2. \u6b63\u8fd0\u52a8\u5b66\uff1a\u83b7\u53d6\u5f53\u524d\u672b\u7aef\u4f4d\u59ff\uff084x4\u53d8\u6362\u77e9\u9635\uff09\n    forward_matrix = self.kinematic_service.get_gripper2base_rm(current_joint_angles)\n\n    # 3. \u76f8\u673a\u5750\u6807\u7cfb \u2192 \u57fa\u5750\u6807\u7cfb\n    T_cam2base = forward_matrix @ self.config.hand_eye_matrix\n\n    p1_base = T_cam2base @ p1_cam\n    p2_base = T_cam2base @ p2_cam\n    v_base = p2_base - p1_base\n\n    # 4. \u8ba1\u7b97\u76ee\u6807\u4f4d\u59ff\n    # 4.1 \u8ba1\u7b97\u96f6\u4ef6\u65b9\u5411\u5411\u91cf\n    theta = np.arctan2(v_base[1], v_base[0])\n\n    # 4.2 \u6784\u5efa\u7ed5 Z \u8f74\u65cb\u8f6c\u7684\u53d8\u6362\u77e9\u9635\n    T_target2base = self.get_z_rotation_matrix(theta)\n    T_target2base[:, 3] = p2_base\n\n    # 4.3 \u6dfb\u52a0\u504f\u79fb\u91cf\n    T_offset2target = np.eye(4)\n    T_offset2target[:3, 3] = self.config.target_offset.to_array()\n    T_target2base = T_target2base @ T_offset2target\n\n    # 4.4 \u8c03\u6574\u672b\u7aef\u59ff\u6001\n    adjustment = self.config.end_effector_adjustment\n    T_target2base = (\n        T_target2base \n        @ self.get_z_rotation_matrix(adjustment.z_rotation) \n        @ self.get_y_rotation_matrix(adjustment.y_rotation)\n    )\n\n    # 5. \u9006\u8fd0\u52a8\u5b66\u6c42\u89e3\n    theta_list = self.kinematic_service.inverse_kinematic(\n        T_target2base[:3, :3], \n        T_target2base[:3, 3],\n        initial_theta=current_joint_angles\n    )\n\n    return theta_list\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.HandEyeTransformDomainService.get_z_rotation_matrix","title":"get_z_rotation_matrix","text":"<pre><code>get_z_rotation_matrix(angle: float) -&gt; np.ndarray\n</code></pre> <p>\u83b7\u53d6\u7ed5 Z \u8f74\u65cb\u8f6c\u7684\u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>angle</code> <code>float</code> <p>\u65cb\u8f6c\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: 4x4 \u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/hand_eye_transform_domain_service.py</code> <pre><code>def get_z_rotation_matrix(self, angle: float) -&gt; np.ndarray:\n    \"\"\"\u83b7\u53d6\u7ed5 Z \u8f74\u65cb\u8f6c\u7684\u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002\n\n    Args:\n        angle (float): \u65cb\u8f6c\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002\n\n    Returns:\n        np.ndarray: 4x4 \u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002\n    \"\"\"\n    c = cos(angle)\n    s = sin(angle)\n    return np.array([\n        [c, -s, 0, 0],\n        [s,  c, 0, 0],\n        [0,  0, 1, 0],\n        [0,  0, 0, 1]\n    ])\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.HandEyeTransformDomainService.get_y_rotation_matrix","title":"get_y_rotation_matrix","text":"<pre><code>get_y_rotation_matrix(angle: float) -&gt; np.ndarray\n</code></pre> <p>\u83b7\u53d6\u7ed5 Y \u8f74\u65cb\u8f6c\u7684\u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>angle</code> <code>float</code> <p>\u65cb\u8f6c\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: 4x4 \u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/hand_eye_transform_domain_service.py</code> <pre><code>def get_y_rotation_matrix(self, angle: float) -&gt; np.ndarray:\n    \"\"\"\u83b7\u53d6\u7ed5 Y \u8f74\u65cb\u8f6c\u7684\u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002\n\n    Args:\n        angle (float): \u65cb\u8f6c\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002\n\n    Returns:\n        np.ndarray: 4x4 \u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002\n    \"\"\"\n    c = cos(angle)\n    s = sin(angle)\n    return np.array([\n        [ c, 0, s, 0],\n        [ 0, 1, 0, 0],\n        [-s, 0, c, 0],\n        [ 0, 0, 0, 1]\n    ])\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.HandEyeTransformDomainService.get_x_rotation_matrix","title":"get_x_rotation_matrix","text":"<pre><code>get_x_rotation_matrix(angle: float) -&gt; np.ndarray\n</code></pre> <p>\u83b7\u53d6\u7ed5 X \u8f74\u65cb\u8f6c\u7684\u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>angle</code> <code>float</code> <p>\u65cb\u8f6c\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: 4x4 \u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/services/algorithm/hand_eye_transform_domain_service.py</code> <pre><code>def get_x_rotation_matrix(self, angle: float) -&gt; np.ndarray:\n    \"\"\"\u83b7\u53d6\u7ed5 X \u8f74\u65cb\u8f6c\u7684\u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002\n\n    Args:\n        angle (float): \u65cb\u8f6c\u89d2\u5ea6\uff08\u5f27\u5ea6\uff09\u3002\n\n    Returns:\n        np.ndarray: 4x4 \u9f50\u6b21\u53d8\u6362\u77e9\u9635\u3002\n    \"\"\"\n    c = cos(angle)\n    s = sin(angle)\n    return np.array([\n        [1,  0,  0, 0],\n        [0,  c, -s, 0],\n        [0,  s,  c, 0],\n        [0,  0,  0, 1]\n    ])\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlan","title":"MotionPlan  <code>dataclass</code>","text":"<pre><code>MotionPlan(name: str, points: List[dict] = list())\n</code></pre> <p>\u8fd0\u52a8\u89c4\u5212\u65b9\u6848\u5b9e\u4f53\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>name</code> <code>str</code> <p>\u65b9\u6848\u540d\u79f0\u3002</p> <code>points</code> <code>List[dict]</code> <p>\u8282\u70b9\u5217\u8868\u3002</p>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlan.add_point","title":"add_point","text":"<pre><code>add_point(point_data: dict)\n</code></pre> <p>\u6dfb\u52a0\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>point_data</code> <code>dict</code> <p>\u8282\u70b9\u6570\u636e\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/entities/motion_plan.py</code> <pre><code>def add_point(self, point_data: dict):\n    \"\"\"\u6dfb\u52a0\u8282\u70b9\u3002\n\n    Args:\n        point_data (dict): \u8282\u70b9\u6570\u636e\u3002\n    \"\"\"\n    self.points.append(point_data)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlan.remove_point","title":"remove_point","text":"<pre><code>remove_point(index: int)\n</code></pre> <p>\u5220\u9664\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/entities/motion_plan.py</code> <pre><code>def remove_point(self, index: int):\n    \"\"\"\u5220\u9664\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n    \"\"\"\n    if 0 &lt;= index &lt; len(self.points):\n        self.points.pop(index)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlan.move_point_up","title":"move_point_up","text":"<pre><code>move_point_up(index: int) -&gt; bool\n</code></pre> <p>\u4e0a\u79fb\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u6210\u529f\u79fb\u52a8\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/entities/motion_plan.py</code> <pre><code>def move_point_up(self, index: int) -&gt; bool:\n    \"\"\"\u4e0a\u79fb\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n\n    Returns:\n        bool: \u662f\u5426\u6210\u529f\u79fb\u52a8\u3002\n    \"\"\"\n    if index &gt; 0:\n        self.points[index], self.points[index-1] = \\\n            self.points[index-1], self.points[index]\n        return True\n    return False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlan.move_point_down","title":"move_point_down","text":"<pre><code>move_point_down(index: int) -&gt; bool\n</code></pre> <p>\u4e0b\u79fb\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u6210\u529f\u79fb\u52a8\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/entities/motion_plan.py</code> <pre><code>def move_point_down(self, index: int) -&gt; bool:\n    \"\"\"\u4e0b\u79fb\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n\n    Returns:\n        bool: \u662f\u5426\u6210\u529f\u79fb\u52a8\u3002\n    \"\"\"\n    if index &lt; len(self.points) - 1:\n        self.points[index], self.points[index+1] = \\\n            self.points[index+1], self.points[index]\n        return True\n    return False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlan.update_point","title":"update_point","text":"<pre><code>update_point(index: int, point_data: dict)\n</code></pre> <p>\u66f4\u65b0\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>index</code> <code>int</code> <p>\u8282\u70b9\u7d22\u5f15\u3002</p> \u5fc5\u9700 <code>point_data</code> <code>dict</code> <p>\u65b0\u7684\u8282\u70b9\u6570\u636e\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/domain/entities/motion_plan.py</code> <pre><code>def update_point(self, index: int, point_data: dict):\n    \"\"\"\u66f4\u65b0\u8282\u70b9\u3002\n\n    Args:\n        index (int): \u8282\u70b9\u7d22\u5f15\u3002\n        point_data (dict): \u65b0\u7684\u8282\u70b9\u6570\u636e\u3002\n    \"\"\"\n    if 0 &lt;= index &lt; len(self.points):\n        self.points[index] = point_data\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.PortScanner","title":"PortScanner","text":"<p>\u4e32\u53e3\u7aef\u53e3\u626b\u63cf\u5668\u3002</p> <p>\u8d1f\u8d23\u626b\u63cf\u53ef\u7528\u7684\u4e32\u53e3\u7aef\u53e3\uff0c\u5305\u542b\u771f\u5b9e\u4e32\u53e3\u548c\u865a\u62df\u4e32\u53e3\u3002</p>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.PortScanner.scan_ports","title":"scan_ports  <code>staticmethod</code>","text":"<pre><code>scan_ports() -&gt; List[str]\n</code></pre> <p>\u626b\u63cf\u53ef\u7528\u7684\u4e32\u53e3\u7aef\u53e3\uff08\u5305\u542b\u771f\u5b9e\u4e32\u53e3\u548c\u865a\u62df\u4e32\u53e3\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>List[str]: \u53ef\u7528\u7aef\u53e3\u540d\u79f0\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/port_scanner.py</code> <pre><code>@staticmethod\ndef scan_ports() -&gt; List[str]:\n    \"\"\"\u626b\u63cf\u53ef\u7528\u7684\u4e32\u53e3\u7aef\u53e3\uff08\u5305\u542b\u771f\u5b9e\u4e32\u53e3\u548c\u865a\u62df\u4e32\u53e3\uff09\u3002\n\n    Returns:\n        List[str]: \u53ef\u7528\u7aef\u53e3\u540d\u79f0\u5217\u8868\u3002\n    \"\"\"\n    all_ports = []\n\n    try:\n        # 1. \u626b\u63cf\u771f\u5b9e\u786c\u4ef6\u4e32\u53e3\n        ports = serial.tools.list_ports.comports()\n        all_ports.extend([port.device for port in ports])\n\n        # 2. \u626b\u63cf\u865a\u62df\u4e32\u53e3\uff08\u4f2a\u7ec8\u7aef\uff09\n        virtual_port_patterns = [\n            '/dev/pts/*',      # \u4f2a\u7ec8\u7aef\n            '/tmp/tty*',       # \u4e34\u65f6\u865a\u62df\u4e32\u53e3\uff08socat\u521b\u5efa\u7684\uff09\n            '/dev/ttyV*',      # \u865a\u62df\u4e32\u53e3\u8bbe\u5907\n        ]\n\n        for pattern in virtual_port_patterns:\n            for device in glob.glob(pattern):\n                # \u68c0\u67e5\u662f\u5426\u662f\u5b57\u7b26\u8bbe\u5907\u4e14\u53ef\u8bbf\u95ee\n                if os.path.exists(device) and PortScanner._is_accessible(device):\n                    if device not in all_ports:\n                        all_ports.append(device)\n\n        # \u6392\u5e8f\uff1a\u771f\u5b9e\u4e32\u53e3\u5728\u524d\uff0c\u865a\u62df\u4e32\u53e3\u5728\u540e\n        all_ports.sort(key=lambda x: (not x.startswith('/dev/ttyUSB'), \n                                     not x.startswith('/dev/ttyACM'), \n                                     x))\n\n        return all_ports\n\n    except Exception:\n        return all_ports\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.PortScanner.get_port_info","title":"get_port_info  <code>staticmethod</code>","text":"<pre><code>get_port_info(port_name: str) -&gt; Optional[Dict[str, str]]\n</code></pre> <p>\u83b7\u53d6\u6307\u5b9a\u7aef\u53e3\u7684\u8be6\u7ec6\u4fe1\u606f\uff08\u652f\u6301\u771f\u5b9e\u4e32\u53e3\u548c\u865a\u62df\u4e32\u53e3\uff09\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>port_name</code> <code>str</code> <p>\u7aef\u53e3\u540d\u79f0\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[Dict[str, str]]</code> <p>Optional[Dict[str, str]]: \u7aef\u53e3\u4fe1\u606f\u5b57\u5178\uff0c\u5305\u542b description \u548c hwid\u3002\u5982\u679c\u7aef\u53e3\u4e0d\u53ef\u7528\u5219\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/port_scanner.py</code> <pre><code>@staticmethod\ndef get_port_info(port_name: str) -&gt; Optional[Dict[str, str]]:\n    \"\"\"\u83b7\u53d6\u6307\u5b9a\u7aef\u53e3\u7684\u8be6\u7ec6\u4fe1\u606f\uff08\u652f\u6301\u771f\u5b9e\u4e32\u53e3\u548c\u865a\u62df\u4e32\u53e3\uff09\u3002\n\n    Args:\n        port_name (str): \u7aef\u53e3\u540d\u79f0\u3002\n\n    Returns:\n        Optional[Dict[str, str]]: \u7aef\u53e3\u4fe1\u606f\u5b57\u5178\uff0c\u5305\u542b description \u548c hwid\u3002\u5982\u679c\u7aef\u53e3\u4e0d\u53ef\u7528\u5219\u8fd4\u56de None\u3002\n    \"\"\"\n    try:\n        # 1. \u5148\u5c1d\u8bd5\u4ece\u771f\u5b9e\u786c\u4ef6\u4e32\u53e3\u83b7\u53d6\u4fe1\u606f\n        ports = serial.tools.list_ports.comports()\n        for port in ports:\n            if port.device == port_name:\n                return {\n                    'device': port.device,\n                    'description': port.description or '',\n                    'hwid': port.hwid or ''\n                }\n\n        # 2. \u5982\u679c\u662f\u865a\u62df\u4e32\u53e3\uff0c\u8fd4\u56de\u81ea\u5b9a\u4e49\u4fe1\u606f\n        if os.path.exists(port_name):\n            description = \"\u865a\u62df\u4e32\u53e3\"\n\n            # \u6839\u636e\u8def\u5f84\u5224\u65ad\u7c7b\u578b\n            if port_name.startswith('/tmp/'):\n                description = \"\u4e34\u65f6\u865a\u62df\u4e32\u53e3 (socat)\"\n            elif port_name.startswith('/dev/pts/'):\n                description = \"\u4f2a\u7ec8\u7aef (pty)\"\n            elif port_name.startswith('/dev/ttyV'):\n                description = \"\u865a\u62df\u4e32\u53e3\u8bbe\u5907\"\n\n            return {\n                'device': port_name,\n                'description': description,\n                'hwid': 'VIRTUAL'\n            }\n\n        return None\n    except Exception:\n        return None\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.PortScanner.get_all_port_info","title":"get_all_port_info  <code>staticmethod</code>","text":"<pre><code>get_all_port_info() -&gt; List[Dict[str, str]]\n</code></pre> <p>\u83b7\u53d6\u6240\u6709\u53ef\u7528\u7aef\u53e3\u7684\u8be6\u7ec6\u4fe1\u606f\uff08\u5305\u542b\u771f\u5b9e\u4e32\u53e3\u548c\u865a\u62df\u4e32\u53e3\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[Dict[str, str]]</code> <p>List[Dict[str, str]]: \u6240\u6709\u7aef\u53e3\u4fe1\u606f\u5217\u8868\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/port_scanner.py</code> <pre><code>@staticmethod\ndef get_all_port_info() -&gt; List[Dict[str, str]]:\n    \"\"\"\u83b7\u53d6\u6240\u6709\u53ef\u7528\u7aef\u53e3\u7684\u8be6\u7ec6\u4fe1\u606f\uff08\u5305\u542b\u771f\u5b9e\u4e32\u53e3\u548c\u865a\u62df\u4e32\u53e3\uff09\u3002\n\n    Returns:\n        List[Dict[str, str]]: \u6240\u6709\u7aef\u53e3\u4fe1\u606f\u5217\u8868\u3002\n    \"\"\"\n    try:\n        all_port_info = []\n\n        # \u83b7\u53d6\u6240\u6709\u7aef\u53e3\n        all_ports = PortScanner.scan_ports()\n\n        # \u4e3a\u6bcf\u4e2a\u7aef\u53e3\u83b7\u53d6\u4fe1\u606f\n        for port_name in all_ports:\n            port_info = PortScanner.get_port_info(port_name)\n            if port_info:\n                all_port_info.append(port_info)\n\n        return all_port_info\n    except Exception:\n        return [] \n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialAdapter","title":"SerialAdapter","text":"<pre><code>SerialAdapter()\n</code></pre> <p>\u4e32\u53e3\u8fde\u63a5\u9002\u914d\u5668\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>serial_port</code> <code>Optional[Serial]</code> <p>PySerial \u5b9e\u4f8b\u3002</p> <code>current_config</code> <code>Optional[Dict[str, Any]]</code> <p>\u5f53\u524d\u914d\u7f6e\u5b57\u5178\u3002</p> <p>\u521d\u59cb\u5316\u4e32\u53e3\u9002\u914d\u5668\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_adapter.py</code> <pre><code>def __init__(self):\n    \"\"\"\u521d\u59cb\u5316\u4e32\u53e3\u9002\u914d\u5668\u3002\"\"\"\n    self.serial_port: Optional[serial.Serial] = None\n    self.current_config: Optional[Dict[str, Any]] = None\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialAdapter.connect","title":"connect","text":"<pre><code>connect(port: str, config: Dict[str, Any]) -&gt; bool\n</code></pre> <p>\u8fde\u63a5\u4e32\u53e3\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>port</code> <code>str</code> <p>\u4e32\u53e3\u540d\u79f0\u3002</p> \u5fc5\u9700 <code>config</code> <code>Dict[str, Any]</code> <p>\u4e32\u53e3\u914d\u7f6e\u53c2\u6570\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u8fde\u63a5\u662f\u5426\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_adapter.py</code> <pre><code>def connect(self, port: str, config: Dict[str, Any]) -&gt; bool:\n    \"\"\"\u8fde\u63a5\u4e32\u53e3\u3002\n\n    Args:\n        port (str): \u4e32\u53e3\u540d\u79f0\u3002\n        config (Dict[str, Any]): \u4e32\u53e3\u914d\u7f6e\u53c2\u6570\u3002\n\n    Returns:\n        bool: \u8fde\u63a5\u662f\u5426\u6210\u529f\u3002\n    \"\"\"\n    try:\n        # \u5982\u679c\u5df2\u7ecf\u8fde\u63a5\uff0c\u5148\u65ad\u5f00\n        if self.is_connected():\n            self.disconnect()\n\n        # \u521b\u5efa\u4e32\u53e3\u8fde\u63a5\n        self.serial_port = serial.Serial(\n            port=port,\n            baudrate=config.get('baudrate', 115200),\n            bytesize=config.get('bytesize', 8),\n            parity=config.get('parity', 'N'),\n            stopbits=config.get('stopbits', 1),\n            timeout=config.get('timeout', 1),\n            xonxoff=config.get('xonxoff', False),\n            rtscts=config.get('rtscts', False),\n            dsrdtr=config.get('dsrdtr', False)\n        )\n\n        # \u4fdd\u5b58\u914d\u7f6e\n        self.current_config = config.copy()\n        self.current_config['port'] = port\n\n        return True\n\n    except Exception:\n        self.serial_port = None\n        self.current_config = None\n        return False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialAdapter.disconnect","title":"disconnect","text":"<pre><code>disconnect() -&gt; bool\n</code></pre> <p>\u65ad\u5f00\u4e32\u53e3\u8fde\u63a5\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u65ad\u5f00\u662f\u5426\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_adapter.py</code> <pre><code>def disconnect(self) -&gt; bool:\n    \"\"\"\u65ad\u5f00\u4e32\u53e3\u8fde\u63a5\u3002\n\n    Returns:\n        bool: \u65ad\u5f00\u662f\u5426\u6210\u529f\u3002\n    \"\"\"\n    try:\n        if self.serial_port and self.serial_port.is_open:\n            self.serial_port.close()\n        return True\n    except Exception:\n        return False\n    finally:\n        self.serial_port = None\n        self.current_config = None\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialAdapter.is_connected","title":"is_connected","text":"<pre><code>is_connected() -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u4e32\u53e3\u662f\u5426\u5df2\u8fde\u63a5\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u5df2\u8fde\u63a5\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_adapter.py</code> <pre><code>def is_connected(self) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u4e32\u53e3\u662f\u5426\u5df2\u8fde\u63a5\u3002\n\n    Returns:\n        bool: \u662f\u5426\u5df2\u8fde\u63a5\u3002\n    \"\"\"\n    return (self.serial_port is not None and \n            self.serial_port.is_open)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialAdapter.get_serial_port","title":"get_serial_port","text":"<pre><code>get_serial_port() -&gt; Optional[serial.Serial]\n</code></pre> <p>\u83b7\u53d6\u4e32\u53e3\u5bf9\u8c61\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[Serial]</code> <p>Optional[serial.Serial]: \u4e32\u53e3\u5bf9\u8c61\uff0c\u672a\u8fde\u63a5\u65f6\u8fd4\u56deNone\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_adapter.py</code> <pre><code>def get_serial_port(self) -&gt; Optional[serial.Serial]:\n    \"\"\"\u83b7\u53d6\u4e32\u53e3\u5bf9\u8c61\u3002\n\n    Returns:\n        Optional[serial.Serial]: \u4e32\u53e3\u5bf9\u8c61\uff0c\u672a\u8fde\u63a5\u65f6\u8fd4\u56deNone\u3002\n    \"\"\"\n    if self.is_connected():\n        return self.serial_port\n    return None\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialAdapter.get_current_config","title":"get_current_config","text":"<pre><code>get_current_config() -&gt; Optional[Dict[str, Any]]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u914d\u7f6e\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[Dict[str, Any]]</code> <p>Optional[Dict[str, Any]]: \u5f53\u524d\u914d\u7f6e\uff0c\u672a\u8fde\u63a5\u65f6\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_adapter.py</code> <pre><code>def get_current_config(self) -&gt; Optional[Dict[str, Any]]:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u914d\u7f6e\u3002\n\n    Returns:\n        Optional[Dict[str, Any]]: \u5f53\u524d\u914d\u7f6e\uff0c\u672a\u8fde\u63a5\u65f6\u8fd4\u56de None\u3002\n    \"\"\"\n    return self.current_config.copy() if self.current_config else None\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialAdapter.get_port_name","title":"get_port_name","text":"<pre><code>get_port_name() -&gt; Optional[str]\n</code></pre> <p>\u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u7684\u7aef\u53e3\u540d\u79f0\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Optional[str]</code> <p>Optional[str]: \u7aef\u53e3\u540d\u79f0\uff0c\u672a\u8fde\u63a5\u65f6\u8fd4\u56de None\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_adapter.py</code> <pre><code>def get_port_name(self) -&gt; Optional[str]:\n    \"\"\"\u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u7684\u7aef\u53e3\u540d\u79f0\u3002\n\n    Returns:\n        Optional[str]: \u7aef\u53e3\u540d\u79f0\uff0c\u672a\u8fde\u63a5\u65f6\u8fd4\u56de None\u3002\n    \"\"\"\n    if self.current_config:\n        return self.current_config.get('port')\n    return None\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialReader","title":"SerialReader","text":"<pre><code>SerialReader(serial_port: Optional[Serial] = None)\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u4e32\u53e3\u8bfb\u53d6\u5904\u7406\u7c7b\u3002</p> <p>\u8d1f\u8d23\u5728\u72ec\u7acb\u7ebf\u7a0b\u4e2d\u8bfb\u53d6\u4e32\u53e3\u6570\u636e\uff0c\u652f\u6301\u591a\u79cd\u7f16\u7801\u683c\u5f0f\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>data_received</code> <code>pyqtSignal</code> <p>\u63a5\u6536\u5230\u6570\u636e\u65f6\u53d1\u9001\u4fe1\u53f7\uff0c\u643a\u5e26\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u3002</p> <p>\u521d\u59cb\u5316\u4e32\u53e3\u8bfb\u53d6\u5668\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>serial_port</code> <code>Serial</code> <p>\u4e32\u53e3\u5bf9\u8c61\u3002</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_reader.py</code> <pre><code>def __init__(self, serial_port: Optional[serial.Serial] = None):\n    \"\"\"\u521d\u59cb\u5316\u4e32\u53e3\u8bfb\u53d6\u5668\u3002\n\n    Args:\n        serial_port (serial.Serial, optional): \u4e32\u53e3\u5bf9\u8c61\u3002\n    \"\"\"\n    super().__init__()\n    self.serial_port = serial_port\n    self.stop_flag = False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialReader.stop","title":"stop","text":"<pre><code>stop() -&gt; None\n</code></pre> <p>\u505c\u6b62\u8bfb\u53d6\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_reader.py</code> <pre><code>def stop(self) -&gt; None:\n    \"\"\"\u505c\u6b62\u8bfb\u53d6\u3002\"\"\"\n    self.stop_flag = True\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialReader.read_data","title":"read_data","text":"<pre><code>read_data() -&gt; None\n</code></pre> <p>\u8bfb\u53d6\u4e32\u53e3\u6570\u636e - \u5728\u72ec\u7acb\u7ebf\u7a0b\u4e2d\u8fd0\u884c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_reader.py</code> <pre><code>def read_data(self) -&gt; None:\n    \"\"\"\u8bfb\u53d6\u4e32\u53e3\u6570\u636e - \u5728\u72ec\u7acb\u7ebf\u7a0b\u4e2d\u8fd0\u884c\u3002\"\"\"\n    self.stop_flag = False\n\n    while not self.stop_flag:\n        if not self.serial_port or not self.serial_port.is_open:\n            time.sleep(0.1)\n            continue\n\n        try:\n            waiting_bytes = self.serial_port.in_waiting\n        except OSError:\n            time.sleep(0.1)\n            continue\n\n        if waiting_bytes &gt; 0:\n            try:\n                data = self.serial_port.read(waiting_bytes)\n\n                # \u56fa\u5b9a\u4f7f\u7528\u5341\u516d\u8fdb\u5236\u683c\u5f0f\n                hex_data = data.hex().upper()\n                self.data_received.emit(hex_data)\n\n            except serial.SerialException:\n                time.sleep(0.1)\n                continue\n        else:\n            time.sleep(0.01)\n\n        time.sleep(0.01) \n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialWriter","title":"SerialWriter","text":"<pre><code>SerialWriter(serial_port: Optional[Serial] = None)\n</code></pre> <p>               Bases: <code>QObject</code></p> <p>\u4e32\u53e3\u53d1\u9001\u5904\u7406\u7c7b\u3002</p> <p>\u8d1f\u8d23\u5728\u72ec\u7acb\u7ebf\u7a0b\u4e2d\u53d1\u9001\u4e32\u53e3\u6570\u636e\uff0c\u4f7f\u7528\u961f\u5217\u7ba1\u7406\u53d1\u9001\u4efb\u52a1\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>serial_port</code> <code>Optional[Serial]</code> <p>\u4e32\u53e3\u5bf9\u8c61\u3002</p> <code>send_queue</code> <code>Queue</code> <p>\u53d1\u9001\u4efb\u52a1\u961f\u5217\u3002</p> <p>\u521d\u59cb\u5316\u4e32\u53e3\u5199\u5165\u5668\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>serial_port</code> <code>Serial</code> <p>\u4e32\u53e3\u5bf9\u8c61\u3002</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_writer.py</code> <pre><code>def __init__(self, serial_port: Optional[serial.Serial] = None):\n    \"\"\"\u521d\u59cb\u5316\u4e32\u53e3\u5199\u5165\u5668\u3002\n\n    Args:\n        serial_port (serial.Serial, optional): \u4e32\u53e3\u5bf9\u8c61\u3002\n    \"\"\"\n    super().__init__()\n    self.serial_port = serial_port\n    self.send_queue = Queue()\n    self.stop_flag = False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialWriter.stop","title":"stop","text":"<pre><code>stop() -&gt; None\n</code></pre> <p>\u505c\u6b62\u53d1\u9001\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_writer.py</code> <pre><code>def stop(self) -&gt; None:\n    \"\"\"\u505c\u6b62\u53d1\u9001\u3002\"\"\"\n    self.stop_flag = True\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialWriter.add_to_queue","title":"add_to_queue","text":"<pre><code>add_to_queue(cmd: Union[str, bytes]) -&gt; None\n</code></pre> <p>\u6dfb\u52a0\u547d\u4ee4\u5230\u53d1\u9001\u961f\u5217\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>cmd</code> <code>Union[str, bytes]</code> <p>\u5f85\u53d1\u9001\u7684\u547d\u4ee4\uff08\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u6216\u5b57\u8282\uff09\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_writer.py</code> <pre><code>def add_to_queue(self, cmd: Union[str, bytes]) -&gt; None:\n    \"\"\"\u6dfb\u52a0\u547d\u4ee4\u5230\u53d1\u9001\u961f\u5217\u3002\n\n    Args:\n        cmd (Union[str, bytes]): \u5f85\u53d1\u9001\u7684\u547d\u4ee4\uff08\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u6216\u5b57\u8282\uff09\u3002\n    \"\"\"\n    self.send_queue.put(cmd)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.SerialWriter.send_data","title":"send_data","text":"<pre><code>send_data() -&gt; None\n</code></pre> <p>\u53d1\u9001\u4e32\u53e3\u6570\u636e - \u5728\u72ec\u7acb\u7ebf\u7a0b\u4e2d\u8fd0\u884c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/communication/serial_writer.py</code> <pre><code>def send_data(self) -&gt; None:\n    \"\"\"\u53d1\u9001\u4e32\u53e3\u6570\u636e - \u5728\u72ec\u7acb\u7ebf\u7a0b\u4e2d\u8fd0\u884c\u3002\"\"\"\n    self.stop_flag = False\n\n    while not self.stop_flag:\n        try:\n            if not self.serial_port or not self.serial_port.is_open:\n                time.sleep(0.1)\n                continue\n\n            if not self.send_queue.empty():\n                try:\n                    cmd = self.send_queue.get()\n                    if isinstance(cmd, str):\n                        cmd = bytes.fromhex(cmd.replace(' ', ''))\n                    self.serial_port.write(cmd)\n                    self.serial_port.flush()\n                    self.send_queue.task_done()\n                except Exception:\n                    # \u9759\u9ed8\u5904\u7406\u9519\u8bef\uff0c\u4e0d\u53d1\u9001\u4fe1\u53f7\n                    pass\n            else:\n                # \u961f\u5217\u4e3a\u7a7a\u65f6\u77ed\u6682\u4f11\u7720\uff0c\u907f\u514dCPU\u7a7a\u8f6c\n                time.sleep(0.01)\n        except Exception:\n            # \u9759\u9ed8\u5904\u7406\u9519\u8bef\uff0c\u4e0d\u53d1\u9001\u4fe1\u53f7\n            time.sleep(0.1) \n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RecordRepository","title":"RecordRepository","text":"<pre><code>RecordRepository(file_path: str = 'teach_record.json')\n</code></pre> <p>\u793a\u6559\u8bb0\u5f55\u6301\u4e45\u5316\u4ed3\u5e93 - Infrastructure\u5c42\u3002</p> <p>\u804c\u8d23\uff1a - \u4eceJSON\u6587\u4ef6\u52a0\u8f7d\u8bb0\u5f55\u6570\u636e - \u4fdd\u5b58\u8bb0\u5f55\u6570\u636e\u5230JSON\u6587\u4ef6 - \u7ba1\u7406\u8bb0\u5f55\u6587\u4ef6\u7684\u8bfb\u5199</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>file_path</code> <code>str</code> <p>\u8bb0\u5f55\u6587\u4ef6\u8def\u5f84\u3002</p> <p>\u521d\u59cb\u5316\u8bb0\u5f55\u4ed3\u5e93\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>str</code> <p>\u8bb0\u5f55\u6587\u4ef6\u8def\u5f84. Defaults to \"teach_record.json\".</p> <code>'teach_record.json'</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/record_repository.py</code> <pre><code>def __init__(self, file_path: str = \"teach_record.json\"):\n    \"\"\"\u521d\u59cb\u5316\u8bb0\u5f55\u4ed3\u5e93\u3002\n\n    Args:\n        file_path (str, optional): \u8bb0\u5f55\u6587\u4ef6\u8def\u5f84. Defaults to \"teach_record.json\".\n    \"\"\"\n    self.file_path = file_path\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RecordRepository.load_records","title":"load_records","text":"<pre><code>load_records() -&gt; Dict[str, List[List[float]]]\n</code></pre> <p>\u4ece\u6587\u4ef6\u52a0\u8f7d\u8bb0\u5f55\u6570\u636e\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Dict[str, List[List[float]]]</code> <p>Dict[str, List[List[float]]]: \u8bb0\u5f55\u6570\u636e\u5b57\u5178 {\u8bb0\u5f55\u540d: \u89d2\u5ea6\u5217\u8868}\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/record_repository.py</code> <pre><code>def load_records(self) -&gt; Dict[str, List[List[float]]]:\n    \"\"\"\u4ece\u6587\u4ef6\u52a0\u8f7d\u8bb0\u5f55\u6570\u636e\u3002\n\n    Returns:\n        Dict[str, List[List[float]]]: \u8bb0\u5f55\u6570\u636e\u5b57\u5178 {\u8bb0\u5f55\u540d: \u89d2\u5ea6\u5217\u8868}\u3002\n    \"\"\"\n    try:\n        if os.path.exists(self.file_path):\n            with open(self.file_path, 'r', encoding='utf-8') as f:\n                data = json.load(f)\n            return data\n        else:\n            return {}\n    except Exception as e:\n        return {}\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RecordRepository.save_records","title":"save_records","text":"<pre><code>save_records(records: Dict[str, List[List[float]]]) -&gt; bool\n</code></pre> <p>\u4fdd\u5b58\u8bb0\u5f55\u6570\u636e\u5230\u6587\u4ef6\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>records</code> <code>Dict[str, List[List[float]]]</code> <p>\u8bb0\u5f55\u6570\u636e\u5b57\u5178\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u4fdd\u5b58\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/record_repository.py</code> <pre><code>def save_records(self, records: Dict[str, List[List[float]]]) -&gt; bool:\n    \"\"\"\u4fdd\u5b58\u8bb0\u5f55\u6570\u636e\u5230\u6587\u4ef6\u3002\n\n    Args:\n        records (Dict[str, List[List[float]]]): \u8bb0\u5f55\u6570\u636e\u5b57\u5178\u3002\n\n    Returns:\n        bool: \u662f\u5426\u4fdd\u5b58\u6210\u529f\u3002\n    \"\"\"\n    try:\n        with open(self.file_path, 'w', encoding='utf-8') as f:\n            json.dump(records, f, ensure_ascii=False, indent=2)\n        return True\n    except Exception as e:\n        return False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.RecordRepository.delete_file","title":"delete_file","text":"<pre><code>delete_file() -&gt; bool\n</code></pre> <p>\u5220\u9664\u8bb0\u5f55\u6587\u4ef6\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>\u662f\u5426\u5220\u9664\u6210\u529f\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/record_repository.py</code> <pre><code>def delete_file(self) -&gt; bool:\n    \"\"\"\u5220\u9664\u8bb0\u5f55\u6587\u4ef6\u3002\n\n    Returns:\n        bool: \u662f\u5426\u5220\u9664\u6210\u529f\u3002\n    \"\"\"\n    try:\n        if os.path.exists(self.file_path):\n            os.remove(self.file_path)\n            return True\n        return False\n    except Exception as e:\n        return False\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanRepository","title":"MotionPlanRepository","text":"<pre><code>MotionPlanRepository(file_path: str = './motion_planning_plans.json')\n</code></pre> <p>\u8fd0\u52a8\u65b9\u6848\u6301\u4e45\u5316\u4ed3\u5e93\u3002</p> <p>\u804c\u8d23\uff1a 1. \u4fdd\u5b58/\u52a0\u8f7d\u65b9\u6848\u5230JSON\u6587\u4ef6 2. \u7ba1\u7406\u6587\u4ef6\u7cfb\u7edf\u64cd\u4f5c</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>file_path</code> <code>Path</code> <p>\u65b9\u6848\u6587\u4ef6\u8def\u5f84\u3002</p> <p>\u521d\u59cb\u5316\u4ed3\u5e93\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>str</code> <p>\u6587\u4ef6\u8def\u5f84. Defaults to \"./motion_planning_plans.json\".</p> <code>'./motion_planning_plans.json'</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/motion_plan_repository.py</code> <pre><code>def __init__(self, file_path: str = \"./motion_planning_plans.json\"):\n    \"\"\"\u521d\u59cb\u5316\u4ed3\u5e93\u3002\n\n    Args:\n        file_path (str, optional): \u6587\u4ef6\u8def\u5f84. Defaults to \"./motion_planning_plans.json\".\n    \"\"\"\n    self.file_path = Path(file_path)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanRepository.save","title":"save","text":"<pre><code>save(plans_data: List[Dict], current_index: int)\n</code></pre> <p>\u4fdd\u5b58\u65b9\u6848\u6570\u636e\u5230\u6587\u4ef6\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>plans_data</code> <code>List[Dict]</code> <p>\u65b9\u6848\u6570\u636e\u5217\u8868\u3002</p> \u5fc5\u9700 <code>current_index</code> <code>int</code> <p>\u5f53\u524d\u9009\u4e2d\u65b9\u6848\u7d22\u5f15\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/motion_plan_repository.py</code> <pre><code>def save(self, plans_data: List[Dict], current_index: int):\n    \"\"\"\u4fdd\u5b58\u65b9\u6848\u6570\u636e\u5230\u6587\u4ef6\u3002\n\n    Args:\n        plans_data (List[Dict]): \u65b9\u6848\u6570\u636e\u5217\u8868\u3002\n        current_index (int): \u5f53\u524d\u9009\u4e2d\u65b9\u6848\u7d22\u5f15\u3002\n    \"\"\"\n    data = {\n        \"current_index\": current_index,\n        \"plans\": plans_data\n    }\n    try:\n        with open(self.file_path, 'w', encoding='utf-8') as f:\n            json.dump(data, f, indent=2, ensure_ascii=False)\n    except Exception as e:\n        pass\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.MotionPlanRepository.load","title":"load","text":"<pre><code>load() -&gt; tuple[List[Dict], int]\n</code></pre> <p>\u4ece\u6587\u4ef6\u52a0\u8f7d\u65b9\u6848\u6570\u636e\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>tuple[List[Dict], int]</code> <p>tuple[List[Dict], int]: (plans_data, current_index)\u3002 \u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\u6216\u52a0\u8f7d\u5931\u8d25\uff0c\u8fd4\u56de\u9ed8\u8ba4\u65b9\u6848\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/motion_plan_repository.py</code> <pre><code>def load(self) -&gt; tuple[List[Dict], int]:\n    \"\"\"\u4ece\u6587\u4ef6\u52a0\u8f7d\u65b9\u6848\u6570\u636e\u3002\n\n    Returns:\n        tuple[List[Dict], int]: (plans_data, current_index)\u3002\n            \u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\u6216\u52a0\u8f7d\u5931\u8d25\uff0c\u8fd4\u56de\u9ed8\u8ba4\u65b9\u6848\u3002\n    \"\"\"\n    if not self.file_path.exists():\n        # \u8fd4\u56de\u9ed8\u8ba4\u65b9\u6848\n        return [{\"name\": \"\u9ed8\u8ba4\u65b9\u6848\", \"points\": []}], 0\n\n    try:\n        with open(self.file_path, 'r', encoding='utf-8') as f:\n            data = json.load(f)\n\n        plans = data.get(\"plans\", [])\n        current_index = data.get(\"current_index\", 0)\n\n        # \u5982\u679c\u6ca1\u6709\u65b9\u6848\uff0c\u521b\u5efa\u9ed8\u8ba4\u65b9\u6848\n        if not plans:\n            plans = [{\"name\": \"\u9ed8\u8ba4\u65b9\u6848\", \"points\": []}]\n            current_index = 0\n\n        return plans, current_index\n\n    except Exception as e:\n        return [{\"name\": \"\u9ed8\u8ba4\u65b9\u6848\", \"points\": []}], 0\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.HandEyeCalibrationRepository","title":"HandEyeCalibrationRepository","text":"<pre><code>HandEyeCalibrationRepository(config_path: str = None)\n</code></pre> <p>\u624b\u773c\u6807\u5b9a\u914d\u7f6e\u4ed3\u50a8 - Infrastructure\u5c42\u3002</p> <p>\u8d1f\u8d23\u4ece\u6587\u4ef6\u7cfb\u7edf\u8bfb\u53d6\u914d\u7f6e\u3002</p> <p>\u804c\u8d23\uff1a - \u4ece JSON \u6587\u4ef6\u52a0\u8f7d\u914d\u7f6e - \u8f6c\u6362\u4e3a Domain \u5c42\u7684\u503c\u5bf9\u8c61 - \u5904\u7406\u6587\u4ef6\u4e0d\u5b58\u5728\u7b49\u5f02\u5e38</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>config_path</code> <code>Path</code> <p>\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\u3002</p> <p>\u521d\u59cb\u5316\u914d\u7f6e\u4ed3\u50a8\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config_path</code> <code>str</code> <p>\u914d\u7f6e\u6587\u4ef6\u8def\u5f84. Defaults to None. \u5982\u679c\u4e3a None\uff0c\u5219\u6309\u4ee5\u4e0b\u4f18\u5148\u7ea7\u67e5\u627e\uff1a 1. ROS2 share \u76ee\u5f55 (controller/config/hand_eye_calibration.json) 2. \u5f00\u53d1\u73af\u5883\u76f8\u5bf9\u8def\u5f84 (../../config/hand_eye_calibration.json)</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/hand_eye_calibration_repository.py</code> <pre><code>def __init__(self, config_path: str = None):\n    \"\"\"\u521d\u59cb\u5316\u914d\u7f6e\u4ed3\u50a8\u3002\n\n    Args:\n        config_path (str, optional): \u914d\u7f6e\u6587\u4ef6\u8def\u5f84. Defaults to None.\n            \u5982\u679c\u4e3a None\uff0c\u5219\u6309\u4ee5\u4e0b\u4f18\u5148\u7ea7\u67e5\u627e\uff1a\n            1. ROS2 share \u76ee\u5f55 (controller/config/hand_eye_calibration.json)\n            2. \u5f00\u53d1\u73af\u5883\u76f8\u5bf9\u8def\u5f84 (../../config/hand_eye_calibration.json)\n    \"\"\"\n    if config_path is None:\n        # \u4f7f\u7528 ROS2 \u5305\u8d44\u6e90\u7ba1\u7406\u65b9\u5f0f\u67e5\u627e\u914d\u7f6e\u6587\u4ef6\n        try:\n            # ROS2 \u65b9\u5f0f\uff1a\u4ece share \u76ee\u5f55\u52a0\u8f7d\n            package_share_dir = get_package_share_directory('controller')\n            config_path = Path(package_share_dir) / 'config' / 'hand_eye_calibration.json'\n        except Exception:\n            # \u5982\u679c\u5305\u672a\u5b89\u88c5\uff0c\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\uff08\u5f00\u53d1\u6a21\u5f0f\uff09\n            current_file = Path(__file__)\n            controller_root = current_file.parent.parent.parent\n            config_path = controller_root / \"config\" / \"hand_eye_calibration.json\"\n\n    self.config_path = Path(config_path)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.HandEyeCalibrationRepository.load","title":"load","text":"<pre><code>load() -&gt; HandEyeCalibrationConfig\n</code></pre> <p>\u52a0\u8f7d\u624b\u773c\u6807\u5b9a\u914d\u7f6e\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>HandEyeCalibrationConfig</code> <code>HandEyeCalibrationConfig</code> <p>\u914d\u7f6e\u503c\u5bf9\u8c61\u3002</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>FileNotFoundError</code> <p>\u914d\u7f6e\u6587\u4ef6\u4e0d\u5b58\u5728\u3002</p> <code>ValueError</code> <p>\u914d\u7f6e\u683c\u5f0f\u9519\u8bef\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/hand_eye_calibration_repository.py</code> <pre><code>def load(self) -&gt; HandEyeCalibrationConfig:\n    \"\"\"\u52a0\u8f7d\u624b\u773c\u6807\u5b9a\u914d\u7f6e\u3002\n\n    Returns:\n        HandEyeCalibrationConfig: \u914d\u7f6e\u503c\u5bf9\u8c61\u3002\n\n    Raises:\n        FileNotFoundError: \u914d\u7f6e\u6587\u4ef6\u4e0d\u5b58\u5728\u3002\n        ValueError: \u914d\u7f6e\u683c\u5f0f\u9519\u8bef\u3002\n    \"\"\"\n    if not self.config_path.exists():\n        raise FileNotFoundError(\n            f\"\u914d\u7f6e\u6587\u4ef6\u4e0d\u5b58\u5728: {self.config_path}\\n\"\n            f\"\u8bf7\u5728 controller/config/ \u76ee\u5f55\u4e0b\u521b\u5efa hand_eye_calibration.json\"\n        )\n\n    try:\n        with open(self.config_path, 'r', encoding='utf-8') as f:\n            data = json.load(f)\n    except json.JSONDecodeError as e:\n        raise ValueError(f\"\u914d\u7f6e\u6587\u4ef6\u683c\u5f0f\u9519\u8bef: {e}\")\n\n    # \u89e3\u6790\u624b\u773c\u6807\u5b9a\u77e9\u9635\n    hand_eye_matrix = np.array(data['hand_eye_matrix'], dtype=float)\n\n    # \u89e3\u6790\u76f8\u673a\u5185\u53c2\n    intrinsics_data = data['camera_intrinsics']\n    camera_intrinsics = CameraIntrinsics(\n        fx=intrinsics_data['fx'],\n        fy=intrinsics_data['fy'],\n        cx=intrinsics_data['cx'],\n        cy=intrinsics_data['cy']\n    )\n\n    # \u89e3\u6790\u76ee\u6807\u504f\u79fb\u91cf\n    offset_data = data['target_offset']\n    target_offset = TargetOffset(\n        x=offset_data['x'],\n        y=offset_data['y'],\n        z=offset_data['z']\n    )\n\n    # \u89e3\u6790\u672b\u7aef\u59ff\u6001\u8c03\u6574\uff08\u89d2\u5ea6\u8f6c\u5f27\u5ea6\uff09\n    adjustment_data = data['end_effector_adjustment']\n    end_effector_adjustment = EndEffectorAdjustment(\n        z_rotation=radians(adjustment_data['z_rotation_deg']),\n        y_rotation=radians(adjustment_data['y_rotation_deg']),\n        x_rotation=radians(adjustment_data['x_rotation_deg'])\n    )\n\n    return HandEyeCalibrationConfig(\n        hand_eye_matrix=hand_eye_matrix,\n        camera_intrinsics=camera_intrinsics,\n        target_offset=target_offset,\n        end_effector_adjustment=end_effector_adjustment\n    )\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.HandEyeCalibrationRepository.save","title":"save","text":"<pre><code>save(config: HandEyeCalibrationConfig)\n</code></pre> <p>\u4fdd\u5b58\u914d\u7f6e\u5230\u6587\u4ef6\uff08\u53ef\u9009\u529f\u80fd\uff0c\u7528\u4e8e\u6807\u5b9a\u5de5\u5177\uff09\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config</code> <code>HandEyeCalibrationConfig</code> <p>\u624b\u773c\u6807\u5b9a\u914d\u7f6e\u5bf9\u8c61\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/hand_eye_calibration_repository.py</code> <pre><code>def save(self, config: HandEyeCalibrationConfig):\n    \"\"\"\u4fdd\u5b58\u914d\u7f6e\u5230\u6587\u4ef6\uff08\u53ef\u9009\u529f\u80fd\uff0c\u7528\u4e8e\u6807\u5b9a\u5de5\u5177\uff09\u3002\n\n    Args:\n        config (HandEyeCalibrationConfig): \u624b\u773c\u6807\u5b9a\u914d\u7f6e\u5bf9\u8c61\u3002\n    \"\"\"\n    # \u786e\u4fdd\u76ee\u5f55\u5b58\u5728\n    self.config_path.parent.mkdir(parents=True, exist_ok=True)\n\n    data = {\n        \"hand_eye_matrix\": config.hand_eye_matrix.tolist(),\n        \"camera_intrinsics\": {\n            \"fx\": config.camera_intrinsics.fx,\n            \"fy\": config.camera_intrinsics.fy,\n            \"cx\": config.camera_intrinsics.cx,\n            \"cy\": config.camera_intrinsics.cy\n        },\n        \"target_offset\": {\n            \"x\": config.target_offset.x,\n            \"y\": config.target_offset.y,\n            \"z\": config.target_offset.z,\n            \"comment\": \"\u76f8\u5bf9\u4e8e\u96f6\u4ef6\u4f4d\u7f6e\u7684\u504f\u79fb\u91cf\uff08\u7c73\uff09\"\n        },\n        \"end_effector_adjustment\": {\n            \"z_rotation_deg\": np.degrees(config.end_effector_adjustment.z_rotation),\n            \"y_rotation_deg\": np.degrees(config.end_effector_adjustment.y_rotation),\n            \"x_rotation_deg\": np.degrees(config.end_effector_adjustment.x_rotation),\n            \"comment\": \"\u672b\u7aef\u59ff\u6001\u8c03\u6574\uff08\u89d2\u5ea6\uff09\"\n        }\n    }\n\n    with open(self.config_path, 'w', encoding='utf-8') as f:\n        json.dump(data, f, indent=2, ensure_ascii=False)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TrajectoryRepository","title":"TrajectoryRepository","text":"<pre><code>TrajectoryRepository(plans_dir: str = './plans')\n</code></pre> <p>\u8f68\u8ff9\u6570\u636e\u4ed3\u5e93 - Infrastructure\u5c42\u3002</p> <p>\u804c\u8d23\uff1a 1. \u4fdd\u5b58\u8f68\u8ff9\u6570\u636e\u5230\u6587\u4ef6\u7cfb\u7edf 2. \u52a0\u8f7d\u8f68\u8ff9\u6570\u636e 3. \u7ba1\u7406\u5b58\u50a8\u76ee\u5f55</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>plans_dir</code> <code>Path</code> <p>\u8f68\u8ff9\u5b58\u50a8\u76ee\u5f55\u3002</p> <p>\u521d\u59cb\u5316\u8f68\u8ff9\u4ed3\u5e93\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>plans_dir</code> <code>str</code> <p>\u5b58\u50a8\u76ee\u5f55. Defaults to \"./plans\".</p> <code>'./plans'</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/trajectory_repository.py</code> <pre><code>def __init__(self, plans_dir: str = \"./plans\"):\n    \"\"\"\u521d\u59cb\u5316\u8f68\u8ff9\u4ed3\u5e93\u3002\n\n    Args:\n        plans_dir (str, optional): \u5b58\u50a8\u76ee\u5f55. Defaults to \"./plans\".\n    \"\"\"\n    self.plans_dir = Path(plans_dir)\n    self.plans_dir.mkdir(exist_ok=True)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TrajectoryRepository.save_trajectory","title":"save_trajectory","text":"<pre><code>save_trajectory(filename: str, positions: List[List[float]]) -&gt; None\n</code></pre> <p>\u4fdd\u5b58\u8f68\u8ff9\u6570\u636e\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>filename</code> <code>str</code> <p>\u6587\u4ef6\u540d\uff08\u4e0d\u542b\u6269\u5c55\u540d\uff09\u3002</p> \u5fc5\u9700 <code>positions</code> <code>List[List[float]]</code> <p>\u8f68\u8ff9\u70b9\u5e8f\u5217 [[q1,...,q6], ...]\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/trajectory_repository.py</code> <pre><code>def save_trajectory(\n    self, \n    filename: str, \n    positions: List[List[float]]\n) -&gt; None:\n    \"\"\"\u4fdd\u5b58\u8f68\u8ff9\u6570\u636e\u3002\n\n    Args:\n        filename (str): \u6587\u4ef6\u540d\uff08\u4e0d\u542b\u6269\u5c55\u540d\uff09\u3002\n        positions (List[List[float]]): \u8f68\u8ff9\u70b9\u5e8f\u5217 [[q1,...,q6], ...]\u3002\n    \"\"\"\n    clean_name = self._sanitize_filename(filename)\n    filepath = self.plans_dir / f\"{clean_name}.json\"\n\n    # \u5c06numpy\u6570\u7ec4\u8f6c\u6362\u4e3aPython\u5217\u8868\n    positions_serializable = self._convert_to_serializable(positions)\n\n    with open(filepath, 'w', encoding='utf-8') as f:\n        json.dump(positions_serializable, f, indent=2, ensure_ascii=False)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TrajectoryRepository.load_trajectory","title":"load_trajectory","text":"<pre><code>load_trajectory(filename: str) -&gt; List[List[float]]\n</code></pre> <p>\u52a0\u8f7d\u8f68\u8ff9\u6570\u636e\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>filename</code> <code>str</code> <p>\u6587\u4ef6\u540d\uff08\u4e0d\u542b\u6269\u5c55\u540d\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[List[float]]</code> <p>List[List[float]]: \u8f68\u8ff9\u70b9\u5e8f\u5217\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/trajectory_repository.py</code> <pre><code>def load_trajectory(self, filename: str) -&gt; List[List[float]]:\n    \"\"\"\u52a0\u8f7d\u8f68\u8ff9\u6570\u636e\u3002\n\n    Args:\n        filename (str): \u6587\u4ef6\u540d\uff08\u4e0d\u542b\u6269\u5c55\u540d\uff09\u3002\n\n    Returns:\n        List[List[float]]: \u8f68\u8ff9\u70b9\u5e8f\u5217\u3002\n    \"\"\"\n    filepath = self.plans_dir / f\"{filename}.json\"\n    with open(filepath, 'r', encoding='utf-8') as f:\n        return json.load(f)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TrajectoryRepository.list_trajectory_files","title":"list_trajectory_files","text":"<pre><code>list_trajectory_files() -&gt; List[str]\n</code></pre> <p>\u5217\u51fa\u6240\u6709\u53ef\u7528\u7684\u8f68\u8ff9\u6587\u4ef6\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>List[str]</code> <p>List[str]: \u6587\u4ef6\u540d\u5217\u8868\uff08\u4e0d\u5e26\u6269\u5c55\u540d\uff09\u3002</p> <code>\u4f8b\u5982</code> <code>List[str]</code> <p>[\"\u9ed8\u8ba4\u65b9\u6848-0\", \"\u9ed8\u8ba4\u65b9\u6848-1\", \"test_trajectory\"]</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/trajectory_repository.py</code> <pre><code>def list_trajectory_files(self) -&gt; List[str]:\n    \"\"\"\u5217\u51fa\u6240\u6709\u53ef\u7528\u7684\u8f68\u8ff9\u6587\u4ef6\u3002\n\n    Returns:\n        List[str]: \u6587\u4ef6\u540d\u5217\u8868\uff08\u4e0d\u5e26\u6269\u5c55\u540d\uff09\u3002\n        \u4f8b\u5982: [\"\u9ed8\u8ba4\u65b9\u6848-0\", \"\u9ed8\u8ba4\u65b9\u6848-1\", \"test_trajectory\"]\n    \"\"\"\n    if not self.plans_dir.exists():\n        return []\n\n    files = []\n    for file in self.plans_dir.glob(\"*.json\"):\n        files.append(file.stem)  # \u6587\u4ef6\u540d\u4e0d\u5e26\u6269\u5c55\u540d\n\n    return sorted(files)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.TrajectoryRepository.trajectory_exists","title":"trajectory_exists","text":"<pre><code>trajectory_exists(filename: str) -&gt; bool\n</code></pre> <p>\u68c0\u67e5\u8f68\u8ff9\u6587\u4ef6\u662f\u5426\u5b58\u5728\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>filename</code> <code>str</code> <p>\u6587\u4ef6\u540d\uff08\u4e0d\u542b\u6269\u5c55\u540d\uff09\u3002</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>bool</code> <code>bool</code> <p>True=\u6587\u4ef6\u5b58\u5728, False=\u6587\u4ef6\u4e0d\u5b58\u5728\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/infrastructure/persistence/trajectory_repository.py</code> <pre><code>def trajectory_exists(self, filename: str) -&gt; bool:\n    \"\"\"\u68c0\u67e5\u8f68\u8ff9\u6587\u4ef6\u662f\u5426\u5b58\u5728\u3002\n\n    Args:\n        filename (str): \u6587\u4ef6\u540d\uff08\u4e0d\u542b\u6269\u5c55\u540d\uff09\u3002\n\n    Returns:\n        bool: True=\u6587\u4ef6\u5b58\u5728, False=\u6587\u4ef6\u4e0d\u5b58\u5728\u3002\n    \"\"\"\n    filepath = self.plans_dir / f\"{filename}.json\"\n    return filepath.exists()\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.register_infrastructure_services","title":"register_infrastructure_services","text":"<pre><code>register_infrastructure_services(container: DIContainer) -&gt; None\n</code></pre> <p>\u6ce8\u518c Infrastructure \u5c42\u670d\u52a1\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>container</code> <code>DIContainer</code> <p>DI \u5bb9\u5668\u5b9e\u4f8b\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/shared/config/service_registry.py</code> <pre><code>def register_infrastructure_services(container: DIContainer) -&gt; None:\n    \"\"\"\u6ce8\u518c Infrastructure \u5c42\u670d\u52a1\u3002\n\n    Args:\n        container (DIContainer): DI \u5bb9\u5668\u5b9e\u4f8b\u3002\n    \"\"\"\n    # \u8bb0\u5f55\u6570\u636e\u6301\u4e45\u5316\u4ed3\u5e93\n    container.register_singleton(RecordRepository)\n    # \u8fd0\u52a8\u89c4\u5212\u65b9\u6848\u6301\u4e45\u5316\u4ed3\u5e93\n    container.register_singleton(MotionPlanRepository)\n    # \u624b\u773c\u6807\u5b9a\u914d\u7f6e\u4ed3\u5e93\n    container.register_singleton(HandEyeCalibrationRepository)\n    # \u8f68\u8ff9\u6570\u636e\u4ed3\u5e93\n    container.register_singleton(TrajectoryRepository)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.register_domain_services","title":"register_domain_services","text":"<pre><code>register_domain_services(container: DIContainer) -&gt; None\n</code></pre> <p>\u6ce8\u518c Domain \u5c42\u670d\u52a1\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>container</code> <code>DIContainer</code> <p>DI \u5bb9\u5668\u5b9e\u4f8b\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/shared/config/service_registry.py</code> <pre><code>def register_domain_services(container: DIContainer) -&gt; None:\n    \"\"\"\u6ce8\u518c Domain \u5c42\u670d\u52a1\u3002\n\n    Args:\n        container (DIContainer): DI \u5bb9\u5668\u5b9e\u4f8b\u3002\n    \"\"\"\n    container.register_singleton(SerialDomainService)\n    container.register_singleton(MessageEncoder)\n    container.register_singleton(MessageDecoder)\n    container.register_singleton(MessageDomainService)\n    container.register_singleton(MotionRunner)\n    # \u8f68\u8ff9\u5e73\u6ed1\u670d\u52a1\n    container.register_singleton(SmoothDomainService)\n    # \u8fd0\u52a8\u5b66\u548c\u8f68\u8ff9\u89c4\u5212\u670d\u52a1\n    container.register_singleton(KinematicDomainService)\n    container.register_singleton(LinearMotionDomainService)  # \u4f9d\u8d56 KinematicDomainService\n    container.register_singleton(CurveMotionDomainService)  # \u4f9d\u8d56 KinematicDomainService\n    # S\u66f2\u7ebf\u7b97\u6cd5\n    container.register_singleton(SCurve)\n    # \u8f68\u8ff9\u89c4\u5212\u670d\u52a1\uff08\u4f9d\u8d56 SCurve, SmoothDomainService, LinearMotionDomainService, CurveMotionDomainService\uff09\n    container.register_singleton(TrajectoryPlanningService)\n    # \u8fd0\u52a8\u6784\u9020\u5668\uff08\u4f9d\u8d56 MotionRunner, TrajectoryPlanningService\uff09\n    container.register_singleton(MotionConstructor)\n    # \u673a\u68b0\u81c2\u72b6\u6001\u670d\u52a1\n    container.register_singleton(RobotStateDomainService)\n    # \u52a8\u529b\u5b66\u670d\u52a1\n    container.register_singleton(DynamicDomainService)\n    # \u793a\u6559\u8bb0\u5f55\u670d\u52a1\n    container.register_singleton(TeachRecordDomainService)\n    # \u8fd0\u52a8\u89c4\u5212\u670d\u52a1\n    container.register_singleton(MotionPlanningDomainService)\n    # \u89c6\u89c9\u670d\u52a1\n    container.register_singleton(CameraDomainService)\n    container.register_singleton(RecognitionDomainService)\n\n    # \u624b\u773c\u6807\u5b9a\u914d\u7f6e\uff08\u4f5c\u4e3a\u503c\u5bf9\u8c61\u6ce8\u5165\uff09\n    def create_hand_eye_config():\n        repo = resolve(HandEyeCalibrationRepository)\n        return repo.load()\n\n    container.register_singleton(HandEyeCalibrationConfig, create_hand_eye_config)\n\n    # \u624b\u773c\u6807\u5b9a\u670d\u52a1\uff08\u4f1a\u81ea\u52a8\u6ce8\u5165 HandEyeCalibrationConfig \u548c KinematicDomainService\uff09\n    container.register_singleton(HandEyeTransformDomainService)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.register_application_services","title":"register_application_services","text":"<pre><code>register_application_services(container: DIContainer) -&gt; None\n</code></pre> <p>\u6ce8\u518c Application \u5c42\u670d\u52a1\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>container</code> <code>DIContainer</code> <p>DI \u5bb9\u5668\u5b9e\u4f8b\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/shared/config/service_registry.py</code> <pre><code>def register_application_services(container: DIContainer) -&gt; None:\n    \"\"\"\u6ce8\u518c Application \u5c42\u670d\u52a1\u3002\n\n    Args:\n        container (DIContainer): DI \u5bb9\u5668\u5b9e\u4f8b\u3002\n    \"\"\"\n    container.register_singleton(MessageDisplay)\n    container.register_singleton(SerialApplicationService)\n    container.register_singleton(CommandHubService)\n    container.register_singleton(MessageResponseService)\n    container.register_singleton(MotionListener)\n    # \u8fd0\u52a8\u89c4\u5212\u5e94\u7528\u670d\u52a1\n    container.register_singleton(MotionPlanningApplicationService)\n    # \u6444\u50cf\u5934\u5e94\u7528\u670d\u52a1\n    container.register_singleton(CameraApplicationService)\n    # \u5de5\u5177\u5e94\u7528\u670d\u52a1\n    container.register_singleton(ToolsApplicationService)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.register_presentation_services","title":"register_presentation_services","text":"<pre><code>register_presentation_services(container: DIContainer) -&gt; None\n</code></pre> <p>\u6ce8\u518c Presentation \u5c42\u670d\u52a1\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>container</code> <code>DIContainer</code> <p>DI \u5bb9\u5668\u5b9e\u4f8b\u3002</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/shared/config/service_registry.py</code> <pre><code>def register_presentation_services(container: DIContainer) -&gt; None:\n    \"\"\"\u6ce8\u518c Presentation \u5c42\u670d\u52a1\u3002\n\n    Args:\n        container (DIContainer): DI \u5bb9\u5668\u5b9e\u4f8b\u3002\n    \"\"\"\n\n    container.register_singleton(DisplayViewModel)\n    container.register_singleton(SerialViewModel)\n    container.register_singleton(StatusViewModel)  \n    container.register_singleton(ControlViewModel)\n    container.register_singleton(EffectorViewModel)\n    container.register_singleton(TrajectoryViewModel)\n    container.register_singleton(DynamicsViewModel)  \n    # CameraViewModel \u53ea\u4f9d\u8d56 CameraApplicationService\uff08Application\u5c42\uff09\n    # DI\u5bb9\u5668\u4f1a\u81ea\u52a8\u6839\u636e\u6784\u9020\u51fd\u6570\u6ce8\u5165\u4f9d\u8d56\n    container.register_singleton(CameraViewModel)\n    # \u8fd0\u52a8\u89c4\u5212ViewModel\n    container.register_singleton(MotionPlanningViewModel)\n    # \u5de5\u5177ViewModel\n    container.register_singleton(ToolsViewModel)\n    container.register_singleton(MainViewModel)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.configure_services","title":"configure_services","text":"<pre><code>configure_services() -&gt; DIContainer\n</code></pre> <p>\u914d\u7f6e\u6240\u6709\u670d\u52a1\u3002</p> <p>\u6309\u5c42\u6b21\u6ce8\u518c\u6240\u6709\u4f9d\u8d56\u670d\u52a1\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>DIContainer</code> <code>DIContainer</code> <p>\u914d\u7f6e\u597d\u7684\u5bb9\u5668\u5b9e\u4f8b\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/shared/config/service_registry.py</code> <pre><code>def configure_services() -&gt; DIContainer:\n    \"\"\"\u914d\u7f6e\u6240\u6709\u670d\u52a1\u3002\n\n    \u6309\u5c42\u6b21\u6ce8\u518c\u6240\u6709\u4f9d\u8d56\u670d\u52a1\u3002\n\n    Returns:\n        DIContainer: \u914d\u7f6e\u597d\u7684\u5bb9\u5668\u5b9e\u4f8b\u3002\n    \"\"\"\n    container = get_container()\n\n    # \u6309\u5c42\u6b21\u6ce8\u518c\u670d\u52a1\n    register_infrastructure_services(container)\n    register_domain_services(container)\n    register_application_services(container)\n    register_presentation_services(container)\n\n    return container\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.get_main_view_model","title":"get_main_view_model","text":"<pre><code>get_main_view_model() -&gt; MainViewModel\n</code></pre> <p>\u4fbf\u6377\u65b9\u6cd5\uff1a\u83b7\u53d6\u4e3b\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>MainViewModel</code> <code>MainViewModel</code> <p>\u4e3b\u89c6\u56fe\u6a21\u578b\u5b9e\u4f8b\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/shared/config/service_registry.py</code> <pre><code>def get_main_view_model() -&gt; MainViewModel:\n    \"\"\"\u4fbf\u6377\u65b9\u6cd5\uff1a\u83b7\u53d6\u4e3b\u89c6\u56fe\u6a21\u578b\u3002\n\n    Returns:\n        MainViewModel: \u4e3b\u89c6\u56fe\u6a21\u578b\u5b9e\u4f8b\u3002\n    \"\"\"\n    return resolve(MainViewModel)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.get_serial_service","title":"get_serial_service","text":"<pre><code>get_serial_service() -&gt; SerialApplicationService\n</code></pre> <p>\u4fbf\u6377\u65b9\u6cd5\uff1a\u83b7\u53d6\u4e32\u53e3\u670d\u52a1\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>SerialApplicationService</code> <code>SerialApplicationService</code> <p>\u4e32\u53e3\u5e94\u7528\u670d\u52a1\u5b9e\u4f8b\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/shared/config/service_registry.py</code> <pre><code>def get_serial_service() -&gt; SerialApplicationService:\n    \"\"\"\u4fbf\u6377\u65b9\u6cd5\uff1a\u83b7\u53d6\u4e32\u53e3\u670d\u52a1\u3002\n\n    Returns:\n        SerialApplicationService: \u4e32\u53e3\u5e94\u7528\u670d\u52a1\u5b9e\u4f8b\u3002\n    \"\"\"\n    return resolve(SerialApplicationService)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.get_serial_view_model","title":"get_serial_view_model","text":"<pre><code>get_serial_view_model() -&gt; SerialViewModel\n</code></pre> <p>\u4fbf\u6377\u65b9\u6cd5\uff1a\u83b7\u53d6\u4e32\u53e3\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>SerialViewModel</code> <code>SerialViewModel</code> <p>\u4e32\u53e3\u89c6\u56fe\u6a21\u578b\u5b9e\u4f8b\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/shared/config/service_registry.py</code> <pre><code>def get_serial_view_model() -&gt; SerialViewModel:\n    \"\"\"\u4fbf\u6377\u65b9\u6cd5\uff1a\u83b7\u53d6\u4e32\u53e3\u89c6\u56fe\u6a21\u578b\u3002\n\n    Returns:\n        SerialViewModel: \u4e32\u53e3\u89c6\u56fe\u6a21\u578b\u5b9e\u4f8b\u3002\n    \"\"\"\n    return resolve(SerialViewModel)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.get_display_view_model","title":"get_display_view_model","text":"<pre><code>get_display_view_model() -&gt; DisplayViewModel\n</code></pre> <p>\u4fbf\u6377\u65b9\u6cd5\uff1a\u83b7\u53d6\u663e\u793a\u89c6\u56fe\u6a21\u578b\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>DisplayViewModel</code> <code>DisplayViewModel</code> <p>\u663e\u793a\u89c6\u56fe\u6a21\u578b\u5b9e\u4f8b\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/shared/config/service_registry.py</code> <pre><code>def get_display_view_model() -&gt; DisplayViewModel:\n    \"\"\"\u4fbf\u6377\u65b9\u6cd5\uff1a\u83b7\u53d6\u663e\u793a\u89c6\u56fe\u6a21\u578b\u3002\n\n    Returns:\n        DisplayViewModel: \u663e\u793a\u89c6\u56fe\u6a21\u578b\u5b9e\u4f8b\u3002\n    \"\"\"\n    return resolve(DisplayViewModel)\n</code></pre>"},{"location":"api/shared/config/service_registry/#controller.shared.config.service_registry.get_listener_service","title":"get_listener_service","text":"<pre><code>get_listener_service() -&gt; MotionListener\n</code></pre> <p>\u4fbf\u6377\u65b9\u6cd5\uff1a\u83b7\u53d6\u76d1\u542c\u670d\u52a1\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>MotionListener</code> <code>MotionListener</code> <p>\u76d1\u542c\u670d\u52a1\u5b9e\u4f8b\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>src/controller/controller/shared/config/service_registry.py</code> <pre><code>def get_listener_service() -&gt; MotionListener:\n    \"\"\"\u4fbf\u6377\u65b9\u6cd5\uff1a\u83b7\u53d6\u76d1\u542c\u670d\u52a1\u3002\n\n    Returns:\n        MotionListener: \u76d1\u542c\u670d\u52a1\u5b9e\u4f8b\u3002\n    \"\"\"\n    return resolve(MotionListener)\n</code></pre>"},{"location":"cv/","title":"\u8ba1\u7b97\u673a\u89c6\u89c9 (CV) \u6a21\u5757","text":"<p>CV \u6a21\u5757\u662f\u7cfb\u7edf\u7684\u89c6\u89c9\u611f\u77e5\u6838\u5fc3\uff0c\u8d1f\u8d23\u8bc6\u522b\u73af\u5883\u4e2d\u7684\u76ee\u6807\u7269\u4f53\u3001\u8ba1\u7b97\u5176\u7cbe\u786e\u4f4d\u7f6e\u548c\u59ff\u6001\u3002</p>"},{"location":"cv/#_1","title":"\u6838\u5fc3\u67b6\u6784","text":"<p>\u8be5\u6a21\u5757\u57fa\u4e8e Ultralytics YOLO11 \u6846\u67b6\uff0c\u4e13\u95e8\u9488\u5bf9\u5de5\u4e1a\u673a\u5668\u4eba\u573a\u666f\u8fdb\u884c\u4e86\u5b9a\u5236\u5f00\u53d1\uff0c\u4e3b\u8981\u5305\u542b\u4ee5\u4e0b\u6838\u5fc3\u7ec4\u4ef6\uff1a</p>"},{"location":"cv/#1-obb-coredetectorsobb","title":"1. OBB \u68c0\u6d4b\u5668 (<code>core/detectors/obb</code>)","text":"<p>\u4e00\u4e2a\u9ad8\u5185\u805a\u3001\u4f4e\u8026\u5408\u7684\u68c0\u6d4b\u5b50\u7cfb\u7edf\uff0c\u8d1f\u8d23\uff1a - \u6a21\u578b\u63a8\u7406\uff1a\u52a0\u8f7d YOLO11-OBB \u6a21\u578b\u8fdb\u884c\u65cb\u8f6c\u76ee\u6807\u68c0\u6d4b\u3002 - \u51e0\u4f55\u89e3\u7b97\uff1a\u7ed3\u5408 <code>Central</code> (\u672c\u4f53) \u548c <code>Head</code> (\u5934\u90e8) \u7684\u68c0\u6d4b\u7ed3\u679c\uff0c\u8ba1\u7b97\u673a\u5668\u4eba\u7cbe\u786e\u7684\u671d\u5411\u89d2\u5ea6\u3002 - \u4e1a\u52a1\u540e\u5904\u7406\uff1a\u89e3\u51b3 OBB \u68c0\u6d4b\u4e2d\u5e38\u89c1\u7684 180\u00b0 \u65b9\u5411\u6a21\u7cca\u95ee\u9898\u3002</p>"},{"location":"cv/#2-data_tools","title":"2. \u6570\u636e\u5de5\u5177 (<code>data_tools</code>)","text":"<p>\u7528\u4e8e\u8bad\u7ec3\u6570\u636e\u7684\u751f\u4ea7\u548c\u589e\u5f3a\uff1a - \u683c\u5f0f\u8f6c\u6362\uff1a\u5c06 LabelMe \u591a\u8fb9\u5f62\u6807\u6ce8\u8f6c\u6362\u4e3a YOLO-OBB \u683c\u5f0f\u3002 - \u6570\u636e\u589e\u5f3a\uff1a\u63d0\u4f9b\u968f\u673a\u65cb\u8f6c\u3001\u7ffb\u8f6c\u3001\u566a\u58f0\u3001\u6a21\u7cca\u7b49\u589e\u5f3a\u7b56\u7565\uff0c\u81ea\u52a8\u751f\u6210\u9ad8\u8d28\u91cf\u8bad\u7ec3\u96c6\u3002</p>"},{"location":"cv/#_2","title":"\u76ee\u5f55\u7ed3\u6784","text":"<pre><code>src/cv/\n\u251c\u2500\u2500 configs/                  # \u6a21\u578b\u914d\u7f6e\u6587\u4ef6 (.yaml)\n\u251c\u2500\u2500 core/                     # \u6838\u5fc3\u4ee3\u7801\n\u2502   \u2514\u2500\u2500 detectors/\n\u2502       \u2514\u2500\u2500 obb/              # OBB \u68c0\u6d4b\u5668\u5b50\u5305\n\u2502           \u251c\u2500\u2500 detector.py   # \u6838\u5fc3\u68c0\u6d4b\u7c7b\n\u2502           \u251c\u2500\u2500 geometry.py   # \u51e0\u4f55\u8ba1\u7b97\u5e93\n\u2502           \u251c\u2500\u2500 types.py      # \u6570\u636e\u7ed3\u6784\u5b9a\u4e49\n\u2502           \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 data_tools/               # \u6570\u636e\u751f\u6210\u4e0e\u5904\u7406\u5de5\u5177\n\u251c\u2500\u2500 weights/                  # \u6a21\u578b\u6743\u91cd\u6587\u4ef6\n\u2514\u2500\u2500 main.py                   # \u7a0b\u5e8f\u5165\u53e3\n</code></pre>"},{"location":"cv/data_tools/","title":"\u6570\u636e\u5de5\u5177\u94fe","text":"<p>\u9ad8\u8d28\u91cf\u7684\u6570\u636e\u662f\u6a21\u578b\u7cbe\u5ea6\u7684\u57fa\u77f3\u3002\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u5957\u5b8c\u6574\u7684\u5de5\u5177\u94fe\uff0c\u7528\u4e8e\u4ece LabelMe \u6807\u6ce8\u751f\u6210 YOLO \u8bad\u7ec3\u6570\u636e\u3002</p>"},{"location":"cv/data_tools/#_2","title":"\u6570\u636e\u751f\u6210\u5668","text":"<p>\u811a\u672c: <code>src/cv/data_tools/generate_yolo_obb_data.py</code></p> <p>\u8be5\u5de5\u5177\u8d1f\u8d23\u5c06\u5c11\u91cf\u7684\u539f\u59cb\u6807\u6ce8\u6570\u636e\u6269\u5145\u4e3a\u5927\u89c4\u6a21\u7684\u8bad\u7ec3\u96c6\u3002</p>"},{"location":"cv/data_tools/#_3","title":"\u4e3b\u8981\u529f\u80fd","text":"<ol> <li> <p>\u683c\u5f0f\u8f6c\u6362:</p> <ul> <li>\u8f93\u5165\uff1aLabelMe JSON\uff08\u591a\u8fb9\u5f62\u6807\u6ce8\uff09\u3002</li> <li>\u8f93\u51fa\uff1aYOLO OBB \u683c\u5f0f (<code>class_id x1 y1 x2 y2 x3 y3 x4 y4</code>)\u3002</li> <li>\u7b97\u6cd5\uff1a\u81ea\u52a8\u8ba1\u7b97\u591a\u8fb9\u5f62\u7684\u6700\u5c0f\u5916\u63a5\u65cb\u8f6c\u77e9\u5f62\u3002</li> </ul> </li> <li> <p>\u6570\u636e\u589e\u5f3a Pipeline:</p> <ul> <li>\u51e0\u4f55\u53d8\u6362: \u968f\u673a\u65cb\u8f6c\uff08+/- 30\u5ea6\uff09\u3001\u6c34\u5e73/\u5782\u76f4\u7ffb\u8f6c\u3002\u5173\u952e\u5728\u4e8e\u4e0d\u4ec5\u65cb\u8f6c\u56fe\u50cf\uff0c\u8fd8\u8981\u7cbe\u786e\u65cb\u8f6c\u6807\u6ce8\u5750\u6807\u3002</li> <li>\u50cf\u7d20\u589e\u5f3a: \u968f\u673a\u4eae\u5ea6/\u5bf9\u6bd4\u5ea6\u8c03\u6574\u3001\u9ad8\u65af\u566a\u58f0\u3001\u6a21\u7cca\u5904\u7406\u3002</li> </ul> </li> <li> <p>\u81ea\u52a8\u6570\u636e\u96c6\u6784\u5efa:</p> <ul> <li>\u4f9d\u636e\u8bbe\u5b9a\u7684 <code>target_count</code>\uff08\u5982 500 \u5f20\uff09\uff0c\u5faa\u73af\u751f\u6210\u589e\u5f3a\u6570\u636e\u3002</li> <li>\u81ea\u52a8\u6309\u6bd4\u4f8b\uff08\u9ed8\u8ba4 7:2:1\uff09\u5212\u5206 <code>train</code> / <code>val</code> / <code>test</code> \u96c6\u3002</li> <li>\u81ea\u52a8\u751f\u6210 <code>dataset.yaml</code> \u914d\u7f6e\u6587\u4ef6\u3002</li> </ul> </li> </ol>"},{"location":"cv/data_tools/#_4","title":"\u4f7f\u7528\u65b9\u6cd5","text":"<pre><code>python src/cv/data_tools/generate_yolo_obb_data.py \\\n    --annotations ./data/annotations \\\n    --output ./data/datasets/yolo_obb \\\n    --target_count 1000\n</code></pre>"},{"location":"cv/detectors/","title":"\u68c0\u6d4b\u5668\u67b6\u6784","text":"<p>CV \u6a21\u5757\u7684\u6838\u5fc3\u662f\u57fa\u4e8e YOLO11-OBB \u7684\u91cd\u6784\u68c0\u6d4b\u5668\u3002\u5b83\u91c7\u7528\u5206\u5c42\u67b6\u6784\u8bbe\u8ba1\uff0c\u5b9e\u73b0\u4e86\u9ad8\u5185\u805a\u4f4e\u8026\u5408\u3002</p>"},{"location":"cv/detectors/#yolo-obb","title":"YOLO-OBB \u68c0\u6d4b\u5668","text":"<p>\u4f4d\u4e8e <code>src/cv/core/detectors/obb/</code>\uff0c\u8be5\u7ec4\u4ef6\u88ab\u62c6\u5206\u4e3a\u591a\u4e2a\u804c\u8d23\u5355\u4e00\u7684\u6a21\u5757\u3002</p>"},{"location":"cv/detectors/#1-detectorpy","title":"1. \u6838\u5fc3\u68c0\u6d4b\u5668 (<code>detector.py</code>)","text":"<p>\u7c7b\u540d: <code>YOLOOBBDetector</code></p> <p>\u8fd9\u662f\u5bf9\u5916\u7684\u7edf\u4e00\u63a5\u53e3\uff08Facade\uff09\u3002\u5b83\u8d1f\u8d23\uff1a - \u52a0\u8f7d YOLO \u6a21\u578b\u3002 - \u63a5\u6536\u56fe\u50cf\u8f93\u5165\u3002 - \u534f\u8c03\u540e\u5904\u7406\u5668\u548c\u53ef\u89c6\u5316\u5668\u3002 - \u8fd4\u56de\u6807\u51c6\u5316\u7684\u7ed3\u679c\u5b57\u5178\u3002</p>"},{"location":"cv/detectors/#2-geometrypy","title":"2. \u51e0\u4f55\u8ba1\u7b97\u5c42 (<code>geometry.py</code>)","text":"<p>\u7c7b\u540d: <code>GeometryUtils</code></p> <p>\u7eaf\u6570\u5b66\u8ba1\u7b97\u5e93\uff0c\u4e0d\u4f9d\u8d56\u4e1a\u52a1\u903b\u8f91\u3002\u6838\u5fc3\u7b97\u6cd5\u5305\u62ec\uff1a - OBB \u89d2\u5ea6\u8ba1\u7b97: \u57fa\u4e8e\u957f\u8fb9\u65b9\u5411\u548c\u76ee\u6807\u5411\u91cf\u7684\u70b9\u79ef\uff0c\u8ba1\u7b97\u7cbe\u786e\u7684\u65cb\u8f6c\u89d2\u5ea6\uff08\u89e3\u51b3 180\u00b0 \u6a21\u7cca\uff09\u3002 - \u771f\u5b9e\u4e2d\u5fc3\u4fee\u6b63 (<code>Real Center</code>): \u6839\u636e\u51e0\u4f55\u5173\u7cfb\uff0c\u4ece\u68c0\u6d4b\u6846\u4e2d\u5fc3\u63a8\u5bfc\u7269\u4f53\u7684\u7269\u7406\u4e2d\u5fc3\u3002</p>"},{"location":"cv/detectors/#3-post_processorpy","title":"3. \u4e1a\u52a1\u540e\u5904\u7406 (<code>post_processor.py</code>)","text":"<p>\u7c7b\u540d: <code>RobotPoseProcessor</code></p> <p>\u5904\u7406\u7279\u5b9a\u7684\u673a\u5668\u4eba\u4e1a\u52a1\u903b\u8f91\uff1a - \u7b5b\u9009\u7f6e\u4fe1\u5ea6\u6700\u9ad8\u7684 <code>Central</code> \u548c <code>Head</code> \u76ee\u6807\u3002 - \u53ea\u6709\u5f53\u4e24\u8005\u540c\u65f6\u5b58\u5728\u65f6\uff0c\u624d\u8fdb\u884c\u59ff\u6001\u89e3\u7b97\u3002 - \u8c03\u7528\u51e0\u4f55\u5c42\u8ba1\u7b97\u6700\u7ec8\u7684\u89d2\u5ea6\u548c\u5411\u91cf\u3002</p>"},{"location":"cv/detectors/#4-typespy","title":"4. \u6570\u636e\u7ed3\u6784 (<code>types.py</code>)","text":"<p>\u4f7f\u7528 <code>dataclass</code> \u5b9a\u4e49\u5f3a\u7c7b\u578b\u6570\u636e\uff1a - <code>OBBDetection</code>: \u5355\u4e2a\u76ee\u6807\u7684\u68c0\u6d4b\u7ed3\u679c\uff08\u89d2\u70b9\u3001\u4e2d\u5fc3\u3001\u7f6e\u4fe1\u5ea6\uff09\u3002 - <code>RobotPoseResult</code>: \u6700\u7ec8\u89e3\u7b97\u51fa\u7684\u673a\u5668\u4eba\u59ff\u6001\uff08\u5305\u542b\u89d2\u5ea6\u3001\u65b9\u5411\u5411\u91cf\u3001\u53ef\u89c6\u5316\u8f85\u52a9\u70b9\uff09\u3002</p>"},{"location":"cv/detectors/#5-visualizerpy","title":"5. \u53ef\u89c6\u5316 (<code>visualizer.py</code>)","text":"<p>\u7c7b\u540d: <code>OBBVisualizer</code></p> <p>\u8d1f\u8d23\u5c06\u590d\u6742\u7684\u68c0\u6d4b\u7ed3\u679c\u7ed8\u5236\u5728\u56fe\u50cf\u4e0a\uff1a - \u7ed8\u5236\u65cb\u8f6c\u8fb9\u754c\u6846\u3002 - \u7ed8\u5236\u65b9\u5411\u7bad\u5934\u548c\u89d2\u5ea6\u5706\u5f27\u3002 - \u6807\u6ce8\u7c7b\u522b\u548c\u7f6e\u4fe1\u5ea6\u3002</p>"},{"location":"cv/quick_start/","title":"\u5feb\u901f\u5f00\u59cb","text":"<p>\u672c\u6587\u6863\u4ecb\u7ecd\u5982\u4f55\u5feb\u901f\u8fd0\u884c CV \u6a21\u5757\u8fdb\u884c\u63a8\u7406\u6d4b\u8bd5\u3002</p>"},{"location":"cv/quick_start/#_2","title":"\u73af\u5883\u51c6\u5907","text":"<ol> <li>\u786e\u4fdd\u5df2\u5b89\u88c5\u4f9d\u8d56\uff1a    <code>bash    pip install ultralytics opencv-python numpy</code></li> <li>\u786e\u4fdd\u6a21\u578b\u6743\u91cd\u6587\u4ef6 <code>best.pt</code> \u5df2\u653e\u7f6e\u5728 <code>src/cv/weights/</code> \u76ee\u5f55\u4e0b\u3002</li> </ol>"},{"location":"cv/quick_start/#_3","title":"\u8fd0\u884c\u63a8\u7406","text":"<p>\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7edf\u4e00\u7684\u5165\u53e3\u811a\u672c <code>main.py</code>\u3002</p> <ol> <li> <p>\u51c6\u5907\u6570\u636e:    \u5c06\u5f85\u6d4b\u8bd5\u7684\u56fe\u7247\u653e\u5165 <code>src/cv/data/raw/</code> \u76ee\u5f55\u3002</p> </li> <li> <p>\u6267\u884c\u547d\u4ee4:    <code>bash    python src/cv/main.py</code></p> </li> <li> <p>\u67e5\u770b\u7ed3\u679c:    \u5904\u7406\u5b8c\u6210\u540e\u7684\u56fe\u7247\u5c06\u4fdd\u5b58\u5728 <code>src/cv/data/outputs/</code> \u76ee\u5f55\u4e2d\u3002</p> </li> <li>\u5305\u542b\u7ed8\u5236\u597d\u7684 OBB \u6846\u3002</li> <li>\u5305\u542b\u65b9\u5411\u7bad\u5934\u548c\u89d2\u5ea6\u6807\u6ce8\u3002</li> </ol>"},{"location":"cv/quick_start/#_4","title":"\u4ee3\u7801\u793a\u4f8b","text":"<p>\u5982\u679c\u4f60\u60f3\u5728\u81ea\u5df1\u7684\u4ee3\u7801\u4e2d\u8c03\u7528\u68c0\u6d4b\u5668\uff1a</p> <pre><code>from src.cv.core.detectors.obb import YOLOOBBDetector\n\n# \u521d\u59cb\u5316\ndetector = YOLOOBBDetector(model_path='path/to/model.pt')\n\n# \u63a8\u7406\nresult = detector.detect_image('path/to/image.jpg')\n\n# \u83b7\u53d6\u59ff\u6001\u4fe1\u606f\nif result['pose_result']:\n    angle = result['pose_result'].final_angle\n    print(f\"Robot Angle: {angle}\")\n</code></pre>"},{"location":"index/quick_start/","title":"\u5feb\u901f\u5f00\u59cb","text":""},{"location":"index/quick_start/#_2","title":"\u73af\u5883\u914d\u7f6e","text":"<ul> <li><code>ubuntu 26.4</code> + <code>ros2 jazzy</code></li> </ul> <pre><code>sudo apt install curl\nsudo curl -sSL https://mirrors.tuna.tsinghua.edu.cn/rosdistro/ros.key -o /usr/share/keyrings/ros-archive-keyring.gpg\necho \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/ros-archive-keyring.gpg] https://mirrors.tuna.tsinghua.edu.cn/ros2/ubuntu $(source /etc/os-release &amp;&amp; echo $UBUNTU_CODENAME) main\" | sudo tee /etc/apt/sources.list.d/ros2.list &gt; /dev/null\nsudo apt update\nsudo apt upgrade\nsudo apt install libfuse2 git\n# \u6dfb\u52a0 151.101.84.133 raw.githubusercontent.com \u5230/etc/hosts\u6587\u4ef6\u4e2d\necho \"151.101.84.133 raw.githubusercontent.com\" | sudo tee -a /etc/hosts\nsudo apt update\nsudo apt upgrade\nsudo apt install ros-humble-desktop\nsudo apt install python3-colcon-common-extensions\necho \"source /opt/ros/humble/setup.bash\" &gt;&gt; ~/.bashrc\nsource ~/.bashrc\nsudo apt install rosdep\nsudo rosdep init\nrosdep update\ncd ~\nmkdir Codes\ncd Codes\ngit clone https://github.com/loukey/zz-ros.git\ngit checkout -b v0.5 origin/v0.5\ncolcon build\nsource install/setup.bash\nros2 run controller controller\n</code></pre>"},{"location":"index/quick_start/#_3","title":"\u914d\u7f6e\u6e05\u534e\u6e90","text":"<pre><code>sudo apt install curl\nsudo curl -sSL https://mirrors.tuna.tsinghua.edu.cn/rosdistro/ros.key -o /usr/share/keyrings/ros-archive-keyring.gpg\necho \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/ros-archive-keyring.gpg] https://mirrors.tuna.tsinghua.edu.cn/ros2/ubuntu $(source /etc/os-release &amp;&amp; echo $UBUNTU_CODENAME) main\" | sudo tee /etc/apt/sources.list.d/ros2.list &gt; /dev/null\nsudo apt update\nsudo apt upgrade\nsudo apt install libfuse2 git\n</code></pre>"},{"location":"index/quick_start/#ros2-jazzy","title":"\u5b89\u88c5ros2-jazzy","text":"<pre><code>sudo apt update\nsudo apt upgrade\nsudo apt install ros-humble-desktop\nsudo apt install python3-colcon-common-extensions\n</code></pre>"},{"location":"index/quick_start/#ros2-jazzy_1","title":"\u6d4b\u8bd5ros2-jazzy","text":"<pre><code>echo \"source /opt/ros/humble/setup.bash\" &gt;&gt; ~/.bashrc\nsource ~/.bashrc\nros2 run demo_nodes_cpp talker\nsudo apt install python3-rosdep\nsudo rosdep init\nrosdep update\n</code></pre>"},{"location":"index/quick_start/#_4","title":"\u4e0b\u8f7d\u4ee3\u7801","text":"<pre><code>cd ~\nmkdir Codes\ncd Codes\ngit clone https://github.com/loukey/zz-ros.git\ncd zz-ros\ngit checkout -b v0.6 origin/v0.6\ngit branch\ncolcon build\nsource install/setup.bash\nros2 run controller controller\nros2 run recognition recognition_pub\n\nsudo apt install python3-pip\npip install pyserial\npip install ultralytics -i https://pypi.tuna.tsinghua.edu.cn/simple\npip install \"numpy&lt;2\"\n</code></pre>"},{"location":"index/quick_start/#_5","title":"\u914d\u7f6e\u76f8\u673a","text":"<pre><code>cd ~/Codes\ngit clone https://github.com/orbbec/OrbbecSDK_ROS2.git\n\nsudo apt install libgflags-dev nlohmann-json3-dev \nsudo apt install ros-$ROS_DISTRO-image-transport  ros-${ROS_DISTRO}-image-transport-plugins ros-${ROS_DISTRO}-compressed-image-transport\nsudo apt install ros-$ROS_DISTRO-image-publisher ros-$ROS_DISTRO-camera-info-manager \nsudo apt install ros-$ROS_DISTRO-diagnostic-updater ros-$ROS_DISTRO-diagnostic-msgs ros-$ROS_DISTRO-statistics-msgs \nsudo apt install ros-$ROS_DISTRO-backward-ros libdw-dev\n\ncd OrbbecSDK_ROS2/orbbec_camera/scripts\nsudo bash install_udev_rules.sh\nsudo udevadm control --reload-rules &amp;&amp; sudo udevadm trigger\ncd ../../\ncolcon build --event-handlers  console_direct+  --cmake-args  -DCMAKE_BUILD_TYPE=Release\nsource install/setup.bash\nros2 launch orbbec_camera gemini_330_series.launch.py\n</code></pre>"},{"location":"index/quick_start/#usb","title":"\u914d\u7f6eUSB","text":"<pre><code>sudo systemctl stop brltty.service\nsudo usermod -aG dialout $USER\n</code></pre>"},{"location":"index/quick_start/#urdf","title":"URDF\u914d\u7f6e","text":"<pre><code># \u5b89\u88c5urdf\u4f9d\u8d56\nsudo apt install ros-jazzy-urdf-tutorial\n</code></pre>"},{"location":"index/config/dynamic_config/","title":"\u52a8\u529b\u5b66\u76f8\u5173\u914d\u7f6e","text":"<p>\u529b\u77e9\u8865\u507f\u8ba1\u7b97\u4f4d\u4e8e<code>controller/domain/algorithm/dynamic_domain_service.py</code>, \u9759\u6469\u64e6\u529b\u8865\u507f\u8ba1\u7b97\u4f4d\u4e8e<code>controller/domain/state/robot_state_domain_service.py</code>,\u5177\u4f53\u914d\u7f6e\u5982\u4e0b</p>"},{"location":"index/config/dynamic_config/#_2","title":"\u529b\u77e9\u8865\u507f","text":"<pre><code># \u8fde\u6746\u8d28\u91cf (kg)\nself.link_masses = [4.64, 10.755, 3.925, 1.24, 1.24, 1.546]\n\n# \u4f7f\u7528\u52a8\u529b\u5b66DH\u53c2\u6570\ndh_param = DHParam()\nself.dh_matrix = dh_param.get_dynamic_dh()\n\n# \u8fde\u6746\u8d28\u5fc3\u5728\u672c\u4f53\u5750\u6807\u7cfb\u4e0b\u7684\u4f4d\u7f6e (m)\nself.link_com_positions = [\n    np.array([0, 0, 0]),\n    np.array([0.2125, 0, 0.134]),\n    np.array([0.1818, 0, 0]),\n    np.array([0, 0, 0]),\n    np.array([0, 0, 0]),\n    np.array([0, 0, 0.05])\n]\n\n# \u91cd\u529b\u5411\u91cf (m/s\u00b2)\nself.g_vector = np.array([0, 0, -9.81])\n\n# \u5173\u8282\u6570\u91cf\nself.n = 6\n\n# \u8865\u507f\u7cfb\u6570\uff08\u6839\u636e\u5b9e\u9645\u673a\u68b0\u81c2\u8c03\u6574\uff09\nself.compensation_factor_front = 0.35  # \u524d3\u4e2a\u5173\u8282\nself.compensation_factor_rear = 0.25   # \u540e3\u4e2a\u5173\u8282\n</code></pre>"},{"location":"index/config/dynamic_config/#_3","title":"\u9759\u6469\u64e6\u529b","text":"<p>\u9759\u6469\u64e6\u529b\u5728\u83b7\u53d6\u529b\u77e9\u8fbe\u523019\u65f6\u5f00\u59cb\u8ba1\u7b97\uff0c\u53d6\u6700\u540e5\u4e2a\u503c\u7684\u5e73\u5747\u6765\u786e\u8ba4\u6469\u64e6\u529b\u65b9\u5411</p> <pre><code># \u9759\u6469\u64e6\u72b6\u6001\uff08\u6bcf\u4e2a\u5173\u8282\uff1a0=\u9759\u6b62, 1=\u8fd0\u52a8\uff09\nself._friction_state = [0] * 6\n\n# \u9759\u6469\u64e6\u8865\u507f\u503c\uff08Nm\uff09\nself._friction_compensation = [0.0] * 6\n\n# \u9759\u6469\u64e6\u914d\u7f6e\uff08\u9608\u503c\uff09\nself._friction_config = [4, 0, 3, 0.5, 0.5, 0.5]\n</code></pre>"},{"location":"index/config/hand_eye_config/","title":"\u624b\u773c\u6807\u5b9a\u914d\u7f6e","text":""},{"location":"index/config/hand_eye_config/#_1","title":"\u624b\u773c\u6807\u5b9a\u76f8\u5173\u914d\u7f6e","text":"<p>\u914d\u7f6e\u6587\u4ef6\u4f4d\u4e8e<code>controller/config/hand_eye_calibration.json</code>, \u914d\u7f6e\u5305\u542b\u4e86\u76f8\u673a\u5185\u53c2\uff0c\u624b\u773c\u6807\u5b9a\u77e9\u9635\u4ee5\u53ca\u672b\u7aef\u6267\u884c\u5668\u504f\u79fb\u53c2\u6570\u8bbe\u7f6e</p>"},{"location":"index/config/kinematic_config/","title":"\u8fd0\u52a8\u5b66\u76f8\u5173\u914d\u7f6e","text":""},{"location":"index/config/kinematic_config/#dh","title":"DH\u53c2\u6570\u914d\u7f6e","text":"<p>\u914d\u7f6e\u4f4d\u4e8e<code>controller/domain/value_objects/dh_param.py</code>, \u5982\u4e0b\u6240\u793a</p> <pre><code>self.kinematic_dh = np.array([\n    [0.0, 0.0, 0.0,  0.0],\n    [0.0, -pi/2, 0.0, -pi/2],\n    [0.425, pi, 0.0, 0.0],\n    [0.401, pi, 0.0856, pi/2],\n    [0.0, pi/2, 0.086, 0.0],\n    [0.0, -pi/2, 0.231, 0.0]  \n], dtype=float)\n\nself.dynamic_dh = np.array([\n    [0.0, 0.0, 0.0, 0.0],\n    [0.0, -pi/2, 0.0, -pi/2],\n    [0.425, pi, 0.0, 0.0],\n    [0.401, pi, 0.0856, pi/2],\n    [0.0, pi/2, 0.086, 0.0],\n    [0.0, -pi/2, 0.0725, 0.0]\n])\n</code></pre>"},{"location":"index/config/kinematic_config/#_2","title":"\u7f16\u7801\u5668\u96f6\u4f4d\u914d\u7f6e","text":"<p>\u914d\u7f6e\u4f4d\u4e8e<code>controller/domain/utils/robot_utils.py</code>, \u5982\u4e0b\u6240\u793a</p> <pre><code>\"\"\"\u521d\u59cb\u5316\u673a\u5668\u4eba\u53c2\u6570\u3002\"\"\"\nself.JOINT_OFFSETS = [79119, 369835, 83627, 392414, 507293, 456372]\nself.RADIAN_TO_POS_SCALE_FACTOR = (2**19) / (2 * pi)  # \u5f27\u5ea6\u8f6c\u4f4d\u7f6e\u503c\u7684\u7cfb\u6570\nself.POS_TO_RADIAN_SCALE_FACTOR = (2 * pi) / (2**19)  # \u4f4d\u7f6e\u503c\u8f6c\u5f27\u5ea6\u7684\u7cfb\u6570\nself.init_radians = [0, -pi/2, 0, pi/2, 0, 0]\n</code></pre>"},{"location":"index/config/message_config/","title":"\u6d88\u606f\u534f\u8bae\u5b57\u6bb5\u8bf4\u660e","text":"<p>\u914d\u7f6e\u4fee\u6539\u6587\u4ef6\u4e3a<code>controller/message_encoder_config.yaml</code>\u548c<code>controller/message_decoder_config.yaml</code></p>"},{"location":"index/config/message_config/#1-message-encoder","title":"1. \u53d1\u9001\u6d88\u606f (Message Encoder)","text":"<p>\u65b9\u5411\uff1a\u4e0a\u4f4d\u673a -&gt; \u63a7\u5236\u5668 (PC -&gt; MCU) \u603b\u957f\u5ea6\uff1a103 \u5b57\u8282 (\u5305\u542b\u5e27\u5934\u5e27\u5c3e\u548cCRC)</p> \u5b57\u6bb5\u540d\u79f0 \u5b57\u8282\u957f\u5ea6 \u8bf4\u660e Header 2 \u5e27\u5934 (0xAA55) <code>control</code> 1 \u63a7\u5236\u5b57 (\u9ed8\u8ba4 0x06) <code>mode</code> 1 \u8fd0\u884c\u6a21\u5f0f (\u9ed8\u8ba4 0x08) <code>joint_angles</code> 24 6\u4e2a\u5173\u8282\u7684\u76ee\u6807\u89d2\u5ea6 (\u6bcf\u4e2a\u5173\u82824\u5b57\u8282) <code>contour_speed</code> 18 6\u4e2a\u5173\u8282\u7684\u8f6e\u5ed3\u901f\u5ea6 (\u6bcf\u4e2a\u5173\u82823\u5b57\u8282) <code>contour_acceleration</code> 18 6\u4e2a\u5173\u8282\u7684\u8f6e\u5ed3\u52a0\u901f\u5ea6 (\u6bcf\u4e2a\u5173\u82823\u5b57\u8282) <code>contour_deceleration</code> 18 6\u4e2a\u5173\u8282\u7684\u8f6e\u5ed3\u51cf\u901f\u5ea6 (\u6bcf\u4e2a\u5173\u82823\u5b57\u8282) <code>torque</code> 12 6\u4e2a\u5173\u8282\u7684\u529b\u77e9\u524d\u9988 (\u6bcf\u4e2a\u5173\u82822\u5b57\u8282) <code>effector_mode</code> 1 \u672b\u7aef\u6267\u884c\u5668\u6a21\u5f0f <code>effector_data</code> 4 \u672b\u7aef\u6267\u884c\u5668\u6570\u636e (\u6d6e\u70b9\u6570) CRC 2 CRC16 \u6821\u9a8c\u7801 Footer 2 \u5e27\u5c3e (0x0D0A)"},{"location":"index/config/message_config/#2-message-decoder","title":"2. \u63a5\u6536\u6d88\u606f (Message Decoder)","text":"<p>\u65b9\u5411\uff1a\u63a7\u5236\u5668 -&gt; \u4e0a\u4f4d\u673a (MCU -&gt; PC) \u603b\u957f\u5ea6\uff1a121 \u5b57\u8282 (\u5305\u542b\u5e27\u5934\u5e27\u5c3e\u548cCRC)</p> \u5b57\u6bb5\u540d\u79f0 \u5b57\u8282\u957f\u5ea6 \u8bf4\u660e Header 2 \u534f\u8bae\u5934 (0xAA55) <code>init_status</code> 1 \u521d\u59cb\u5316\u72b6\u6001 <code>control</code> 1 \u5f53\u524d\u6536\u5230\u7684\u547d\u4ee4 <code>mode</code> 1 \u5f53\u524d\u8fd0\u884c\u6a21\u5f0f <code>positions</code> 24 6\u4e2a\u5173\u8282\u7684\u5f53\u524d\u4f4d\u7f6e (\u6bcf\u4e2a\u5173\u82824\u5b57\u8282) <code>status</code> 12 6\u4e2a\u5173\u8282\u7684\u72b6\u6001\u5b57 (\u6bcf\u4e2a\u5173\u82822\u5b57\u8282) <code>speeds</code> 24 6\u4e2a\u5173\u8282\u7684\u5b9e\u9645\u901f\u5ea6 (\u6bcf\u4e2a\u5173\u82824\u5b57\u8282) <code>torques</code> 12 6\u4e2a\u5173\u8282\u7684\u5f53\u524d\u529b\u77e9 (\u6bcf\u4e2a\u5173\u82822\u5b57\u8282) <code>double_encoder_interpolations</code> 24 \u53cc\u7f16\u7801\u5668\u63d2\u503c\u6570\u636e (\u6bcf\u4e2a\u5173\u82824\u5b57\u8282) <code>errors</code> 12 6\u4e2a\u5173\u8282\u7684\u9519\u8bef\u7801 (\u6bcf\u4e2a\u5173\u82822\u5b57\u8282) <code>effector_data</code> 4 \u672b\u7aef\u6267\u884c\u5668(\u5939\u722a)\u6570\u636e CRC 2 CRC16 \u6821\u9a8c\u7801 Footer 2 \u5e27\u5c3e (0x0D0A)"},{"location":"index/config/save_config/","title":"\u8f68\u8ff9\u4fdd\u5b58\u8bf4\u660e","text":"<p>\u672c\u7cfb\u7edf\u4e2d\u6709\u4e24\u79cd\u7c7b\u578b\u7684\u8f68\u8ff9\u4fdd\u5b58\u673a\u5236\uff0c\u5206\u522b\u5bf9\u5e94\u793a\u6559\u8bb0\u5f55\u548c\u8fd0\u52a8\u89c4\u5212\u65b9\u6848\u3002</p>"},{"location":"index/config/save_config/#1-teach-records","title":"1. \u793a\u6559\u8bb0\u5f55\u4fdd\u5b58 (Teach Records)","text":"<p>\u8fd9\u662f\u6307\u5728\"\u52a8\u529b\u5b66/\u793a\u6559\"\u6a21\u5f0f\u4e0b\u5f55\u5236\u7684\u539f\u59cb\u5173\u8282\u89d2\u5ea6\u6570\u636e\u3002</p> <ul> <li>\u4fdd\u5b58\u4f4d\u7f6e: \u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u7684 <code>teach_record.json</code> \u6587\u4ef6\u3002</li> <li>\u6587\u4ef6\u683c\u5f0f: JSON \u683c\u5f0f\u3002</li> <li>\u6570\u636e\u7ed3\u6784: \u5b57\u5178\u683c\u5f0f\uff0c\u952e\u4e3a\u8bb0\u5f55\u540d\u79f0\uff0c\u503c\u4e3a\u89d2\u5ea6\u5217\u8868\u7684\u5217\u8868\u3002     <code>json     {       \"record1\": [[0.1, 0.2, ...], [0.11, 0.21, ...]],       \"record2\": [...]     }</code></li> <li>\u547d\u540d\u89c4\u5219:<ul> <li>\u81ea\u52a8\u751f\u6210: <code>record1</code>, <code>record2</code>, <code>record3</code>... (\u9012\u589e\u8ba1\u6570)</li> <li>\u53cd\u8f6c\u8bb0\u5f55: <code>{\u539f\u540d}-\u53cd\u8f6c</code> (\u4f8b\u5982 <code>record1-\u53cd\u8f6c</code>)</li> <li>\u547d\u540d\u51b2\u7a81\u65f6: <code>{\u539f\u540d}-\u53cd\u8f6c-{\u5e8f\u53f7}</code> (\u4f8b\u5982 <code>record1-\u53cd\u8f6c-2</code>)</li> </ul> </li> <li>\u8d1f\u8d23\u7c7b: <code>RecordRepository</code> (\u4f4d\u4e8e <code>infrastructure/persistence/record_repository.py</code>)</li> </ul>"},{"location":"index/config/save_config/#2-motion-plan-trajectories","title":"2. \u8fd0\u52a8\u89c4\u5212\u8f68\u8ff9\u4fdd\u5b58 (Motion Plan Trajectories)","text":"<p>\u8fd9\u662f\u6307\u5728\"\u8fd0\u52a8\u89c4\u5212\"\u529f\u80fd\u4e2d\uff0c\u5c06\u89c4\u5212\u597d\u7684\u5e73\u6ed1\u8f68\u8ff9\uff08\u7ecf\u8fc7\u63d2\u503c\u548c\u6ee4\u6ce2\u540e\u7684\u6700\u7ec8\u6267\u884c\u70b9\uff09\u4fdd\u5b58\u4e0b\u6765\u7684\u6587\u4ef6\u3002\u8fd9\u4e9b\u6587\u4ef6\u901a\u5e38\u7528\u4e8e\u8c03\u8bd5\u3001\u5206\u6790\u6216\u4f5c\u4e3a\u672c\u5730\u8f68\u8ff9\u518d\u6b21\u52a0\u8f7d\u3002</p> <ul> <li>\u4fdd\u5b58\u4f4d\u7f6e: \u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u7684 <code>plans/</code> \u6587\u4ef6\u5939\u3002</li> <li>\u6587\u4ef6\u683c\u5f0f: JSON \u683c\u5f0f\u3002</li> <li>\u6570\u636e\u7ed3\u6784: \u7eaf\u5217\u8868\u683c\u5f0f\uff0c\u5305\u542b\u4e00\u7cfb\u5217\u5173\u8282\u89d2\u5ea6\u5217\u8868\u3002     <code>json     [       [0.0, -1.57, 0.0, 1.57, 0.0, 0.0],       [0.01, -1.56, 0.0, 1.57, 0.0, 0.0],       ...     ]</code></li> <li>\u547d\u540d\u89c4\u5219:<ul> <li>\u4fdd\u5b58\u6574\u4e2a\u65b9\u6848: \u4f7f\u7528\u65b9\u6848\u540d\u79f0\u4f5c\u4e3a\u6587\u4ef6\u540d\u3002\u4f8b\u5982 <code>\u9ed8\u8ba4\u65b9\u6848.json</code>\u3002</li> <li>\u4fdd\u5b58\u5355\u4e2a\u8282\u70b9: \u4f7f\u7528 <code>{\u65b9\u6848\u540d}-{\u8282\u70b9\u7d22\u5f15}</code> \u4f5c\u4e3a\u6587\u4ef6\u540d\u3002\u4f8b\u5982 <code>\u9ed8\u8ba4\u65b9\u6848-0.json</code>, <code>\u9ed8\u8ba4\u65b9\u6848-1.json</code>\u3002</li> </ul> </li> <li>\u8d1f\u8d23\u7c7b: <code>TrajectoryRepository</code> (\u4f4d\u4e8e <code>infrastructure/persistence/trajectory_repository.py</code>)</li> </ul>"},{"location":"index/config/save_config/#3-motion-plan-configuration","title":"3. \u8fd0\u52a8\u65b9\u6848\u914d\u7f6e\u4fdd\u5b58 (Motion Plan Configuration)","text":"<p>\u8fd9\u662f\u6307\u4fdd\u5b58\u8fd0\u52a8\u89c4\u5212\u7684\u914d\u7f6e\u53c2\u6570\uff08\u5982\u8282\u70b9\u5217\u8868\u3001\u76ee\u6807\u70b9\u3001\u66f2\u7ebf\u7c7b\u578b\u7b49\uff09\uff0c\u800c\u4e0d\u662f\u5177\u4f53\u7684\u8f68\u8ff9\u70b9\u3002</p> <ul> <li>\u4fdd\u5b58\u4f4d\u7f6e: \u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u7684 <code>motion_planning_plans.json</code> \u6587\u4ef6\u3002</li> <li>\u6587\u4ef6\u683c\u5f0f: JSON \u683c\u5f0f\u3002</li> <li>\u547d\u540d\u89c4\u5219: \u53ea\u6709\u4e00\u4e2a\u56fa\u5b9a\u6587\u4ef6\u3002</li> <li>\u8d1f\u8d23\u7c7b: <code>MotionPlanRepository</code> (\u4f4d\u4e8e <code>infrastructure/persistence/motion_plan_repository.py</code>)</li> </ul>"},{"location":"introduction/base/","title":"\u57fa\u7840\u77e5\u8bc6","text":"<ul> <li><code>https://xw4l8he0hag.feishu.cn/docx/TM7bdoWGNooAKbxQXTjcF8IOnkg</code></li> </ul>"},{"location":"introduction/dh_setting/","title":"\u673a\u68b0\u81c2DH\u8bbe\u7f6e","text":""},{"location":"introduction/dh_setting/#_1","title":"\u673a\u68b0\u81c2\u56fe\u89e3","text":""},{"location":"introduction/dh_setting/#_2","title":"\u8fde\u6746\u53c2\u6570\u8868","text":"<p>\u4e0b\u8868\u5217\u51fa\u4e86\u673a\u68b0\u81c2\u7684\u6807\u51c6 DH \u53c2\u6570\uff08Denavit-Hartenberg Parameters\uff09\u3002</p> i (\u8fde\u6746\u7f16\u53f7) \u8fde\u6746\u957f\u5ea6 \\(a_{i-1}\\) \u8fde\u6746\u8f6c\u89d2 \\(\\alpha_{i-1}\\) \u8fde\u6746\u504f\u8ddd \\(d_{i}\\) \u5173\u8282\u89d2 \\(\\theta_{i}\\) 1 0.0 0.0 0.0 0.0 2 0.0 \\(-\\pi/2\\) (-90\u00b0) 0.0 \\(-\\pi/2\\) (-90\u00b0) 3 0.425 \\(\\pi\\) (180\u00b0) 0.0 0.0 4 0.401 \\(\\pi\\) (180\u00b0) 0.0856 \\(\\pi/2\\) (90\u00b0) 5 0.0 \\(\\pi/2\\) (90\u00b0) 0.086 0.0 6 0.0 \\(-\\pi/2\\) (-90\u00b0) 0.0725 0.0"},{"location":"introduction/hand_eye_calibration/","title":"\u624b\u773c\u6807\u5b9a (Hand-Eye Calibration)","text":""},{"location":"introduction/hand_eye_calibration/#1","title":"1. \u5750\u6807\u7cfb\u5b9a\u4e49\u4e0e\u53d8\u6362","text":"<p>\u5728\u624b\u773c\u6807\u5b9a\u7cfb\u7edf\u4e2d\uff0c\u6211\u4eec\u4e3b\u8981\u5173\u6ce8\u4ee5\u4e0b\u56db\u4e2a\u5173\u952e\u5750\u6807\u7cfb\u53ca\u5176\u76f8\u4e92\u4e4b\u95f4\u7684\u53d8\u6362\u5173\u7cfb\u3002</p>"},{"location":"introduction/hand_eye_calibration/#_1","title":"\u5750\u6807\u7cfb\u5b9a\u4e49","text":"<ul> <li>\\(\\textbf{W}\\) (World): \u57fa\u5750\u6807\u7cfb\uff0c\u673a\u68b0\u81c2\u7684\u56fa\u5b9a\u5e95\u5ea7\u5750\u6807\u7cfb\u3002</li> <li>\\(\\textbf{G}\\) (Gripper): \u672b\u7aef\u6267\u884c\u5668\u5750\u6807\u7cfb\uff08\u6216\u6cd5\u5170\u5750\u6807\u7cfb\uff09\uff0c\u968f\u673a\u68b0\u81c2\u8fd0\u52a8\u3002</li> <li>\\(\\textbf{C}\\) (Camera): \u76f8\u673a\u5750\u6807\u7cfb\uff0c\u968f\u76f8\u673a\u79fb\u52a8\uff08\u773c\u5728\u624b\u4e0a\uff09\u3002</li> <li>\\(\\textbf{B}\\) (Board): \u6807\u5b9a\u677f\u5750\u6807\u7cfb\uff0c\u56fa\u5b9a\u5728\u7a7a\u95f4\u4e2d\u7684\u67d0\u4e2a\u4f4d\u7f6e\uff08\u773c\u5728\u624b\u4e0a\u573a\u666f\uff09\u3002</li> </ul>"},{"location":"introduction/hand_eye_calibration/#_2","title":"\u5750\u6807\u7cfb\u53d8\u6362","text":"<ul> <li>\\({}^{W}_G\\textbf{R}\\): \u57fa\u5750\u6807\u7cfb\u5230\u5939\u722a\u5750\u6807\u7cfb\u7684\u53d8\u6362\uff08\u7531\u673a\u68b0\u81c2\u6b63\u8fd0\u52a8\u5b66\u5df2\u77e5\uff09\u3002</li> <li>\\({}^{G}_C\\textbf{R}\\): \u5939\u722a\u5750\u6807\u7cfb\u5230\u76f8\u673a\u5750\u6807\u7cfb\u7684\u53d8\u6362\uff08\u5f85\u6c42\u89e3\u7684\u672a\u77e5\u91cf \\(X\\)\uff09\u3002</li> <li>\\({}^{C}_B\\textbf{R}\\): \u76f8\u673a\u5750\u6807\u7cfb\u5230\u6807\u5b9a\u677f\u5750\u6807\u7cfb\u7684\u53d8\u6362\uff08\u7531\u76f8\u673a\u62cd\u6444\u6807\u5b9a\u677f\u56fe\u50cf\u89e3\u7b97\u5f97\u5230\uff09\u3002</li> </ul>"},{"location":"introduction/hand_eye_calibration/#2","title":"2. \u624b\u773c\u6807\u5b9a\u7406\u8bba","text":"<p>\u624b\u773c\u6807\u5b9a\u7684\u6838\u5fc3\u76ee\u7684\u662f\u6c42\u89e3\u76f8\u673a\u76f8\u5bf9\u4e8e\u672b\u7aef\u6267\u884c\u5668\u7684\u56fa\u5b9a\u53d8\u6362\u77e9\u9635 \\(X\\)\uff08\u5373 \\({}^{G}_C\\textbf{R}\\)\uff09\u3002</p>"},{"location":"introduction/hand_eye_calibration/#_3","title":"\u6c42\u89e3\u539f\u7406","text":"<p>\u6211\u4eec\u901a\u8fc7\u63a7\u5236\u673a\u68b0\u81c2\u79fb\u52a8\u5230\u4e0d\u540c\u7684\u4f4d\u7f6e \\(i\\) \u548c \\(j\\)\uff0c\u5e76\u5728\u6bcf\u4e2a\u4f4d\u7f6e\u62cd\u6444\u6807\u5b9a\u677f\u3002\u5bf9\u4e8e\u4efb\u610f\u4e24\u4e2a\u4f4d\u7f6e\uff0c\u7a7a\u95f4\u4e2d\u6807\u5b9a\u677f\u76f8\u5bf9\u4e8e\u57fa\u5750\u6807\u7cfb\u7684\u4f4d\u59ff\u5e94\u8be5\u662f\u56fa\u5b9a\u7684\uff08\u6216\u8005\u5f62\u6210\u95ed\u73af\u94fe\uff09\uff0c\u4ece\u800c\u5efa\u7acb\u65b9\u7a0b\u3002</p> <ol> <li> <p>\u5efa\u7acb\u95ed\u73af\u65b9\u7a0b     \u5bf9\u4e8e\u4efb\u610f\u4e24\u4e2a\u65f6\u523b \\(i\\) \u548c \\(j\\)\uff0c\u4ece\u57fa\u5750\u6807\u7cfb\u51fa\u53d1\uff0c\u7ecf\u7531\u4e0d\u540c\u7684\u8def\u5f84\u5230\u8fbe\u6807\u5b9a\u677f\u5750\u6807\u7cfb\uff0c\u5176\u7ed3\u679c\u5e94\u8be5\u662f\u76f8\u7b49\u7684\uff1a</p> \\[ {}^{W}_G\\textbf{R}_i \\cdot {}^{G}_C\\textbf{R} \\cdot {}^{C}_B\\textbf{R}_i = {}^{W}_G\\textbf{R}_j \\cdot {}^{G}_C\\textbf{R} \\cdot {}^{C}_B\\textbf{R}_j \\] </li> <li> <p>\u53d8\u6362\u6574\u7406     \u5c06\u4e0a\u5f0f\u53f3\u4fa7\u7684 \\({}^{C}_B\\textbf{R}_j\\) \u79fb\u5230\u5de6\u4fa7\uff08\u53f3\u4e58\u5176\u9006\u77e9\u9635\uff09\uff1a</p> \\[ {}^{W}_G\\textbf{R}_i \\cdot {}^{G}_C\\textbf{R} \\cdot {}^{C}_B\\textbf{R}_i \\cdot {}^{C}_B\\textbf{R}^{-1}_j = {}^{W}_G\\textbf{R}_j \\cdot {}^{G}_C\\textbf{R} \\] </li> <li> <p>\u5206\u79bb\u672a\u77e5\u91cf     \u5c06\u4e0a\u5f0f\u5de6\u4fa7\u7684 \\({}^{W}_G\\textbf{R}_i\\) \u79fb\u5230\u53f3\u4fa7\uff08\u5de6\u4e58\u5176\u9006\u77e9\u9635\uff09\uff1a</p> \\[ {}^{G}_C\\textbf{R} \\cdot \\left( {}^{C}_B\\textbf{R}_i \\cdot {}^{C}_B\\textbf{R}^{-1}_j \\right) = \\left( {}^{W}_G\\textbf{R}^{-1}_i \\cdot {}^{W}_G\\textbf{R}_j \\right) \\cdot {}^{G}_C\\textbf{R} \\] </li> <li> <p>\u6784\u5efa \\(AX=XB\\) \u6a21\u578b     \u5b9a\u4e49\u4ee5\u4e0b\u4e2d\u95f4\u53d8\u91cf\uff1a</p> <ul> <li>\\(A = {}^{W}_G\\textbf{R}^{-1}_i \\cdot {}^{W}_G\\textbf{R}_j\\) \uff08\u673a\u68b0\u81c2\u4e24\u6b21\u8fd0\u52a8\u4e4b\u95f4\u7684\u76f8\u5bf9\u53d8\u6362\uff09</li> <li>\\(B = {}^{C}_B\\textbf{R}_i \\cdot {}^{C}_B\\textbf{R}^{-1}_j\\) \uff08\u76f8\u673a\u4e24\u6b21\u89c2\u6d4b\u4e4b\u95f4\u7684\u76f8\u5bf9\u53d8\u6362\uff09</li> <li>\\(X = {}^{G}_C\\textbf{R}\\) \uff08\u5f85\u6c42\u89e3\u7684\u624b\u773c\u53d8\u6362\u77e9\u9635\uff09</li> </ul> <p>\u5219\u95ee\u9898\u8f6c\u5316\u4e3a\u7ecf\u5178\u7684\u77e9\u9635\u65b9\u7a0b\u6c42\u89e3\uff1a</p> \\[ A \\cdot X = X \\cdot B \\] </li> </ol> <p>\u901a\u8fc7\u6536\u96c6\u591a\u7ec4 \\(i, j\\) \u8fd0\u52a8\u6570\u636e\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u6570\u503c\u65b9\u6cd5\uff08\u5982 Tsai, Lenz, Park \u7b49\u7b97\u6cd5\uff09\u89e3\u51fa\u77e9\u9635 \\(X\\)\u3002</p>"}]}